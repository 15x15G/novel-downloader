// ==UserScript==
// @name           小说下载器
// @version        4.4.11.327
// @author         bgme
// @description    一个可扩展的通用型小说下载器。
// @supportURL     https://github.com/yingziwu/novel-downloader
// @match          *://www.ciweimao.com/chapter-list/*
// @match          *://book.sfacg.com/Novel/*/MainIndex/
// @match          *://book.qidian.com/info/*
// @match          *://www.jjwxc.net/onebook.php?novelid=*
// @match          *://www.gongzicp.com/novel-*.html
// @match          *://gongzicp.com/novel-*.html
// @match          *://book.zongheng.com/showchapter/*.html
// @match          *://huayu.zongheng.com/showchapter/*.html
// @match          *://www.linovel.net/book/*.html
// @match          *://www.17k.com/list/*.html
// @match          *://www.shuhai.com/book/*.htm
// @match          *://mm.shuhai.com/book/*.htm
// @match          *://www.tadu.com/book/*
// @match          *://www.qimao.com/shuku/*/
// @match          *://sosad.fun/threads/*/profile*
// @match          *://wenzhan.org/threads/*/profile*
// @match          *://sosadfun.com/threads/*/profile*
// @match          *://xn--pxtr7m5ny.com/threads/*/profile*
// @match          *://xn--pxtr7m.com/threads/*/profile*
// @match          *://xn--pxtr7m5ny.net/threads/*/profile*
// @match          *://xn--pxtr7m.net/threads/*/profile*
// @match          *://sosadfun.link/threads/*/profile*
// @match          *://www.sosad.fun/threads/*/profile*
// @match          *://www.wenzhan.org/threads/*/profile*
// @match          *://www.sosadfun.com/threads/*/profile*
// @match          *://www.xn--pxtr7m5ny.com/threads/*/profile*
// @match          *://www.xn--pxtr7m.com/threads/*/profile*
// @match          *://www.xn--pxtr7m5ny.net/threads/*/profile*
// @match          *://www.xn--pxtr7m.net/threads/*/profile*
// @match          *://www.sosadfun.link/threads/*/profile*
// @match          *://www.uukanshu.com/b/*/
// @match          *://www.yruan.com/article/*.html
// @match          *://www.biquwoo.com/bqw*/
// @match          *://www.biquwo.org/bqw*/
// @match          *://www.shuquge.com/txt/*/index.html
// @match          *://m.shuquge.com/s/*.html
// @match          *://m.shuquge.com/d/*.html
// @match          *://www.sizhicn.com/txt/*/index.html
// @match          *://www.dingdiann.net/ddk*/
// @match          *://www.xkzw.org/xkzw*/
// @match          *://www.lewenn.com/lw*/
// @match          *://www.klxs.la/info-*/
// @match          *://www.266ks.com/*_*/
// @match          *://www.266ks.com/*_*/index*.html
// @match          *://www.hetushu.com/book/*/index.html
// @match          *://hetushu.com/book/*/index.html
// @match          *://www.shouda8.com/*/
// @match          *://www.shouda88.com/*/
// @match          *://www.gebiqu.com/biquge_*/
// @match          *://www.meegoq.com/book*.html
// @match          *://www.viviyzw.com/book*.html
// @match          *://www.xiaoshuodaquan.com/*/
// @match          *://www.1pwx.com/*/
// @match          *://1pwx.com/*/
// @match          *://www.81book.com/book/*/
// @match          *://www.81zw.com/book/*/
// @match          *://m.yuzhaige.cc/*/*/
// @match          *://m.yushuge123.com/*/*/
// @match          *://www.xinwanben.com/*/
// @match          *://m.xinwanben.com/*/
// @match          *://www.idejian.com/book/*/
// @match          *://www.wenku8.net/novel/*/*/index.htm
// @match          *://www.dmzj.com/info/*.html
// @match          *://manhua.dmzj.com/*/
// @match          *://www.westnovel.com/*/*/
// @match          *://www.mht.tw/*/
// @match          *://www.mht99.com/*/
// @match          *://www.bz01.org/*_*/
// @match          *://www.banzhuer.org/*_*/
// @match          *://www.xbiquge.so/book/*/
// @match          *://www.hongyeshuzhai.com/shuzhai/*/
// @match          *://www.linovelib.com/novel/*/catalog
// @match          *://www.luoqiuzw.com/book/*/
// @match          *://www.yibige.la/*/
// @match          *://www.fushuwang.org/*/*/*/*.html
// @match          *://www.fushuwang.org/*/*/*/*.html?*
// @match          *://www.soxscc.net/*/
// @match          *://www.soxscc.org/*/
// @match          *://www.soxs.cc/*/
// @match          *://www.soshuw.com/*/
// @match          *://www.soshuwu.org/*/
// @match          *://www.soxscc.cc/*/
// @match          *://www.soshuwu.com/*/
// @match          *://www.kubiji.net/*/
// @match          *://www.shubaowa.org/*_*/
// @match          *://www.fuguoduxs.com/*_*/
// @match          *://www.xyqxs.cc/html/*/*/index.html
// @match          *://www.630shu.net/shu/*.html
// @match          *://www.qingoo.cn/details?bookId=*
// @match          *://www.trxs.cc/tongren/*.html
// @match          *://www.trxs123.com/tongren/*.html
// @match          *://www.jpxs123.com/*/*.html
// @match          *://trxs.cc/tongren/*.html
// @match          *://trxs123.com/tongren/*.html
// @match          *://jpxs123.com/*/*.html
// @match          *://www.tongrenquan.org/tongren/*.html
// @match          *://www.tongrenquan.me/tongren/*.html
// @match          *://tongrenquan.me/tongren/*.html
// @match          *://www.imiaobige.com/read/*/
// @match          *://www.256wxc.com/read/*/index.html
// @match          *://www.256wxc.com/read/*/
// @match          *://www.256wenku.com/read/*/index.html
// @match          *://www.256wenku.com/read/*/
// @match          *://www.biquge66.com/biquge*/
// @match          *://*.lofter.com/
// @match          *://*.lofter.com/?page=*
// @match          *://www.lwxs9.org/*/*/
// @match          *://www.shubl.com/book/book_detail/*
// @match          *://www.ujxs.net/read/*/
// @match          *://m.haitangtxt.net/*/*/
// @match          *://ebook.longmabook.com/?act=showinfo&bookwritercode=*&bookid=*
// @match          *://www.longmabookcn.com/?act=showinfo&bookwritercode=*&bookid=*
// @match          *://ebook.lmbooks.com/?act=showinfo&bookwritercode=*&bookid=*
// @match          *://www.lmebooks.com/?act=showinfo&bookwritercode=*&bookid=*
// @match          *://www.haitbook.com/?act=showinfo&bookwritercode=*&bookid=*
// @match          *://www.htwhbook.com/?act=showinfo&bookwritercode=*&bookid=*
// @match          *://www.myhtebook.com/?act=showinfo&bookwritercode=*&bookid=*
// @match          *://www.lovehtbooks.com/?act=showinfo&bookwritercode=*&bookid=*
// @match          *://www.myhtebooks.com/?act=showinfo&bookwritercode=*&bookid=*
// @match          *://www.myhtlmebook.com/?act=showinfo&bookwritercode=*&bookid=*
// @match          *://jp.myhtebook.com/?act=showinfo&bookwritercode=*&bookid=*
// @match          *://jp.myhtlmebook.com/?act=showinfo&bookwritercode=*&bookid=*
// @match          *://ebook.urhtbooks.com/?act=showinfo&bookwritercode=*&bookid=*
// @match          *://www.urhtbooks.com/?act=showinfo&bookwritercode=*&bookid=*
// @match          *://www.newhtbook.com/?act=showinfo&bookwritercode=*&bookid=*
// @match          *://www.lvhtebook.com/?act=showinfo&bookwritercode=*&bookid=*
// @match          *://jp.lvhtebook.com/?act=showinfo&bookwritercode=*&bookid=*
// @match          *://www.htlvbooks.com/?act=showinfo&bookwritercode=*&bookid=*
// @match          *://dijiubook.net/*_*/
// @match          *://www.biquwx.la/*_*/
// @match          *://www.25zw.com/*/
// @match          *://www.tycqxs.com/*_*/
// @name:en        novel-downloader
// @description:en An scalable universal novel downloader.
// @namespace      https://blog.bgme.me
// @icon           https://cdn.jsdelivr.net/gh/yingziwu/novel-downloader/assets/icon.png
// @license        AGPL-3.0
// @run-at         document-start
// @noframes       
// @compatible     Firefox 77+
// @compatible     Chrome 85+
// @compatible     Edge 85+
// @compatible     Opera 71+
// @compatible     Safari 13.1+
// @incompatible   Internet Explorer
// @exclude        *://www.jjwxc.net/onebook.php?novelid=*&chapterid=*
// @exclude        *://www.meegoq.com/book/*.html
// @exclude        *://www.viviyzw.com/book/*.html
// @exclude        *://www.yruan.com/article/*/*.html
// @exclude        *://m.yuzhaige.cc/tag/*/
// @exclude        *://m.yuzhaige.cc/sort/*/
// @exclude        *://m.yuzhaige.cc/top/*/
// @exclude        *://m.yuzhaige.cc/full/*/
// @exclude        *://m.yuzhaige.cc/book/*/
// @exclude        *://m.yushuge123.com/tag/*/
// @exclude        *://m.yushuge123.com/sort/*/
// @exclude        *://m.yushuge123.com/top/*/
// @exclude        *://m.yushuge123.com/full/*/
// @exclude        *://m.yushuge123.com/book/*/
// @exclude        *://www.linovel.net/book/*/*.html
// @exclude        *://www.qimao.com/shuku/*-*/
// @exclude        *://www.trxs.cc/tongren/*/*.html
// @exclude        *://www.trxs123.com/tongren/*/*.html
// @exclude        *://www.tongrenquan.org/tongren/*/*.html
// @exclude        *://tongrenquan.org/tongren/*/*.html
// @exclude        *://www.jpxs123.com/*/*/*.html
// @exclude        *://m.haitangtxt.net/tag/*/
// @exclude        *://m.haitangtxt.net/sort/*/
// @exclude        *://m.haitangtxt.net/top/*/
// @exclude        *://m.haitangtxt.net/full/*/
// @exclude        *://m.haitangtxt.net/book/*/
// @exclude        *://www.tadu.com/book/*/*/*
// @exclude        *://www.tadu.com/book/*/0*
// @exclude        *://www.tadu.com/book/*/1*
// @exclude        *://www.tadu.com/book/*/2*
// @exclude        *://www.tadu.com/book/*/3*
// @exclude        *://www.tadu.com/book/*/4*
// @exclude        *://www.tadu.com/book/*/5*
// @exclude        *://www.tadu.com/book/*/6*
// @exclude        *://www.tadu.com/book/*/7*
// @exclude        *://www.tadu.com/book/*/8*
// @exclude        *://www.tadu.com/book/*/9*
// @exclude        *://www.25zw.com/lastupdate/
// @exclude        *://www.25zw.com/postdate/
// @exclude        *://www.25zw.com/monthvisit/
// @exclude        *://www.25zw.com/goodnum/
// @exclude        *://www.25zw.com/goodnew/
// @grant          unsafeWindow
// @grant          GM_info
// @grant          GM_xmlhttpRequest
// @grant          GM_setValue
// @grant          GM_getValue
// @grant          GM_deleteValue
// @grant          GM.info
// @grant          GM.xmlHttpRequest
// @grant          GM.setValue
// @grant          GM.getValue
// @grant          GM.deleteValue
// @connect        self
// @connect        shouda8.com
// @connect        shouda88.com
// @connect        qidian.com
// @connect        yuewen.com
// @connect        kuangxiangit.com
// @connect        sinaimg.cn
// @connect        jjwxc.net
// @connect        image.gebiqu.com
// @connect        qpic.cn
// @connect        zongheng.com
// @connect        17k.com
// @connect        img.uukanshu.com
// @connect        aliyuncs.com
// @connect        cdn.bcebos.com
// @connect        rs.sfacg.com
// @connect        shuhai.com
// @connect        ch-intel.com
// @connect        huluxia.com
// @connect        linovel.net
// @connect        ax1x.com
// @connect        tadu.com
// @connect        zhangyue01.com
// @connect        cdn.wtzw.com
// @connect        wenku8.com
// @connect        dmzj.com
// @connect        hongyeshuzhal.com
// @connect        hongyeshuzhai.com
// @connect        linovelib.com
// @connect        soxscc.net
// @connect        soxscc.org
// @connect        soxs.cc
// @connect        soshuw.com
// @connect        soxscc.cc
// @connect        soshuwu.com
// @connect        kubiji.net
// @connect        idejian.com
// @connect        img.imiaobige.com
// @connect        postimg.cc
// @connect        lofter.com
// @connect        lf127.net
// @connect        126.net
// @connect        shubl.com
// @connect        loli.net
// @connect        alicdn.com
// @connect        toutiaoimg.com
// @connect        imgdb.cn
// @connect        meego.cn
// @connect        poco.cn
// @connect        dijiuzww.com
// @connect        25zw.com
// @connect        sina.com.cn
// @connect        *
// @require        https://cdn.jsdelivr.net/npm/crypto-js@4.1.1/crypto-js.js#sha512-NQVmLzNy4Lr5QTrmXvq/WzTMUnRHmv7nyIT/M6LyGPBS+TIeRxZ+YQaqWxjpRpvRMQSuYPQURZz/+pLi81xXeA==
// @require        https://cdn.jsdelivr.net/npm/fflate@0.7.1/umd/index.js#sha512-laBNdxeV48sttD1kBYahmdSXpSRitYmkte49ZUqm3KEOUK4cIJAjqt1MYwScWvBqqP4WDtEftDSPYE1ii/bxCg==
// @require        https://cdn.jsdelivr.net/npm/idb-keyval@6.0.3/dist/umd.js#sha512-+PXdWKx8apEQ52dxoVrQIwhLZj96Gde37eq+CXYQvG059IC5VF+nQ1DvD3JKqUVPL0k+TAJ8DDunVXjzKrlrHg==
// @require        https://cdn.jsdelivr.net/npm/loglevel@1.7.1/lib/loglevel.js#sha512-M8fjILtZEfPxVu6CCA2zI+oQL7hUMODvl7SshhQXHUGrxshEmr2hUoR5xrI0/OXDoAuTxQAkA258IQ4cH7RcVg==
// @require        https://cdn.jsdelivr.net/npm/nunjucks@3.2.3/browser/nunjucks.min.js#sha512-Uj8C5szr1tnKPNZb6ps5gFYtTGskzsUCiwY35QP/s2JIExZl7iYNletcmOJ8D6ocuaMRi9JGVrWRePaX9raujA==
// @require        https://cdn.jsdelivr.net/npm/vue@3.2.21/dist/vue.global.prod.js#sha512-mpjwM3OYBweZsR1BySj7jw3TuvKILFaLojtwYNBKKWuieiWiYByAgHddb1VX4+YO/NBe83cKW58k6ekhgfYgbQ==
// @downloadURL    https://github.com/yingziwu/novel-downloader/raw/gh-pages/bundle.user.js
// @updateURL      https://github.com/yingziwu/novel-downloader/raw/gh-pages/bundle.meta.js
// ==/UserScript==

(()=>{var e=[,(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.debug=void 0;const o=n(2),r=n(3);t.debug=async function(){const e=await(0,r.getRule)();let t;t=void 0!==window._book?window._book:await e.bookParse(),unsafeWindow.rule=e,unsafeWindow.book=t,window._book=t,unsafeWindow.saveAs=o.saveAs}},function(e,t,n){var o;void 0===(o=function(){"use strict";function t(e,t,n){var o=new XMLHttpRequest;o.open("GET",e),o.responseType="blob",o.onload=function(){c(o.response,t,n)},o.onerror=function(){console.error("could not download file")},o.send()}function o(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function r(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var a="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n.g&&n.g.global===n.g?n.g:void 0,i=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),c=a.saveAs||("object"!=typeof window||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!i?function(e,n,i){var c=a.URL||a.webkitURL,s=document.createElement("a");n=n||e.name||"download",s.download=n,s.rel="noopener","string"==typeof e?(s.href=e,s.origin===location.origin?r(s):o(s.href)?t(e,n,i):r(s,s.target="_blank")):(s.href=c.createObjectURL(e),setTimeout((function(){c.revokeObjectURL(s.href)}),4e4),setTimeout((function(){r(s)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,n,a){if(n=n||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}(e,a),n);else if(o(e))t(e,n,a);else{var i=document.createElement("a");i.href=e,i.target="_blank",setTimeout((function(){r(i)}))}}:function(e,n,o,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),"string"==typeof e)return t(e,n,o);var c="application/octet-stream"===e.type,s=/constructor/i.test(a.HTMLElement)||a.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||c&&s||i)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var e=u.result;e=l?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=e:location=e,r=null},u.readAsDataURL(e)}else{var d=a.URL||a.webkitURL,p=d.createObjectURL(e);r?r.location=p:location.href=p,r=null,setTimeout((function(){d.revokeObjectURL(p)}),4e4)}});a.saveAs=c.saveAs=c,e.exports=c}.apply(t,[]))||(e.exports=o)},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRule=void 0,t.getRule=async function(){const e=document.location.host;let t;switch(e){case"www.ciweimao.com":{const{Ciweimao:e}=await Promise.resolve().then((()=>n(4)));t=e;break}case"www.uukanshu.com":{const{Uukanshu:e}=await Promise.resolve().then((()=>n(35)));t=e;break}case"www.yruan.com":{const{Yrun:e}=await Promise.resolve().then((()=>n(36)));t=e;break}case"www.shuquge.com":case"www.sizhicn.com":{const{shuquge:e}=await Promise.resolve().then((()=>n(37)));t=e();break}case"www.dingdiann.net":{const{dingdiann:e}=await Promise.resolve().then((()=>n(39)));t=e();break}case"www.biquge66.com":case"www.lewenn.com":case"www.klxs.la":case"www.xkzw.org":{const{Xkzw:e}=await Promise.resolve().then((()=>n(40)));t=e;break}case"www.266ks.com":{const{c226ks:e}=await Promise.resolve().then((()=>n(41)));t=e();break}case"book.sfacg.com":{const{Sfacg:e}=await Promise.resolve().then((()=>n(43)));t=e;break}case"www.hetushu.com":case"hetushu.com":{const{Hetushu:e}=await Promise.resolve().then((()=>n(44)));t=e;break}case"www.shouda8.com":case"www.shouda88.com":{const{Shouda8:e}=await Promise.resolve().then((()=>n(45)));t=e;break}case"www.gebiqu.com":{const{gebiqu:e}=await Promise.resolve().then((()=>n(46)));t=e();break}case"www.meegoq.com":case"www.viviyzw.com":{const{Meegoq:e}=await Promise.resolve().then((()=>n(47)));t=e;break}case"www.xiaoshuodaquan.com":case"www.1pwx.com":case"1pwx.com":{const{Xiaoshuodaquan:e}=await Promise.resolve().then((()=>n(48)));t=e;break}case"book.qidian.com":{const{Qidian:e}=await Promise.resolve().then((()=>n(49)));t=e;break}case"www.jjwxc.net":{const{Jjwxc:e}=await Promise.resolve().then((()=>n(50)));t=e;break}case"www.banzhuer.org":case"www.biquwoo.com":case"www.biquwo.org":case"www.hongyeshuzhai.com":{const{common:e}=await Promise.resolve().then((()=>n(46)));t=e();break}case"www.bz01.org":{const{common1:e}=await Promise.resolve().then((()=>n(46)));t=e();break}case"www.81book.com":case"www.81zw.com":{const{c81book:e}=await Promise.resolve().then((()=>n(46)));t=e();break}case"book.zongheng.com":case"huayu.zongheng.com":{const{Zongheng:e}=await Promise.resolve().then((()=>n(53)));t=e;break}case"www.17k.com":{const{C17k:e}=await Promise.resolve().then((()=>n(54)));t=e;break}case"www.shuhai.com":case"mm.shuhai.com":{const{Shuhai:e}=await Promise.resolve().then((()=>n(55)));t=e;break}case"www.gongzicp.com":case"gongzicp.com":{const{Gongzicp:e}=await Promise.resolve().then((()=>n(56)));t=e;break}case"m.yuzhaige.cc":case"m.yushuge123.com":{const{Yuzhaige:e}=await Promise.resolve().then((()=>n(57)));t=e;break}case"www.linovel.net":{const{Linovel:e}=await Promise.resolve().then((()=>n(59)));t=e;break}case"www.xinwanben.com":{const{xinwanben:e}=await Promise.resolve().then((()=>n(39)));t=e();break}case"www.tadu.com":{const{Tadu:e}=await Promise.resolve().then((()=>n(60)));t=e;break}case"www.idejian.com":{const{Idejian:e}=await Promise.resolve().then((()=>n(61)));t=e;break}case"www.qimao.com":{const{Qimao:e}=await Promise.resolve().then((()=>n(62)));t=e;break}case"www.wenku8.net":{const{Wenku8:e}=await Promise.resolve().then((()=>n(63)));t=e;break}case"manhua.dmzj.com":case"www.dmzj.com":{const{Dmzj:e}=await Promise.resolve().then((()=>n(64)));t=e;break}case"sosad.fun":case"www.sosad.fun":case"wenzhan.org":case"www.wenzhan.org":case"sosadfun.com":case"www.sosadfun.com":case"xn--pxtr7m5ny.com":case"www.xn--pxtr7m5ny.com":case"xn--pxtr7m.com":case"www.xn--pxtr7m.com":case"xn--pxtr7m5ny.net":case"www.xn--pxtr7m5ny.net":case"xn--pxtr7m.net":case"www.xn--pxtr7m.net":case"sosadfun.link":case"www.sosadfun.link":{const{Sosadfun:e}=await Promise.resolve().then((()=>n(65)));t=e;break}case"www.westnovel.com":{const{Westnovel:e}=await Promise.resolve().then((()=>n(66)));t=e;break}case"www.mht.tw":case"www.mht99.com":{const{mht:e}=await Promise.resolve().then((()=>n(39)));t=e();break}case"www.xbiquge.so":{const{xbiquge:e}=await Promise.resolve().then((()=>n(46)));t=e();break}case"www.linovelib.com":{const{Linovelib:e}=await Promise.resolve().then((()=>n(67)));t=e;break}case"www.luoqiuzw.com":{const{luoqiuzw:e}=await Promise.resolve().then((()=>n(46)));t=e();break}case"www.yibige.la":{const{Yibige:e}=await Promise.resolve().then((()=>n(68)));t=e;break}case"www.fushuwang.org":{const{Fushuwang:e}=await Promise.resolve().then((()=>n(69)));t=e;break}case"www.soxscc.net":case"www.soxscc.org":case"www.soxs.cc":case"www.soshuw.com":case"www.soshuwu.org":case"www.soxscc.cc":case"www.soshuwu.com":case"www.kubiji.net":{const{Soxscc:e}=await Promise.resolve().then((()=>n(70)));t=e;break}case"www.fuguoduxs.com":case"www.shubaowa.org":{const{Shubaowa:e}=await Promise.resolve().then((()=>n(71)));t=e;break}case"www.xyqxs.cc":{const{xyqxs:e}=await Promise.resolve().then((()=>n(37)));t=e();break}case"www.630shu.net":{const{c630shu:e}=await Promise.resolve().then((()=>n(72)));t=e;break}case"www.qingoo.cn":{const{Qingoo:e}=await Promise.resolve().then((()=>n(74)));t=e;break}case"www.trxs.cc":case"www.trxs123.com":case"www.jpxs123.com":case"trxs.cc":case"trxs123.com":case"jpxs123.com":{const{trxs:e}=await Promise.resolve().then((()=>n(75)));t=e();break}case"www.tongrenquan.org":case"www.tongrenquan.me":case"tongrenquan.me":case"tongrenquan.org":{const{tongrenquan:e}=await Promise.resolve().then((()=>n(75)));t=e();break}case"www.imiaobige.com":{const{Imiaobige:e}=await Promise.resolve().then((()=>n(76)));t=e;break}case"www.256wxc.com":case"www.256wenku.com":{const{c256wxc:e}=await Promise.resolve().then((()=>n(77)));t=e;break}case function(t){if(/lofter\.com$/.test(e))return e}():{const{Lofter:e}=await Promise.resolve().then((()=>n(78)));t=e;break}case"www.lwxs9.org":{const{lwxs9:e}=await Promise.resolve().then((()=>n(46)));t=e();break}case"www.shubl.com":{const{Shubl:e}=await Promise.resolve().then((()=>n(79)));t=e;break}case"www.ujxs.net":{const{Ujxs:e}=await Promise.resolve().then((()=>n(80)));t=e;break}case"m.haitangtxt.net":{const{Haitangtxt:e}=await Promise.resolve().then((()=>n(81)));t=e;break}case"ebook.longmabook.com":case"www.longmabookcn.com":case"ebook.lmbooks.com":case"www.lmebooks.com":case"www.haitbook.com":case"www.htwhbook.com":case"www.myhtebook.com":case"www.lovehtbooks.com":case"www.myhtebooks.com":case"www.myhtlmebook.com":case"jp.myhtebook.com":case"jp.myhtlmebook.com":case"ebook.urhtbooks.com":case"www.urhtbooks.com":case"www.newhtbook.com":case"www.lvhtebook.com":case"jp.lvhtebook.com":case"www.htlvbooks.com":{const{Longmabook:e}=await Promise.resolve().then((()=>n(83)));t=e;break}case"dijiubook.net":{const{dijiubook:e}=await Promise.resolve().then((()=>n(46)));t=e();break}case"www.biquwx.la":{const{biquwx:e}=await Promise.resolve().then((()=>n(46)));t=e();break}case"www.25zw.com":{const{c25zw:e}=await Promise.resolve().then((()=>n(46)));t=e();break}case"www.tycqxs.com":{const{tycqxs:e}=await Promise.resolve().then((()=>n(46)));t=e();break}default:throw new Error("Not Found Rule!")}return new t}},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Ciweimao=void 0;const o=n(5),r=n(6),a=n(14),i=n(8),c=n(8),s=n(13),l=n(9),u=n(7),d=n(15),p=n(34);class m extends d.BaseRuleClass{constructor(){super(),this.imageMode="TM",this.charset="UTF-8",this.concurrencyLimit=1,this.maxRunLimit=1}async bookParse(){const e=`https://www.ciweimao.com/book/${unsafeWindow.HB.book.book_id}`,t=document.querySelector(".book-catalog .hd h3").innerText.trim(),n=document.querySelector(".book-catalog .hd > p > a").innerText.trim(),o=await(0,c.getHtmlDOM)(e,void 0),a=o.querySelector(".book-intro-cnt .book-desc"),[i,s,d]=await(0,p.introDomHandle)(a),m={},h=o.querySelector(".cover > img").src;h&&(0,r.getImageAttachment)(h,this.imageMode,"cover-").then((e=>{m.cover=e})).catch((e=>l.log.error(e))),m.tags=Array.from(o.querySelectorAll(".label-box > .label")).map((e=>e.innerText.trim()));const g=[],f=document.querySelectorAll(".book-chapter > .book-chapter-box");let w=0;for(let n=0;n<f.length;n++){const o=f[n],r=n+1,a=o.querySelector(".sub-tit").innerText;let i=0;const c=o.querySelectorAll(".book-chapter-list > li > a");for(const n of Array.from(c)){w++,i++;const o=n.innerText.trim(),c=n.href;let s=!1,l=!1;n.childElementCount&&(s=!0,"icon-unlock"===n.firstElementChild?.className&&(l=!0));const d=new u.Chapter(e,t,c,w,o,s,l,a,r,i,this.chapterParse,this.charset,{}),p=1===document.querySelector(".login-info.ly-fr")?.childElementCount;!s||p&&l||(d.status=u.Status.aborted),g.push(d)}}return new u.Book(e,t,n,i,s,m,g)}async chapterParse(e,t,n,r,d,p){function m(e){let t=e.content;const n=e.keys,r=e.keys.length,a=e.accessKey.split(""),i=a.length,c=new Array;c.push(n[a[i-1].charCodeAt(0)%r]),c.push(n[a[0].charCodeAt(0)%r]);for(let e=0;e<c.length;e++){t=atob(t);const n=c[e],r=btoa(t.substr(0,16)),a=btoa(t.substr(16)),i=o.format.OpenSSL.parse(a);t=o.AES.decrypt(i,o.enc.Base64.parse(n),{iv:o.enc.Base64.parse(r),format:o.format.OpenSSL}),e<c.length-1&&(t=t.toString(o.enc.Base64),t=atob(t))}return t.toString(o.enc.Utf8)}async function h(){const t=(await(0,c.getHtmlDOM)(e,void 0)).querySelectorAll("#J_BookCnt .chapter.author_say");let n;if(0!==t.length){const e=document.createElement("hr");n=document.createElement("div"),n.appendChild(e);for(const e of Array.from(t))(0,s.rm)("i",!0,e),n.appendChild(e)}return n}const g=e.split("/").slice(-1)[0];return n?async function(){if(1===document.querySelector(".login-info.ly-fr")?.childElementCount&&r){async function n(e,t){const n=unsafeWindow.HB,o=n.config.rootPath+"chapter/ajax_get_image_session_code";l.log.debug(`[Chapter]请求 ${o} Referer ${t}`);const r=await(0,i.gfetch)(o,{method:"POST",headers:{Accept:"application/json, text/javascript, */*; q=0.01",Referer:t,Origin:"https://www.ciweimao.com","X-Requested-With":"XMLHttpRequest"},responseType:"json"}).then((e=>e.response)).catch((e=>l.log.error(e)));if(1e5!==r.code)throw l.log.error(r),new Error(`下载 ${t} 失败`);const a=m({content:r.image_code,keys:r.encryt_keys,accessKey:r.access_key});return n.config.rootPath+"chapter/book_chapter_image?chapter_id="+e+"&area_width=871&font=undefined&font_size=14&image_code="+a+"&bg_color_name=white&text_color_name=white"}const o=await h(),r=await n(g,e);l.log.debug(`[Chapter]请求 ${r} Referer ${e}`);const c=await(0,i.gfetch)(r,{method:"GET",headers:{Referer:e,Accept:"image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8"},responseType:"blob"}).then((e=>e.response)).catch((e=>l.log.error(e))),s=`vipCHapter${g}.png`,d=new u.AttachmentClass(r,s,"TM");c&&(d.imageBlob=c,d.status=u.Status.finished);const p=[d];let f,w,y;if(o){const{dom:e,text:t,images:n}=await(0,a.cleanDOM)(o,"TM");[f,w,y]=[e,t,n]}const b=document.createElement("img");b.src=s,b.alt=r;const v=document.createElement("div");v.appendChild(b),f&&v.appendChild(f);let x=`VIP章节，请打开HTML文件查看。\n![${r}](${s})`;return w&&(x=x+"\n\n"+w),{chapterName:t,contentRaw:v,contentText:x,contentHTML:v,contentImages:p,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}():async function(){const n=await h(),o=document.createElement("div"),r=await async function(e,t){const n="https://www.ciweimao.com/",o=n+"chapter/ajax_get_session_code",r=n+"chapter/get_book_chapter_detail_info";l.log.debug(`[Chapter]请求 ${o} Referer ${t}`);const a=(await(0,i.gfetch)(o,{method:"POST",headers:{Accept:"application/json, text/javascript, */*; q=0.01","Content-Type":"application/x-www-form-urlencoded; charset=UTF-8",Referer:t,Origin:"https://www.ciweimao.com","X-Requested-With":"XMLHttpRequest"},data:`chapter_id=${e}`,responseType:"json"}).then((e=>e.response)).catch((e=>l.log.error(e)))).chapter_access_key;l.log.debug(`[Chapter]请求 ${r} Referer ${t}`);const c=await(0,i.gfetch)(r,{method:"POST",headers:{Accept:"application/json, text/javascript, */*; q=0.01","Content-Type":"application/x-www-form-urlencoded; charset=UTF-8",Referer:t,Origin:"https://www.ciweimao.com","X-Requested-With":"XMLHttpRequest"},data:`chapter_id=${e}&chapter_access_key=${a}`,responseType:"json"}).then((e=>e.response)).catch((e=>l.log.error(e)));if(1e5!==c.code)throw l.log.error(c),new Error(`下载 ${t} 失败`);return m({content:c.chapter_content,keys:c.encryt_keys,accessKey:a})}(g,e);o.innerHTML=r,(0,s.rm)(".chapter span",!0,o),n&&o.appendChild(n);const{dom:c,text:u,images:d}=await(0,a.cleanDOM)(o,"TM");return{chapterName:t,contentRaw:o,contentText:u,contentHTML:c,contentImages:d,additionalMetadate:null}}()}}t.Ciweimao=m},e=>{"use strict";e.exports=CryptoJS},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getImageAttachment=t.clearAttachmentClassCache=t.putAttachmentClassCache=t.getAttachmentClassCache=void 0;const o=n(7),r=n(13);let a=[];function i(e){return a.find((t=>t.url===e))}function c(e){return a.push(e),!0}t.getAttachmentClassCache=i,t.putAttachmentClassCache=c,t.clearAttachmentClassCache=function(){a=[]},t.getImageAttachment=async function(e,t="TM",n="",s=!1,l){const u=Math.random().toString().replace("0.","");let d;const p=i(e);if(p)d=p;else{d=new o.AttachmentClass(e,u,t);const i=await d.init();if(i){const t=await(0,r.calculateMd5)(i),o=i.type.split("/")[1];let l,u=o;if(["octet-stream"].includes(o)){const t=new URL(e).pathname.split(".").slice(-1)[0].match(/(^[\d|\w]+)/);u=t?t[0]:new URL(e).pathname.split(".").slice(-1)[0]}if(s){let t=new URL(e).pathname.split("/").slice(-1)[0];a.find((n=>n.name===t&&n.url!==e))&&(t=new URL(e).pathname.split("/").slice(-2).join("_")),l=[n,t].join("")}else l=[n,t,".",u].join("");d.name=l,c(d)}}return l&&(d.comments=l),d}},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExpectError=t.AttachmentClass=t.Chapter=t.Book=t.Status=void 0;const o=n(8),r=n(13),a=n(9),i=n(11);var c;!function(e){e[e.pending=0]="pending",e[e.downloading=1]="downloading",e[e.failed=2]="failed",e[e.finished=3]="finished",e[e.aborted=4]="aborted",e[e.saved=5]="saved"}(c=t.Status||(t.Status={})),t.Book=class{constructor(e,t,n,o,r,i,c){this.bookUrl=e,this.bookname=t,this.author=n,this.introduction=o,this.introductionHTML=r,this.additionalMetadate=i,this.chapters=c,a.log.debug("[Book]初始化完成")}},t.Chapter=class{constructor(e,t,n,o,r,a,i,s,l,u,d,p,m){this.bookUrl=e,this.bookname=t,this.chapterUrl=n,this.chapterNumber=o,this.chapterName=r,this.isVIP=a,this.isPaid=i,this.sectionName=s,this.sectionNumber=l,this.sectionChapterNumber=u,this.chapterParse=d,this.charset=p,this.options=m,this.status=c.pending,this.retryTime=0}async init(){const{chapterName:e,contentRaw:t,contentText:n,contentHTML:o,contentImages:r,additionalMetadate:i}=await this.parse();return this.chapterName=e,this.contentRaw=t,this.contentText=n,this.contentHTML=o,this.contentImages=r,this.additionalMetadate=i,this.status===c.failed?a.log.error(`[Chapter]章节名：${this.chapterName}, 分卷名：${this.sectionName}, URL:${this.chapterUrl}, VIP:${this.isVIP}, Paid:${this.isPaid}, isNull:${!Boolean(this.contentHTML)} 解析出错。`):a.log.info(`[Chapter]章节名：${this.chapterName}, 分卷名：${this.sectionName}, URL:${this.chapterUrl}, VIP:${this.isVIP}, Paid:${this.isPaid}, isNull:${!Boolean(this.contentHTML)} 解析成功。`),this}async parse(){return this.status=c.downloading,this.chapterParse(this.chapterUrl,this.chapterName,this.isVIP,this.isPaid,this.charset,this.options).then((async e=>{const t=e.contentImages;if(t){let e=t.filter((e=>e.status===c.downloading));for(;e.length;)await(0,r.sleep)(500),e=t.filter((e=>e.status===c.downloading))}return this.status=c.finished,e})).catch((async e=>(this.retryTime++,a.log.error(`[Chapter]${this.chapterName}解析出错，第${this.retryTime}次重试，章节地址：${this.chapterUrl}`),this.status!==c.failed&&this.retryTime<i.retryLimit?(await(0,r.sleep)(1500*this.retryTime),this.parse()):(this.status=c.failed,a.log.error(e),a.log.trace(e),{chapterName:this.chapterName,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}))))}},t.AttachmentClass=class{constructor(e,t,n){this.url=e,this.name=t,this.mode=n,this.status=c.pending,this.retryTime=0,this.defaultHeader={Referer:document.location.origin}}async init(){return"naive"===this.mode?this.imageBlob=await this.downloadImage():this.imageBlob=await this.tmDownloadImage(),this.imageBlob&&a.log.info(`[attachment] ${this.url} 下载完成。`),this.imageBlob}downloadImage(){const e=Object.assign(this.defaultHeader,this.headers),t=e.Referer;return delete e.Referer,this.status=c.downloading,fetch(this.url,{headers:{...e},referrer:t}).then((e=>{if(e.ok)return this.status=c.finished,e.blob();throw 404===e.status&&(this.status=c.failed),new Error(`Bad response!\nRequest url: ${this.url}\nStatus code: ${e.status}`)})).catch((async e=>(this.retryTime++,a.log.error(`[attachment]下载 ${this.url} 出错，第${this.retryTime}次重试，下载模式：${this.mode}`),this.status!==c.failed&&this.retryTime<i.retryLimit?(await(0,r.sleep)(1500*this.retryTime),this.downloadImage()):(this.status=c.failed,a.log.error(e),a.log.trace(e),null))))}tmDownloadImage(){const e=Object.assign(this.defaultHeader,this.headers);return this.status=c.downloading,(0,o.gfetch)(this.url,{headers:{...e},responseType:"blob"}).then((e=>{if(e.status>=200&&e.status<=299)return this.status=c.finished,e.response;throw 404===e.status&&(this.status=c.failed),new Error(`Bad response!\nRequest url: ${this.url}\nStatus code: ${e.status}`)})).catch((async e=>(this.retryTime++,a.log.error(`[attachment]下载 ${this.url} 出错，第${this.retryTime}次重试，下载模式：${this.mode}`),this.status!==c.failed&&this.retryTime<i.retryLimit?(await(0,r.sleep)(1e3*this.retryTime),this.tmDownloadImage()):(this.status=c.failed,a.log.error(e),a.log.trace(e),null))))}};class s extends Error{}t.ExpectError=s},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ggetHtmlDOM=t.ggetText=t.getHtmlDOM=t.getText=t.gfetch=void 0;const o=n(9),r=n(12);function a(e,{method:t="GET",headers:n,data:o,cookie:a,binary:i,nocache:c,revalidate:s,timeout:l,context:u,responseType:d,overrideMimeType:p,anonymous:m,username:h,password:g}={}){return new Promise(((f,w)=>{if(!r._GM_xmlhttpRequest)throw new Error("未发现 _GM_xmlhttpRequest API");(0,r._GM_xmlhttpRequest)({url:e,method:t,headers:n,data:o,cookie:a,binary:i,nocache:c,revalidate:s,timeout:l,context:u,responseType:d,overrideMimeType:p,anonymous:m,username:h,password:g,onload:e=>{f(e)},onerror:e=>{w(e)}})}))}async function i(e,t,n){const r=new URL(e);return"https:"===document.location.protocol&&"http:"===r.protocol&&(r.protocol="https:",e=r.toString()),void 0===t?fetch(e,n).then((t=>{if(t.ok)return t.text();throw new Error(`Bad response! ${e}`)})).catch((e=>o.log.error(e))):fetch(e,n).then((t=>{if(t.ok)return t.arrayBuffer();throw new Error(`Bad response! ${e}`)})).then((e=>new TextDecoder(t).decode(e))).catch((e=>o.log.error(e)))}async function c(e,t,n){return void 0===t?a(e,n).then((t=>{if(t.status>=200&&t.status<=299)return t.responseText;throw new Error(`Bad response! ${e}`)})).catch((e=>o.log.error(e))):(n?n.responseType="arraybuffer":n={responseType:"arraybuffer"},a(e,n).then((t=>{if(t.status>=200&&t.status<=299)return t.response;throw new Error(`Bad response! ${e}`)})).then((e=>new TextDecoder(t).decode(e))).catch((e=>o.log.error(e))))}t.gfetch=a,t.getText=i,t.getHtmlDOM=async function(e,t,n){const o=await i(e,t,n);if(!o)throw new Error("Fetch Content failed!");return(new DOMParser).parseFromString(o,"text/html")},t.ggetText=c,t.ggetHtmlDOM=async function(e,t,n){const o=await c(e,t,n);if(!o)throw new Error("Fetch Content failed!");return(new DOMParser).parseFromString(o,"text/html")}},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.log=t.saveLogTextToFile=t.getLogText=t.logText=void 0;const o=n(2),r=n(10);t.log=r.default,n(11).enableDebug.value?r.default.setLevel("trace"):r.default.setLevel("info"),t.logText="",t.getLogText=function(){return t.logText};const a=r.default.methodFactory;r.default.methodFactory=(e,n,o)=>{const i=a(e,n,o);return e=>{try{"object"==typeof e?e instanceof Error?t.logText+=e.stack:t.logText+=JSON.stringify(e,void 0,2)+"\n":t.logText+=e+"\n"}catch(e){r.default.error(e)}i(e)}},r.default.setLevel(r.default.getLevel()),t.saveLogTextToFile=function(){(0,o.saveAs)(new Blob([t.logText],{type:"text/plain; charset=UTF-8"}),`novel-downloader-${Date.now().toString()}.log`)}},e=>{"use strict";e.exports=log},(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.r18SiteList=t.iconJump=t.iconSetting=t.iconStart1=t.iconStart0=t.enableJjwxcRemoteFont=t.enableR18SiteWarning=t.enableCustomSaveOptions=t.enableCustomChapterFilter=t.enableCustomFinishCallback=t.enableDebug=t.retryLimit=void 0,t.retryLimit=5,t.enableDebug={value:!1},t.enableCustomFinishCallback=!0,t.enableCustomChapterFilter=!0,t.enableCustomSaveOptions=!0,t.enableR18SiteWarning=!1,t.enableJjwxcRemoteFont=!0,t.iconStart0="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAFYElEQVR4nO2dIUxkORyHP4XD4E6RYNZgUGvWonAnVqxDbbJiNWLNOsQ65Oo1CMQIFAnJJiQIcgY7YhIEbgTJiEkm4USPuyNh3pv2tf33tb9f8kl4fe3H0Pm37xXi50/gHJgBC+C5YB6Bv4AL4CuwH7872skBcI/9oA5lBpwAO1F7p/IcUf5fuy8L4AzYjthPVWYfeMJ+wFLxABxG660K8xv7QcrBWawOqykfsB+YnEzQv4RXOcV+UHJzD+zF6LwaMsF+QCyYo3kBALfYD4YVK+DL8C4cd+6wHwhrfgJbQztyrJEAjhvgj4F9OcrUKMA33Me778/NaLCUXKMA27ivt48BP7vArYU0k1oFAPeRHjrJPQ3u0ZGlZgHATe5+Bv6ecxooGtUuwEuOCVvsugd2vXp0ZGlFAHDL3bOA3zfHzSmqTEsCgNsjcBXwO5e4T5Hq0poA4OYFoWsg1RWNWhTgJZ8ImxdcUdFuo5YFADcvmAZcY0olRaPWBQD313wZcJ0n3Fa6UUcC/JfvAdda4TagjjYS4HWOcF/7fK/5i5FODmvcDzC0eveOsO3xt4xwRVECvJ1t3MMmvtd+AN5HuH62SIDunOC/tLxgREUjCdCf0HnBKFYUJcBm2SNsXnCZqD3RIgE2zzZuidi3PVPcxLLISAD/fMYtDvm0qdht6BIgLIf4zwuWOHmKigQIzy5hhbSiKocSYFi2cFVA3zZ+ytjGztQogMVS7Vf85gVPFLLVrEYBrGbcvlvRJzbNfJ0aBbDc1++7Fd28bFyjAOdRe8g/PlvOfhm18d/UKMCKMjZqHNM/L1hiXCmsUYBn3ILMZ+zX6N/jVgi72mr6KFqtArzwiJtsneE+li3oezLJdNGodgHGgOm3AQlgz03vKCWMBLDnrneUEkYC2CMBGkcCNI4EaBwJ0DgSYEMecE/mbkLIA59NCnCzplElEbqfLvTJXwlQGEN2z+zjv4GzKQFK/xewZPiCTumS6xOgg4cI9xiyZ08CFIIESBwJYI8E6EACJI4EsEcCdCABEkcC2CMBOpAAiSMB7JEAHUiAxJEA9kiADiRA4kgAeyRABxIgcSSAPRKgAwmQOBLAHgnQgQRIHAlgjwToQAIkjgSwRwJ0IAESRwLYYyrA7zWNKgUJkDgSwB4J0IEESBwJYE8zAqxwr0T7webv2Ivxbv2PHtc7xb1qNucDpc0I8DHTPcXIB/yPi5MAHcT4KM+dXH3ThADzXDcUMSHHxEmADr5kuqcYOSJfvzQjwIKCz8/7X3bof8O3BAjkDvtXuPcl5HBICeDB9yx3FpZj8vdHcwKsKOCsnDeyhzvNSwJkYEp5hypfY9MXTQrwjDtJo5ScYNcPzQrwTBmHOx1g+y7BpgV4xJ21Z5Ut8hV8JMAaLpPf5fqcdbRLAmTE4lj1wwHtlQCRyV0l3MHvnF8JkIGcVcLc1T4JsCE5qoQW1T4JsCGpq4RW1b5iBbhe0yhLUlYJS7xfCfAGKaqE3wq4LwngQcxTta2rfRIggDlxqoQlVPskQCAxqoQlVPskwACG7CUspdonAQYQWiUsqdonAQYSUiUsqdonASLgUyUsrdonASKwwj2y1ZcSq30SIBKbVAlLK29LgMh0VQlLrfZJgMi89aRxydU+CRCZOe5g6JfsMo6TwiVARJbABe7r3pgmfRJASAAhAQQSQCABmsdUgKs1jRL5uO0dpYSRAPZMekcpYS7WNErk47R3lBLmx5pGiXyYvi1lDFumaua6f4jS5w77jmiRBa/XM8zyjnHX0sfIkrjPPQzOAeNdTRsbUzbb2ZQ9W7i9dBNghltyjUHrny4r3JtHJ//0b9RH4P8GSxsCzEN/51YAAAAASUVORK5CYII=",t.iconStart1="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAESElEQVR4nO2cLUxcQRSFv4QgEBiSKgQCh6pCouvQlbVVdaRuTFUNoqaqEkktCoVD4HBITBMMosmaVsxu+kL3l3lv7p13z5ccyc68OSf3sLtvHwghhBBCjJM/hRKNowAERwEIjgIQHAUgOApAcBSA4CgAwVEAgqMABEcBCI4CEBwFIDgKQHAUgOAoAMFRAIKjAARHAQiOAhAcBSA4CkBwFIDgKADBUQCCowAERwEIjgIQHAUgOApAcBSA4CgAzkmUm9SqUvHpjYSEvRky35iEvSky35iEvTky35iEvUky35iEvVky35iEvWky35iEvXky35iEvYky35iEvZky35iEvaky35iEvbky35iEvcky35iEvdky35iEveky35iEzA9PQuaHJyHzm2e78O8T7Zhfeq2j4i1wDvyi/GAT/s1P5Gs9J197SN4An4A7hjlgz+a/fM078lm8KXxt92wDp8BPYEL9g/ZoflcT8tmcMrKK6I54TwfueS/NV8SyEe/54D3uoZmK2GTEt2KA5dov5bYiXjvivRthsea6Mq+Ivka8V0NqrlWqahUx1IjfRGeF15DWWCMVrnG2xhpDaLCKqDHiV+ka+ADs9nA9ack6qYfX3yXv9XrJOkOruCIsRvxLPZANOXztRSwhzVkvDbDO4fR1H+asV0trV4SHEf8M/ABOVm22B1Jn3VRhvRPytT1jc7YLK8LTiN/Z/FyLSNT/Vm8HZxVhtYnZiD8oOc3GOcC+Iqou9gx8p86Ib40T8tnUrogqi1wB76k/4ltkh3xWVzQegHvgM7Df6/HEYp98hvc0EoAn8hg7HuAwonNMPtsnnAVggkZ8TboV0cfb9aIRf4ZGvCX7ZA9KKmLjEf8NjXiPHJO92bQiFICRUCUAqgBfVK+AedI/gXVx80/goorQ28BhcPs2cFlF6IOgMpr7IGiRVBHrM5qPguep5vf9rWF1v0DVxbrS18EBvw5epGv6u+fPOx7uGXQXgJnGXBHWt4Q1EYCuhrwptBYebgptNgBd3dBORcxG/A325zaaAMz0G7gA3gFbaxpSgy3yni7Ie7Q+p9EGoKtH4AtwtNqfwTia7uER+/MIF4CuboCPwN5Su/phb7pWKyM+RABmGqoiWh7xoQLQ1SPwlbKKOJq+RssjPmwAurpl/YqYjfhbB/tWAHrWBLjk/9/HzX4XeYnd7yIVgMqa/T7O+neR1jLfgKQASIYy34CkAEiGcvGACKmu5j5DKPJboQha9BZ4Lh4eEiX1o+LnCKoi2tMgTxJVRfjWRiO+FFWEH5k/TVwVUV/mD4ueh4cHTY5ZVUd8KaqI/mQ+4ktRRWwulyO+FFXEcjU14ktRRfxT8yO+lIgVMcoRX8rYP2gKNeJLGVNFhB/xpbRYERrxA+C9IjTiK+KpIjTijbGoCI14hwxdERrxDdFnRWjEN85rKkIjfoSsqgiN+EB0K0IjXgghhBDh+Avri3imoU6g/AAAAABJRU5ErkJggg==",t.iconSetting="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAABmJLR0QA/wD/AP+gvaeTAAAIxElEQVR4nO2dW4wWRRbHfzArzAIioFxk4oMKjLgqug9k2UUi3g0YYwKId59UXnaj0ejDamLUxTWi8cEbglFJvL7hLfFuHBGNVxBXjFGZWVC8jIoDOzPLTPtwvk+GoafOqe6qntbpf1LJZKrr1L+quqtOnXOqPqhQoUKFChUqVKhQoUKF8uDvQBIoXVUwdzOGDzYBB44JKOtPAWUFRZkHYFZAWUcHlDUk0ADsJNwUtKsms3Qo6xcwAxgVUN4fgcMCyguGsg5AyPm/jlJOQ0NpAI6KIDM3yjoAIRfgOko5AGVFG+5F9fiUMqcrZT6Ozvp3goOAXtydOT6lXJNS5v9AY2Tuv2mcAKwCfsDdkVscMtqVsiuAA+PQ/+3iNGA9dp3+KYes1wzlfwZuASbm4LxfjrJRcASwGXnD5mJb3A8BnsF/U3WTQ+ZdHnI6gFuBA4xtbEBeljXIVzrTWK4QPMvejfsauA9ZGEekPH8x8BP+nZ8ASxw8lmWQtw041yFzFvJibetX7jlHmUKxAHcDfwQeARYDE4B7lOe11OzgMjeH3Bf7yG4CrgY2KGUW+HVVeIwAPsHeSE270dKnuG0643LK7wReB3qMz28m/QsvDFemkAqduoAngFOwrS0n157vKoBbUuuDQcFEdJUxa+pB3sQrgMkZ+U0GrgFaI3Gspx+BSRk55sJ9GchqaTdwP3BoQJ4jkcV5SwS+9bQyIF8TjkU6K2QjNgGzI3IeAVwGfBOYd/3FOTYi933wauAGPAqMLoj7OOBOwr9ALcCwIhqwyEDmv8Db2LSeFUWQTsFsRKuydG478K3hucWxSTcCXxiILKo9fwhwKWI+6E557vbYhBVMRqa+gaaVF4CLEO+c5cVrJawnbx/800DiddI/xQlIY55AzACD3fl1TEZM1X3XomtI12xeQW//dbGINiGGrBCLUZb5fixwHqIlvY0spt219E3tfyuBpcD+nrKbkI6boTxnUT46avKC42Gl4gS4N0K9zcBqJLLBuiDuREzb0yPwsajfa0JX+hdsC+pJAescBdyGOFKsHd8/dSMWz5COmAsN9fYCc0JVOAy7vb49UMXTgY3GOi3pTeDgALwuxf5CvEVAn/vV2A1pP5PvSziOOJulNrJHWwwDbvSs7w4CBz1cht1K2AmclaGO6cTp/L6D4Psl7Ac86FFHD2LDioKlpOvzaWk3cImH7EbgA6PsPOkdJFLOgjHs62zSXrylHm3OhDOB/xkJ9QCXG+XeZpQZIt1g4NMIvO8hs530cJkomA/sMBLrRY9EaMa2uPUCTwMXILGeo2rpcEQ7edrIqQOYonAajl31/ZJB8BHPBr43kNtqkLXaIKcV+KtB1lz0wK4EuNsg612DnPcIo2FlwlHs66zun9YqMsaih6K34tfIqeiD0IHM8S6sUWS04L/r3gt51aSPkFgcF95V8hfiNmAlyML2lQcvLdIBxByiOdU3KfmtiNqdGSH0VC3o9T0lf76S/wywzk7nV7QgGowLJyr52gDkPvoUYgCmKvmblXwtEvpxDy6+ZbW6Ne5a2wuBppJqlk/N0ZHnZMs0RfZ2pfxopfyuHNyCQdsda2eztPCRPA4OrQM7lfJ/UMrvzsENKOaARpKzfB4/ayE+2jwIMQBdSr4WObZDyc8aFwT6ZusnJX+kkt/twSUVIQagQ8nXOvBzJf9vHlx8y2p1a56tnR5cUhFiAFwHJkAPsvpQyT/Hg0t/aIYxrW5XIDDYdvlOhBgA7S06Usl/WclfgJgXfDEPCY934SUl/89K/n/sdOJgDOJtcmkKqxUZ+6ObItrw07mbkNikvKaItYqMHcCpHryCYgo2Y9UHBlmrDHLasH0J89A7P8EWz7nVIKcbP79HEMzEFqCVIGZmzQEyHbuj51kkvmgaouePrv19MXbnSRf6Bm+SUVaCmMmvV+QFw/HYzND19D42i+GtHjLzpuXGtl6L36GSVcjmLRrOxi8+50Xsh+Aa0deTEGkdun7fF4uwewAT4HnExB4c/8DulE+Ah/A/zjmFuAcqtpItam0+chDDWs+HGetJxXAkxMKnoTeS3QxwDDaPlm9qJd+NKUd78tpEIFPIMCTIyFLpbuxOeBcmYjt07TPtaGYJC6Zid9S7zjN7Yw62xejCgHU2ItELHYZ6B0pdwL/wm/M1nGCodzsR1gHNP5oggauhMQVxoPsMREeNS4xbsl4y1L8sQr00oXeCJTx9BhIK7rtIjUHsQvcisarbkTe8q/b3euQQ+BL0HW4aLCHzC9E7/2MiqqLXGQiknZUajwS2trBnKvuUSHH0GbAcUTVfQLS9tPWiAQlC0Nq/MCZRnyNKI5EoOteh6TIMwnLSv+QW5KTMtNpzlnsoXimC8GIDkW/R7+7pOwgxj6e6sMLAr5c9J3Jcz/WgW0+DIfQx1V7kBM5BBfEfAzwWuA0PFsQdiHNQO0HessuJewHGHMSOH5L3LuREaKFYGYD4QGkLMueG1N+nAQ8Q58W5OSBPMybhZx/JktqQhTDPhR1XAG/gZ8fySVE2XVYUcV1Nwp4ra042cBqOXG1T1JU1UTZdVoxAwvcsROtX0HQanx8ojXPwacB+/cBAycf+H3XTZYV2ZdkG5JBfXd9vRjY8WTvI5ZZsziE3QS79m4Co2o+g32sXddPlg+fYm9g2RMd2Bb8uxeZz9fnkl2SQlyBr2fkp8kYCZyAKx/Z+ZbRojkIxE7k9aw1ytaP1rv6xwL/xM7Td5ZB3k4ecelqLbTfegDj870BCcQrbdFmR5zLTiYhJwHLuzHUg5ClD+Xp6A9uiPqRwILp5oN1RXruW7Afkso95cej/PtCIfmIybcoYr5TppThThxll/P2ATuAz5Zm0Y1HaNQRtwHeZGA1BPEk+dXKgxbZ0KOMXAOL4CA0tEnpQMJQGYEMEmblR1gHYGEFmKQegrGjALwRSS9UPuXmih7CHHzbWZJYOZR0ACDsNlXIBhnIPQMiFuJr/K1SoUKFChQoVKlSoUBr8Ah3QujNKRJdpAAAAAElFTkSuQmCC",t.iconJump="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAG6wAABusBTDGeSgAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAeVSURBVHic7VpvTBNpHv6901L+yQU3nCfrByU9IRYrWrCVGkVzgu4ZCSFSMBDJrhcTP+iqMdlcLvFyl7sPftn9diZsiHterpYz8TxuCXsauBNy2VVoXIEIXV2hAYt/WqF/mMGZ6fzugwxXSjudlnYHWJ5kMm+n7/zmeZ55531/7ztDEBF+zKCUJqA01gxQmoDSWDNAaQJKY80ApQkojTUDlCawFNTU1Pzk3LlzzYQQkmiMFW0AABzRarVfXLx40UYISUjLijaA4zjNunXrQK/XWy5dutS5b98+dbwxVrQB4jwmIyMDtm/fXrV3796eQ4cOZcYTY0UbEAqNRgM6na7caDTeP3r0aI7c81aNAQAAaWlpsG3bNr3BYHhYW1v7npxzVpUBAABqtRoKCwu1er1+sK6uLj9W/RVtQLS1DJVKBVu3bn1fr9cPWCyWAqkYK9oAKVAUBVqtNq+kpORRQ0ODLlo9kooVoVOnTv0yOzv7F1J1Yl1XDi+e53++e/fu6uzs7AX1w8sTExPMo0eP9lmtVnt4jKQbQAhJv3z58rDBYJhveuI1pEjKLSd6nsvlYh8+fFhptVp7Qvmm4hFQAUDCqWmqkJ+frykrK+tubGz8IPR4SvqA5brQumHDBpXJZPqyqampTjy2KjvBYDAILMsCwzAQCATA5/OB1+uFqakpAACqsLDQ1tzcfAoAIO7cWQ5S3QIEQYDZ2VngOA6CwSDwPA88z8+XAQDECWKkfVZWFqXVaj9vaGiYTYkByQbP80DTNDAMAwzDAMuyABBZnJRwcY+IMDMz4x8eHuYTNoAQQk6fPn1yYmLi7x0dHb7Q/5baAliWBZqm5zc5d1WOcJGby+V6cevWrY+dTudXCRlACKHOnj17o6ioyPL8+XMGAP6WSBwRgiCAz+cDn88HDMNAMBiUJSYe4YQQCAaD4HQ6v2tra/vY7Xb3ICIdtwFms1l9/vz5DpPJVMXzPLAsqwmvg4goipj7vWAP8K6jCgQCMD09DYFAICJpKcQjnBACLMvCkydPHlit1osMw/Qj4luAODvBAwcOZJrN5i6j0Vienp4OPp8vUjX+7t27nz5+/NgoFSsZmWBWVtZPi4uLj6Snp0u2jtnZWRgaGuq02Wy/EQRhEBF5MYZsAw4fPpxjMpn+W1paqtdoNICIEUkiIksI+UtfX9+SHgs5OHjw4NHi4uIj4Y9CaDkQCEBfX9+f29vbrwCAAxGF0BiyDDh27Nh7ZWVlD0pKSrRpaWnz4qPdJUT0LkWYXFRWVnKi4Ej9gdfrFXp6ej7r7u7+EwCMYgTCMQ2oqanJ37lzZ79er39frVaDIPzfwNCyUiCEAEVR82URr1+/Zru6un53//79LxDRFe18SQNqa2sLdu3a9UCn0+VRFDUveLmkuiKP8DF+cnLS39nZ+cng4OBNRHRLxYhqwPHjx3UGg+GboqKiHACIKH65tADRAEEQYHx8/OXt27cvjI6OdiBixF46FBENsFgspaWlpb1arTYz1jR0y5YtdWfOnNkVSihSWeo/OWW/3/+v1tbWO+FcRQM4joPR0dHvb968ee7Vq1f/QUQ6suSFWGRAfX39/rKysrubN2/WSIlHRMjMzASz2Vw9PT0NDMNEHMfjGa+l9uPj45WEkN3i+B0an2VZcDgc9ra2tgt+v/9BeB3ZBtTX139gNBr/uWnTJlV4Lx9eRkSYmpoCv98fNXGJJSoezF1fFXYMaZqGp0+f3rHZbL8WBGEgdIyXg3kDTpw4Ubdnzx7bxo0bqdBnO5IJHMeBx+MBlmWXJE7u3Y8Gu93+Lcdxf+zt7bUCwEj4GC8HagCAxsbGX5WXl7fk5eWRaOJF0DQNHo8n5kiQzLsf7Ryv1+vo7e29AgCBSGO8HKgtFkvj/v37P8/NzY3Zq79582ZBk0+GqKXEmmvu/rgvHgJqeHiY93g8tJT4YDAILpcL/H7pay21SUvFEpOdZIMaGhrqvHbt2ocOh8MTOoMTEQwG4cWLF8BxXERiSt39ZIFCRJ/T6fyypaWlaWBgYEwUCrBYvBRS8cz/EMZQAACISLvd7n9fvXq1yW63f8uy7ALxUoRCJ0ZSm1g31h4RQRCERVuq0u8FL0YIIWqKovQnT568UlBQUBk+yQjfcxwHIyMjXzEM8zpicIlMMNrxaHXGxsa+7u/vb0VEVpYymVj0Zoi8+9SkqLq6+pMdO3Y0Z2RkLCAWSpDjOLh3795H3d3dHckkFQVvUzHNXpQKI6JACBlpb2///czMjNtkMl3Iyspa1AWLRqhUKg4RXyWb2A+FiJOhuaTiGSHk05mZmTcVFRW/zcnJ0SjRS6cakusBiOgihLTQND1VVVV1Zf369TkAyg5byUbMFSFEdBNC/hoIBKarq6s/y8vL+5lKpYp12oqBrPQKEX3Pnj37x40bNz6anJz8XhCEVXH3AeJ4OYqI9MuXL7uuX7/+4djYmF1OcrQSEFeCjYhv/X7/162tracdDseduXd0y2OBMFHIzeTCsjoKAHQVFRV/yM3NLU4kxnLZEv5EhrzrBNYBABPvKsxyQko+klpJWJVfiMSDNQOUJqA01gxQmoDSWDNAaQJK40dvwP8AKk+/HC2PJW8AAAAASUVORK5CYII=",t.r18SiteList=["www.dierbanzhu1.com","www.bz01.org","m.yuzhaige.cc"]},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t._GM_deleteValue=t._GM_getValue=t._GM_setValue=t._GM_xmlhttpRequest=t._GM_info=void 0;const o=n(9);if("undefined"==typeof GM_info){if("undefined"==typeof GM)throw new Error("未发现 GM_info");if(void 0===GM.info)throw new Error("未发现 GM_info");t._GM_info=GM.info}else t._GM_info=GM_info;if("undefined"==typeof GM_xmlhttpRequest){if("undefined"==typeof GM)throw new Error("未发现 GM_xmlhttpRequest");if(void 0===GM.xmlHttpRequest)throw new Error("未发现 GM_xmlhttpRequest");t._GM_xmlhttpRequest=GM.xmlHttpRequest}else t._GM_xmlhttpRequest=GM_xmlhttpRequest;"undefined"==typeof GM_setValue?"undefined"==typeof GM||void 0===GM.setValue?o.log.warn("未发现 GM_setValue"):t._GM_setValue=GM.setValue:t._GM_setValue=GM_setValue,"undefined"==typeof GM_getValue?"undefined"==typeof GM||void 0===GM.getValue?o.log.warn("未发现 GM_getValue"):t._GM_getValue=GM.getValue:t._GM_getValue=GM_getValue,"undefined"==typeof GM_deleteValue?"undefined"==typeof GM||void 0===GM.deleteValue?o.log.warn("未发现 GM_deleteValue"):t._GM_deleteValue=GM.deleteValue:t._GM_deleteValue=GM_deleteValue},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.regexpEscape=t.deepcopy=t.LocalStorageExpired=t.calculateMd5=t.storageAvailable=t.sandboxed=t.sleep=t.concurrencyRun=t.rm2=t.rm=void 0;const o=n(5);function r(e){let t;try{t=window[e];const n="__storage_test__";return t.setItem(n,n),t.removeItem(n),!0}catch(e){return e instanceof DOMException&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&t&&0!==t.length}}t.rm=function(e,t=!1,n){if(t)n.querySelectorAll(e).forEach((e=>e.remove()));else{const t=n.querySelector(e);t&&t.remove()}},t.rm2=function(e,t){Array.from(e.childNodes).forEach((e=>{let n="";n="#text"===e.nodeName?e.textContent??"":e.innerText;for(const o of t)o instanceof RegExp&&o.test(n)&&e.remove(),"string"==typeof o&&n.includes(o)&&e.remove()}))},t.concurrencyRun=function(e,t,n){async function o(e){return await n(e.shift()),0!==e.length?o(e):"finish!"}const r=[...e],a=[];for(;t--;)a.push(o(r));return Promise.all(a)},t.sleep=function(e){return new Promise((t=>setTimeout(t,e)))},t.sandboxed=function(e){const t=document.createElement("iframe");if(document.body.appendChild(t),t.contentWindow){const n=t.contentWindow.Function,o=Object.keys(t.contentWindow).join();return document.body.removeChild(t),n(o,e)()}},t.storageAvailable=r,t.calculateMd5=function(e){return new Promise(((t,n)=>{const r=new FileReader;r.readAsArrayBuffer(e),r.onloadend=()=>{if(r.result){const e=o.lib.WordArray.create(r.result),n=o.MD5(e).toString();t(n)}else n(Error("计算MD5值出错"))}}))},t.LocalStorageExpired=class{constructor(){if(!r("localStorage"))throw new Error("当前浏览器不支持 localStorage");this.storage=window.localStorage,this.init()}init(){const e=new RegExp("__expires__$"),t=this.storage;Object.keys(t).forEach((t=>{e.test(t)||this.get(t)}))}set(e,t,n){const o=this.storage;o[e]=JSON.stringify(t),n&&(o[`${e}__expires__`]=Date.now()+1e3*n)}get(e){const t=this.storage,n=t[`${e}__expires__`]??!1,o=Date.now();if(n&&o>=n)this.remove(e);else{if(!n)return t[e];try{return JSON.parse(t[e])}catch(n){return t[e]}}}remove(e){const t=this.storage;t[e]&&(delete t[e],t[`${e}__expires__`]&&delete t[`${e}__expires__`])}},t.deepcopy=function(e){return JSON.parse(JSON.stringify(e))},t.regexpEscape=function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.htmlTrim=t.cleanDOM=void 0;const o=n(9),r=n(6),a=["article","aside","footer","form","header","main","nav","section","figure","div","b","strong","i","em","dfn","var","cite","span","font","u","del","sup","sub","strike","small","samp","s"],i=["script","meta","link","style","#comment","button","input","select"];function*c(e,t,n){const o=Array.from(e.childNodes);for(const e of o){const o=e.nodeName.toLowerCase();t.includes(o)?yield*c(e,t,n):"#text"===o?1===e.parentElement?.childNodes.length&&t.slice(9).includes(o)?yield e.parentElement:e.textContent?.trim()&&(yield e):n.includes(o)||(yield e)}}function s(e){return(e=e.nextSibling)&&"#text"===e.nodeName.toLowerCase()&&""===e.textContent?.trim()?e.nextSibling:e}function l(e){return(e=e.previousSibling)&&"#text"===e.nodeName.toLowerCase()&&""===e.textContent?.trim()?e.previousSibling:e}function u(e){const t=e.parentElement;if(!t)return null;const n=t.nodeName.toLowerCase();return["div","p"].includes(n)?t:u(t)}async function d(e,t){function n(){const e=document.createElement("p");e.appendChild(a),t.dom.appendChild(e),t.text=t.text+i+"\n\n"}if(!e.src)return;const o=await async function(e,t){if(!e.src)return;const n=t.imgMode,o=e.src;let a=!1;t.option?.keepImageName&&(a=!0);const i=`__imageName__${Math.random().toString().replace("0.","")}__`,c=(0,r.getImageAttachment)(o,n,"",a,i);t.images.push(c);const s=document.createElement("img");return s.setAttribute("data-src-address",i),s.alt=o,[s,`![${o}](${i})`,c]}(e,t);if(!o)return;const[a,i,c]=o;if(1!==e.parentElement?.childElementCount){function o(){if("p"===r?.nodeName.toLowerCase())return r.appendChild(a),void(t.text=t.text+` ${i} `);{const e=document.createElement("p");return e.appendChild(a),t.dom.appendChild(e),void(t.text=t.text+` ${i} `)}}const r=t.dom.lastElementChild,c=s(e),u=l(e);if("p"!==e.parentElement?.nodeName.toLowerCase()||"p"!==r?.nodeName.toLowerCase())return void n();if("#text"===u?.nodeName.toLowerCase()||"#text"===c?.nodeName.toLowerCase())return void o();if("img"===u?.nodeName.toLowerCase()&&"img"===r.lastElementChild?.nodeName.toLowerCase()&&r.lastElementChild.alt===u.src)return void o()}else n()}async function p(e,t){if(0===e.childElementCount){const n=t.dom.lastElementChild,o=e.innerText.trim();if("p"===n?.nodeName.toLowerCase()){const e=document.createTextNode(o);n.appendChild(e),t.text=t.text+o}else{const e=document.createElement("p");e.innerText=o,t.dom.appendChild(e),t.text=t.text+"\n\n"+o}}else await y(e,t)}async function m(e,t){if(0===e.childElementCount){const n=document.createElement("p");n.innerText=e.innerText.trim();const o=e.innerText.trim()+"\n\n";return t.dom.appendChild(n),void(t.text=t.text+o)}await y(e,t)}function h(e,t){function n(){const e=document.createElement("p");e.innerText=i,t.dom.appendChild(e)}function o(){const e=t.dom.lastElementChild;if("p"===e?.nodeName.toLowerCase()){const n=document.createTextNode(i);e.appendChild(n);const o=i+"\n".repeat(r);t.text=t.text+o}else{n();const e=i+"\n".repeat(r);t.text=t.text+e}}const r=e.filter((e=>"br"===e.nodeName.toLowerCase())).length,a=e[0],i=a.textContent?a.textContent.trim():"";if(!i)return;const c=t.dom.lastElementChild,d=l(a);if("p"!==a.parentElement?.nodeName.toLowerCase()||"p"!==c?.nodeName.toLowerCase()||"img"!==d?.nodeName.toLowerCase()||"img"!==c.lastElementChild?.nodeName.toLowerCase()||c.lastElementChild.alt!==d.src)if(0!==r){if(1===r){const e=t.dom.lastElementChild;if("p"===e?.nodeName.toLowerCase()){const n=document.createElement("br"),o=document.createTextNode(i);e.appendChild(n),e.appendChild(o);const r=i+"\n";return void(t.text=t.text+r)}{n();const e=i+"\n";return void(t.text=t.text+e)}}if(2!==r&&3!==r){if(r>3){n();for(let e=Math.round((r-2)/3);e>0;e--){const e=document.createElement("p"),n=document.createElement("br");e.appendChild(n),t.dom.appendChild(e)}const e=i+"\n".repeat(r);t.text=t.text+e}}else{n();const e=i+"\n".repeat(r);t.text=t.text+e}}else{const e=s(a),r=l(a);if(null===e){if("br"===r?.nodeName.toLowerCase()){n();const e=i+"\n\n";return void(t.text=t.text+e)}return null===r&&1===u(a)?.childNodes.length?(n(),void(t.text.endsWith("\n")?t.text=t.text+i+"\n\n":t.text=t.text+"\n\n"+i+"\n\n")):void o()}if(null===r){n();const e=i;return void(t.text.endsWith("\n")?t.text=t.text+e:t.text=t.text+"\n\n"+e)}o()}else o()}function g(e,t){const n=document.createElement("hr"),o="-".repeat(20);t.dom.appendChild(n),t.text=t.text+"\n\n"+o+"\n\n"}async function f(e,t){if(0!==e.childElementCount)return await p(e,t);if(e.href){const n=document.createElement("a");n.href=e.href,n.innerText=e.innerText,n.rel="noopener noreferrer";const o=`[${e.innerText}](${e.href})`;return t.dom.appendChild(n),void(t.text=t+"\n\n"+o)}}function w(e,t){t.dom.appendChild(e.cloneNode(!0)),t.text=t.text+"\n\n"+e.outerHTML}async function y(e,t){const n=[...c(e,a,i)].filter((e=>e));for(let e=0;e<n.length;e++){const o=n[e];if(void 0===o)continue;const r=o.nodeName.toLowerCase();switch(r){case"u":case"del":case"sup":case"sub":case"strike":case"small":case"samp":case"s":case"b":case"strong":case"i":case"em":case"dfn":case"var":case"cite":case"span":case"font":await p(o,t);break;case"div":case"p":await m(o,t);break;case"#text":{const a=[o];let i=e+1,c=r;do{if(i>=n.length)break;const e=n[i];c=e.nodeName.toLowerCase(),"br"===c&&(a.push(e),delete n[i],i++)}while("br"===c);h(a,t);break}case"img":await d(o,t);break;case"hr":g(0,t);break;case"a":await f(o,t);break;case"video":w(o,t)}}return t}t.cleanDOM=async function(e,t,n=null){const r={dom:document.createElement("div"),text:"",images:[],imgMode:t,option:n};await y(e,r);const a=r.dom;let i=r.text;const c=r.images;let s;try{s=await Promise.all(c)}catch(e){o.log.error(e),o.log.trace(e)}s||(o.log.error("[cleanDom] images is undefined!"),s=[]);for(const e of s){const t=e.comments,n=e.imageBlob;if(t){const o=a.querySelector(`img[data-src-address="${t}"]`);n?(o?.setAttribute("data-src-address",e.name),i=i.replaceAll(t,e.name)):(o?.setAttribute("data-src-address",e.url),i=i.replaceAll(t,e.url))}}return i=i.trim(),{dom:a,text:i,images:s}},t.htmlTrim=function(e){const t=Array.from(e.childNodes).reverse();for(const e of t){const t=e.nodeName.toLowerCase();if(!["#text","br"].includes(t))return;if("#text"===t){if(""!==e.textContent?.trim())return;e.remove()}"br"===t&&e.remove()}}},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseRuleClass=void 0;const o=n(6),r=n(13),a=n(9),i=n(7),c=n(16),s=n(11),l=n(33),u=n(19),d="novel-downloader-EaraVl9TtSM2405L";t.BaseRuleClass=class{constructor(){this.imageMode="TM",this.charset=document.charset,this.concurrencyLimit=10}async run(){a.log.info("[run]下载开始");const e=this;try{if(!e.preHook())return;void 0!==window._book&&window._book?e.book=window._book:(e.book=await e.bookParse(),window._book=e.book),a.log.debug("[book]Book object:\n"+JSON.stringify(e.book));const t=e.getSave(e.book);return await e.initChapters(e.book,t),a.log.debug("[run]开始保存文件"),t.saveTxt(),await t.saveZip(!1),e.postHook(),e.postCallback(),(0,l.successPlus)(),(0,l.printStat)(),e.book}catch(t){e.catchError(t)}}preTest(){const e=this,t=window.customStorage;let n=t.get(d);if(n){const t=Object.keys(n).length;if(e.maxRunLimit&&t>=e.maxRunLimit)return!1}else n={},n[document.location.href]=!0,t.set(d,n,20);return!0}preWarning(){return!0}preHook(){const e=this;if(!e.preTest()){const t=`当前网站目前最多允许${e.maxRunLimit}个下载任务同时进行。\n请待其它下载任务完成后，再行尝试。`;return alert(t),a.log.info(`[run]${t}`),!1}return!!e.preWarning()&&(e.audio=new Audio("data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU3LjcxLjEwMAAAAAAAAAAAAAAA/+M4wAAAAAAAAAAAAEluZm8AAAAPAAAAEAAABVgANTU1NTU1Q0NDQ0NDUFBQUFBQXl5eXl5ea2tra2tra3l5eXl5eYaGhoaGhpSUlJSUlKGhoaGhoaGvr6+vr6+8vLy8vLzKysrKysrX19fX19fX5eXl5eXl8vLy8vLy////////AAAAAExhdmM1Ny44OQAAAAAAAAAAAAAAACQCgAAAAAAAAAVY82AhbwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+MYxAALACwAAP/AADwQKVE9YWDGPkQWpT66yk4+zIiYPoTUaT3tnU487uNhOvEmQDaCm1Yz1c6DPjbs6zdZVBk0pdGpMzxF/+MYxA8L0DU0AP+0ANkwmYaAMkOKDDjmYoMtwNMyDxMzDHE/MEsLow9AtDnBlQgDhTx+Eye0GgMHoCyDC8gUswJcMVMABBGj/+MYxBoK4DVpQP8iAtVmDk7LPgi8wvDzI4/MWAwK1T7rxOQwtsItMMQBazAowc4wZMC5MF4AeQAGDpruNuMEzyfjLBJhACU+/+MYxCkJ4DVcAP8MAO9J9THVg6oxRMGNMIqCCTAEwzwwBkINOPAs/iwjgBnMepYyId0PhWo+80PXMVsBFzD/AiwwfcKGMEJB/+MYxDwKKDVkAP8eAF8wMwIxMlpU/OaDPLpNKkEw4dRoBh6qP2FC8jCJQFcweQIPMHOBtTBoAVcwOoCNMYDI0u0Dd8ANTIsy/+MYxE4KUDVsAP8eAFBVpgVVPjdGeTEWQr0wdcDtMCeBgDBkgRgwFYB7Pv/zqx0yQQMCCgKNgonHKj6RRVkxM0GwML0AhDAN/+MYxF8KCDVwAP8MAIHZMDDA3DArAQo3K+TF5WOBDQw0lgcKQUJxhT5sxRcwQQI+EIPWMA7AVBoTABgTgzfBN+ajn3c0lZMe/+MYxHEJyDV0AP7MAA4eEwsqP/PDmzC/gNcwXUGaMBVBIwMEsmB6gaxhVuGkpoqMZMQjooTBwM0+S8FTMC0BcjBTgPwwOQDm/+MYxIQKKDV4AP8WADAzAKQwI4CGPhWOEwCFAiBAYQnQMT+uwXUeGzjBWQVkwTcENMBzA2zAGgFEJfSPkPSZzPXgqFy2h0xB/+MYxJYJCDV8AP7WAE0+7kK7MQrATDAvQRIwOADKMBuA9TAYQNM3AiOSPjGxowgHMKFGcBNMQU1FMy45OS41VVU/31eYM4sK/+MYxKwJaDV8AP7SAI4y1Yq0MmOIADGwBZwwlgIJMztCM0qU5TQPG/MSkn8yEROzCdAxECVMQU1FMy45OS41VTe7Ohk+Pqcx/+MYxMEJMDWAAP6MADVLDFUx+4J6Mq7NsjN2zXo8V5fjVJCXNOhwM0vTCDAxFpMYYQU+RlVMQU1FMy45OS41VVVVVVVVVVVV/+MYxNcJADWAAP7EAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV/+MYxOsJwDWEAP7SAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV/+MYxPMLoDV8AP+eAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV/+MYxPQL0DVcAP+0AFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV"),e.audio.loop=!0,e.audio.play(),window.onbeforeunload=e=>(e.preventDefault(),e.returnValue="您正尝试离开本页面，当前页面有下载任务正在运行，是否确认离开？"),window.downloading=!0,!0)}postCallback(){if(s.enableCustomFinishCallback&&"function"==typeof unsafeWindow.customFinishCallback){const e=unsafeWindow.customFinishCallback;e&&(a.log.info(`发现自定义结束回调函数，内容如下：\n${e.toString()}`),e())}}postHook(){const e=window.customStorage.get(d);return e&&delete e[document.location.href],(0,o.clearAttachmentClassCache)(),this.audio?.pause(),this.audio?.remove(),window.onbeforeunload=null,window.downloading=!1,u.vm.reset(),!0}catchError(e){a.log.error(e),a.log.trace(e),this.postHook(),e instanceof i.ExpectError||(document.getElementById("button-div")?.remove(),a.log.error("运行过程出错，请附上相关日志至支持地址进行反馈。\n支持地址：https://github.com/yingziwu/novel-downloader"),(0,l.failedPlus)(),alert("运行过程出错，请附上相关日志至支持地址进行反馈。\n支持地址：https://github.com/yingziwu/novel-downloader"),(0,a.saveLogTextToFile)())}getSave(e){if(a.log.debug("[run]保存数据"),s.enableCustomSaveOptions&&"object"==typeof unsafeWindow.saveOptions&&(0,c.saveOptionsValidate)(unsafeWindow.saveOptions)){const t=unsafeWindow.saveOptions;if(t)return a.log.info("[run]发现自定义保存参数，内容如下\n",t),(0,c.getSaveBookObj)(e,t)}return(0,c.getSaveBookObj)(e,{})}getChapters(e){let t=e.chapters.filter((e=>e.status===i.Status.pending));return function(){if(s.enableCustomChapterFilter&&"function"==typeof unsafeWindow.chapterFilter){let e="[initChapters]发现自定义筛选函数，自定义筛选函数内容如下：\n";return e+=unsafeWindow.chapterFilter.toString(),a.log.info(e),!0}return!1}()&&(a.log.debug("[initChapters]筛选需下载章节"),t=t.filter((e=>function(e){let t=!0;try{const n=unsafeWindow.chapterFilter(e);"boolean"==typeof n&&(t=n)}catch(e){a.log.error("运行自定义筛选函数时出错。",e),a.log.trace(e)}return t}(e)))),t}async initChapters(e,t){const n=this;a.log.info("[initChapters]开始初始化章节"),Object.entries(n).forEach((e=>a.log.info(`[initChapters] ${e[0]}: ${e[1]}`)));const o=n.getChapters(e);if(0===o.length)return a.log.error("[initChapters]初始化章节出错，未找到需初始化章节"),[];if(u.vm.totalChapterNumber=o.length,1===n.concurrencyLimit)for(const e of o){if(window.stopFlag){a.log.info("[chapter]收到停止信号，停止继续下载。");break}try{let o=await e.init();o=await n.postChapterParseHook(o,t)}catch(e){a.log.error(e),a.log.trace(e)}}else await(0,r.concurrencyRun)(o,n.concurrencyLimit,(async e=>{if(void 0===e)return Promise.resolve();if(window.stopFlag)return a.log.info("[chapter]收到停止信号，停止继续下载。"),Promise.resolve();try{let o=await e.init();return o=await n.postChapterParseHook(o,t),o}catch(e){a.log.error(e),a.log.trace(e)}}));return a.log.info("[initChapters]章节初始化完毕"),o}async postChapterParseHook(e,t){const n=window.customStorage;let o=n.get(d);return o||(o={}),o[document.location.href]=!0,n.set(d,o,20),void 0!==e.contentHTML&&(t.addChapter(e),u.vm.finishedChapterNumber++),e}}},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSaveBookObj=t.saveOptionsValidate=t.getSectionsObj=t.SaveBook=void 0;const o=n(2),r=n(17),a=n(9),i=n(7),c=n(11),s=n(19),l=n(26),u=n(27),d=n(32);class p{constructor(e){this.book=e,this.chapters=e.chapters,this.savedZip=new r.FflateZip,this._sections=[],this.savedTextArray=[],this.saveFileNameBase=`[${this.book.author}]${this.book.bookname}`,this.mainStyleText=l.default,this.tocStyleText=d.default}saveTxt(){const e=this.genMetaDateTxt();this.savedTextArray.push(e),a.log.debug("[save]对 chapters 排序"),this.chapters.sort(this.chapterSort);const t=[];for(const e of this.chapters){const n=this.getchapterName(e);if(e.sectionName&&!t.includes(e.sectionName)){t.push(e.sectionName);const n=this.genSectionText(e.sectionName);this.savedTextArray.push(n)}const o=this.genChapterText(n,e.contentText??"");this.savedTextArray.push(o),c.enableDebug.value||(e.contentText=null)}a.log.info("[save]保存TXT文件");const n=this.savedTextArray.join("\n").replaceAll("\n","\r\n");(0,o.saveAs)(new Blob([n],{type:"text/plain;charset=utf-8"}),`${this.saveFileNameBase}.txt`)}saveLog(){this.savedZip.file("debug.log",new Blob([a.logText],{type:"text/plain; charset=UTF-8"}))}saveZip(e=!1){a.log.debug("[save]保存元数据文本");const t=this.genMetaDateTxt();if(this.savedZip.file("info.txt",new Blob([t],{type:"text/plain;charset=utf-8"})),a.log.debug("[save]保存样式"),this.savedZip.file("style.css",new Blob([this.mainStyleText],{type:"text/css;charset=utf-8"})),this.book.additionalMetadate.cover&&(a.log.debug("[save]保存封面"),this.addImageToZip(this.book.additionalMetadate.cover,this.savedZip)),this.book.additionalMetadate.attachments){a.log.debug("[save]保存书籍附件");for(const e of this.book.additionalMetadate.attachments)this.addImageToZip(e,this.savedZip)}a.log.debug("[save]开始生成并保存卷文件"),this.saveSections(),a.log.debug("[save]开始生成并保存 index.html"),this.saveToC(),e?(a.log.debug("[save]开始保存章节文件"),this.saveChapters()):(a.log.debug("[save]保存仅标题章节文件"),this.chapters.filter((e=>e.status!==i.Status.saved)).forEach((e=>this.addChapter(e,"Stub")))),a.log.info("[save]开始保存ZIP文件");const n=this;return n.saveLog(),new Promise(((e,t)=>{this.savedZip.onFinal=t=>{(0,o.saveAs)(t,`${n.saveFileNameBase}.zip`),e()},this.savedZip.onFinalError=e=>{a.log.error("saveZip: "+e),a.log.trace(e),t(e)},this.savedZip.generateAsync((e=>{s.vm.zipPercent=e}))}))}saveToC(){a.log.debug("[save]对 chapters 排序"),this.chapters.sort(this.chapterSort);const e=this,t=m(e.chapters);e.book.additionalMetadate.cover?e.tocStyleText=`${e.tocStyleText}\n  .info {\n    display: grid;\n    grid-template-columns: 30% 70%;\n  }`:e.tocStyleText=`${e.tocStyleText}\n  .info {\n    display: grid;\n    grid-template-columns: 100%;\n  }`;const n=u.index.render({creationDate:Date.now(),bookname:e.book.bookname,tocStyleText:e.tocStyleText,author:e.book.author,cover:e.book.additionalMetadate.cover,introductionHTML:e.book.introductionHTML?.outerHTML,bookUrl:e.book.bookUrl,sectionsObj:Object.values(t),Status:i.Status});this.savedZip.file("index.html",new Blob([n.replaceAll("data-src-address","src")],{type:"text/html; charset=UTF-8"}))}saveChapters(){for(const e of this.chapters)this.addChapter(e)}saveSections(){a.log.debug("[save]对 chapters 排序"),this.chapters.sort(this.chapterSort);for(const e of this.chapters){const t=`No${this.getChapterNumberToSave(e)}Section.html`;if(e.sectionName&&!this._sections.includes(e.sectionName)){this._sections.push(e.sectionName),a.log.debug(`[save]保存卷HTML文件：${e.sectionName}`);const n=this.genSectionHtmlFile(e);this.savedZip.file(t,n)}}}getChapterNumberToSave(e){return`${"0".repeat(this.chapters.length.toString().length-e.chapterNumber.toString().length)}${e.chapterNumber.toString()}`}addChapter(e,t=""){const n=this.getchapterName(e),o=`No${this.getChapterNumberToSave(e)}Chapter${t}.html`;a.log.debug(`[save]保存章HTML文件：${n}`);const r=this.genChapterHtmlFile(e);if(c.enableDebug.value||(e.contentRaw=null,e.contentHTML=null),this.savedZip.file(o,r),e.chapterHtmlFileName=o,e.status=i.Status.saved,e.contentImages&&0!==e.contentImages.length){a.log.debug(`[save]保存章节附件：${n}`);for(const t of e.contentImages)this.addImageToZip(t,this.savedZip);c.enableDebug.value||(e.contentImages=null)}}getchapterName(e){return e.chapterName?e.chapterName:e.chapterNumber.toString()}genMetaDateTxt(){let e=`题名：${this.book.bookname}\n作者：${this.book.author}`;return this.book.additionalMetadate.tags&&(e+=`\nTag列表：${this.book.additionalMetadate.tags.join("、")}`),e+=`\n原始网址：${this.book.bookUrl}`,this.book.additionalMetadate.cover&&(e+=`\n封面图片地址：${this.book.additionalMetadate.cover.url}`),this.book.introduction&&(e+=`\n简介：${this.book.introduction}`),e+=`\n下载时间：${(new Date).toISOString()}\n本文件由小说下载器生成，软件地址：https://github.com/yingziwu/novel-downloader\n\n`,e}addImageToZip(e,t){e.status===i.Status.finished&&e.imageBlob?(a.log.debug(`[save]添加附件，文件名：${e.name}，对象`,e.imageBlob),t.file(e.name,e.imageBlob),e.status=i.Status.saved,c.enableDebug.value||(e.imageBlob=null)):e.status===i.Status.saved?a.log.debug(`[save]附件${e.name}已添加`):(a.log.warn(`[save]添加附件${e.name}失败，该附件未完成或内容为空。`),a.log.warn(e))}genSectionText(e){return`${"=".repeat(20)}\n\n\n\n# ${e}\n\n\n\n${"=".repeat(20)}\n\n`}genChapterText(e,t){return`## ${e}\n\n${t}\n\n`}genSectionHtmlFile(e){const t=u.section.render({sectionName:e.sectionName});return new Blob([t.replaceAll("data-src-address","src")],{type:"text/html; charset=UTF-8"})}genChapterHtmlFile(e){const t=u.chapter.render({chapterUrl:e.chapterUrl,chapterName:e.chapterName,outerHTML:e.contentHTML?.outerHTML??""});return new Blob([t.replaceAll("data-src-address","src")],{type:"text/html; charset=UTF-8"})}chapterSort(e,t){return e.chapterNumber>t.chapterNumber?1:e.chapterNumber===t.chapterNumber?0:e.chapterNumber<t.chapterNumber?-1:0}}function m(e){const t={};for(const n of e){let e=null;e=n.sectionNumber&&n.sectionName?n.sectionNumber:-99999999,t[e]?t[e].chpaters.push(n):t[e]={sectionName:n.sectionName,sectionNumber:n.sectionNumber,chpaters:[n]}}const n=Object.entries(t);return n.sort((function(e,t){const n=Number(e[0]),o=Number(t[0]);return n>o?1:n===o?0:n<o?-1:0})),n.map((e=>e[1]))}function h(e){const t=["mainStyleText","tocStyleText"],n=["getchapterName","genSectionText","genChapterText","genSectionHtmlFile","genChapterHtmlFile","chapterSort"];function o(e){return!!(new Array).concat(t).concat(n).includes(e)}function r(n){return!(!t.includes(n)||"string"!=typeof e[n])}function a(t){return!(!n.includes(t)||"function"!=typeof e[t])}if("object"!=typeof e)return!1;if(0===Object.keys(e).length)return!1;for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){if(!o(t))return!1;if(!r(t)&&!a(t))return!1}return!0}t.SaveBook=p,t.getSectionsObj=m,t.saveOptionsValidate=h,t.getSaveBookObj=function(e,t){const n=new p(e);return c.enableCustomSaveOptions&&h(t)&&Object.assign(n,t),void 0!==e.saveOptions&&Object.assign(n,e.saveOptions),n}},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FflateZip=void 0;const o=n(18),r=n(9),a=n(13);t.FflateZip=class{constructor(e=!1){this.count=0,this.zcount=0,this.tcount=0,this.memlimit=e,this.filenameList=[],this.zipOut=[];const t=this;this.savedZip=new o.Zip(((e,n,o)=>{if(e)throw r.log.error(e),r.log.trace(e),e;if(t.zipOut.push(n),t.zcount++,o){const e=new Blob(t.zipOut,{type:"application/zip"});if(r.log.debug("[fflateZip][debug][zcount]"+t.zcount),r.log.debug("[fflateZip][debug][count]"+t.count),r.log.info("[fflateZip] ZIP生成完毕，文件大小："+e.size),t.zipOut=[],"function"!=typeof t.onFinal)throw new Error("[fflateZip] 完成函数出错");void 0!==t.onUpdateId&&clearInterval(t.onUpdateId);try{t.onFinal(e)}catch(e){"function"==typeof t.onFinalError&&t.onFinalError(e)}}}))}file(e,t){this.filenameList.includes(e)?r.log.error(`filename ${e} has existed on zip.`):(this.count++,this.filenameList.push(e),t.arrayBuffer().then((e=>new Uint8Array(e))).then((n=>{if(this.memlimit||t.type.includes("image/")){const t=new o.ZipPassThrough(e);this.addToSavedZip(this.savedZip,t,n),this.tcount++}else{const t=new o.AsyncZipDeflate(e,{level:6});this.addToSavedZip(this.savedZip,t,n),this.tcount++}})).catch((e=>r.log.error(e))))}addToSavedZip(e,t,n){e.add(t),t.push(n,!0)}async generateAsync(e){for(;this.tcount!==this.count;)await(0,a.sleep)(500);const t=this;this.onUpdateId=window.setInterval((()=>{const n=t.zcount/3/t.count*100;"function"==typeof e&&e(n)}),100),this.savedZip.end()}}},e=>{"use strict";e.exports=fflate},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vm=t.el=t.style=void 0;const o=n(20),r=n(21),a=n(22),i=n(25);t.style=(0,r.createStyle)(a.default),t.el=(0,r.createEl)('<div id="progress-bar"></div>'),t.vm=o.createApp({data:()=>({totalChapterNumber:0,finishedChapterNumber:0,zipPercent:0}),computed:{chapterPercent(){return 0!==this.totalChapterNumber&&0!==this.finishedChapterNumber?this.finishedChapterNumber/this.totalChapterNumber*100:0},chapterProgressSeen(){return 0!==this.chapterPercent},zipProgressSeen(){return 0!==this.zipPercent},ntProgressSeen(){return!(!this.chapterProgressSeen&&!this.zipProgressSeen)},chapterProgressTitle(){return`章节：${this.finishedChapterNumber}/${this.totalChapterNumber}, ${this.chapterPercent}`}},methods:{reset(){this.totalChapterNumber=0,this.finishedChapterNumber=0,this.zipPercent=0}},template:i.default}).mount(t.el)},e=>{"use strict";e.exports=Vue},(e,t)=>{"use strict";function n(e){const t=document.createElement("div");if(t.innerHTML=e,1===t.childElementCount&&t.firstElementChild)return t.firstElementChild;throw new Error("Create HTMLElement Failed!")}Object.defineProperty(t,"__esModule",{value:!0}),t.createStyle=t.createEl=void 0,t.createEl=n,t.createStyle=function(e,t){const o=n(`<style>${e}</style>`);return t&&(o.id=t),o}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>c});var o=n(23),r=n.n(o),a=n(24),i=n.n(a)()(r());i.push([e.id,"#nd-progress {\n  position: fixed;\n  bottom: 8%;\n  right: 3%;\n  z-index: 2147483647;\n  border-style: none;\n  text-align: center;\n  vertical-align: baseline;\n  background-color: rgba(210, 210, 210, 0.2);\n  padding: 6px;\n  border-radius: 12px;\n}\n#chapter-progress {\n  --color: green;\n  --position: 0%;\n  width: 200px;\n  height: 10px;\n  border-radius: 30px;\n  background-color: #ccc;\n  background-image: radial-gradient(\n      closest-side circle at var(--position),\n      var(--color),\n      var(--color) 100%,\n      transparent\n    ),\n    linear-gradient(var(--color), var(--color));\n  background-image: -webkit-radial-gradient(\n      var(--position),\n      circle closest-side,\n      var(--color),\n      var(--color) 100%,\n      transparent\n    ),\n    -webkit-linear-gradient(var(--color), var(--color));\n  background-size: 100%, var(--position);\n  background-repeat: no-repeat;\n}\n#zip-progress {\n  --color: yellow;\n  --position: 0%;\n  width: 200px;\n  height: 10px;\n  border-radius: 30px;\n  background-color: #ccc;\n  background-image: radial-gradient(\n      closest-side circle at var(--position),\n      var(--color),\n      var(--color) 100%,\n      transparent\n    ),\n    linear-gradient(var(--color), var(--color));\n  background-image: -webkit-radial-gradient(\n      var(--position),\n      circle closest-side,\n      var(--color),\n      var(--color) 100%,\n      transparent\n    ),\n    -webkit-linear-gradient(var(--color), var(--color));\n  background-size: 100%, var(--position);\n  background-repeat: no-repeat;\n  margin-top: 5px;\n}\n",""]);const c=i},e=>{"use strict";e.exports=function(e){return e[1]}},e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",o=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),o&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),o&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,o,r,a){"string"==typeof e&&(e=[[null,e,void 0]]);var i={};if(o)for(var c=0;c<this.length;c++){var s=this[c][0];null!=s&&(i[s]=!0)}for(var l=0;l<e.length;l++){var u=[].concat(e[l]);o&&i[u[0]]||(void 0!==a&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=a),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),r&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=r):u[4]="".concat(r)),t.push(u))}},t}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o});const o='<div> <div id="nd-progress" v-if="ntProgressSeen"> <div v-if="chapterProgressSeen" id="chapter-progress" v-bind:style="{\'--position\': chapterPercent+\'%\'}" v-bind:title="chapterProgressTitle"></div> <div v-if="zipProgressSeen" id="zip-progress" title="ZIP" v-bind:style="{\'--position\': zipPercent+\'%\'}"></div> </div> </div> '},(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>c});var o=n(23),r=n.n(o),a=n(24),i=n.n(a)()(r());i.push([e.id,'body {\n  background-color: #f0f0f2;\n  margin: 0;\n  padding: 0;\n  font-family: -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI",\n    "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;\n}\ndiv.main {\n  width: 900px;\n  margin: 5em auto;\n  padding: 2em;\n  background-color: #fdfdff;\n  border-radius: 0.5em;\n  box-shadow: 2px 3px 7px 2px rgba(0, 0, 0, 0.02);\n}\n@media (max-width: 700px) {\n  div.main {\n    margin: 0 auto;\n    width: auto;\n  }\n}\nh1 {\n  line-height: 130%;\n  text-align: center;\n  font-weight: bold;\n  font-size: xxx-large;\n  margin-top: 3.2em;\n  margin-bottom: 3.3em;\n}\nh2 {\n  line-height: 130%;\n  text-align: center;\n  font-weight: bold;\n  font-size: x-large;\n  margin-top: 1.2em;\n  margin-bottom: 2.3em;\n}\ndiv {\n  margin: 0px;\n  padding: 0px;\n  text-align: justify;\n}\np {\n  text-indent: 2em;\n  display: block;\n  line-height: 1.3em;\n  margin-top: 0.4em;\n  margin-bottom: 0.4em;\n}\nimg {\n  vertical-align: text-bottom;\n  max-width: 90%;\n}\n.title {\n  margin-bottom: 0.7em;\n}\n',""]);const c=i},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.index=t.chapter=t.section=void 0;const o=n(28),r=n(29),a=n(30),i=n(31),c=new i.Environment(void 0,{autoescape:!1});t.section=new i.Template(a.default,c,void 0,!0),t.chapter=new i.Template(o.default,c,void 0,!0),t.index=new i.Template(r.default,c,void 0,!0)},(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o});const o='<!DOCTYPE html> <html> <head> <meta charset="UTF-8"/> <meta name="viewport" content="width=device-width,initial-scale=1"/> <meta name="referrer" content="same-origin"/> <meta name="generator" content="https://github.com/yingziwu/novel-downloader"/> <meta name="source" content="{{ chapterUrl }}"/> <link href="style.css" rel="stylesheet"/> <title>{{ chapterName }}</title> </head> <body> <div class="main"> <h2>{{ chapterName }}</h2> {{ outerHTML }} </div> </body> </html> '},(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o});const o='<!DOCTYPE html> <html> <head> <meta charset="UTF-8"/> <meta name="viewport" content="width=device-width,initial-scale=1"/> <meta name="referrer" content="same-origin"/> <meta name="generator" content="https://github.com/yingziwu/novel-downloader"/> <meta name="date-creation" content="{{ creationDate }}"/> <link href="style.css" rel="stylesheet"/> <title>{{ bookname }}</title> <style></style> </head> <body> <div class="main"> <h1>{{ bookname }}</h1> <h3 class="author">{{ author }}</h3> <div class="info"> {% if cover -%} <img class="cover" data-src-address="{{ cover.name }}"/> {%- endif %} {% if introductionHTML -%} <div> <h3>简介</h3> <div class="introduction">{{ introductionHTML }}</div> </div> {%- endif %} </div> <div class="bookurl"> <a href="{{ bookUrl }}">打开原始网站</a> </div> <hr/> {% for sectionObj in sectionsObj -%} <div id="section{{ sectionObj.sectionNumber }}" class="section"> {% if sectionObj.sectionName %} <h2 class="section-label">{{ sectionObj.sectionName }}</h2> {% endif %} {% for chapter in sectionObj.chpaters -%} <div class="chapter"> {% if not (chapter.contentHTML or chapter.status === Status.saved) -%} <a class="disabled" href="{{ chapter.chapterHtmlFileName }}">{{ chapter.chapterName }}</a> {%- else -%} <a href="{{ chapter.chapterHtmlFileName }}">{{ chapter.chapterName }}</a> {%- endif %} </div> {%- endfor %} </div> {%- endfor %} </div> </body> </html>'},(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o});const o='<!DOCTYPE html> <html> <head> <meta charset="UTF-8"/> <meta name="viewport" content="width=device-width,initial-scale=1"/> <meta name="referrer" content="same-origin"/> <meta name="generator" content="https://github.com/yingziwu/novel-downloader"/> <link href="style.css" rel="stylesheet"/> <title>{{ sectionName }}</title> </head> <body> <div class="main"><h1>{{ sectionName }}</h1></div> </body> </html> '},e=>{"use strict";e.exports=nunjucks},(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>c});var o=n(23),r=n.n(o),a=n(24),i=n.n(a)()(r());i.push([e.id,'img {\n  max-width: 100%;\n  max-height: 15em;\n}\n.introduction {\n  font-size: smaller;\n  max-height: 18em;\n  overflow-y: scroll;\n}\n.introduction p {\n  text-indent: 0;\n}\n.bookurl {\n  text-align: center;\n  font-size: smaller;\n  padding-top: 1em;\n  padding-bottom: 0.5em;\n  margin-top: 0.4em;\n}\n.bookurl > a {\n  color: gray;\n}\n.info h3 {\n  padding-left: 0.5em;\n  margin-top: -1.2em;\n  margin-bottom: 0.5em;\n}\n.section {\n  margin-top: 1.5em;\n  display: grid;\n  grid-template-columns: 30% 30% 30%;\n}\n.section > h2:first-child {\n  grid-column-end: span 3;\n}\n.section > .chapter {\n  padding-bottom: 0.3em;\n  text-align: center;\n}\n.main > h1 {\n  margin-top: 1.5em;\n  margin-bottom: 1.5em;\n}\na.disabled {\n  pointer-events: none;\n  cursor: default;\n  color: gray;\n}\n.author::before {\n  content: "作者：";\n}\n.author {\n  text-align: center;\n  margin-top: -3em;\n  margin-bottom: 3em;\n}\n',""]);const c=i},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resetStat=t.printStat=t.failedPlus=t.successPlus=void 0;const o=n(12),r=n(9),a="novel-downloader-22932304826849026",i=document.location.hostname;async function c(){const e=await(0,o._GM_getValue)(a);let t;return t=e?JSON.parse(e):{success:{},failed:{}},t}const s=async e=>{const t=JSON.stringify(e);return await(0,o._GM_setValue)(a,t),e},l=async e=>{const t=await c(),n=t[e];return n[i]?n[i]=n[i]+1:n[i]=1,s(t)};t.successPlus=()=>l("success"),t.failedPlus=()=>l("failed"),t.printStat=async()=>{const e=await c();r.log.info("[stat]小说下载器脚本运行情况统计："),r.log.info(e);for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){r.log.info(`[stat]${t}:`);const n=e[t];for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&r.log.info(`  [stat]${e}: ${n[e]}`)}},t.resetStat=()=>s({success:{},failed:{}})},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nextPageParse=t.introDomHandle=void 0;const o=n(14),r=n(8),a=n(9);t.introDomHandle=async function(e,t){if(null===e)return[null,null,null];{t&&(e=t(e.cloneNode(!0)));const{dom:n,text:r,images:a}=await(0,o.cleanDOM)(e,"TM");return[r,n,a]}},t.nextPageParse=async function(e){const{chapterName:t,chapterUrl:n,charset:i,selector:c,contentPatch:s,getNextPage:l,continueCondition:u,enableCleanDOM:d}=e;a.log.debug(`[Chapter]请求 ${n}`);let p=n,m=await(0,r.getHtmlDOM)(n,i);const h=document.createElement("div");let g,f,w,y=!1;do{let e=m.querySelector(c);const t=l(m);u(e,t)?t!==p?y=!0:(a.log.error("网站页面出错，URL： "+p),y=!1):y=!1,e=s(e,m);for(const t of Array.from(e.childNodes))h.appendChild(t.cloneNode(!0));y&&(a.log.debug(`[Chapter]请求 ${t}`),p=t,m=await(0,r.getHtmlDOM)(t,i))}while(y);if(d||void 0===d){const e=await(0,o.cleanDOM)(h,"TM");g=e.dom,f=e.text,w=e.images}else g=null,f=null,w=null;return{chapterName:t,contentRaw:h,contentText:f,contentHTML:g,contentImages:w,additionalMetadate:null}}},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Uukanshu=void 0;const o=n(6),r=n(14),a=n(8),i=n(13),c=n(9),s=n(7),l=n(15),u=n(34);class d extends l.BaseRuleClass{constructor(){super(),this.imageMode="TM",this.charset="GBK"}async bookParse(){const e=document.location.href,t=document.querySelector("dd.jieshao_content > h1 > a").innerText.replace("最新章节","").trim(),n=document.querySelector("dd.jieshao_content > h2 > a").innerText.trim(),r=document.querySelector("dd.jieshao_content > h3"),[a,i,l]=await(0,u.introDomHandle)(r,(e=>(e.innerHTML=e.innerHTML.replace(/^.+简介：\s+www.uukanshu.com\s+/,"").replace(/\s+https:\/\/www.uukanshu.com/,"").replace(/－+/,""),e))),d={},p=document.querySelector("a.bookImg > img").src;p&&(0,o.getImageAttachment)(p,this.imageMode,"cover-").then((e=>{d.cover=e})).catch((e=>c.log.error(e)));const m=[],h=document.querySelector('span[onclick="javascript:reverse(this);"]'),g=unsafeWindow.reverse;"顺序排列"===h.innerText&&g(h);const f=document.getElementById("chapterList")?.childNodes;if(f&&0!==f.length){let n=0,o=0,r=null,a=0;for(const i of Array.from(f))if("volume"===i.className)o++,a=0,r=i.innerText;else{n++,a++;const c=i.firstElementChild,l=c.innerText,u=c.href,d=!1,p=!1,h=new s.Chapter(e,t,u,n,l,d,p,r,o,a,this.chapterParse,this.charset,{});m.push(h)}}return new s.Book(e,t,n,a,i,d,m)}async chapterParse(e,t,n,o,c,s){const l=await(0,a.getHtmlDOM)(e,c);t=l.querySelector("#timu").innerText.trim();const u=l.querySelector("#contentbox");if(u){(0,i.rm)(".ad_content",!0,u);const e=[/[ＵｕUu]+看书\s*[wｗ]+.[ＵｕUu]+[kｋ][aａ][nｎ][ｓs][hｈ][ＵｕUu].[nｎ][eｅ][tｔ]/g,/[ＵｕUu]+看书\s*[wｗ]+.[ＵｕUu]+[kｋ][aａ][nｎ][ｓs][hｈ][ＵｕUu].[cＣｃ][oＯｏ][mＭｍ]/g,/[UＵ]*看书[（\\(].*?[）\\)]文字首发。/,/请记住本书首发域名：。?/g,/笔趣阁手机版阅读网址：/g,/小说网手机版阅读网址：/g,/https:\/\//g,/http:\/\//g,/UU看书\s+欢迎广大书友光临阅读，最新、最快、最火的连载作品尽在UU看书！UU看书。;?/g];for(const t of e)u.innerHTML=u.innerHTML.replace(t,"");const{dom:n,text:o,images:a}=await(0,r.cleanDOM)(u,"TM");return{chapterName:t,contentRaw:u,contentText:o,contentHTML:n,contentImages:a,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}t.Uukanshu=d},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Yrun=void 0;const o=n(6),r=n(14),a=n(8),i=n(9),c=n(7),s=n(15),l=n(34);class u extends s.BaseRuleClass{constructor(){super(),this.imageMode="TM",this.concurrencyLimit=1}async bookParse(){const e=document.location.href,t=document.querySelector("#info > h1:nth-child(1)").innerText.trim(),n=document.querySelector("#info > p:nth-child(2)").innerText.replace(/作(\s+)?者[：:]/,"").trim(),r=document.querySelector("#intro > p"),[a,s,u]=await(0,l.introDomHandle)(r),d={},p=document.querySelector("#fmimg > img").src;p&&(0,o.getImageAttachment)(p,this.imageMode,"cover-").then((e=>{d.cover=e})).catch((e=>i.log.error(e)));const m=[],h=document.querySelectorAll("#list>dl>dd>a");if(h&&0!==h.length)for(let n=0;n<h.length;n++){const o=h[n],r=o.innerText,a=o.href,i=!1,s=!1,l=new c.Chapter(e,t,a,n,r,i,s,null,null,null,this.chapterParse,"UTF-8",{});m.push(l)}return new c.Book(e,t,n,a,s,d,m)}async chapterParse(e,t,n,o,i,c){const s=await(0,a.getHtmlDOM)(e,i);t=s.querySelector(".bookname > h1:nth-child(1)").innerText.trim();const l=s.querySelector("#content");if(l){const{dom:e,text:n,images:o}=await(0,r.cleanDOM)(l,"TM");return{chapterName:t,contentRaw:l,contentText:n,contentHTML:e,contentImages:o,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}t.Yrun=u},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xyqxs=t.shuquge=void 0;const o=n(13),r=n(38);t.shuquge=()=>(0,r.mkBiqugeClass2)((e=>(document.querySelector(".noshow")?.classList.remove("noshow"),document.querySelector(".showall")&&(document.querySelector(".showall").innerHTML=""),e.innerHTML=e.innerHTML.replace(/作者：.+所写的《.+》无弹窗免费全文阅读为转载作品,章节由网友发布。/,"").replace(/推荐地址：https?:\/\/www.shuquge.com\/txt\/\d+\/index\.html/g,""),e)),(e=>(e.innerHTML=e.innerHTML.replace("请记住本书首发域名：www.shuquge.com。书趣阁_笔趣阁手机版阅读网址：m.shuquge.com","").replace(/https?:\/\/www.shuquge.com\/txt\/\d+\/\d+\.html/,""),e)),1),t.xyqxs=()=>(0,r.mkBiqugeClass2)((e=>(e.innerHTML=e.innerHTML.replace(/推荐地址：https:\/\/www.xyqxs.cc\/html\/\d+\/\d+\/index\.html/g,""),e)),(e=>((0,o.rm)("div[style]",!0,e),(0,o.rm)("script",!0,e),(0,o.rm)('div[align="center"]',!1,e),e.innerHTML=e.innerHTML.replace("请记住本书首发域名：www.xyqxs.cc。笔趣阁手机版阅读网址：m.xyqxs.cc","").replace(/\(https:\/\/www.xyqxs.cc\/html\/\d+\/\d+\/\d+\.html\)/,""),e)))},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mkBiqugeClass3=t.mkBiqugeClass2=t.mkBiqugeClass=t.chapterParseTemp=t.bookParseTemp=void 0;const o=n(6),r=n(14),a=n(8),i=n(9),c=n(7),s=n(15),l=n(34);async function u({bookUrl:e,bookname:t,author:n,introDom:r,introDomPatch:a,coverUrl:s,chapterListSelector:u,charset:d,chapterParse:p,enableIgnore:m=!0}){const[h,g,f]=await(0,l.introDomHandle)(r,a),w={};s&&(0,o.getImageAttachment)(s,"TM","cover-").then((e=>{w.cover=e})).catch((e=>i.log.error(e)));const y=document.querySelectorAll(u),b=[];Array.from(y).map((e=>Array.from(e.children))).forEach((e=>e.forEach((e=>b.push(e)))));let v=1;if(m&&"DT"===b[0].nodeName){const e=b[0];if(/最新(.+)?章节/.test(e.innerText))for(delete b[0];v<b.length&&"DT"!==b[v].nodeName;v++)delete b[v]}const x=[],T=b.filter((e=>void 0!==e));let M=0,A=0,S=null,k=0;for(const n of T)if("DT"===n.nodeName)A++,k=0,S=n.innerText.includes("《")?n.innerText.replace(`《${t}》`,"").trim():n.innerText.replace(`${t}`,"").trim();else if("DD"===n.nodeName){if(0===n.childElementCount)continue;M++,k++;const o=n.firstElementChild,r=o.innerText,a=o.href,i=!1,s=!1,l=new c.Chapter(e,t,a,M,r,i,s,S,A,k,p,d,{bookname:t});x.push(l)}return new c.Book(e,t,n,h,g,w,x)}async function d({dom:e,chapterUrl:t,chapterName:n,contenSelector:o,contentPatch:a,charset:i,options:c}){let s=e.querySelector(o);if(s){s=a(s,c);const{dom:e,text:t,images:o}=await(0,r.cleanDOM)(s,"TM");return{chapterName:n,contentRaw:s,contentText:t,contentHTML:e,contentImages:o,additionalMetadate:null}}return{chapterName:n,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}t.bookParseTemp=u,t.chapterParseTemp=d,t.mkBiqugeClass=function(e,t,n,o){return class extends s.BaseRuleClass{constructor(){super(),"number"==typeof n&&(this.concurrencyLimit=n),this.imageMode="TM",this.charset=document.charset,this.overrideConstructor(this)}async bookParse(){return void 0===o&&(o=!0),u({bookUrl:document.location.href,bookname:document.querySelector("#info h1:nth-of-type(1)").innerText.trim().replace(/最新章节$/,""),author:document.querySelector("#info > p:nth-child(2)").innerText.replace(/作(\s+)?者[：:]/,"").trim(),introDom:document.querySelector("#intro"),introDomPatch:e,coverUrl:document.querySelector("#fmimg > img").src,chapterListSelector:"#list>dl",charset:document.charset,chapterParse:this.chapterParse,enableIgnore:o})}async chapterParse(e,n,o,r,i,c){const s=await(0,a.getHtmlDOM)(e,i);return d({dom:s,chapterUrl:e,chapterName:(s.querySelector(".bookname > h1:nth-child(1)")?.innerText.trim()||n)??"",contenSelector:"#content",contentPatch:t,charset:i,options:c})}overrideConstructor(e){}}},t.mkBiqugeClass2=function(e,t,n){return class extends s.BaseRuleClass{constructor(){super(),"number"==typeof n&&(this.concurrencyLimit=n),this.imageMode="TM",this.charset=document.charset,this.overrideConstructor(this)}async bookParse(){return u({bookUrl:document.location.href,bookname:document.querySelector(".info > h2").innerText.trim().replace(/最新章节$/,""),author:document.querySelector(".small > span:nth-child(1)").innerText.replace(/作(\s+)?者[：:]/,"").trim(),introDom:document.querySelector(".intro"),introDomPatch:e,coverUrl:document.querySelector(".info > .cover > img").src,chapterListSelector:".listmain>dl",charset:document.charset,chapterParse:this.chapterParse})}async chapterParse(e,n,o,r,i,c){const s=await(0,a.getHtmlDOM)(e,i);return d({dom:s,chapterUrl:e,chapterName:s.querySelector(".content > h1:nth-child(1)").innerText.trim(),contenSelector:"#content",contentPatch:t,charset:i,options:c})}overrideConstructor(e){}}},t.mkBiqugeClass3=function(e,t,n,o,r,a){return class extends s.BaseRuleClass{constructor(){super(),"number"==typeof r&&(this.concurrencyLimit=r),this.imageMode="TM",this.charset=document.charset,this.overrideConstructor(this)}async bookParse(){return void 0===a&&(a=!0),u({bookUrl:document.location.href,bookname:document.querySelector("#info h1:nth-of-type(1)").innerText.trim().replace(/最新章节$/,""),author:document.querySelector("#info > p:nth-child(2)").innerText.replace(/作(\s+)?者[：:]/,"").trim(),introDom:document.querySelector("#intro"),introDomPatch:e,coverUrl:document.querySelector("#fmimg > img").src,chapterListSelector:"#list>dl",charset:document.charset,chapterParse:this.chapterParse,enableIgnore:a})}async chapterParse(e,r,a,i,c,s){return(0,l.nextPageParse)({chapterName:r,chapterUrl:e,charset:c,selector:"#content",contentPatch:t,getNextPage:n,continueCondition:o})}overrideConstructor(e){}}}},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xinwanben=t.mht=t.dingdiann=void 0;const o=n(14),r=n(13),a=n(38);t.dingdiann=()=>(0,a.mkBiqugeClass3)((e=>e),((e,t)=>((0,r.rm)("div[align]",!1,e),(0,r.rm)("script",!0,e),["一秒记住，精彩小说无弹窗免费阅读！","&lt;/a　:&gt;","--&gt;&gt;","本章未完，点击下一页继续阅读"].forEach((t=>e.innerHTML=e.innerHTML.replaceAll(t,""))),(0,o.htmlTrim)(e),e)),(e=>e.querySelector(".bottem2 > a:nth-child(4)").href),((e,t)=>e.innerText.includes("本章未完，点击下一页继续阅读"))),t.mht=()=>(0,a.mkBiqugeClass3)((e=>e),((e,t)=>((0,r.rm)("p[data-id]",!0,e),(0,o.htmlTrim)(e),e)),(e=>e.querySelector(".bottem2 > a:nth-child(4)").href),((e,t)=>new URL(t).pathname.includes("_"))),t.xinwanben=()=>(0,a.mkBiqugeClass3)((e=>{const t=e.innerHTML.match(/《(.*)》/);let n;return 2===t?.length&&(n=t[1]),(0,r.rm2)(e,["还不错的话请不要忘记向您QQ群和微博里的朋友推荐哦！","小说免费阅读地址："]),e.innerHTML=e.innerHTML.replace(`${n}小说简介：`,""),e}),((e,t)=>((0,r.rm2)(e,["手机用户输入地址","提示：浏览器搜索","把本站分享那些需要的小伙伴！找不到书请留言！"]),(0,o.htmlTrim)(e),e)),(e=>e.querySelector("#next_url").href),((e,t)=>new URL(t).pathname.includes("_")),void 0,!0)},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Xkzw=void 0;const o=n(5),r=n(6),a=n(14),i=n(8),c=n(9),s=n(7),l=n(15),u=n(34);class d extends l.BaseRuleClass{constructor(){super(),this.imageMode="TM"}async bookParse(){const e=document.location.href,t=document.querySelector("#info > h1:nth-child(1)").innerText.trim(),n=document.querySelector("#info > p:nth-child(2)").innerText.replace(/作(\s+)?者[：:]/,"").trim(),o=document.querySelector("#intro"),[a,i,l]=await(0,u.introDomHandle)(o),d={},p=document.querySelector("#fmimg > img").src;p&&(0,r.getImageAttachment)(p,this.imageMode,"cover-").then((e=>{d.cover=e})).catch((e=>c.log.error(e)));const m=[],h=unsafeWindow.bookId,g=[document.location.origin,"action.php"].join("/");c.log.debug(`[chapter]正在请求${g}`);const f=await fetch(g,{headers:{accept:"application/json, text/javascript, */*","content-type":"application/x-www-form-urlencoded","x-requested-with":"XMLHttpRequest"},body:`action=clist&bookid=${h}`,method:"POST",mode:"cors",credentials:"include"}).then((e=>e.json())).catch((e=>c.log.error(e))),w=document.querySelector("#wrapper > div.box_con:nth-child(7) > div:nth-child(1) > dl:nth-child(1)"),y=document.querySelector("#wrapper > div.box_con:nth-child(11) > div:nth-child(1) > dl:nth-child(1)"),b=e=>{let n="";const o=[];let r=[];if(e?.childElementCount){const a=Array.from(e.children);for(let i=0;i<e.childElementCount;i++){const e=a[i];if(0!==i){if("DD"===e.nodeName){const t=e.firstElementChild,n=t.innerText,o=t.href.split("/").slice(-1)[0].replace(".html","");r.push({chapterid:Number(o)-11*h,chaptername:n,isempty:0,originalurl:"",currenturl:""})}else if("DT"===e.nodeName){const a={columnname:n,columnid:0,chapterlist:r};o.push(a),n=e.innerText.replace(`《${t}》`,"").trim(),r=[]}}else n=e.innerText.replace(`《${t}》`,"").trim()}}return[o,r]},[v,x]=b(w),T=x.length;for(let e=0;e<T;e++){const e=x.pop();e&&f.columnlist[0].chapterlist.unshift(e)}if(0!==v.length){const e=v.length;for(let t=0;t<e;t++){const e=v.pop();e&&f.columnlist.unshift(e)}}const[M,A]=b(y),S=A.length,k=f.columnlist.length;for(let e=0;e<S;e++){const e=A.shift();e&&f.columnlist[k-1].chapterlist.push(e)}if(0!==M.length){const e=M.length;for(let t=0;t<e;t++){const e=M.shift();e&&f.columnlist.push(e)}}let C=0,q=0,P=null,L=0;for(const n of f.columnlist){q++,P=n.columnname;for(const o of n.chapterlist){C++,L++;const n=o.chaptername,r=e+(o.chapterid+11*h)+".html",a=!1,i=!1,c=new s.Chapter(e,t,r,C,n,a,i,P,q,L,this.chapterParse,"UTF-8",{});m.push(c)}}return new s.Book(e,t,n,a,i,d,m)}async chapterParse(e,t,n,r,c,s){const l=await(0,i.getHtmlDOM)(e,c);!function(e){!function(t){const n=t.getElementById("other"),o=t.getElementById("contenttips");if(n){let t=n.innerHTML.trim();const r=parseInt(t.substring(0,1),10);let a,i;1===r?(a=t.substring(1,9),i=t.substring(9,17),t=t.substring(17),n.innerHTML=function(t,n,o){const r=e.enc.Utf8.parse(n),a=e.enc.Utf8.parse(o),i=e.enc.Hex.parse(t),c=e.enc.Base64.stringify(i);return e.DES.decrypt(c,r,{iv:a,mode:e.mode.CBC,padding:e.pad.Pkcs7}).toString(e.enc.Utf8).toString()}(t,a,i),n.style.display="block",o&&o.remove()):2===r?(a=t.substring(1,33),i=t.substring(33,49),t=t.substring(49),n.innerHTML=function(t,n,o){const r=e.enc.Utf8.parse(n),a=e.enc.Utf8.parse(o),i=e.enc.Hex.parse(t),c=e.enc.Base64.stringify(i);return e.AES.decrypt(c,r,{iv:a,mode:e.mode.CBC,padding:e.pad.Pkcs7}).toString(e.enc.Utf8).toString()}(t,a,i),n.style.display="block",o&&o.remove()):3===r?(a=t.substring(1,9),i=t.substring(9,17),t=t.substring(17),n.innerHTML=function(t,n,o){const r=e.enc.Utf8.parse(n),a=e.enc.Utf8.parse(o),i=e.enc.Hex.parse(t),c=e.enc.Base64.stringify(i);return e.RC4.decrypt(c,r,{iv:a,mode:e.mode.CBC,padding:e.pad.Pkcs7}).toString(e.enc.Utf8).toString()}(t,a,i),n.style.display="block",o&&o.remove()):(a=t.substring(1,25),i=t.substring(25,33),t=t.substring(33),n.innerHTML=function(t,n,o){const r=e.enc.Utf8.parse(n),a=e.enc.Utf8.parse(o),i=e.enc.Hex.parse(t),c=e.enc.Base64.stringify(i);return e.TripleDES.decrypt(c,r,{iv:a,mode:e.mode.CBC,padding:e.pad.Pkcs7}).toString(e.enc.Utf8).toString()}(t,a,i),n.style.display="block",o&&o.remove())}}(l)}(o),t=l.querySelector(".bookname > h1:nth-child(1)").innerText.trim();const u=l.querySelector("#content");if(u){const{dom:e,text:n,images:o}=await(0,a.cleanDOM)(u,"TM");return{chapterName:t,contentRaw:u,contentText:n,contentHTML:e,contentImages:o,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}t.Xkzw=d},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.c226ks=void 0;const o=n(13),r=n(34),a=n(42);t.c226ks=()=>(0,a.mkRuleClass)({bookUrl:document.location.href.replace(/index_\d+\.html/,"index_1.html"),bookname:document.querySelector(".info > .top > h1").innerText.trim(),author:document.querySelector(".info > .top > .fix > p:nth-child(1)").innerText.replace(/作(\s+)?者[：:]/,"").trim(),introDom:document.querySelector(".desc"),introDomPatch:e=>e,coverUrl:document.querySelector(".imgbox > img").src,getIndexUrls:()=>Array.from(document.querySelectorAll('[name="pageselect"] > option')).map((e=>document.location.origin+e.getAttribute("value"))),getAList:e=>e.querySelectorAll("div.section-box:nth-child(4) > ul:nth-child(1) > li > a"),getContentFromUrl:async(e,t,n)=>{const{chapterName:a,contentRaw:i,contentText:c,contentHTML:s,contentImages:l,additionalMetadate:u}=await(0,r.nextPageParse)({chapterName:t,chapterUrl:e,charset:n,selector:"#content",contentPatch:(e,t)=>((0,o.rm)("script",!0,e),(0,o.rm)("div.posterror",!1,e),(0,o.rm)("div[onclick]",!0,e),e.innerHTML=e.innerHTML.replace('<div class="posterror"><a href="javascript:postError();" class="red">章节错误,点此举报(免注册)</a>,举报后维护人员会在两分钟内校正章节内容,请耐心等待,并刷新页面。</div>',""),e),getNextPage:e=>e.querySelector("div.section-opt.m-bottom-opt > a:nth-child(5)").href,continueCondition:(e,t)=>t.split("/").slice(-1)[0].includes("_"),enableCleanDOM:!1});return i},contentPatch:e=>e})},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mkRuleClass=void 0;const o=n(6),r=n(14),a=n(8),i=n(9),c=n(7),s=n(15),l=n(11),u=n(34);t.mkRuleClass=function(e){const{bookUrl:t,bookname:n,author:d,introDom:p,introDomPatch:m,coverUrl:h,getIndexUrls:g,getAList:f,getContentFromUrl:w,getContent:y,contentPatch:b}=e;return class extends s.BaseRuleClass{constructor(){super(),this.imageMode="TM"}async bookParse(){const[e,r,s]=await(0,u.introDomHandle)(p,m),w={};h&&(0,o.getImageAttachment)(h,this.imageMode,"cover-").then((e=>{w.cover=e})).catch((e=>i.log.error(e)));const y=g(),b=(e,t)=>(0,a.getHtmlDOM)(e).then((e=>e)).catch((n=>(i.log.error(n),i.log.error(`[bookParse][getIndexDom]抓取目录页失败: ${e}, 第${l.retryLimit-t}次重试`),--t>0?b(e,t):null))),v=y.map((e=>b(e,l.retryLimit))),x=(await Promise.all(v)).map((e=>e?f(e):(i.log.error("[bookParse]部分目录页抓取失败！"),null))).filter((e=>null!==e)),T=[];x.forEach((e=>Array.from(e).forEach((e=>T.push(e)))));const M=[];let A=0;for(const e of Array.from(T)){A++;const o=e.innerText,r=e.href,a=!1,i=!1,s=new c.Chapter(t,n,r,A,o,a,i,null,null,null,this.chapterParse,this.charset,{bookname:n});M.push(s)}return new c.Book(t,n,d,e,r,w,M)}async chapterParse(e,t,n,o,i,c){let s;if(void 0!==w)s=await w(e,t,i);else if(void 0!==y){const t=await(0,a.getHtmlDOM)(e,i);s=y(t)}if(s){s=b(s);const{dom:e,text:n,images:o}=await(0,r.cleanDOM)(s,"TM");return{chapterName:t,contentRaw:s,contentText:n,contentHTML:e,contentImages:o,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}}},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Sfacg=void 0;const o=n(6),r=n(14),a=n(8),i=n(13),c=n(9),s=n(7),l=n(15),u=n(11),d=n(34);class p extends l.BaseRuleClass{constructor(){super(),this.imageMode="TM",this.concurrencyLimit=1}async bookParse(){const e=document.location.href.replace("/MainIndex/",""),t=document.querySelector("h1.story-title").innerText.trim(),n=await(0,a.getHtmlDOM)(e,void 0),r=n.querySelector(".author-name").innerText.trim(),l=n.querySelector(".introduce"),[u,p,m]=await(0,d.introDomHandle)(l),h={},g=n.querySelector("#hasTicket div.pic img").src;if(g&&(0,o.getImageAttachment)(g,this.imageMode,"cover-").then((e=>{h.cover=e})).catch((e=>c.log.error(e))),h.tags=Array.from(n.querySelectorAll("ul.tag-list > li.tag > a")).map((e=>((0,i.rm)("span.icn",!1,e),e.innerText.trim().replace(/\(\d+\)$/,"")))),n.querySelector(".d-banner")){const e=n.querySelector(".d-banner")?.style.backgroundImage.split('"');if(3===e?.length){const t=e[1],n=new s.AttachmentClass(t,`beitou.${t.split(".").slice(-1)[0]}`,"TM");n.init(),h.attachments=[n]}}const f=[],w=document.querySelectorAll(".story-catalog");let y=0;for(let n=0;n<w.length;n++){const o=w[n],r=n+1,a=o.querySelector(".catalog-title").innerText.replace(`【${t}】`,"").trim();let i=0;const c=o.querySelectorAll(".catalog-list > ul > li > a");for(const n of Array.from(c)){const o=n.getAttribute("title")?.trim();y++,i++;const c=o||"",l=n.href;let u=!1;const d=null;n.childElementCount&&"icn_vip"===n.firstElementChild?.getAttribute("class")&&(u=!0);const p=new s.Chapter(e,t,l,y,c,u,d,a,r,i,this.chapterParse,"UTF-8",{}),m=3===document.querySelector(".user-bar > .top-link > .normal-link")?.childElementCount;u&&!m&&(p.status=s.Status.aborted),f.push(p)}}return new s.Book(e,t,r,u,p,h,f)}async chapterParse(e,t,n,o,i,l){const d=e.split("/").slice(-2,-1)[0];async function p(){const n=await(0,a.getHtmlDOM)(e,i);t=n.querySelector("h1.article-title").innerText.trim();const o=n.querySelector(".article-content");if(o){const{dom:e,text:n,images:a}=await(0,r.cleanDOM)(o,"TM");return{chapterName:t,contentRaw:o,contentText:n,contentHTML:e,contentImages:a,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}return n?async function(){if(3===document.querySelector(".user-bar > .top-link > .normal-link")?.childElementCount){const t=await(0,a.getHtmlDOM)(e,i),n=t.querySelector("h1.article-title").innerText.trim();if(null===t.querySelector(".pay-section")){const o=t.querySelector(".article-content > #vipImage");if(o){const t=o.src,r=`vipCHapter${d}.gif`,a=await async function(t,n){let o=0;const r=await function t(n){return c.log.debug(`[Chapter]请求 ${n} Referer ${e} 重试次数 ${o}`),fetch(n,{headers:{accept:"image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8"},referrer:e,body:null,method:"GET",mode:"cors",credentials:"include"}).then((e=>e.blob())).then((r=>53658===r.size||42356===r.size?(c.log.error(`[Chapter]请求 ${n} 失败 Referer ${e}`),o<u.retryLimit?(o++,t(n)):null):r)).catch((e=>c.log.error(e)))}(t),a=new s.AttachmentClass(t,n,"naive");return r?(a.imageBlob=r,a.status=s.Status.finished):a.status=s.Status.failed,a}(t,r),i=[a],l=document.createElement("img");l.src=r,l.alt=t;const p=document.createElement("div");return p.appendChild(l),{chapterName:n,contentRaw:p,contentText:`VIP章节，请打开HTML文件查看。\n![${t}](${r})`,contentHTML:p,contentImages:i,additionalMetadate:null}}return p()}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}():p()}}t.Sfacg=p},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Hetushu=void 0;const o=n(6),r=n(14),a=n(8),i=n(13),c=n(9),s=n(7),l=n(15),u=n(34);class d extends l.BaseRuleClass{constructor(){super(),this.imageMode="TM"}async bookParse(){const e=document.location.href,t=document.querySelector(".book_info > h2").innerText.trim(),n=document.querySelector(".book_info > div:nth-child(3) > a:nth-child(1)").innerText.trim(),r=document.querySelector(".intro"),[a,i,l]=await(0,u.introDomHandle)(r),d={},p=document.querySelector(".book_info > img").src;p&&(0,o.getImageAttachment)(p,this.imageMode,"cover-").then((e=>{d.cover=e})).catch((e=>c.log.error(e)));const m=[],h=document.querySelector("#dir")?.childNodes;if(h&&0!==h.length){let n=0,o=0,r=null,a=0;for(const i of h)if("DT"===i.nodeName)o++,a=0,r=i.innerText.trim();else if("DD"===i.nodeName){n++,a++;const c=i.firstElementChild,l=c.innerText,u=c.href,d=!1,p=!1,h=new s.Chapter(e,t,u,n,l,d,p,r,o,a,this.chapterParse,"UTF-8",{});m.push(h)}}return new s.Book(e,t,n,a,i,d,m)}async chapterParse(e,t,n,o,s,l){const u=await(0,a.getHtmlDOM)(e,s);t=u.querySelector("#content .h2").innerText.trim(),await async function(){let t,n,o,r;if(!/\/(book[0-9]?)\/([0-9]+)\/([0-9]+)\.html(\?position=([0-9]+))?$/.test(e))return!1;t=RegExp.$1,n=RegExp.$2,o=RegExp.$3,r=RegExp.$5;const a=[document.location.origin,t,n,"r"+o+".json"].join("/");c.log.debug(`[Chapter]请求 ${a} Referer ${e}`);const i=await fetch(a,{headers:{accept:"*/*","cache-control":"no-cache","content-type":"application/x-www-form-urlencoded",pragma:"no-cache","x-requested-with":"XMLHttpRequest"},referrer:e,method:"GET",mode:"cors",credentials:"include"}).then((e=>e.headers.get("token"))).catch((e=>c.log.error(e)));if(i){const e=atob(i).split(/[A-Z]+%/).map((e=>Number(e))),t=u.querySelector("#content");let n=0,o=0;for(let e=0;e<t.childNodes.length&&("H2"===t.childNodes[e].nodeName&&(o=e+1),"DIV"!==t.childNodes[e].nodeName||"chapter"===t.childNodes[e].className);e++);const r=[];for(let a=0;a<e.length;a++)e[a]<5?(r[e[a]]=t.childNodes[a+o],n++):r[e[a]-n]=t.childNodes[a+o];for(const e of r)e&&t.appendChild(e)}}();const d=u.querySelector("#content");if(d){"h2, acronym, bdo, big, cite, code, dfn, kbd, q, s, samp, strike, tt, u, var".split(", ").forEach((e=>{(0,i.rm)(e,!0,d)})),Array.from(d.querySelectorAll("div")).map((e=>{const t=document.createElement("p");t.innerHTML=e.innerHTML,e.parentNode?.replaceChild(t,e)}));const{dom:e,text:n,images:o}=await(0,r.cleanDOM)(d,"TM");return{chapterName:t,contentRaw:d,contentText:n,contentHTML:e,contentImages:o,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}t.Hetushu=d},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Shouda8=void 0;const o=n(6),r=n(14),a=n(8),i=n(13),c=n(9),s=n(7),l=n(15),u=n(34);class d extends l.BaseRuleClass{constructor(){super(),this.imageMode="TM"}async bookParse(){const e=document.location.href,t=document.querySelector(".bread-crumbs > li:nth-child(4)").innerText.trim(),n=document.querySelector("div.bookname > h1 > em").innerText.replace("作者：","").trim(),r=document.querySelector(".intro"),[a,l,d]=await(0,u.introDomHandle)(r,(e=>((0,i.rm)(".book_keywords",!1,e),(0,i.rm)("script",!0,e),(0,i.rm)("#cambrian0",!1,e),e))),p={},m=document.querySelector(".pic > img:nth-child(1)").src;m&&(0,o.getImageAttachment)(m,this.imageMode,"cover-").then((e=>{p.cover=e})).catch((e=>c.log.error(e)));const h=[],g=document.querySelectorAll(".link_14 > dl dd a");for(let n=0;n<g.length;n++){const o=g[n],r=o.innerText,a=o.href,i=!1,c=!1,l=new s.Chapter(e,t,a,n+1,r,i,c,null,null,null,this.chapterParse,"UTF-8",{});h.push(l)}return new s.Book(e,t,n,a,l,p,h)}async chapterParse(e,t,n,o,c,s){const l=await(0,a.getHtmlDOM)(e,c);t=l.querySelector(".kfyd > h2:nth-child(1)").innerText.trim();const u=l.querySelector("#content");if(u){(0,i.rm)("p:last-child",!1,u);const{dom:e,text:n,images:o}=await(0,r.cleanDOM)(u,"TM");return{chapterName:t,contentRaw:u,contentText:n,contentHTML:e,contentImages:o,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}t.Shouda8=d},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xbiquge=t.c25zw=t.dijiubook=t.tycqxs=t.biquwx=t.lwxs9=t.luoqiuzw=t.gebiqu=t.c81book=t.common1=t.common=void 0;const o=n(13),r=n(38);t.common=()=>(0,r.mkBiqugeClass)((e=>e),(e=>e)),t.common1=()=>(0,r.mkBiqugeClass)((e=>e),(e=>e),void 0,!1),t.c81book=()=>(0,r.mkBiqugeClass)((e=>e),(e=>e)),t.gebiqu=()=>(0,r.mkBiqugeClass)((e=>(e.innerHTML=e.innerHTML.replace(/如果您喜欢.+，别忘记分享给朋友/g,""),(0,o.rm)('a[href^="http://down.gebiqu.com"]',!1,e),e)),(e=>(e.innerHTML=e.innerHTML.replace(/"www.gebiqu.com"/g,""),e))),t.luoqiuzw=()=>(0,r.mkBiqugeClass)((e=>e),(e=>{const t=e.firstElementChild;return t.innerText.includes("天才一秒记住本站地址：")&&t.remove(),["记住网址m.luoqｉｕｘｚｗ．ｃｏｍ"].forEach((t=>e.innerHTML=e.innerHTML.replace(t,""))),e})),t.lwxs9=()=>(0,r.mkBiqugeClass)((e=>e),(e=>((0,o.rm)("div[align]",!1,e),e))),t.biquwx=()=>(0,r.mkBiqugeClass)((e=>(e.innerHTML=e.innerHTML.replace(/本站提示：各位书友要是觉得《.+》还不错的话请不要忘记向您QQ群和微博里的朋友推荐哦！/,""),e)),(e=>e),1),t.tycqxs=()=>(0,r.mkBiqugeClass)((e=>e),(e=>(e.innerHTML=e.innerHTML.replace(/推荐都市大神老施新书:<a href="https:\/\/www\.tycqxs\.com\/[\d_]+\/" target="_blank">.+<\/a>/,""),e))),t.dijiubook=()=>{const e=(0,r.mkBiqugeClass)((e=>(e.innerHTML=e.innerHTML.replace("本书网址：",""),(0,o.rm)('a[href^="https://dijiubook.net/"]',!1,e),(0,o.rm)("dl > dt:nth-of-type(2)",!1,document.querySelector("#list")),document.querySelectorAll('#list a[href^="https://m.dijiubook.net"]').forEach((e=>e.parentElement?.remove())),document.querySelectorAll('#list a[href$=".apk"]').forEach((e=>e.parentElement?.remove())),e)),(e=>((0,o.rm)("a",!0,e),e)));return e.prototype.overrideConstructor=e=>{e.concurrencyLimit=1,e.maxRunLimit=1,e.postChapterParseHook=async e=>(await(0,o.sleep)(3e3*Math.random()),e)},e},t.c25zw=()=>(0,r.mkBiqugeClass)((e=>(e.querySelector("font")?.parentElement?.remove(),e.innerHTML=e.innerHTML.replace("简介:",""),e)),(e=>((0,o.rm)(".bottem",!1,e),e))),t.xbiquge=()=>(0,r.mkBiqugeClass)((e=>e),((e,t)=>(e.innerHTML=e.innerHTML.replace(`笔趣阁 www.xbiquge.so，最快更新${t.bookname} ！`,""),e)))},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Meegoq=void 0;const o=n(6),r=n(14),a=n(8),i=n(13),c=n(9),s=n(7),l=n(15),u=n(34);class d extends l.BaseRuleClass{constructor(){super(),this.imageMode="TM",this.concurrencyLimit=3,this.charset="GBK"}async bookParse(){const e=document.location.href.replace("/book","/info"),t=await(0,a.getHtmlDOM)(e,"GBK"),n=t.querySelector("article.info > p.detail.pt20 > i:nth-child(1) > a").innerText.trim(),r=t.querySelector("article.info > header > h1").innerText.trim(),l=t.querySelector("article.info > p.desc"),[d,p,m]=await(0,u.introDomHandle)(l,(e=>((0,i.rm)("b",!1,e),e))),h={},g=t.querySelector("article.info > div.cover > img").src;g&&(0,o.getImageAttachment)(g,this.imageMode,"cover-").then((e=>{h.cover=e})).catch((e=>c.log.error(e)));const f=[],w=document.querySelector("ul.mulu");if(w?.childElementCount){const t=Array.from(w.children);if(Array.from(t[0].classList).includes("volumn")&&t[0].innerText.match(/最新.章/))for(let e=0;e<w?.childElementCount;e++){if(0!==e&&Array.from(t[e].classList).includes("volumn")&&"全部章节"!==t[e].innerText.trim()){delete t[0];break}delete t[e]}const n=t.filter((e=>void 0!==e));let o=0,a=0,i=null,c=0;for(const t of n)if(Array.from(t.classList).includes("volumn"))a++,c=0,i=t.innerText.trim();else{o++,c++;const n=t.firstElementChild,l=n.innerText,u=n.href,d=!1,p=!1,m=new s.Chapter(e,r,u,o,l,d,p,i,a,c,this.chapterParse,this.charset,{});f.push(m)}}return new s.Book(e,r,n,d,p,h,f)}async chapterParse(e,t,n,o,i,c){const s=await(0,a.getHtmlDOM)(e,i);t=s.querySelector("article > header > h1").innerText.trim();const l=s.querySelector("#content");if(l){const{dom:e,text:n,images:o}=await(0,r.cleanDOM)(l,"TM");return{chapterName:t,contentRaw:l,contentText:n,contentHTML:e,contentImages:o,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}t.Meegoq=d},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Xiaoshuodaquan=void 0;const o=n(6),r=n(14),a=n(8),i=n(13),c=n(9),s=n(7),l=n(15),u=n(34);class d extends l.BaseRuleClass{constructor(){super(),this.imageMode="TM",this.charset="GBK",this.concurrencyLimit=5}async bookParse(){const e=document.querySelector(".crumbswrap")?.childElementCount;let t=document.location.href;e&&(t=document.querySelector(`.crumbswrap > a:nth-child(${e-2})`).href);const n=document.querySelector("div.dirwraps > h1").innerText.replace("《","").replace("》","").trim(),r=document.querySelector(".smallcons > span:nth-child(1) > a:nth-child(1)").innerText.trim(),i=document.querySelector(".bookintro"),[l,d,p]=await(0,u.introDomHandle)(i,(e=>(e.innerHTML=e.innerHTML.replace("内容简介:",""),e))),m={};let h;e&&(h=(await(0,a.getHtmlDOM)(t,"GBK")).querySelector(".con_limg > img").src),h&&(0,o.getImageAttachment)(h,this.imageMode,"cover-").then((e=>{m.cover=e})).catch((e=>c.log.error(e)));const g=[],f=document.querySelectorAll(".dirwraps > div.dirtitone"),w=document.querySelectorAll(".dirwraps > div.clearfix.dirconone");let y=0;for(let e=0;e<w.length;e++){const o=f[e],r=w[e],a=e+1,i=o.firstElementChild?.innerText.replace(n,"").trim();let c=0;const l=r.querySelectorAll("ul>li>a");for(const e of Array.from(l)){y++,c++;const o=e.innerText,r=e.href,l=!1,u=!1,d=new s.Chapter(t,n,r,y,o,l,u,i,a,c,this.chapterParse,this.charset,{});g.push(d)}}return new s.Book(t,n,r,l,d,m,g)}async chapterParse(e,t,n,o,c,s){const l=await(0,a.getHtmlDOM)(e,c);t=l.querySelector(".page-body > h1:nth-child(4)").innerText.trim();const u=l.querySelector("#content");if(u){(0,i.rm)("div",!0,u),(0,i.rm)("script",!0,u);const e=document.createElement("div");e.innerHTML=u.innerHTML.replace(/\n/g,"<br/>");const{dom:n,text:o,images:a}=await(0,r.cleanDOM)(e,"TM");return{chapterName:t,contentRaw:e,contentText:o,contentHTML:n,contentImages:a,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}t.Xiaoshuodaquan=d},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Qidian=void 0;const o=n(6),r=n(14),a=n(8),i=n(8),c=n(13),s=n(9),l=n(7),u=n(15),d=n(34);class p extends u.BaseRuleClass{constructor(){super(),this.imageMode="TM",this.concurrencyLimit=5}async bookParse(){let e=document.getElementById("bookImg");if(!e)throw new Error("未发现 bookId");e=e.getAttribute("data-bid");const t=document.getElementById("authorId")?.getAttribute("data-authorid"),n=unsafeWindow.jQuery.ajaxSettings.data._csrfToken,r=document.location.href,a=document.querySelector(".book-info > h1 > em").innerText.trim(),i=document.querySelector(".book-info .writer").innerText.replace(/作\s+者:/,"").trim(),u=document.querySelector(".book-info-detail .book-intro"),[p,m,h]=await(0,d.introDomHandle)(u),g={},f=document.querySelector("#bookImg > img").src;f&&(0,o.getImageAttachment)(f,this.imageMode,"cover-").then((e=>{g.cover=e})).catch((e=>s.log.error(e))),g.tags=Array.from(document.querySelectorAll(".book-info > .tag > a, .tag-wrap > .tags")).map((e=>e.innerText.trim()));const w=Boolean(document.querySelector(".book-information .flag"));s.log.info(`[Book]限免书籍 ${w}`);const y=[],b=document.querySelectorAll("#j-catalogWrap li").length;b&&(()=>{const e=document.querySelector("#J-catalogCount").innerText.match(/\d+/);if(e)return Number(e[0])})()===b||await(0,c.sleep)(3e3);const v=document.querySelectorAll("#j-catalogWrap > .volume-wrap > .volume");let x=0;for(let o=0;o<v.length;o++){const i=v[o],c=o+1,s=i.querySelector("h3").innerText.trim().split("\n").slice(-1)[0].split("·")[0];let u=0;const d=i.querySelectorAll("ul.cf > li");for(const o of Array.from(d)){const i=o.querySelector("a");x++,u++;const d=i.innerText.trim(),p=i.href,m=()=>"vipreader.qidian.com"===new URL(p).host,h=()=>!!m()&&2!==o.childElementCount;let g;g=m()?p.split("/").slice(-1)[0]:null;const f=new l.Chapter(r,a,p,x,d,m(),h(),s,c,u,this.chapterParse,"UTF-8",{_csrfToken:n,bookId:e,authorId:t,chapterId:g,limitFree:w}),b=()=>{const e=document.querySelector(".sign-in"),t=document.querySelector(".sign-out");return!!(e&&t&&Array.from(t.classList).includes("hidden"))};m()&&(f.status=l.Status.aborted,w&&(f.status=l.Status.pending),b()&&f.isPaid&&(f.status=l.Status.pending)),y.push(f)}}return new l.Book(r,a,i,p,m,g,y)}async chapterParse(e,t,n,o,c,l){const u=l.bookId,d=l.authorId,p=l.chapterId,m=l.limitFree,h=l._csrfToken;async function g(){const n=await(0,i.ggetHtmlDOM)(e,c),o={chapterName:t=n.querySelector(".j_chapterName > .content-wrap").innerText.trim(),contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null};if(n.querySelector(".vip-limit-wrap"))return o;const a=n.querySelector(".read-content"),s=n.querySelector(".author-say-wrap");if(a){if(s){const e=s.querySelector("div.author-say > p:nth-child(3)"),t=document.createElement("hr");a.appendChild(t),a.appendChild(e)}const{dom:e,text:n,images:o}=await(0,r.cleanDOM)(a,"TM");return{chapterName:t,contentRaw:a,contentText:n,contentHTML:e,contentImages:o,additionalMetadate:null}}return o}return n?async function(){if(m||o){const n=await g();return n.contentHTML?n:async function(){const n=await async function(){const t="https://vipreader.qidian.com/ajax/chapter/chapterInfo?"+new URLSearchParams({_csrfToken:h,bookId:u,chapterId:p,authorId:d}).toString();return s.log.debug(`[Chapter]请求 ${t} Referer ${e}`),(0,a.gfetch)(t,{headers:{accept:"application/json, text/javascript, */*; q=0.01","x-requested-with":"XMLHttpRequest",Referer:e},responseType:"json"}).then((e=>e.response)).catch((e=>s.log.error(e)))}();if(!n)throw new Error("Request Api failed!");if(0===n.code){const e=n.data.chapterInfo.authorSay,o=n.data.chapterInfo.content,a=document.createElement("div");if(a.innerHTML=o,e){const t=document.createElement("hr");a.appendChild(t);const n=document.createElement("p");n.innerHTML=e,a.appendChild(n)}const{dom:i,text:c,images:s}=await(0,r.cleanDOM)(a,"TM");return{chapterName:t,contentRaw:a,contentText:c,contentHTML:i,contentImages:s,additionalMetadate:null}}return s.log.error(`[chapter]VIP章节API请求失败！\n${JSON.stringify(n)}`),{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}()}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}():g()}}t.Qidian=p},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Jjwxc=void 0;const o=n(6),r=n(14),a=n(8),i=n(8),c=n(13),s=n(9),l=n(7),u=n(15),d=n(11),p=n(34),m=n(51);class h extends u.BaseRuleClass{constructor(){super(),this.imageMode="TM",this.concurrencyLimit=5,this.charset="GB18030"}async bookParse(){const e=document.location.href;let t="";const n={};let r="佚名",a=null,u=null,d=null;if(0===Array.from(document.querySelectorAll(".smallreadbody")).filter((e=>e.innerText.includes("文案信息审核未通过，等待作者修改后重新审核"))).length){t=document.querySelector('h1[itemprop="name"] > span').innerText.trim(),r=document.querySelector("td.sptd h2 a span").innerText.replace(/作\s+者:/,"").trim();const e=document.querySelector("#novelintro");[a,u,d]=await(0,p.introDomHandle)(e),d&&(n.attachments=[...d]);const i=document.querySelector(".noveldefaultimage").src;i&&(0,o.getImageAttachment)(i,this.imageMode,"cover-").then((e=>{n.cover=e})).catch((e=>s.log.error(e)));let c=document.querySelector("table > tbody > tr > td.readtd > div.righttd > ul.rightul > li:nth-child(1) > span:nth-child(2)").innerText.split("-");c=c.concat(Array.from(document.querySelectorAll("div.smallreadbody:nth-child(3) > span > a")).map((e=>e.innerText)));const l=document.querySelector("table > tbody > tr > td.readtd > div.righttd > ul.rightul > li:nth-child(2)").innerText.replace("\n",""),m=document.querySelector("table > tbody > tr > td.readtd > div.righttd > ul.rightul > li:nth-child(3)").innerText.replace("\n","");c.push(l),c.push(m),n.tags=c}else{if(window.scrollTo(0,document.body.scrollHeight),await(0,c.sleep)(3e3),t=document.querySelector("td[id^=comment_] span.coltext > a")?.innerText.trim().replace(/《|》/g,""),window.scrollTo(0,0),!t)throw new Error("抓取书名出错");const e=document.querySelector("#oneboolt > tbody > tr:nth-child(1) > td > div > h2 > a")?.href;e&&(r=(await(0,i.getHtmlDOM)(e,this.charset)).querySelector('span[itemprop="name"]')?.innerText??r)}const m=[],h=document.querySelectorAll("#oneboolt > tbody > tr");let g=0,f=0,w=null,y=0;for(const n of Array.from(h))if(n.getAttribute("bgcolor"))f++,y=0,w=n.querySelector("b.volumnfont")?.innerText.trim();else if(n.getAttribute("itemprop")){g++,y++;const o=n.querySelector("td:nth-child(2)"),r=o?.querySelector("a:nth-child(1)"),a=()=>!!r?.getAttribute("onclick");if("[锁]"===o?.innerText.trim()){const n="[锁]",o="",r=new l.Chapter(e,t,o,g,n,!1,null,w,f,y,this.chapterParse,this.charset,{});r.status=l.Status.aborted,m.push(r)}else if(a()){const n=r.innerText.trim(),o=r.getAttribute("rel");if(o){const r=new l.Chapter(e,t,o,g,n,a(),null,w,f,y,this.chapterParse,this.charset,{}),i=()=>!document.getElementById("jj_login");a()&&!i()&&(r.status=l.Status.aborted),m.push(r)}}else{const n=r.innerText.trim(),o=r.href,i=new l.Chapter(e,t,o,g,n,a(),null,w,f,y,this.chapterParse,this.charset,{}),c=()=>!document.getElementById("jj_login");a()&&!c()&&(i.status=l.Status.aborted),m.push(i)}}return new l.Book(e,t,r,a,u,n,m)}async chapterParse(e,t,n,u,p,h){return n?async function(){const n=await(0,i.ggetHtmlDOM)(e,p);if(!n.querySelector("#buy_content")&&n.querySelector("div.noveltext")){const t=n.querySelector("div.noveltext h2").innerText.trim(),i=n.querySelector("div.noveltext");if(i){(0,c.rm)("hr",!0,i);const u=i.querySelector(".readsmall");let p,h;if(u){const{dom:e,text:t,images:n}=await(0,r.cleanDOM)(u,"TM");[p,h]=[e,t]}(0,c.rm)("div",!0,i),i.innerHTML=i.innerHTML.replaceAll("@无限好文，尽在晋江文学城","");let{dom:g,text:f,images:w}=await(0,r.cleanDOM)(i,"TM");if(u&&p&&h){const e=document.createElement("hr");p.className="authorSay",g.appendChild(e),g.appendChild(p),f=f+"\n\n"+"-".repeat(20)+"\n\n"+h}let y=g,b=f;const[v,x,T]=await async function(){let t=0;const[r,i]=function(){const e=n.querySelectorAll("body > style")[1];let t,o;if(e.sheet){const n=e.sheet.cssRules[e.sheet.cssRules.length-2],r=n.cssText.match(/jjwxcfont_[\d\w]+/),a=n.cssText.match(/{(.*)}/);if(r&&a){t=r[0];const e=a[1];for(const n of e.split(","))if(n.includes('format("woff2")')){const e=n.match(/url\("(.*)"\)\s/);if(e)return o=document.location.protocol+e[1],[t,o]}}}const r=document.querySelector("div.noveltext")?.classList[1];return r?(t=r,o=document.location.protocol+`//static.jjwxc.net/tmp/fonts/${t}.woff2?h=my.jjwxc.net`,[t,o]):[null,null]}();if(r&&i){const n=`${r}.woff2`;let c;const u=(0,o.getAttachmentClassCache)(i);if(u)c=u;else{const r=await function n(o){return s.log.debug(`[Chapter]请求 ${o} Referer ${e} 重试次数 ${t}`),(0,a.gfetch)(o,{headers:{accept:"*/*",Referer:e},responseType:"blob"}).then((r=>r.status>=200&&r.status<=299?r.response:(s.log.error(`[Chapter]请求 ${o} 失败 Referer ${e}`),t<d.retryLimit?(t++,n(o)):null))).catch((e=>s.log.error(e)))}(i);c=new l.AttachmentClass(i,n,"TM"),c.imageBlob=r,c.status=l.Status.finished,(0,o.putAttachmentClassCache)(c)}const p=document.createElement("style");return p.innerHTML=`.${r} {\n  font-family: ${r}, 'Microsoft YaHei', PingFangSC-Regular, HelveticaNeue-Light, 'Helvetica Neue Light', sans-serif !important;\n}\n@font-face {\n  font-family: ${r};\n  src: url('${n}') format('woff2');\n}\n.hide {\n  display: none;\n}`,[r,c,p]}return[null,null,null]}();if(v&&x&&T){b=await(0,m.replaceJjwxcCharacter)(v,f),w.push(x),y=document.createElement("div");const e=document.createElement("div");e.innerHTML=await(0,m.replaceJjwxcCharacter)(v,g.innerHTML),y.appendChild(T),g.className=`${v} hide`,y.appendChild(g),y.appendChild(e)}return{chapterName:t,contentRaw:i,contentText:b,contentHTML:y,contentImages:w,additionalMetadate:null}}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}():async function(){const n=await(0,i.getHtmlDOM)(e,p);t=n.querySelector("div.noveltext h2").innerText.trim();const o=n.querySelector("div.noveltext");if(o){(0,c.rm)("hr",!0,o);const e=o.querySelector(".readsmall");let n,a;if(e){const{dom:t,text:o,images:i}=await(0,r.cleanDOM)(e,"TM");[n,a]=[t,o]}(0,c.rm)("div",!0,o),o.innerHTML=o.innerHTML.replaceAll("@无限好文，尽在晋江文学城","");let{dom:i,text:s,images:l}=await(0,r.cleanDOM)(o,"TM");if(e&&n&&a){const e=document.createElement("hr");n.className="authorSay",i.appendChild(e),i.appendChild(n),s=s+"\n\n"+"-".repeat(20)+"\n\n"+a}return{chapterName:t,contentRaw:o,contentText:s,contentHTML:i,contentImages:l,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}()}}t.Jjwxc=h},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.replaceJjwxcCharacter=void 0;const o=n(52),r=n(9),a=n(11);t.replaceJjwxcCharacter=async function(e,t){let n=t;const i=await async function(e){return(await async function(){const e="novel-downloader-jjwxcFontTables",t="novel-downloader-jjwxcFontTables__expires__";let n=await(0,o.get)(e);return n&&await(0,o.get)(t)&&await(0,o.get)(t)>Date.now()?n:await async function(){try{r.log.info("[jjwxc-font]开始下载字体对照表打包文件。");const a=await fetch("https://cdn.jsdelivr.net/gh/yingziwu/jjwxcFontTables@gh-pages/bundle.json");return n=await a.json(),n?(await(0,o.get)(e)?await(0,o.update)(e,(e=>n)):await(0,o.set)(e,n),await(0,o.get)(t)?await(0,o.update)(t,(e=>Date.now()+864e5)):await(0,o.set)(t,Date.now()+864e5),n):{}}catch(e){return{}}}()}())[e]||(a.enableJjwxcRemoteFont?await async function(e){const t=`https://jjwxc.bgme.bid/${e}.json`;try{r.log.info(`[jjwxc-font]开始请求远程字体对照表 ${e}`);const n=await fetch(t);return 200===n.status?(r.log.info(`[jjwxc-font]远程字体对照表 ${e} 下载成功`),await n.json()):void r.log.info(`[jjwxc-font]远程字体对照表 ${e} 下载失败`)}catch(t){return r.log.error(t),void r.log.info(`[jjwxc-font]远程字体对照表 ${e} 下载失败`)}}(e):void 0)}(e);if(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e)){const t=i[e];n=n.replaceAll(e,t)}n=n.replace(/\u200c/g,"")}return n}},e=>{"use strict";e.exports=idbKeyval},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Zongheng=void 0;const o=n(6),r=n(14),a=n(8),i=n(9),c=n(7),s=n(15),l=n(34);class u extends s.BaseRuleClass{constructor(){super(),this.imageMode="TM",this.concurrencyLimit=5}async bookParse(){const e=document.location.href.replace("/showchapter/","/book/"),t=document.querySelector("div.book-meta > h1").innerText.trim(),n=document.querySelector("div.book-meta > p > span:nth-child(1) > a").innerText.trim(),r=await(0,a.getHtmlDOM)(e,void 0),s=r.querySelector("div.book-info > div.book-dec"),[u,d,p]=await(0,l.introDomHandle)(s),m={},h=r.querySelector("div.book-img > img").src;h&&(0,o.getImageAttachment)(h,this.imageMode,"cover-").then((e=>{m.cover=e})).catch((e=>i.log.error(e))),m.tags=Array.from(r.querySelectorAll(".book-info>.book-label a")).map((e=>e.innerText.trim()));const g=[],f=document.querySelectorAll(".volume-list");let w=0;for(let n=0;n<f.length;n++){const o=f[n],r=n+1,a=o.querySelector("div.volume");Array.from(a.children).forEach((e=>e.remove()));const i=a.innerText.trim();let s=0;const l=o.querySelectorAll("ul.chapter-list > li");for(const n of Array.from(l)){const o=n.querySelector("a");w++,s++;const a=o.innerText.trim(),l=o.href,u=()=>!!n.className.includes("vip"),d=()=>!1,p=new c.Chapter(e,t,l,w,a,u(),d(),i,r,s,this.chapterParse,"UTF-8",{}),m=()=>!1;!u()||m()&&p.isPaid||(p.status=c.Status.aborted),g.push(p)}}return new c.Book(e,t,n,u,d,m,g)}async chapterParse(e,t,n,o,i,c){return n?async function(){return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}():async function(){const t=await(0,a.ggetHtmlDOM)(e,i),n=t.querySelector("div.title_txtbox").innerText.trim(),o=t.querySelector("div.content");if(o){const{dom:e,text:t,images:a}=await(0,r.cleanDOM)(o,"TM");return{chapterName:n,contentRaw:o,contentText:t,contentHTML:e,contentImages:a,additionalMetadate:null}}return{chapterName:n,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}()}}t.Zongheng=u},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.C17k=void 0;const o=n(6),r=n(14),a=n(8),i=n(13),c=n(9),s=n(7),l=n(15),u=n(34);class d extends l.BaseRuleClass{constructor(){super(),this.imageMode="TM",this.charset="UTF-8",this.concurrencyLimit=5}async bookParse(){const e=document.location.href.replace("/list/","/book/"),t=document.querySelector("h1.Title").innerText.trim(),n=document.querySelector("div.Author > a").innerText.trim(),r=await(0,a.getHtmlDOM)(e,void 0),i=r.querySelector("#bookInfo p.intro > a"),[l,d,p]=await(0,u.introDomHandle)(i),m={},h=r.querySelector("#bookCover img.book").src;h&&(0,o.getImageAttachment)(h,this.imageMode,"cover-").then((e=>{m.cover=e})).catch((e=>c.log.error(e)));const g=[],f=document.querySelectorAll("dl.Volume");let w=0;for(let n=0;n<f.length;n++){const o=f[n],r=n+1,a=o.querySelector("dt > span.tit").innerText.trim();let i=0;const c=o.querySelectorAll("dd > a");for(const n of Array.from(c)){const o=n.firstElementChild;w++,i++;const c=o.innerText.trim(),l=n.href,u=()=>!!o?.className.includes("vip"),d=()=>!1,p=new s.Chapter(e,t,l,w,c,u(),d(),a,r,i,this.chapterParse,this.charset,{}),m=()=>!1;!u()||m()&&p.isPaid||(p.status=s.Status.aborted),g.push(p)}}return new s.Book(e,t,n,l,d,m,g)}async chapterParse(e,t,n,o,c,s){return n?async function(){return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}():async function(){const n=await(0,a.getHtmlDOM)(e,c);t=n.querySelector("#readArea > div.readAreaBox.content > h1").innerText.trim();const o=n.querySelector("#readArea > div.readAreaBox.content > div.p");if(o){(0,i.rm)("p.copy",!1,o),(0,i.rm)("#banner_content",!1,o),(0,i.rm)("div.qrcode",!1,o),(0,i.rm)("div.chapter_text_ad",!1,o);const{dom:e,text:n,images:a}=await(0,r.cleanDOM)(o,"TM");return{chapterName:t,contentRaw:o,contentText:n,contentHTML:e,contentImages:a,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}()}}t.C17k=d},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Shuhai=void 0;const o=n(6),r=n(14),a=n(8),i=n(13),c=n(9),s=n(7),l=n(15),u=n(34);class d extends l.BaseRuleClass{constructor(){super(),this.imageMode="TM",this.concurrencyLimit=5,this.charset="GBK"}async bookParse(){const e=document.location.href,t=document.querySelector("div.book-info-bookname > span:nth-child(1)").innerText.trim(),n=document.querySelector("div.book-info-bookname > span:nth-child(2)").innerText.replace("作者: ","").trim(),r=document.querySelector("div.book-info-bookintro")||document.querySelector("div.book-info-bookintro-all"),[a,l,d]=await(0,u.introDomHandle)(r),p={},m=document.querySelector(".book-cover-wrapper > img").getAttribute("data-original");m&&(0,o.getImageAttachment)(m,this.imageMode,"cover-").then((e=>{p.cover=e})).catch((e=>c.log.error(e))),p.tags=Array.from(document.querySelectorAll(".book-info-bookstate > .tag")).map((e=>e.innerText.trim()));const h=[];0===document.querySelectorAll("#catalog > .chapter-item").length&&await(0,i.sleep)(3e3);const g=document.querySelectorAll("#catalog > .chapter-item");let f=0,w=0,y=null,b=0;for(const n of Array.from(g))if("SPAN"===n.nodeName)w++,b=0,y=n?.innerText.trim();else if("DIV"===n.nodeName){f++,b++;const o=n.querySelector("a"),r=()=>2===n.childElementCount,a=()=>!1,i=o.innerText.trim(),c=o.href,l=new s.Chapter(e,t,c,f,i,r(),a(),y,w,b,this.chapterParse,this.charset,{}),u=()=>!1;!r()||u()&&l.isPaid||(l.status=s.Status.aborted),h.push(l)}return new s.Book(e,t,n,a,l,p,h)}async chapterParse(e,t,n,o,c,s){return n?async function(){return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}():async function(){const n=await(0,a.ggetHtmlDOM)(e,c);t=n.querySelector("div.chapter-name").innerText.replace("正文 ","").trim();const o=n.querySelector("#reader-content > div:nth-child(1)");if(o){(0,i.rm)("div.chaper-info",!1,o);const{dom:e,text:n,images:a}=await(0,r.cleanDOM)(o,"TM");return{chapterName:t,contentRaw:o,contentText:n,contentHTML:e,contentImages:a,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}()}}t.Shuhai=d},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Gongzicp=void 0;const o=n(5),r=n(6),a=n(13),i=n(9),c=n(7),s=n(15),l=n(11),u=n(34);class d extends s.BaseRuleClass{constructor(){super(),this.imageMode="TM",this.concurrencyLimit=1}async bookParse(){const e=document.location.href,t=document.querySelector("span.id").innerText.replace("CP","");if(!t)throw new Error("获取bookID出错");const n=new URL("https://webapi.gongzicp.com/novel/novelGetInfo");n.searchParams.set("id",t),i.log.debug(`请求地址: ${n.toString()}`);const o=await fetch(n.toString(),{credentials:"include",headers:{Accept:"application/json, text/plain, */*",Client:"pc",Lang:"cn","Content-Type":"application/json;charset=utf-8"},referrer:e,method:"GET",mode:"cors"}).then((e=>e.json())).catch((e=>i.log.error(e)));if(200!==o.code)throw new Error(`数据接口请求失败，URL:${n.toString()}`);const a=o.data,s=a.novelInfo.novel_name,l=a.novelInfo.author_nickname,d=document.createElement("div");d.innerHTML=a.novelInfo.novel_info;const[p,m,h]=await(0,u.introDomHandle)(d),g={},f=a.novelInfo.novel_cover;f&&(0,r.getImageAttachment)(f,this.imageMode,"cover-").then((e=>{g.cover=e})).catch((e=>i.log.error(e))),g.tags=a.novelInfo.tag_list;const w=await async function(){const e="https://webapi.gongzicp.com/user/getUserInfo";return i.log.debug(`正在请求: ${e}`),200===(await fetch(e,{headers:{accept:"application/json, text/javascript, */*; q=0.01","x-requested-with":"XMLHttpRequest"},method:"GET",mode:"cors",credentials:"include"}).then((e=>e.json())).catch((e=>i.log.error(e)))).code}(),y=[],b=a.chapterList;let v=0,x=null,T=0;for(const t of b)if("volume"===t.type)v=t.vid,x=t.name,T=0;else if("item"===t.type){const n=[document.location.origin,"v4",`read-${t.id}.html`].join("/"),o=Number(t.order),r=t.name,i=t.pay,l=t.is_sub,u=t.lock;T++;const d={novel_id:a.novelInfo.novel_id,chapter_id:t.id},p=new c.Chapter(e,s,n,o,r,i,l,x,v,T,this.chapterParse,"UTF-8",d);(!i||w&&p.isPaid)&&!u||(p.status=c.Status.aborted),y.push(p)}return new c.Book(e,s,l,p,m,g,y)}async chapterParse(e,t,n,r,c,s){function u(){if(i.log.info("[chapter]随机翻页中……"),document.location.pathname.includes("novel")&&document.querySelector(".chapter-list > .chapter > a").click(),document.location.pathname.includes("read")){const e=document.querySelector(".right-menu");6===e?.childElementCount?document.querySelector(".right-menu > div:nth-child(3) > a:nth-child(1)").click():7===e?.childElementCount&&(document.querySelector("div.content.unpaid")||Math.random()<.3?document.querySelector(".right-menu > div:nth-child(3) > a:nth-child(1)").click():document.querySelector(".right-menu > div:nth-child(4) > a:nth-child(1)").click())}}return async function(){return await async function(){Math.random()<.2&&u(),await(0,a.sleep)(3e3+Math.round(4e3*Math.random()))}(),async function(){const n=s.novel_id,r=s.chapter_id,c=new URL("https://webapi.gongzicp.com/novel/chapterGetInfo");c.searchParams.set("cid",r.toString()),c.searchParams.set("nid",n.toString());let d=0;const p=await async function t(n){i.log.debug(`请求地址: ${n}, Referrer: ${e}，retryTime：${d}`);const o=await fetch(n,{credentials:"include",headers:{Accept:"application/json, text/plain, */*",Client:"pc",Lang:"cn","Content-Type":"application/json;charset=utf-8"},referrer:e,method:"GET",mode:"cors"}).then((e=>e.json())).catch((e=>i.log.error(e)));if(0!==o.data.chapterInfo.content.length&&o.data.chapterInfo.content.length<30){if(d++,l.retryLimit>l.retryLimit)throw i.log.error(`请求 ${n} 失败`),new Error(`请求 ${n} 失败`);return i.log.warn("[chapter]疑似被阻断，进行随机翻页……"),u(),await(0,a.sleep)(3e3),u(),await(0,a.sleep)(7e3),u(),await(0,a.sleep)(3e3),t(n)}return d=0,o}(c.toString());if(200===p.code){const e=p.data.chapterInfo;if(0!==e.chapterPrice&&0===e.content.length)return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null};if(0===e.chapterPrice||0!==e.chapterPrice&&0!==e.content.length){const n=function(e){let t;t=unsafeWindow.__NUXT__.state.CpST.LCngpxaF.substr(1,10);const n=(r="iGzsYn",r+=parseInt("165455",14).toString(32),o.enc.Utf8.parse("$h$b3!"+r));var r,a,i;return((e,t,n)=>{const r=o.AES.decrypt(e,t,n);return o.enc.Utf8.stringify(r).toString()})(e,(i=t,i+=parseInt("4d5a6c8",14).toString(36),o.enc.Utf8.parse(i+"A")),(a=n,{mode:o.mode.CBC,padding:o.pad.Pkcs7,iv:a}))}(e.content),r=document.createElement("pre");r.innerHTML=n;let a,i=n.split("\n").map((e=>e.trim())).join("\n\n");const c=document.createElement("div");if(c.innerHTML=n.split("\n").map((e=>e.trim())).map((e=>0===e.length?"<p><br/></p>":`<p>${e}</p>`)).join("\n"),0===e.postscript.length)a=c;else{a=document.createElement("div"),a.className="main";const t=document.createElement("hr"),n=document.createElement("div");n.innerHTML=e.postscript.split("\n").map((e=>0===e.length?"<p><br/></p>":`<p>${e}</p>`)).join("\n"),a.appendChild(c),a.appendChild(t),a.appendChild(n),r.innerHTML=[r.innerHTML,"-".repeat(20),e.postscript].join("\n\n"),i=[i,"-".repeat(20),e.postscript].join("\n\n")}return{chapterName:t,contentRaw:r,contentText:i,contentHTML:a,contentImages:null,additionalMetadate:null}}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}()}()}}t.Gongzicp=d},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Yuzhaige=void 0;const o=n(14),r=n(8),a=n(13),i=n(9),c=n(7),s=n(15),l=n(34),u=n(58);class d extends s.BaseRuleClass{constructor(){super(),this.imageMode="TM"}async bookParse(){const e=document.querySelector("div.currency_head > h1 > a").href,t=e.split("/").slice(-2,-1)[0];i.log.debug(`[chapter]请求 ${e}`);const n=await(0,r.getHtmlDOM)(e,"UTF-8"),o=n.querySelector("div.cataloginfo > h3").innerText.trim(),s=n.querySelector(".infotype > p:nth-child(1) > a:nth-child(1)").innerText.trim(),u=n.querySelector(".intro"),[d,p,m]=await(0,l.introDomHandle)(u,(e=>((0,a.rm)("span:nth-child(1)",!1,e),e))),h=[],g=(()=>{const e=[],n=Number((()=>{const e=document.querySelector("div.page:nth-child(6)");if(e){const t=Array.from(e.childNodes).slice(-1)[0].textContent?.match(/第\d+\/(\d+)页/);if(t)return t[1]}})());for(let o=1;o<=n;o++){const n=[document.location.origin,document.location.pathname.split("/")[1],`${t}_${o}`].join("/")+"/";e.push(n)}return e})();let f=[];for(const e of g){i.log.debug(`[chapter]请求 ${e}`);const t=(await(0,r.getHtmlDOM)(e,"UTF-8")).querySelector("ul.chapters");t?.childElementCount&&(f=f.concat(Array.from(t.children)))}const w=f.filter((e=>void 0!==e));let y=0;for(const t of w){y++;const n=t.firstElementChild,r=n.innerText,a=n.href,i=!1,s=!1,l=new c.Chapter(e,o,a,y,r,i,s,null,null,null,this.chapterParse,"UTF-8",{});h.push(l)}return new c.Book(e,o,s,d,p,{},h)}async chapterParse(e,t,n,a,c,s){function l(){function e(e,t){let n=Math.ceil((t+1)%r);return n=Math.ceil(e-n),n}const t=p.getElementsByTagName("meta")[7].getAttribute("content"),n=p.querySelector("#articlecontent");let o,r;const a=p.getElementsByTagName("script")[1].innerText.trim().match(/"(http.+)"/);if(a&&(o=a[1],r=Number(new URL(o).searchParams.get("code"))),t){const o=atob(t).split(/[A-Z]+%/).map((e=>Number(e))),r=[];if(Array.from(p.querySelectorAll("script")).filter((e=>e.src.includes("/17mb/js/article.js"))).length){for(let t=0;t<o.length;t++)r[e(o[t],t)]=n.childNodes[t];for(const e of r)1===e.nodeType&&(e.innerText.includes("本章尚未完结,请")||e.innerText.includes("本章已阅读完毕")||m.appendChild(e));return}}for(const e of Array.from(n.childNodes))e.innerText.includes("本章尚未完结,请")||e.innerText.includes("本章已阅读完毕")||m.appendChild(e)}let d=e,p=await(0,r.getHtmlDOM)(e,c);const m=document.createElement("div");let h=!1;do{l();const e=p.querySelector(".novelbutton .p1.p3 > a:nth-child(1)").href;new URL(e).pathname.includes("_")?e!==d?h=!0:(i.log.error("网站页面出错，URL： "+d),h=!1):h=!1,h&&(d=e,p=await(0,r.getHtmlDOM)(e,c))}while(h);if(m){const{dom:e,text:n,images:r}=await(0,o.cleanDOM)(m,"TM",{keepImageName:!0}),a=document.createElement("div");a.innerHTML=(0,u.replaceYuzhaigeImage)(m.innerHTML);const{dom:i,text:c,images:s}=await(0,o.cleanDOM)(a,"TM",{keepImageName:!0}),l=document.createElement("style");l.innerHTML=".hide { display: none; }",e.className="hide";const d=document.createElement("div");return d.appendChild(l),d.appendChild(e),d.appendChild(i),{chapterName:t,contentRaw:m,contentText:c,contentHTML:d,contentImages:r,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}t.Yuzhaige=d},(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.replaceYuzhaigeImage=void 0,t.replaceYuzhaigeImage=function(e){let t=e;for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e)){const o=n[e],r=`<img src="${document.location.origin}/wzbodyimg/${e}">`;t=t.replaceAll(r,o)}return t};const n={"wc5pDq.png":"勃","wEwIpN.png":"萄","WFOBXF.png":"伦","WFuqEG.png":"滚","WNTyYB.png":"菊","WrI5St.png":"戴","WSYLdq.png":"宠","wvHBh4.png":"奶","wWVoto.png":"巴","wz2cGb.png":"乳","wZicAt.png":"道","WzS8He.png":"戴","X6QTS9.png":"胯","XBTII5.png":"腿","XBv6rP.png":"跳","xFVZW9.png":"殖","XhuslD.png":"鸡","xIFlai.png":"食","XK7taQ.png":"爽","xljRqd.png":"顶","xo18Yq.png":"尿","xOIyuf.png":"塞","xQ2ZWb.png":"股","XqsaJY.png":"软","xrbxqL.png":"裸","xw7cLW.png":"蚌","xwkwQW.png":"精","XXlZMA.png":"殖","y3FgRm.png":"柱","y4Afmt.png":"腿","Y4aXzR.png":"粗","Y7G6Lu.png":"呻","YGnnuo.png":"蜜","ygqjgt.png":"捏","yGwSy7.png":"骚","yjX9oi.png":"揉","YNmgYJ.png":"肛","yuo7sA.png":"摩","yWAu0U.png":"催","yWhRNI.png":"娇","YZ4EAh.png":"喉","yzS8NJ.png":"胯","z0DZro.png":"吮","Z7byDx.png":"润","ZatUU6.png":"奴","zCtJCx.png":"润","ZDJHkT.png":"泌","ZKDja5.png":"龟","ZqyamF.png":"屄","ZzsV7x.png":"睾","0bErVo.png":"深","0ShNwM.png":"吹","0uCAgc.png":"强","1AMfxw.png":"干","1EmzV7.png":"性","1RbeKi.png":"头","1RIz6c.png":"感","1ZkZsI.png":"欲","2AXYPX.png":"泄","2gwsiE.png":"湿","2LQHtR.png":"根","2wePG6.png":"体","2Xijao.png":"捏","3ha4Fq.png":"欢","3RfcEA.png":"高","3uNZxG.png":"胸","4bu7Gr.png":"蒂","4T4DPM.png":"擦","4XjmUQ.png":"进","5hjo9r.png":"下","5ueElb.png":"宫","5yFlDm.png":"宫","6UsGer.png":"瓣","6w928M.png":"挺","6YavUk.png":"暖","7dKm1T.png":"进","7tzEqy.png":"点","8Q4cTQ.png":"部","9Ns27O.png":"阳","9pAfcz.png":"头","9Xkn86.png":"唇","62TB7X.png":"紧","668QKT.png":"下","aedVOS.png":"露","AI15xh.png":"娇","AikKsW.png":"肠","AJcH1b.png":"出","ALnkng.png":"喘","anzcle.png":"道","apsw0Z.png":"子","azRZNn.png":"水","B38zEI.png":"水","BAVYZd.png":"阴","BBioQd.png":"暖","BBZnCY.png":"唇","bE6LV6.png":"美","bF30CY.png":"吸","bihdjA.png":"唇","BPQcCZ.png":"具","BpYip0.png":"管","BrY1ZI.png":"腿","BvbcsW.png":"紧","bXRYQt.png":"处","Caqk3D.png":"眼","CBylOX.png":"道","ClFBCD.png":"处","CLS5cG.png":"坚","cPjFxZ.png":"种","CUJkGk.png":"情","CZL2OC.png":"皮","D3I7u1.png":"蒂","d5KjC5.png":"体","d7fjCZ.png":"露","df6AnM.png":"出","dhAaVT.png":"坚","dkuDIk.png":"舌","DSiSlL.png":"爱","dTnQ9K.png":"魔","dXMpnD.png":"晕","DXtzqf.png":"身","DXXixh.png":"套","DZYaDR.png":"阳","e5QAQ1.png":"强","ECcmqT.png":"春","eeYwrN.png":"水","eGWHWT.png":"慰","eOOKlp.png":"触","EvHzor.png":"欲","ewwRMT.png":"逼","EZW46f.png":"深","FBosfH.png":"性","fC5MmR.png":"户","ffTW4v.png":"抽","ffZqua.png":"性","FgN2Tl.png":"乱","fHvZK9.png":"缝","fj7veK.png":"长","fkPlzo.png":"食","fKWetR.png":"管","FUmeqN.png":"□","Fus88J.png":"牛","G4uOno.png":"喷","g7bVzL.png":"高","GBmlnw.png":"跳","gCWM61.png":"精","GdAidg.png":"筋","GLZIqA.png":"子","gqDVGg.png":"巨","gu5ykL.png":"轮","GULUze.png":"高","h2FI8R.png":"胸","h4WPDX.png":"晕","hCztH8.png":"露","hfI2uM.png":"坚","hGHijB.png":"器","hIhWai.png":"高","HIUVkJ.png":"射","HkcQea.png":"交","hm5O6l.png":"套","hpFE8s.png":"流","HPxfmS.png":"含","hVxPKi.png":"触","Ia3sI1.png":"乱","IA8APJ.png":"巴","IlUZRn.png":"坚","iN7Lri.png":"食","iQMM3x.png":"感","ISfDuf.png":"体","isWxov.png":"马","ITILdU.png":"执","IU731r.png":"顶","IUanTB.png":"融","IUUwWq.png":"入","Ixqere.png":"流","J9AEU9.png":"入","JBfhPp.png":"操","jDxrrX.png":"子","jE4V2B.png":"深","jF1KPd.png":"□","jFACnh.png":"毛","jiyfGR.png":"根","JLkmp8.png":"股","jWwTqU.png":"情","K00hgA.png":"入","KaFnqe.png":"滚","Kaqaq0.png":"阴","kDOkxJ.png":"长","kSkOOe.png":"按","KtjQU3.png":"捏","kWmDQN.png":"处","kZQ8K6.png":"下","l0kRFF.png":"物","L9dqnM.png":"欲","Ldo3hW.png":"肉","ljppnW.png":"感","lNGSuh.png":"肠","lRfqbE.png":"精","lUzsIi.png":"轮","LZraJy.png":"春","mBpVnV.png":"乱","MEM8Wx.png":"干","MO2VKV.png":"液","ModDMS.png":"抽","mOZJWk.png":"马","mpgh5T.png":"出","nj29a6.png":"执","NOEnvb.png":"跳","nrSIO8.png":"深","o2xN3U.png":"花","O3b3KR.png":"暖","o5uSeU.png":"宫","OaBMS5.png":"拔","OB7KzU.png":"眼","oCH7SV.png":"魔","oeeXig.png":"马","OgBVeb.png":"软","oHc3dE.png":"物","OLHWRr.png":"点","onuRXa.png":"蒂","oqLfcR.png":"滑","oUntUm.png":"浓","OXOdsf.png":"道","p3ARaM.png":"流","p068ps.png":"宫","PLwxDG.png":"种","PmCTBy.png":"色","pMlQBk.png":"汁","pQypTa.png":"进","PtUVdN.png":"抽","PW1WSi.png":"湿","Pw3ezj.png":"配","pXy3UL.png":"交","Q7jy4x.png":"内","q07XV1.png":"器","Q9OBtA.png":"潮","QbYFBI.png":"阴","qEI00x.png":"下","qewOBk.png":"滑","QfXoIi.png":"肉","qJIAe3.png":"按","QkWjrV.png":"身","QnFF9j.png":"根","qNFYq4.png":"干","QU7Lcv.png":"□","qwsVcX.png":"抽","qxb6Lz.png":"点","QzP4Nz.png":"眼","R8uNPt.png":"内","R9tjeh.png":"出","rFr75w.png":"胸","rGA9Cq.png":"交","RjCFQu.png":"紧","RLNC0G.png":"点","rocNQb.png":"做","Rpp7lC.png":"蒂","rUJMTx.png":"色","RZZBiZ.png":"眼","S2Dvd4.png":"泄","s8DZGN.png":"情","s560YT.png":"具","SeKcc0.png":"色","sFFl4b.png":"宠","SiAa7G.png":"头","slAZvO.png":"色","sTPB8l.png":"触","sV6OrY.png":"长","syPCmu.png":"轮","Sz5U6E.png":"器","SZn6xB.png":"物","T6sDn9.png":"情","t9WGXQ.png":"逼","TCRQtC.png":"滑","TGkFFQ.png":"逼","tNjFEZ.png":"花","tOUYgC.png":"魔","TSjC0C.png":"庭","TSp4f1.png":"拔","TWIhpT.png":"爱","TxaWbU.png":"融","ua2bew.png":"顶","UbTLa5.png":"挺","uDN4sP.png":"入","ueMquS.png":"身","UEVcqG.png":"身","UIFeaH.png":"配","unR6fo.png":"阳","Upc9Pu.png":"交","UukBzP.png":"洞","UvCU0f.png":"宠","VAOIqQ.png":"美","vMf2zS.png":"配","VnXHdX.png":"做","vpHmyj.png":"内","Vql6Ev.png":"姐","vrkjXi.png":"种","vtnLR7.png":"水","wkUtOc.png":"□","WOHLvx.png":"奶","WppxBg.png":"美","WRtMHz.png":"囊","WTAi5O.png":"揉","wtwCbu.png":"牛","WXf8jT.png":"具","xpWTjp.png":"物","XqFPrk.png":"做","XrHw7R.png":"体","XskrJT.png":"阳","xubhKq.png":"毛","xxqGbU.png":"胸","y2rhls.png":"做","y8TJ26.png":"种","YbmlHp.png":"花","YpcoIg.png":"美","yruS8G.png":"虐","YTWiNM.png":"花","YvzoUL.png":"喉","YY1gAh.png":"融","yYS2XJ.png":"进","ZaWg8Q.png":"浓","zbUsFu.png":"热","zGqroA.png":"子","zhogXd.png":"露","zM4vGZ.png":"滚","ZMyXfX.png":"硬","Znemv4.png":"马","ZnORLb.png":"头","zovunx.png":"穴","ZpcLFr.png":"爱","4KLtoP.png":"蚌","k2hzhi.png":"蕊","OpOeoc.png":"雏","D6GjNJ.png":"邦","nSh1y5.png":"邦","ZD1bga.png":"膜","0JNnRt.png":"裆","0laGrG.png":"勃","0sEWeF.png":"爽","0X07Oj.png":"长","0ZBaBv.png":"穴","1WoJda.png":"挺","1yUGqq.png":"套","2ABT9u.png":"管","2BcI5e.png":"核","2dfEmL.png":"肏","2LdPZ9.png":"巴","2VLZTT.png":"吸","2WgKu9.png":"春","03PhNV.png":"摩","3preuJ.png":"潮","3tNh88.png":"插","4m7wbi.png":"晕","4mO3Bj.png":"妓","4P4bWw.png":"烫","4qJrgq.png":"催","4xMdlq.png":"捅","5aHMLF.png":"浓","5caAaX.png":"含","5IL1sE.png":"腺","5qxLLo.png":"萄","5rXkkk.png":"弄","5uAxU4.png":"揉","5XAgwu.png":"奸","6A9MvV.png":"勃","6jL6AP.png":"荡","6ontyx.png":"葡","6VRwjR.png":"粗","6zcWUT.png":"泄","7aWXdF.png":"潮","7Bz8yG.png":"棍","7fhmqV.png":"裤","7jKFaP.png":"奸","7lNejO.png":"灌","7pFdxn.png":"撸","7Q7Jrg.png":"屌","8BNYPM.png":"暖","8J5geS.png":"吟","8Kf7GD.png":"茎","8mHmVv.png":"茎","8N16Hq.png":"虐","8UniDu.png":"户","8w5K9T.png":"裸","8wm13p.png":"晕","8ZNrSv.png":"硬","9BRV3o.png":"屌","9Nqw8t.png":"瘫","9RBhTJ.png":"骚","9RvnBS.png":"肉","9TaMmD.png":"泌","9UaEDH.png":"洞","9zWVtd.png":"姐","47FrvB.png":"乳","76gAv7.png":"爽","77lL1M.png":"吟","798jja.png":"皮","a0mCeq.png":"软","ACrPlr.png":"食","aFoXhJ.png":"痒","Afr6zx.png":"殖","aHuUcm.png":"菊","AiDkbY.png":"肛","aOxG78.png":"葡","AQZ08I.png":"肛","ARAUs9.png":"屁","arEzdS.png":"奶","axdkbW.png":"壁","aYGWo2.png":"菊","b1C6Pu.png":"痒","bCQ2nL.png":"敏","BgJzfk.png":"欢","BhgFcH.png":"囊","bOoL0J.png":"淫","BqO1fa.png":"舌","bqXZDH.png":"肥","BsU6ka.png":"蕊","Bu9FZQ.png":"淫","bufT6t.png":"膜","bWdbXA.png":"滚","C4UN5R.png":"淫","CgqkFG.png":"荡","CH67yh.png":"娇","CM7jpY.png":"孕","cNghja.png":"荡","CnOBoo.png":"插","CNQW3o.png":"烫","cow4Kc.png":"强","CXC9uz.png":"肉","Cy7Ynb.png":"瘫","czWHZw.png":"雏","D0Lwo9.png":"蜜","dB0uJO.png":"舌","dHuyiO.png":"屌","DQWBph.png":"丸","DsEJTV.png":"呻","dUrJvn.png":"膜","Ea3lho.png":"臀","EboGWZ.png":"肠","eifoua.png":"孕","EiUhlF.png":"套","ENwWoX.png":"乱","EQEgJx.png":"摩","EQiUab.png":"裤","er8NJ7.png":"吮","F0WoiN.png":"具","f1YTv0.png":"潮","f2N1vL.png":"奸","F3nlmb.png":"裤","F6lW1R.png":"肿","f60BEY.png":"尿","f461mD.png":"根","fd6C8F.png":"鸡","Fdz1Vc.png":"壁","FetNxM.png":"屌","FfxOzl.png":"裸","Fge27m.png":"萄","fGpEWq.png":"呻","Fl20Ip.png":"龟","fNXZyj.png":"戴","fRmx68.png":"部","fSdsL1.png":"裆","FT9nI5.png":"菊","FVVqzv.png":"蛋","FwjZJi.png":"吸","fX4WIp.png":"伦","FXgFwc.png":"插","FXmf8I.png":"摺","fxPcW3.png":"洞","g2jVxn.png":"肏","gb3LOX.png":"胯","gDVng6.png":"宠","gImiVY.png":"弄","gJDFQC.png":"舔","gJDG8l.png":"孕","GJodYn.png":"拔","GmLjKa.png":"尉","gNlJMc.png":"棍","GppocX.png":"配","gsRjtr.png":"柱","GTOAc4.png":"挺","GzjpTS.png":"精","h8zRxr.png":"股","H17DtI.png":"屁","ha14XV.png":"触","hatLmR.png":"臀","hbrRIS.png":"蕾","hC4NbQ.png":"睾","hG0SRP.png":"擦","HhNUaw.png":"蕊","hKjWPG.png":"撸","Hn8Afh.png":"瓣","hngWaZ.png":"吸","htV3uv.png":"壁","hVaVng.png":"按","HVHPCy.png":"瓣","hVwy7k.png":"舔","i4tyrQ.png":"茎","i5s28n.png":"伦","IAloq6.png":"吮","ICHARH.png":"户","icI6Ey.png":"臀","iCRh88.png":"棒","Iej2pu.png":"妓","IkqJmu.png":"虐","imVjMj.png":"乳","iNIMEL.png":"蛋","IOjnEP.png":"欢","ip6KUM.png":"禽","IPC2R8.png":"鸡","ipVGiA.png":"捅","IpYNG3.png":"奴","ITUjFq.png":"皮","ixiion.png":"部","IZcCzq.png":"蜜","IzJ4WG.png":"茎","J1CBtB.png":"跳","j9C44i.png":"烫","JCQtUs.png":"乳","JEcz0E.png":"蜜","JfPEEe.png":"伦","jHi6Vu.png":"龟","jjfR6D.png":"葡","jktdia.png":"擦","JlkuRa.png":"萄","jnAvXp.png":"庭","jnCCk9.png":"泄","jvj3DG.png":"硬","Jy4pAI.png":"瓣","jZyPEL.png":"孕","K2AtMQ.png":"骚","K2jjT6.png":"蕾","k6X0xy.png":"肿","k9h8DR.png":"逼","k9zXwG.png":"爽","KalRLt.png":"润","kawcM7.png":"棍","kdsEv6.png":"弄","KdwL4R.png":"蛋","kPG0vR.png":"灌","KSqmoM.png":"液","kTCaM9.png":"蛋","kVLLjB.png":"荡","kygbuo.png":"牛","kZDlEj.png":"管","l0BNLC.png":"泌","l1Dmft.png":"牛","L1yl45.png":"射","L3a5ft.png":"囊","L3LaNQ.png":"吹","L9F6F8.png":"催","LB1WMg.png":"操","LBPqYj.png":"洞","LDjbfQ.png":"尿","ldo7FB.png":"紧","lErO3o.png":"柱","LFBZKA.png":"姐","lfGqdb.png":"棒","lGKjej.png":"妓","LjemA3.png":"肛","Ljh7qo.png":"插","LJSiT5.png":"屄","Lk5uQy.png":"核","lngKEo.png":"喷","lOfDdC.png":"丸","Lsq92O.png":"吟","LsyPdc.png":"吟","lVbZkd.png":"捏","lVMTQu.png":"敏","LVmymH.png":"肠","lyYo4Y.png":"呻","lZtabT.png":"阴","M3VjF9.png":"撸","m4yvu3.png":"穴","M8bV3k.png":"囊","MBhDEi.png":"痒","MC5lZn.png":"塞","Mc8JM6.png":"拔","mD7hPS.png":"屁","mExNDV.png":"灌","MKapwC.png":"肥","mKxUHv.png":"擦","Mo31Ax.png":"毛","mRFQJQ.png":"喉","MsUFfR.png":"殖","mTzxxd.png":"缝","n2ufBJ.png":"奸","n3oOgA.png":"捅","n9j6EC.png":"庭","n49ZFH.png":"裆","nCrl80.png":"瘫","NDlwhm.png":"腺","nE1Y7y.png":"瘫","neIgqc.png":"吹","NeKVfz.png":"慰","NHH9A1.png":"睾","NKN1rk.png":"吮","NKUSkP.png":"壁","NlfTkc.png":"屄","NlZDDQ.png":"腿","nmoPI2.png":"丸","NnfPEJ.png":"龟","NP33MO.png":"汁","NQ7oga.png":"感","nsDzuq.png":"邦","NsIwni.png":"巨","oaLZIg.png":"睾","oC3HDZ.png":"粗","OFx7ZU.png":"裸","OHU6tX.png":"液","olFcqI.png":"干","OMdbeV.png":"膜","On4f9C.png":"筋","oncaJq.png":"皮","Oo8iWN.png":"按","OUWXqz.png":"春","OuXWg2.png":"丸","ozF5Kr.png":"虐","p0bqZi.png":"屄","p1H9RN.png":"射","p5QCRV.png":"滑","p5zEbo.png":"蕾","P43O6G.png":"戴","PalsBW.png":"奴","PcAvOY.png":"嫩","pHfPTa.png":"巨","pi2z0b.png":"筋","plFlPb.png":"棍","pNPlu5.png":"灌","PnZNBC.png":"淫","pQ1W2F.png":"裤","PX3jJ6.png":"泌","q14YbK.png":"顶","Qc9LRh.png":"喘","qe2YZi.png":"揉","qEy1kT.png":"部","Qfs9DA.png":"催","Qg8Qwg.png":"蕾","qJ1X2h.png":"姐","qm0ZBO.png":"慰","QmcP4w.png":"敏","Qn3xBM.png":"嫩","qNGvlk.png":"尿","qPhrVf.png":"处","qPX1Ef.png":"含","qr8InI.png":"肥","QtLIGq.png":"液","QtSnzR.png":"喘","Qv3JbY.png":"缝","QYF65i.png":"筋","Qz4Txd.png":"臀","qzdvCv.png":"巴","r7NsvF.png":"弄","r8oBsP.png":"鸡","r9Gw4X.png":"核","R65BZO.png":"舔","Rf7Jf6.png":"摩","Rho2GL.png":"痒","rlVLx7.png":"爱","Rm3wex.png":"喷","RmrhKk.png":"舔","RMWsBY.png":"敏","rn9y6F.png":"塞","RnfJ8h.png":"柱","RP5Oud.png":"喘","Rp5tmA.png":"操","rpSSYK.png":"胯","rQKjMD.png":"毛","RrXcE9.png":"器","RyL5jk.png":"汁","s67RPe.png":"烫","s95kq4.png":"湿","sdXZMk.png":"勃","SGxBy7.png":"屁","smhB8j.png":"射","Srgobp.png":"户","srlW2t.png":"流","ST21xu.png":"浓","STzFJz.png":"粗","sugwEw.png":"奶","SzADhL.png":"肿","T5yzvl.png":"汁","t6K8rK.png":"性","tAIV6q.png":"操","TCFRca.png":"棒","te79V0.png":"棒","tjbhCV.png":"嫩","tNFwEz.png":"喉","tPTX1h.png":"肥","tsQMiL.png":"吹","TUZb1W.png":"欲","TWFykG.png":"妓","twLxYU.png":"软","tXNaZ2.png":"融","U3bhkh.png":"骚","u6K6ci.png":"欢","u9Tibu.png":"内","Ua2WwL.png":"娇","Uai2en.png":"强","UeWULF.png":"庭","UfXSsz.png":"后","ui0T5v.png":"禽","UqClGF.png":"股","Urv1FM.png":"肿","uwXRHd.png":"喷","v4iqzP.png":"缝","vAdmoL.png":"硬","VhA8GI.png":"嫩","VHsdy1.png":"核","vjOssT.png":"塞","vkYfGf.png":"魔","vMmUqq.png":"奴","VnvOwV.png":"润","VoAjiw.png":"湿","vrtXeW.png":"裆","VUbefT.png":"轮","vulCqw.png":"执","VYaPfX.png":"穴","VyJ2cS.png":"邦","W06Vg1.png":"巨","W7cCwn.png":"捅","W9Y9vD.png":"舌","wa54S5.png":"含","FNq1zS.png":"蚌","DDpMPK.png":"蚌","vDbU8w.png":"腺","SSoXSL.png":"葡","YB6iOy.png":"腺","kMqpt6.png":"雏","5RwMUT.png":"蕊","b94JXX.png":"脔","oxFS6J.png":"脔","H53jMR.png":"雏"}},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Linovel=void 0;const o=n(6),r=n(14),a=n(8),i=n(9),c=n(7),s=n(15),l=n(34);class u extends s.BaseRuleClass{constructor(){super(),this.imageMode="TM",this.concurrencyLimit=5}async bookParse(){const e=document.location.href,t=document.querySelector(".book-title").innerText.trim(),n=document.querySelector(".author-frame > .novelist > div:nth-child(3) > a").innerText.trim(),r=document.querySelector(".about-text"),[a,s,u]=await(0,l.introDomHandle)(r),d={},p=[],m=document.querySelector(".book-cover > a").href;m&&(p.push(m),(0,o.getImageAttachment)(m,this.imageMode,"cover-").then((e=>{d.cover=e})).catch((e=>i.log.error(e)))),d.attachments=[];const h=Array.from(document.querySelectorAll(".section-list > .section > .volume-info > .volume-cover a")).map((e=>e.href));for(const e of h)p.includes(e)||(p.push(e),(0,o.getImageAttachment)(e,this.imageMode,"volumeCover-").then((e=>{d.attachments?.push(e)})).catch((e=>i.log.error(e))));d.tags=Array.from(document.querySelectorAll("div.meta-info > div.book-cats.clearfix > a")).map((e=>e.innerText.trim()));const g=[],f=document.querySelectorAll(".section-list > .section");let w=0;for(let n=0;n<f.length;n++){const o=f[n],r=n+1,a=o.querySelector(".volume-info > h2.volume-title > a").innerText.trim();let i=0;const s=o.querySelectorAll(".chapter-list > .text-content-actual div.chapter");for(const n of Array.from(s)){const o=n.firstElementChild;w++,i++;const s=o.innerText.trim(),l=o.href,u=()=>!!n.className.includes("lock")&&!n.className.includes("unlock"),d=()=>!1,p=new c.Chapter(e,t,l,w,s,u(),d(),a,r,i,this.chapterParse,"UTF-8",{}),m=()=>!1;!u()||m()&&p.isPaid||(p.status=c.Status.aborted),g.push(p)}}return new c.Book(e,t,n,a,s,d,g)}async chapterParse(e,t,n,o,i,c){return n?async function(){return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}():async function(){const t=await(0,a.getHtmlDOM)(e,i),n=t.querySelector(".article-title").innerText.trim(),o=t.querySelector(".article-text");if(o){const{dom:e,text:t,images:a}=await(0,r.cleanDOM)(o,"TM");return{chapterName:n,contentRaw:o,contentText:t,contentHTML:e,contentImages:a,additionalMetadate:null}}return{chapterName:n,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}()}}t.Linovel=u},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Tadu=void 0;const o=n(6),r=n(14),a=n(8),i=n(8),c=n(9),s=n(7),l=n(15),u=n(34);class d extends l.BaseRuleClass{constructor(){super(),this.imageMode="TM",this.concurrencyLimit=5}async bookParse(){const e=document.location.href,t=document.querySelector("div.bookNm > a.bkNm").innerText.trim(),n=document.querySelector("div.authorInfo > a.author > span").innerText.trim(),r=document.querySelector("div.boxCenter.boxT.clearfix > div.lf.lfO > p.intro"),[a,i,l]=await(0,u.introDomHandle)(r),d={},p=document.querySelector("a.bookImg > img").getAttribute("data-src");p&&(0,o.getImageAttachment)(p,this.imageMode,"cover-").then((e=>{d.cover=e})).catch((e=>c.log.error(e)));const m=[],h=document.querySelectorAll("div.lf.lfT > li > div > a");let g=0;for(const n of Array.from(h)){g++;const o=n.innerText,r=n.href,a=()=>!!n.childElementCount,i=()=>!1,c=new s.Chapter(e,t,r,g,o,a(),i(),null,null,null,this.chapterParse,"UTF-8",{}),l=()=>!1;!a()||l()&&c.isPaid||(c.status=s.Status.aborted),m.push(c)}return new s.Book(e,t,n,a,i,d,m)}async chapterParse(e,t,n,o,s,l){return n?async function(){return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}():async function(){c.log.debug(`[Chapter]请求 ${e}`);const n=await(0,i.getHtmlDOM)(e,s),o=document.createElement("div"),l=n.getElementById("bookPartResourceUrl")?.getAttribute("value");if(l){const e=new URL(l);e.searchParams.set("callback","callback"),c.log.debug(`[Chapter]请求 ${e.toString()}`);const n=await(0,a.gfetch)(e.toString(),{headers:{accept:"*/*",Referer:document.location.origin}}).then((t=>{if(t.status>=200&&t.status<=299)return t.responseText;throw new Error(`Bad response! ${e.toString()}`)})).catch((e=>c.log.error(e)));if(!n)throw new Error("jsonp request failed!");const i=new Function(`function callback(obj) { return obj; } return ${n};`)();if("object"==typeof i){o.innerHTML=i.content;const{dom:e,text:n,images:a}=await(0,r.cleanDOM)(o,"TM");return{chapterName:t,contentRaw:o,contentText:n,contentHTML:e,contentImages:a,additionalMetadate:null}}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}()}}t.Tadu=d},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Idejian=void 0;const o=n(6),r=n(14),a=n(8),i=n(13),c=n(9),s=n(7),l=n(15),u=n(34);class d extends l.BaseRuleClass{constructor(){super(),this.imageMode="TM",this.maxRunLimit=5}async bookParse(){const e=document.location.href,t=e.match(/\/(\d+)\/$/),n=t&&t[1],r=document.querySelector(".detail_bkname > a").innerText.trim(),a=document.querySelector(".detail_bkauthor").childNodes[0];let i="佚名";a&&a.textContent&&(i=a.textContent.trim());const l=document.querySelector(".brief_con"),[d,p,m]=await(0,u.introDomHandle)(l),h={},g=document.querySelector(".book_img > img").src;g&&(0,o.getImageAttachment)(g,this.imageMode,"cover-").then((e=>{h.cover=e})).catch((e=>c.log.error(e))),h.tags=Array.from(document.querySelectorAll("div.detail_bkgrade > span")).map((e=>e.innerText.trim()));const f=[],w=document.querySelectorAll(".catelog_list > li > a");let y=0;for(const t of Array.from(w)){y++;const o=t.innerText,a=t.href,i=!1,c=!1,l=new s.Chapter(e,r,a,y,o,i,c,null,null,null,this.chapterParse,"UTF-8",{bookID:n});f.push(l)}return document.cookie="",new s.Book(e,r,i,d,p,h,f)}async chapterParse(e,t,n,o,s,l){const u=new URL(e);u.hostname="m.idejian.com",e=u.toString();const d=new URL("https://m.idejian.com/catalog");d.searchParams.set("bookId",l.bookID);const p=d.toString(),m="Mozilla/5.0 (iPhone; CPU iPhone OS 13_3_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.5 Mobile/15E148 Snapchat/10.77.5.59 (like Safari/604.1)";""===document.cookie&&(await(0,a.ggetText)(p,s,{headers:{"User-Agent":m}}),await(0,a.ggetText)(e,s,{headers:{"User-Agent":m,Referer:p}})),c.log.debug(`[Chapter]请求 ${e}，Refer：${p}`);const h=await(0,a.ggetHtmlDOM)(e,s,{headers:{"User-Agent":m,Referer:p}});let g;if(t=h.querySelector(".text-title-1").innerText.trim(),g=1===h.querySelectorAll("div.h5_mainbody").length?h.querySelector("div.h5_mainbody"):h.querySelectorAll("div.h5_mainbody")[1],g){(0,i.rm)("h1",!1,g);const{dom:e,text:n,images:o}=await(0,r.cleanDOM)(g,"TM");return{chapterName:t,contentRaw:g,contentText:n,contentHTML:e,contentImages:o,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}t.Idejian=d},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Qimao=void 0;const o=n(6),r=n(14),a=n(8),i=n(9),c=n(7),s=n(15),l=n(34);class u extends s.BaseRuleClass{constructor(){super(),this.imageMode="TM"}async bookParse(){const e=document.location.href,t=document.querySelector("h2.tit").innerText.trim(),n=document.querySelector(".p-name > a").innerHTML.trim(),r=document.querySelector(".book-introduction .article"),[a,s,u]=await(0,l.introDomHandle)(r),d={},p=document.querySelector(".poster-pic > img").src;p&&(0,o.getImageAttachment)(p,this.imageMode,"cover-").then((e=>{d.cover=e})).catch((e=>i.log.error(e))),d.tags=Array.from(document.querySelectorAll(".qm-tags > a")).map((e=>e.innerText.trim()));const m=[],h=document.querySelectorAll('.chapter-directory > dd > div[sort-type="ascending"] a');let g=0;for(const n of Array.from(h)){g++;const o=n.innerText,r=n.href,a=()=>!!n.childElementCount,i=()=>!1,s=new c.Chapter(e,t,r,g,o,a(),i(),null,null,null,this.chapterParse,"UTF-8",{}),l=()=>!1;!a()||l()&&s.isPaid||(s.status=c.Status.aborted),m.push(s)}return new c.Book(e,t,n,a,s,d,m)}async chapterParse(e,t,n,o,c,s){return n?async function(){return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}():async function(){i.log.debug(`[Chapter]请求 ${e}`);const n=await(0,a.getHtmlDOM)(e,c);t=n.querySelector(".title").innerText.trim();const o=n.querySelector(".article");if(o){const{dom:e,text:n,images:a}=await(0,r.cleanDOM)(o,"TM");return{chapterName:t,contentRaw:o,contentText:n,contentHTML:e,contentImages:a,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}()}}t.Qimao=u},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Wenku8=void 0;const o=n(6),r=n(14),a=n(8),i=n(13),c=n(9),s=n(7),l=n(15),u=n(34);class d extends l.BaseRuleClass{constructor(){super(),this.imageMode="TM",this.charset="GBK"}async bookParse(){const e=document.location.pathname.split("/").slice(-2,-1)[0],t=[document.location.origin,"book",`${e}.htm`].join("/"),n=document.querySelector("#title").innerText.trim(),r=await(0,a.getHtmlDOM)(t,"GBK"),i=r.querySelector("#content > div:nth-child(1) > table:nth-child(1) > tbody:nth-child(1) > tr:nth-child(2) > td:nth-child(2)").innerText.replace("小说作者：","").trim(),l=r.querySelector("#content > div:nth-child(1) > table:nth-child(4) > tbody:nth-child(1) > tr:nth-child(1) > td:nth-child(2) > span:nth-child(11)"),[d,p,m]=await(0,u.introDomHandle)(l),h={},g=r.querySelector("#content > div:nth-child(1) > table:nth-child(4) > tbody:nth-child(1) > tr:nth-child(1) > td:nth-child(1) > img:nth-child(1)").src;g&&(0,o.getImageAttachment)(g,this.imageMode,"cover-").then((e=>{h.cover=e})).catch((e=>c.log.error(e)));const f=[],w=Array.from(document.querySelectorAll(".css > tbody td")).filter((e=>e.innerText.trim()));let y=0,b=0,v=null,x=0;for(const e of Array.from(w))if("vcss"===e.className)b++,x=0,v=e.innerText.trim();else if("ccss"===e.className){y++,x++;const o=e.firstElementChild,r=o.innerText.trim(),a=o.href,i=new s.Chapter(t,n,a,y,r,!1,!1,v,b,x,this.chapterParse,this.charset,{});f.push(i)}return new s.Book(t,n,i,d,p,h,f)}async chapterParse(e,t,n,o,c,s){const l=(await(0,a.getHtmlDOM)(e,c)).querySelector("#content");if(l){(0,i.rm)("#contentdp",!0,l);const{dom:e,text:n,images:o}=await(0,r.cleanDOM)(l,"TM");return{chapterName:t,contentRaw:l,contentText:n,contentHTML:e,contentImages:o,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}t.Wenku8=d},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Dmzj=void 0;const o=n(6),r=n(14),a=n(8),i=n(13),c=n(9),s=n(7),l=n(15),u=n(34);class d extends l.BaseRuleClass{constructor(){super(),this.imageMode="TM"}async bookParse(){const e=document.location.href,t="www.dmzj.com"===document.location.host,n=(t?document.querySelector(".comic_deCon > h1 > a"):document.querySelector(".anim_title_text > a > h1")).innerText.trim(),r=(t?document.querySelector(".comic_deCon_liO > li:nth-child(1)"):document.querySelector(".anim-main_list > table:nth-child(1) > tbody:nth-child(1) > tr:nth-child(3) > td:nth-child(2) > a:nth-child(1)")).innerText.replace("作者：","").trim(),a=t?document.querySelector(".comic_deCon_d"):document.querySelector(".line_height_content"),[i,l,d]=await(0,u.introDomHandle)(a),p={},m=(t?document.querySelector(".comic_i_img > a > img"):document.querySelector("#cover_pic")).src;m&&(0,o.getImageAttachment)(m,this.imageMode,"cover-").then((e=>{p.cover=e})).catch((e=>c.log.error(e)));const h=[],g=t?document.querySelectorAll("div.zj_list_con:nth-child(4) > ul.list_con_li > li"):document.querySelectorAll(".cartoon_online_border > ul > li");let f=0;for(const o of Array.from(g)){f++;const r=o.firstElementChild;let a;a=t?r.lastElementChild.innerText:r.innerText;const i=r.href,c=!1,l=!1,u=new s.Chapter(e,n,i,f,a,c,l,null,null,null,this.chapterParse,"UTF-8",{});h.push(u)}return new s.Book(e,n,r,i,l,p,h)}async chapterParse(e,t,n,o,s,l){c.log.debug(`[Chapter]请求 ${e}`);const u="www.dmzj.com"===document.location.host,d=function(e){const t="https://images.dmzj.com/",n=Array.from(e.querySelectorAll("head > script")).filter((e=>e.innerHTML.includes("eval(")))[0];let o=(0,i.sandboxed)(n.innerText+";return pages;");o=o.replace(/\n/g,""),o=o.replace(/\r/g,"|");const r=(0,i.sandboxed)("return ("+o+")");if(r){let e;return e=u?r.page_url.split("|").map((e=>t+e)):r.map((e=>t+e)),e}}(await(0,a.getHtmlDOM)(e,s));if(d){const e=document.createElement("div");for(const t of d){const n=document.createElement("p"),o=document.createElement("img");o.src=t,n.appendChild(o),e.appendChild(n)}const{dom:n,text:o,images:a}=await(0,r.cleanDOM)(e,"TM");return{chapterName:t,contentRaw:e,contentText:o,contentHTML:n,contentImages:a,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}t.Dmzj=d},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Sosadfun=void 0;const o=n(14),r=n(8),a=n(7),i=n(15);class c extends i.BaseRuleClass{constructor(){super(),this.imageMode="TM"}async bookParse(){const e=document.location.origin+document.location.pathname,t=document.querySelector(".font-1").innerText.trim(),n=document.querySelector("div.h5:nth-child(1) > div:nth-child(1) > a:nth-child(1)");let r;r=n?n.innerText.trim():"匿名咸鱼";const i={};let c,s,l;if(i.tags=Array.from(document.querySelectorAll("div.h5:nth-child(1) > div:nth-child(3) > a")).map((e=>e.innerText.trim())),"主楼隐藏，请登录后查看"===document.querySelector(".col-xs-12 > .main-text.no-selection").innerText.trim())throw alert("本小说需要登录后浏览！"),new a.ExpectError("本小说需要登录后浏览！");{l=document.createElement("div");const e=document.querySelector("div.article-title div.h5"),t=document.querySelector(".col-xs-12 > .main-text.no-selection");if(e){const t=document.createElement("p");t.innerText=e.innerText,l.appendChild(t)}if(t)for(const e of Array.from(t.cloneNode(!0).children))l.appendChild(e)}if(null===l)c=null,s=null;else{const{dom:e,text:t,images:n}=await(0,o.cleanDOM)(l,"TM");c=t,s=e,n&&(i.attachments=[...n])}const u=[],d=document.querySelectorAll(".table > tbody:nth-child(2) > tr > th:nth-child(1) > a");let p=0;for(const n of Array.from(d)){p++;const o=n.innerText.trim(),r=n.href,i=new a.Chapter(e,t,r,p,o,!1,!1,null,null,null,this.chapterParse,"UTF-8",{});u.push(i)}return new a.Book(e,t,r,c,s,i,u)}async chapterParse(e,t,n,a,i,c){const s=await(0,r.getHtmlDOM)(e,i);t=s.querySelector("strong.h3").innerText.trim();const l=document.createElement("div"),u=s.querySelector(".main-text.no-selection > span[id^=full]"),d=s.querySelector(".main-text.no-selection > .grayout");if(u)for(const e of Array.from(u.cloneNode(!0).children))l.appendChild(e);if(u){let{dom:e,text:n,images:r}=await(0,o.cleanDOM)(l,"TM");if(d){const{dom:t,text:a,images:i}=await(0,o.cleanDOM)(d,"TM"),c=document.createElement("hr"),s=document.createElement("div");s.className="authorSay";for(const e of Array.from(t.cloneNode(!0).children))s.appendChild(e);l.appendChild(c),l.appendChild(s),e.appendChild(c),e.appendChild(s),n=n+"\n\n"+"-".repeat(20)+"\n\n"+a,i.forEach((e=>r.push(e)))}return{chapterName:t,contentRaw:l,contentText:n,contentHTML:e,contentImages:r,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}t.Sosadfun=c},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Westnovel=void 0;const o=n(6),r=n(14),a=n(8),i=n(13),c=n(9),s=n(7),l=n(15),u=n(34);class d extends l.BaseRuleClass{constructor(){super(),this.imageMode="TM"}async bookParse(){const e=document.location.href,t=document.querySelector(".btitle > h1 > a").innerText.trim(),n=document.querySelector(".btitle > em:nth-child(2)").innerText.replace("作者：","").trim(),r=document.querySelector(".intro-p > p:nth-child(1)"),[a,i,l]=await(0,u.introDomHandle)(r),d={},p=document.querySelector(".img-img").src;p&&(0,o.getImageAttachment)(p,this.imageMode,"cover-").then((e=>{d.cover=e})).catch((e=>c.log.error(e)));const m=[],h=document.querySelectorAll(".chapterlist > dd > a");let g=0;for(const n of Array.from(h)){g++;const o=n.innerText.trim(),r=n.href,a=new s.Chapter(e,t,r,g,o,!1,!1,null,null,null,this.chapterParse,"UTF-8",{});m.push(a)}return new s.Book(e,t,n,a,i,d,m)}async chapterParse(e,t,n,o,c,s){const l=await(0,a.getHtmlDOM)(e,c);t=l.querySelector("#BookCon > h1:nth-child(1)").innerText.trim();const u=l.querySelector("#BookText");if(u){(0,i.rm)("div.ads",!0,u),(0,i.rm)("div.link",!0,u),(0,i.rm)("h4",!0,u);const{dom:e,text:n,images:o}=await(0,r.cleanDOM)(u,"TM");return{chapterName:t,contentRaw:u,contentText:n,contentHTML:e,contentImages:o,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}t.Westnovel=d},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Linovelib=void 0;const o=n(6),r=n(8),a=n(13),i=n(9),c=n(7),s=n(15),l=n(34);class u extends s.BaseRuleClass{constructor(){super(),this.imageMode="TM"}async bookParse(){const e=document.location.href.replace(/\/catalog$/,".html"),t=document.querySelector(".book-meta > h1").innerText.trim(),n=document.querySelector(".book-meta > p:nth-child(2) > span:nth-child(1) > a:nth-child(2)").innerText.trim(),a=await(0,r.getHtmlDOM)(e,void 0),s=a.querySelector(".book-dec > p:nth-child(1)"),[u,d,p]=await(0,l.introDomHandle)(s),m={},h=a.querySelector(".book-img > img").src;h&&(0,o.getImageAttachment)(h,this.imageMode,"cover-").then((e=>{m.cover=e})).catch((e=>i.log.error(e))),m.tags=Array.from(a.querySelectorAll(".book-label a")).map((e=>e.innerText.trim()));const g=[],f=document.querySelector(".chapter-list");if(!f)throw new Error("获取章节失败！");const w=f.children;let y=0,b=0,v=null,x=0;for(const n of Array.from(w)){const o=n.nodeName.toLowerCase();if("div"===o)b++,x=0,v=n.innerText.trim();else if("li"===o){y++,x++;const o=n.firstElementChild,r=!1,a=o.innerText.trim(),i=o.href,s=new c.Chapter(e,t,i,y,a,r,null,v,b,x,this.chapterParse,"UTF-8",{});i.startsWith("javascript")&&(s.status=c.Status.aborted),g.push(s)}}return new c.Book(e,t,n,u,d,m,g)}async chapterParse(e,t,n,o,r,i){return(0,l.nextPageParse)({chapterName:t,chapterUrl:e,charset:r,selector:"#TextContent",contentPatch:(e,t)=>{const n=Array.from(t.querySelectorAll("script")).find((e=>e.innerHTML.includes('document.getElementById("chapter_last")')));if(n){const e=n.innerText.trim().match(/let dom_nr = '(.+)';/);if(e){const n=e[1];t.getElementById("chapter_last").innerHTML=n}}return(0,a.rm)(".tp",!0,e),(0,a.rm)(".bd",!0,e),e},getNextPage:e=>e.querySelector(".mlfy_page > a:nth-child(5)").href,continueCondition:(e,t)=>new URL(t).pathname.includes("_")})}}t.Linovelib=u},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Yibige=void 0;const o=n(6),r=n(8),a=n(13),i=n(9),c=n(7),s=n(15),l=n(34);class u extends s.BaseRuleClass{constructor(){super(),this.imageMode="TM"}async bookParse(){const e=document.querySelector("#list_hb > li:nth-child(2) > a:nth-child(1)").href,t=await(0,r.getHtmlDOM)(e,void 0),n=t.querySelector(".title > h1:nth-child(1)").innerText.trim(),a=t.querySelector("div.xsxq_2:nth-child(2) > a:nth-child(1)").innerText.trim(),s=document.createElement("p"),u=t.querySelector(".nr");for(const e of Array.from(u.childNodes)){if("#text"===e.nodeName.toLowerCase()&&"相关："===e.textContent?.trim())break;s.appendChild(e.cloneNode(!0))}const[d,p,m]=await(0,l.introDomHandle)(s),h={},g=t.querySelector(".limg > img:nth-child(1)").src;g&&(0,o.getImageAttachment)(g,this.imageMode,"cover-").then((e=>{h.cover=e})).catch((e=>i.log.error(e)));const f=[],w=document.querySelector(".books_li");if(w?.childElementCount){const t=Array.from(w.children);if("DT"===t[0].nodeName&&t[0].innerText.includes("最新12章节"))for(let e=0;e<w?.childElementCount;e++){if(0!==e&&"DT"===t[e].nodeName){delete t[0];break}delete t[e]}const o=t.filter((e=>void 0!==e&&null===e.getAttribute("style")));let r=0,a=0,i=null,s=0;for(const t of o)if("DT"===t.nodeName)a++,s=0,i=t.innerText.replace(`《${n}》`,"").trim();else if("DD"===t.nodeName){if(0===t.childElementCount)continue;r++,s++;const o=t.firstElementChild,l=o.innerText,u=o.href,d=!1,p=!1,m=new c.Chapter(e,n,u,r,l,d,p,i,a,s,this.chapterParse,"UTF-8",{bookname:n});f.push(m)}}return new c.Book(e,n,a,d,p,h,f)}async chapterParse(e,t,n,o,r,i){return(0,l.nextPageParse)({chapterName:t,chapterUrl:e,charset:r,selector:"#fontsize",contentPatch:(e,t)=>((0,a.rm)("div",!0,e),(0,a.rm)("script",!0,e),e.innerHTML=e.innerHTML.replaceAll("测试广告1","").replaceAll("测试广告2",""),e),getNextPage:e=>e.querySelector(".nr_fy > a:nth-child(4)").href,continueCondition:(e,t)=>new URL(t).pathname.includes("_")})}}t.Yibige=u},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Fushuwang=void 0;const o=n(14),r=n(8),a=n(13),i=n(7),c=n(15);class s extends c.BaseRuleClass{constructor(){super(),this.imageMode="TM",this.charset="GBK",this.maxRunLimit=5,this.saveOptions={genChapterText:(e,t)=>`${t}\n`}}async bookParse(){const e=(document.location.origin+document.location.pathname).replace(/(_\d+)\.html$/,".html"),[t,n]=document.querySelector(".title_info > tbody:nth-child(1) > tr:nth-child(1) > td:nth-child(1) > h1:nth-child(1)").innerText.split("——"),[o,r]=[null,null],a=document.querySelectorAll("p.pageLink > select > option"),c=Array.from(a).map((e=>document.location.origin+e.getAttribute("value"))),s=[];for(let n=0;n<c.length;n++){const o=c[n],r=`page${n}`,a=!1,l=!1,u=new i.Chapter(e,t,o,n+1,r,a,l,null,null,null,this.chapterParse,this.charset,{});s.push(u)}const l=new i.Book(e,t,n,o,r,{},s);return l.saveOptions=this.saveOptions,l}async chapterParse(e,t,n,i,c,s){const l=(await(0,r.getHtmlDOM)(e,c)).querySelector("#text");if(l){(0,a.rm)("span",!0,l),(0,a.rm)("p.pageLink",!0,l),(0,a.rm)("script",!0,l);const{dom:e,text:n,images:r}=await(0,o.cleanDOM)(l,"TM");return{chapterName:t,contentRaw:l,contentText:n,contentHTML:e,contentImages:r,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}t.Fushuwang=s},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Soxscc=void 0;const o=n(6),r=n(14),a=n(8),i=n(13),c=n(9),s=n(7),l=n(15),u=n(34);class d extends l.BaseRuleClass{constructor(){super(),this.imageMode="TM"}async bookParse(){const e=document.location.href,t=document.querySelector(".xiaoshuo > h1").innerText.trim(),n=document.querySelector(".xiaoshuo > h6:nth-child(3) > a").innerText.trim(),r=document.querySelector("#intro"),[a,l,d]=await(0,u.introDomHandle)(r,(e=>((0,i.rm)("span.tags",!1,e),(0,i.rm)("q",!0,e),e))),p={},m=document.querySelector(".book_cover > img").src;m&&(0,o.getImageAttachment)(m,this.imageMode,"cover-").then((e=>{p.cover=e})).catch((e=>c.log.error(e)));const h=[],g=document.querySelector("div.novel_list[id]"),f=Array.from(g.children);let w=0;for(let n=0;n<f.length;n++){const o=f[n],r=o.querySelector("dt > b")?.innerText,a=Array.from(o.querySelectorAll("dd > a"));let i=0;for(const o of a){w++,i++;const a=o.href,c=o.innerText,l=!1,u=!1,d=new s.Chapter(e,t,a,w,c,l,u,r,n+1,i,this.chapterParse,"UTF-8",{bookname:t});h.push(d)}}return new s.Book(e,t,n,a,l,p,h)}async chapterParse(e,t,n,o,i,c){const s=await(0,a.getHtmlDOM)(e,i),l=c.bookname;t=s.querySelector(".read_title > h1").innerText.trim();const u=s.querySelector("div.content[id]");if(u){const e=`您可以在百度里搜索“${l} .+(${document.location.hostname})”查找最新章节！`;u.innerHTML=u.innerHTML.replaceAll(e,""),Array.from(u.querySelectorAll("p")).forEach((e=>{const t=["最新章节地址：","全文阅读地址：","txt下载地址：","手机阅读：",'为了方便下次阅读，你可以点击下方的"收藏"记录本次',"请向你的朋友（QQ、博客、微信等方式）推荐本书"];for(const n of t)e.innerText.includes(n)&&e.remove()}));const{dom:n,text:o,images:a}=await(0,r.cleanDOM)(u,"TM");return{chapterName:t,contentRaw:u,contentText:o,contentHTML:n,contentImages:a,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}t.Soxscc=d},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Shubaowa=void 0;const o=n(6),r=n(14),a=n(8),i=n(9),c=n(7),s=n(15),l=n(34);class u extends s.BaseRuleClass{constructor(){super(),this.imageMode="TM",this.charset="GBK"}async bookParse(){const e=document.location.href,t=document.querySelector("#info > h1:nth-child(1)").innerText.trim(),n=document.querySelector("#info > p:nth-child(2)").innerText.replace(/作(\s+)?者[：:]/,"").trim(),r=document.querySelector("#intro"),[a,s,u]=await(0,l.introDomHandle)(r),d={},p=document.querySelector("#fmimg > img")?.src;p&&(0,o.getImageAttachment)(p,this.imageMode,"cover-").then((e=>{d.cover=e})).catch((e=>i.log.error(e)));const m=[],h=document.querySelectorAll("#list > dl > dd > a");let g=0;for(const n of Array.from(h)){g++;const o=n.innerText,r=n.href,a=new c.Chapter(e,t,r,g,o,!1,!1,null,null,null,this.chapterParse,this.charset,{});m.push(a)}return new c.Book(e,t,n,a,s,d,m)}async chapterParse(e,t,n,o,i,c){const s=await(0,a.getHtmlDOM)(e,i);t=s.querySelector(".bookname > h1:nth-child(1)").innerText.trim();const l=s.querySelector("#content");if(l){const{dom:e,text:n,images:o}=await(0,r.cleanDOM)(l,"TM");return{chapterName:t,contentRaw:l,contentText:n,contentHTML:e,contentImages:o,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}t.Shubaowa=u},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.c630shu=void 0;const o=n(73);t.c630shu=(0,o.mkRuleClass)({bookUrl:document.location.href,bookname:document.querySelector("#info > h1").innerText.trim(),author:document.querySelector("div.options > span.item:nth-child(1) > a").innerText.trim(),introDom:document.querySelector("#intro"),introDomPatch:e=>e,coverUrl:document.querySelector(".img_in > img").src,aList:document.querySelectorAll(".zjlist > dd > a"),getContent:e=>e.querySelector("#content"),contentPatch:e=>(e.innerHTML=e.innerHTML.replace(/恋上你看书网 WWW.630SHU.NET ，最快更新.+最新章节！/,""),e)})},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mkRuleClass=void 0;const o=n(6),r=n(14),a=n(8),i=n(9),c=n(7),s=n(15),l=n(34);t.mkRuleClass=function(e){const{bookUrl:t,bookname:n,author:u,introDom:d,introDomPatch:p,coverUrl:m,aList:h,getContentFromUrl:g,getContent:f,contentPatch:w}=e;return class extends s.BaseRuleClass{constructor(){super(),this.imageMode="TM"}async bookParse(){const[e,r,a]=await(0,l.introDomHandle)(d,p),s={};m&&(0,o.getImageAttachment)(m,this.imageMode,"cover-").then((e=>{s.cover=e})).catch((e=>i.log.error(e)));const g=[];let f=0;for(const e of Array.from(h)){f++;const o=e.innerText,r=e.href,a=!1,i=!1,s=new c.Chapter(t,n,r,f,o,a,i,null,null,null,this.chapterParse,this.charset,{bookname:n});g.push(s)}return new c.Book(t,n,u,e,r,s,g)}async chapterParse(e,t,n,o,i,c){let s;if(void 0!==g)s=await g(e,t,i);else if(void 0!==f){const t=await(0,a.getHtmlDOM)(e,i);s=f(t)}if(s){s=w(s);const{dom:e,text:n,images:o}=await(0,r.cleanDOM)(s,"TM");return{chapterName:t,contentRaw:s,contentText:n,contentHTML:e,contentImages:o,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}}},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Qingoo=void 0;const o=n(6),r=n(14),a=n(8),i=n(13),c=n(9),s=n(7),l=n(15),u=n(34);class d extends l.BaseRuleClass{constructor(){super(),this.imageMode="TM",this.charset="UTF-8"}async bookParse(){const e=document.location.href,t=document.querySelector(".title > dl > dd > h1").innerText.trim(),n=document.querySelector("#author").innerText.replace("作者：","").trim(),r=document.querySelector("#allDesc"),[a,i,l]=await(0,u.introDomHandle)(r),d={},p=document.querySelector(".title > dl > dt > img:nth-child(1)").src;p&&(0,o.getImageAttachment)(p,this.imageMode,"cover-").then((e=>{d.cover=e})).catch((e=>c.log.error(e)));const m=[],h=unsafeWindow.data,g=document.querySelector("#chapterItem")?.firstElementChild?.href,f=new URL(g);for(const n of h){const o=n.status,r=n.sn,a=n.name;f.searchParams.set("index",(r-1).toString());const i=f.toString(),c=!1,l=!1,u=new s.Chapter(e,t,i,r,a,c,l,null,null,null,this.chapterParse,this.charset,{});o||(u.status=s.Status.aborted),m.push(u)}return new s.Book(e,t,n,a,i,d,m)}async chapterParse(e,t,n,o,c,s){const l=await(0,a.getHtmlDOM)(e,c);t=l.querySelector("#content > h1").innerText.trim();const u=l.querySelector("#content");if(u){(0,i.rm)("div.header",!1,u),(0,i.rm)("h1",!1,u),(0,i.rm)("h6",!1,u);const{dom:e,text:n,images:o}=await(0,r.cleanDOM)(u,"TM");return{chapterName:t,contentRaw:u,contentText:n,contentHTML:e,contentImages:o,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}t.Qingoo=d},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tongrenquan=t.trxs=void 0;const o=n(73);t.trxs=()=>(0,o.mkRuleClass)({bookUrl:document.location.href,bookname:document.querySelector(".infos > h1").innerText.split("(")[0].trim(),author:document.querySelector(".date > span > a").innerText.trim(),introDom:document.querySelector(".infos > p"),introDomPatch:e=>e,coverUrl:document.querySelector(".pic > img").src,aList:document.querySelectorAll("div.book_list > ul.clearfix > li > a"),getContent:e=>e.querySelector(".read_chapterDetail"),contentPatch:e=>e}),t.tongrenquan=()=>(0,o.mkRuleClass)({bookUrl:document.location.href,bookname:document.querySelector(".infos > h1").innerText.split("(")[0].trim(),author:document.querySelector(".date > span").innerText.replace("作者：","").trim(),introDom:document.querySelector(".infos > p"),introDomPatch:e=>e,coverUrl:document.querySelector(".pic > img").src,aList:document.querySelectorAll("div.book_list > ul.clearfix > li > a"),getContent:e=>e.querySelector(".read_chapterDetail"),contentPatch:e=>e})},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Imiaobige=void 0;const o=n(6),r=n(14),a=n(8),i=n(9),c=n(7),s=n(15),l=n(34);class u extends s.BaseRuleClass{constructor(){super(),this.imageMode="TM",this.charset="UTF-8"}async bookParse(){const e=document.location.href.replace("/read/","/novel/").replace(/\/$/,".html"),t=await(0,a.getHtmlDOM)(e,this.charset),n=t.querySelector(".booktitle > h1").innerText.trim(),r=t.querySelector("#author > a").innerText.trim(),s=t.querySelector("#bookintro"),[u,d,p]=await(0,l.introDomHandle)(s),m={},h=t.querySelector("#bookimg > img").src;h&&(0,o.getImageAttachment)(h,this.imageMode,"cover-").then((e=>{m.cover=e})).catch((e=>i.log.error(e)));const g=[],f=document.querySelectorAll("#readerlists > ul");let w=0;for(let t=0;t<f.length;t++){const o=f[t],r=t+1,a=o.querySelector("h3").innerText.replace(n,"").trim();if(a.includes("最新章节"))continue;let i=0;const s=o.querySelectorAll("li > a");for(const t of Array.from(s)){w++,i++;const o=t.innerText.trim(),s=t.href,l=new c.Chapter(e,n,s,w,o,!1,!1,a,r,i,this.chapterParse,this.charset,{bookname:n});g.push(l)}}return new c.Book(e,n,r,u,d,m,g)}async chapterParse(e,t,n,o,i,c){const s=c.bookname,l=await(0,a.getHtmlDOM)(e,i);t=l.querySelector(".title > h1:nth-child(1)").innerText.trim();const u=l.querySelector("#content");if(u){u.innerHTML=u.innerHTML.replace(`<p>您可以在百度里搜索“${s} 妙笔阁(imiaobige.com)”查找最新章节！</p>`,"");const{dom:e,text:n,images:o}=await(0,r.cleanDOM)(u,"TM");return{chapterName:t,contentRaw:u,contentText:n,contentHTML:e,contentImages:o,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}t.Imiaobige=u},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.c256wxc=void 0;const o=n(73);t.c256wxc=(0,o.mkRuleClass)({bookUrl:document.location.href,bookname:document.querySelector(".art_tit").innerText.trim(),author:(document.querySelector("span.bookinfo:nth-child(1) > a")??document.querySelector("span.bookinfo:nth-child(1)")).innerText.replace(/^作者：/,"").trim(),introDom:document.querySelector(".infotype > p"),introDomPatch:e=>e,coverUrl:null,aList:document.querySelectorAll(".catalog > li > a"),getContent:e=>e.querySelector(".book_con"),contentPatch:e=>e})},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Lofter=void 0;const o=n(6),r=n(14),a=n(8),i=n(9),c=n(7),s=n(15);class l extends s.BaseRuleClass{constructor(){super(),this.imageMode="TM",this.concurrencyLimit=5}async bookParse(){const e=document.location.origin,t=JSON.parse('"'+unsafeWindow._ntes_ntit.replaceAll("%","\\")+'"'),n=t+"的Lofter",r=document.querySelector('meta[name="Description"]')?.getAttribute("content")?.replace(new RegExp(`^${t} - `),"")??null;let s=null;r&&(s=document.createElement("p"),s.innerText=r);const l={},u=document.querySelector('link[rel="shortcut icon"]')?.getAttribute("href");if(u){const e=new URL(u);e.search="";const t=e.toString();(0,o.getImageAttachment)(t,this.imageMode,"avatar-").then((e=>{l.cover=e})).catch((e=>i.log.error(e)))}const d=[],p=new Set,m=[],h=async e=>{i.log.info(`[chapter]正在抓取目录页：${e}`);const t=await(0,a.getHtmlDOM)(e,void 0),n=`a[href^="${[document.location.origin,"post"].join("/")}"]`;new Set(Array.from(t.querySelectorAll(n)).map((e=>e.href))).forEach((e=>p.add(e))),new Set(Array.from(t.querySelectorAll('a[href^="https://www.lofter.com/lpost"]')).map((e=>e.href))).forEach((e=>p.add(e)));const o=e=>{const t=new URL(e).searchParams.get("page")??"1";return Number(t)},r=o(e),c=t.querySelectorAll('a[href^="?page"]');for(const e of Array.from(c)){const t=e.href,n=new URL(t);n.searchParams.delete("t");const a=n.toString();o(t)!==r&&(m.includes(a)||(m.push(a),await h(t)))}};await h(document.location.href);let g=0;for(const o of Array.from(p)){const r=new c.Chapter(e,n,o,g,null,!1,!1,null,null,null,this.chapterParse,"UTF-8",{author:t});d.push(r),g++}return new c.Book(e,n,t,r,s,l,d)}async chapterParse(e,t,n,o,c,s){return new URL(e).pathname.startsWith("/lpost/")?async function(){i.log.debug(`[chapter]请求页面：${e}`);const n=await(0,a.ggetHtmlDOM)(e,c);t=n.querySelector("#title")?.innerText.trim();const o=n.querySelector("#m-cnt .long-text");if(o){const{dom:e,text:n,images:a}=await(0,r.cleanDOM)(o,"TM");return{chapterName:t,contentRaw:o,contentText:n,contentHTML:e,contentImages:a,additionalMetadate:null}}throw new Error(`[chapter]未发现内容，url：${e}`)}():async function(){i.log.debug(`[chapter]请求页面：${e}`);const n=await(0,a.getHtmlDOM)(e,c);t=n.querySelector("title")?.innerText.replace(new RegExp(`-${s.author}$`),"").replace("\n","").trim()??null;const o=[".ct .ctc",".main .content",".m-post .text"];let l;for(const e of o){const t=n.querySelector(e);if(null!==t){l=t;break}}if(l){const{dom:e,text:n,images:o}=await(0,r.cleanDOM)(l,"TM");return{chapterName:t,contentRaw:l,contentText:n,contentHTML:e,contentImages:o,additionalMetadate:null}}throw new Error(`[chapter]未发现内容，url：${e}`)}()}}t.Lofter=l},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Shubl=void 0;const o=n(5),r=n(6),a=n(14),i=n(8),c=n(13),s=n(9),l=n(7),u=n(15),d=n(34);class p extends u.BaseRuleClass{constructor(){super(),this.imageMode="TM",this.charset="UTF-8",this.concurrencyLimit=1,this.maxRunLimit=1}async bookParse(){const e=document.location.href,t=document.querySelector(".book-title > span").innerText.trim(),n=document.querySelector("div.username").innerText.trim(),o=document.querySelector(".book-brief"),[a,i,c]=await(0,d.introDomHandle)(o,(e=>(e.innerHTML=e.innerHTML.replace("简介：",""),e))),u={},p=document.querySelector(".book-img").src;p&&(0,r.getImageAttachment)(p,this.imageMode,"cover-").then((e=>{u.cover=e})).catch((e=>s.log.error(e))),u.tags=Array.from(document.querySelectorAll("div.row > span.tag")).map((e=>e.innerText.trim()));const m=[],h=Array.from(document.querySelectorAll("#chapter_list > div.chapter > div.chapter-title")).map((e=>e.innerText.trim())),g=document.querySelectorAll("#chapter_list > div.chapter > div.articles"),f=h.length;let w=0;for(let n=0;n<f;n++){const o=g[n],r=n+1,a=h[n];let i=0;const c=o.querySelectorAll("span.chapter_item");for(const n of Array.from(c)){w++,i++;const o=n.querySelector("a");if(o){const c=o.innerText.trim(),s=o.href,u=()=>2===n.childElementCount,d=()=>!(!u()||"unlock"!==n.querySelector("i")?.className),p=()=>3===document.querySelector("#header > div.container > div.right.pull-right")?.childElementCount,h=new l.Chapter(e,t,s,w,c,u(),d(),a,r,i,this.chapterParse,this.charset,{});!u()||p()&&d()||(h.status=l.Status.aborted),m.push(h)}}}return new l.Book(e,t,n,a,i,u,m)}async chapterParse(e,t,n,r,u,d){function p(e){let t=e.content;const n=e.keys,r=e.keys.length,a=e.accessKey.split(""),i=a.length,c=new Array;c.push(n[a[i-1].charCodeAt(0)%r]),c.push(n[a[0].charCodeAt(0)%r]);for(let e=0;e<c.length;e++){t=atob(t);const n=c[e],r=btoa(t.substr(0,16)),a=btoa(t.substr(16)),i=o.format.OpenSSL.parse(a);t=o.AES.decrypt(i,o.enc.Base64.parse(n),{iv:o.enc.Base64.parse(r),format:o.format.OpenSSL}),e<c.length-1&&(t=t.toString(o.enc.Base64),t=atob(t))}return t.toString(o.enc.Utf8)}const m="https://www.shubl.com/",h=e.split("/").slice(-1)[0];return n?async function(){if(r){async function n(e,t){const n=m+"chapter/ajax_get_image_session_code";s.log.debug(`[Chapter]请求 ${n} Referer ${t}`);const o=await(0,i.gfetch)(n,{method:"POST",headers:{Accept:"application/json, text/javascript, */*; q=0.01",Referer:t,Origin:document.location.origin,"X-Requested-With":"XMLHttpRequest"},responseType:"json"}).then((e=>e.response)).catch((e=>s.log.error(e)));if(1e5!==o.code)throw s.log.error(o),new Error(`下载 ${t} 失败`);const r=p({content:o.image_code,keys:o.encryt_keys,accessKey:o.access_key});return m+"chapter/book_chapter_image?chapter_id="+e+"&area_width=939.2&font=undefined&font_size=18&image_code="+r+"&bg_color_name=white&text_color_name=white"}const o=await n(h,e);s.log.debug(`[Chapter]请求 ${o} Referer ${e}`);const r=await(0,i.gfetch)(o,{method:"GET",headers:{Referer:e,Accept:"image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8"},responseType:"blob"}).then((e=>e.response)).catch((e=>s.log.error(e))),a=`vipCHapter${h}.png`,c=new l.AttachmentClass(o,a,"TM");r&&(c.imageBlob=r,c.status=l.Status.finished);const u=[c],d=document.createElement("img");d.src=a,d.alt=o;const g=document.createElement("div");return g.appendChild(d),{chapterName:t,contentRaw:g,contentText:`VIP章节，请打开HTML文件查看。\n![${o}](${a})`,contentHTML:g,contentImages:u,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}():async function(){const n=document.createElement("div"),o=await async function(e,t){const n=m+"chapter/ajax_get_session_code",o=m+"chapter/get_book_chapter_detail_info";s.log.debug(`[Chapter]请求 ${n} Referer ${t}`);const r=(await(0,i.gfetch)(n,{method:"POST",headers:{Accept:"application/json, text/javascript, */*; q=0.01","Content-Type":"application/x-www-form-urlencoded; charset=UTF-8",Referer:t,Origin:document.location.origin,"X-Requested-With":"XMLHttpRequest"},data:`chapter_id=${e}`,responseType:"json"}).then((e=>e.response)).catch((e=>s.log.error(e)))).chapter_access_key;s.log.debug(`[Chapter]请求 ${o} Referer ${t}`);const a=await(0,i.gfetch)(o,{method:"POST",headers:{Accept:"application/json, text/javascript, */*; q=0.01","Content-Type":"application/x-www-form-urlencoded; charset=UTF-8",Referer:t,Origin:document.location.origin,"X-Requested-With":"XMLHttpRequest"},data:`chapter_id=${e}&chapter_access_key=${r}`,responseType:"json"}).then((e=>e.response)).catch((e=>s.log.error(e)));if(1e5!==a.code)throw s.log.error(a),new Error(`下载 ${t} 失败`);return p({content:a.chapter_content,keys:a.encryt_keys,accessKey:r})}(h,e);n.innerHTML=o,(0,c.rm)(".chapter span",!0,n);const{dom:r,text:l,images:u}=await(0,a.cleanDOM)(n,"TM");return{chapterName:t,contentRaw:n,contentText:l,contentHTML:r,contentImages:u,additionalMetadate:null}}()}}t.Shubl=p},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Ujxs=void 0;const o=n(6),r=n(14),a=n(8),i=n(13),c=n(9),s=n(7),l=n(15),u=n(34);class d extends l.BaseRuleClass{constructor(){super(),this.imageMode="TM",this.charset="GBK"}async bookParse(){const e=document.location.origin+document.location.pathname.replace(/^\/read/,"/book"),t=document.querySelector("#smallcons > h1").innerText.trim(),n=document.querySelector("#smallcons > span:nth-child(3) > a").innerText.trim(),r=await(0,a.getHtmlDOM)(e,this.charset),i=r.querySelector("#bookintro"),[l,d,p]=await(0,u.introDomHandle)(i),m={},h=r.querySelector(".img > img")?.src;h&&(0,o.getImageAttachment)(h,this.imageMode,"cover-").then((e=>{m.cover=e})).catch((e=>c.log.error(e)));const g=document.querySelectorAll("#readerlist > ul > li"),f=[];let w=0,y=0,b=null,v=0;for(const n of Array.from(g))if(n.getAttribute("class"))y++,v=0,b=n.querySelector("h3")?.innerText.replace(t,"").trim()??null;else{const o=n.firstElementChild;w++,v++;const r=o.innerText,a=o.href,i=!1,c=!1,l=new s.Chapter(e,t,a,w,r,i,c,b,y,v,this.chapterParse,this.charset,{bookname:t});f.push(l)}return new s.Book(e,t,n,l,d,m,f)}async chapterParse(e,t,n,o,c,s){const l=(await(0,a.getHtmlDOM)(e,c)).querySelector(".read-content");if(l){(0,i.rm)("script",!0,l),["【悠久小説網ωωω.ＵＪХＳ.ｎｅｔ】，免费小说无弹窗免费阅读！","佰度搜索 【悠久小說網 ＷＷＷ.ＵＪХＳ．ＮＥＴ】 全集TXT电子书免费下载！"].forEach((e=>l.innerHTML=l.innerHTML.replaceAll(e,"")));const{dom:e,text:n,images:o}=await(0,r.cleanDOM)(l,"TM");return{chapterName:t,contentRaw:l,contentText:n,contentHTML:e,contentImages:o,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}t.Ujxs=d},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Haitangtxt=void 0;const o=n(14),r=n(8),a=n(13),i=n(9),c=n(7),s=n(15),l=n(34),u=n(82);class d extends s.BaseRuleClass{constructor(){super(),this.imageMode="TM"}async bookParse(){const e=document.querySelector("div.currency_head > h1 > a").href,t=e.split("/").slice(-2,-1)[0];i.log.debug(`[chapter]请求 ${e}`);const n=await(0,r.getHtmlDOM)(e,"UTF-8"),o=n.querySelector("div.cataloginfo > h3").innerText.trim(),s=n.querySelector(".infotype > p:nth-child(1) > a:nth-child(1)").innerText.trim(),u=n.querySelector(".intro"),[d,p,m]=await(0,l.introDomHandle)(u,(e=>((0,a.rm)("span:nth-child(1)",!1,e),e))),h=[],g=(()=>{const e=[],n=Number((()=>{const e=document.querySelector("div.page:nth-child(6)");if(e){const t=Array.from(e.childNodes).slice(-1)[0].textContent?.match(/第\d+\/(\d+)页/);if(t)return t[1]}})());for(let o=1;o<=n;o++){const n=[document.location.origin,document.location.pathname.split("/")[1],`${t}_${o}`].join("/")+"/";e.push(n)}return e})();let f=[];for(const e of g){i.log.debug(`[chapter]请求 ${e}`);const t=(await(0,r.getHtmlDOM)(e,"UTF-8")).querySelector("ul.chapters");t?.childElementCount&&(f=f.concat(Array.from(t.children)))}const w=f.filter((e=>void 0!==e));let y=0;for(const t of w){y++;const n=t.firstElementChild,r=n.innerText,a=n.href,i=!1,s=!1,l=new c.Chapter(e,o,a,y,r,i,s,null,null,null,this.chapterParse,"UTF-8",{});h.push(l)}return new c.Book(e,o,s,d,p,{},h)}async chapterParse(e,t,n,a,c,s){function l(){function e(e,t){let n=Math.ceil((t+1)%r);return n=Math.ceil(e-n),n}const t=p.getElementsByTagName("meta")[7].getAttribute("content"),n=p.querySelector("#articlecontent");let o,r;const a=p.getElementsByTagName("script")[1].innerText.trim().match(/"(http.+)"/);if(a&&(o=a[1],r=Number(new URL(o).searchParams.get("code"))),t){const o=atob(t).split(/[A-Z]+%/).map((e=>Number(e))),r=[];if(Array.from(p.querySelectorAll("script")).filter((e=>e.src.includes("/17mb/js/article.js"))).length){for(let t=0;t<o.length;t++)r[e(o[t],t)]=n.childNodes[t];for(const e of r)1===e.nodeType&&(e.innerText.includes("本章尚未完结,请")||e.innerText.includes("本章已阅读完毕")||m.appendChild(e));return}}for(const e of Array.from(n.childNodes))e.innerText.includes("本章尚未完结,请")||e.innerText.includes("本章已阅读完毕")||m.appendChild(e)}let d=e,p=await(0,r.getHtmlDOM)(e,c);const m=document.createElement("div");let h=!1;do{l();const e=p.querySelector(".novelbutton .p1.p3 > a:nth-child(1)").href;new URL(e).pathname.includes("_")?e!==d?h=!0:(i.log.error("网站页面出错，URL： "+d),h=!1):h=!1,h&&(d=e,p=await(0,r.getHtmlDOM)(e,c))}while(h);if(m){const{dom:e,text:n,images:r}=await(0,o.cleanDOM)(m,"TM",{keepImageName:!0}),a=document.createElement("div");a.innerHTML=(0,u.replaceHaitangtxtImage)(m.innerHTML);const{dom:i,text:c,images:s}=await(0,o.cleanDOM)(a,"TM",{keepImageName:!0}),l=document.createElement("style");l.innerHTML=".hide { display: none; }",e.className="hide";const d=document.createElement("div");return d.appendChild(l),d.appendChild(e),d.appendChild(i),{chapterName:t,contentRaw:m,contentText:c,contentHTML:d,contentImages:r,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}t.Haitangtxt=d},(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.replaceHaitangtxtImage=void 0,t.replaceHaitangtxtImage=function(e){let t=e;for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e)){const o=n[e],r=`<img src="${document.location.origin}/wzbodyimg/${e}">`;t=t.replaceAll(r,o)}return t};const n={}},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Longmabook=void 0;const o=n(6),r=n(14),a=n(8),i=n(13),c=n(9),s=n(7),l=n(15),u=n(34);class d extends l.BaseRuleClass{constructor(){super(),this.imageMode="TM",this.concurrencyLimit=5}async bookParse(){if(!Boolean(document.querySelector('a[href="/?act=signinlst"]')))throw alert("小说下载器：海棠文化线上文学城需登录后方可下载！请登录帐号。"),new s.ExpectError("海棠文化线上文学城需登录后方可浏览！");const e=this,t=document.location.href,n=document.querySelector("#mypages > div:nth-child(8) > div:nth-child(1) > h4").innerText,r=document.querySelector("#writerinfos > a").innerText,l=new URLSearchParams(document.location.search),d=l.get("bookid");if(!d)throw new Error("获取 bookid 出错");const p=l.get("bookwritercode"),m=document.querySelector("#mypages > div:nth-child(8) > div:nth-child(1)")?.cloneNode(!0);let[h,g,f]=[null,null,null];m&&((0,i.rm)("div",!0,m),(0,i.rm)("textarea",!0,m),(0,i.rm)("font",!0,m),(0,i.rm)("b",!0,m),(0,i.rm)("span",!0,m),(0,i.rm)("h4",!0,m),(0,i.rm)("img",!0,m),m.innerHTML=m.innerHTML.replace(/【作品编号：\d+】|【作品編號：\d+】/,"").replace("\n)\n",""),[h,g,f]=await(0,u.introDomHandle)(m,void 0));const w={},y=document.querySelector("#mypages > div:nth-child(8) > div:nth-child(1) > img")?.src.replace("_s.","_b.");y&&(0,o.getImageAttachment)(y,this.imageMode,"cover-").then((e=>{w.cover=e})).catch((e=>c.log.error(e))),w.tags=document.querySelector('#mypages > div:nth-child(8) > div:nth-child(1) > font[color="#800080"]')?.innerText.split("/").map((e=>e.trim()))??[];const b=[],v=await async function(){const t=document.location.origin+"/showbooklist.php";let n=!1,o=1,r=0;const i={ebookid:d,pages:o.toString(),showbooklisttype:"1"};do{c.log.info(`[book]请求章节目录中，page: ${o}`);const s=await(0,a.getHtmlDOM)(t,e.charset,{headers:{"content-type":"application/x-www-form-urlencoded; charset=UTF-8","x-requested-with":"XMLHttpRequest"},body:new URLSearchParams(i).toString(),method:"POST",mode:"cors",credentials:"include"});if(s.documentElement.innerText.includes("章節數量較多，採分頁顯示")){const e=Array.from(s.querySelectorAll(".uk-list.uk-list-divider > li")).filter((e=>e.innerHTML.includes("換頁：&nbsp;&nbsp;")))[0],t=Array.from(e.querySelectorAll("a")).map((e=>{const t=e.getAttribute("onclick")?.match(/\('\d+','(\d+)'\)/);if(2===t?.length)return Number(t[1])})).filter((e=>e));r=Math.max(...t),o++,1!==o&&o<=r?(i.pages=o.toString(),n=!0):n=!1}else n=!1;const l=Array.from(s.querySelectorAll(".uk-list.uk-list-divider > li")).filter((e=>{const t=["章節數量較多，採分頁顯示","換頁：&nbsp;&nbsp;"];for(const n of t)if(e.innerHTML.includes(n))return!1;return!0}));l.push(...l)}while(n);return[]}();let x=0,T=0,M=null,A=0;for(const e of v){const o=e.querySelector("span")?.getAttribute("uk-icon");if("folder"===o){const t=e.querySelector("b > font")?.innerText.trim();t!==M&&(M=t,T++,A=0)}else if("file-text"===o){x++,A++;const o=e.querySelector("a"),r=o?.innerText.trim(),a=o?.href,i=Boolean(e.innerText.match(/\$[\d\.]+/));if(a&&r){const e=new s.Chapter(t,n,a,x,r,i,null,M,T,A,this.chapterParse,this.charset,{bookId:d,bookwritercode:p});b.push(e)}}}return new s.Book(t,n,r,h,g,w,b)}async chapterParse(e,t,n,o,s,l){const u=this,d=await(0,a.getHtmlDOM)(e,s);if(d.body.innerHTML.includes("您目前正在海棠清水區，只能觀看清水認證文章。"))throw window.stopFlag||(alert("您目前正在海棠清水區，只能觀看清水認證文章。請使用海棠其他網址進入。"),window.stopFlag=!0),new Error("您目前正在海棠清水區，只能觀看清水認證文章。請使用海棠其他網址進入。");const p={chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null};if(d.querySelector("#paperbuybtm"))return c.log.info(`[chapter]付费章节 ${t} 未购买。`),p;const m=document.createElement("div");let h="",g=[];const[f,w,y]=await async function(){const e=document.createElement("div");Array.from(d.querySelectorAll("#mypages > div:nth-child(10) > div:nth-child(2) > div:nth-child(6) > ul > li:nth-child(14) > img")).forEach((t=>e.appendChild(t.cloneNode(!0))));const{dom:t,text:n,images:o}=await(0,r.cleanDOM)(e,u.imageMode);return[t,n,o]}(),[b,v,x]=await async function(){const[t,n]=(()=>{const e=Array.from(d.querySelectorAll("script")).filter((e=>e.innerText.includes("vercodechk")))[0].innerText.match(/{\spaperid:\s'(\d+)',\svercodechk:\s'(\w+)'}/);if(3===e?.length){const[t,n]=e.slice(1);return[t,n]}return[null,null]})();if(t&&n){const o=document.location.origin+"/showpapercolor.php";c.log.debug(`[chapter]正在请求${o}`);const a=await fetch(o,{credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8","X-Requested-With":"XMLHttpRequest","Cache-Control":"max-age=0"},referrer:e,body:new URLSearchParams({paperid:t,vercodechk:n}).toString(),method:"POST",mode:"cors"}),s=document.createElement("div");s.innerHTML=await a.text(),(0,i.rm)('img[src="/images/fullcolor.png"]',!0,s);const{dom:l,text:d,images:p}=await(0,r.cleanDOM)(s,u.imageMode);return[l,d,p]}return[null,null,null]}(),[T,M,A]=await async function(){const e=d.querySelector("#colorpanelwritersay");if(e){const{dom:t,text:n,images:o}=await(0,r.cleanDOM)(e,u.imageMode);return[t,n,o]}return[null,null,null]}();if(f&&(m.appendChild(f),h+=w+"\n\n",y&&(g=g.concat(y))),b&&(m.appendChild(b),h+=v,x&&(g=g.concat(x))),T){const e=document.createElement("hr");T.className="authorSay",m.appendChild(e),m.appendChild(T),h+="\n\n"+"-".repeat(20)+"\n\n"+M,A&&(g=g.concat(A))}return{chapterName:t,contentRaw:m,contentText:h,contentHTML:m,contentImages:g,additionalMetadate:null}}}t.Longmabook=d},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.environments=void 0;const o=n(12),r=n(13),a=n(11);function i(e){const t=window[e],n=t.toString().length,o=t.prototype,r=/function \w+\(\) {\n?(\s+)?\[native code\]\n?(\s+)?}/;try{if(void 0===o||Boolean(t.toString().match(r)))return[!0,n].join(", ")}catch{return[!0,n].join(", ")}return[!1,n].join(", ")}t.environments={当前时间:(new Date).toISOString(),当前页URL:document.location.href,当前页Referrer:document.referrer,浏览器UA:navigator.userAgent,浏览器语言:navigator.languages,设备运行平台:navigator.platform,设备内存:navigator.deviceMemory??"",CPU核心数:navigator.hardwareConcurrency,eval:i("eval"),fetch:i("fetch"),XMLHttpRequest:i("XMLHttpRequest"),window:Object.keys(window).length,localStorage:(0,r.storageAvailable)("localStorage"),sessionStorage:(0,r.storageAvailable)("sessionStorage"),Cookie:navigator.cookieEnabled,doNotTrack:navigator.doNotTrack??0,ScriptHandler:o._GM_info.scriptHandler,"ScriptHandler version":o._GM_info.version,"Novel-downloader version":o._GM_info.script.version,enableDebug:a.enableDebug.value}},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const o=n(13);t.init=function(){window.downloading=!1,window.customStorage=new o.LocalStorageExpired,window.stopFlag=!1}},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(20),r=n(9);globalThis.Vue=o,globalThis.Function=new Proxy(Function,{construct(e,t){const n=t[t.length-1];return n.includes("Vue")&&n.includes("_Vue")?(r.log.debug("Function hook:"+n),function(){const o=new e(`return (${(()=>Object.getOwnPropertyNames(window).filter((e=>window[e]===window))).toString()})()`)(),r=[];r.push(...o),t[t.length-1]="with (window) {"+n+"}",r.push(...t);const a=new e(...r);return new Proxy(a,{apply(e,t,n){const r=[];return o.forEach((()=>r.push(window))),r.push(...n),Reflect.apply(e,window,r)}})}()):new e(...t)}})},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.init=void 0;const o=n(88),r=n(94),a=n(105),i=n(93),c=n(19),s=n(92),l=n(102);t.init=function(){customElements.define("dialog-ui",a.default),document.body.appendChild(o.el),document.body.appendChild(c.el),document.body.appendChild(s.el),document.head.appendChild(o.style),document.head.appendChild(c.style),document.head.appendChild(s.style),document.head.appendChild(i.style),document.head.appendChild(r.style),document.head.appendChild(l.style)}},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vm=t.el=t.style=void 0;const o=n(20),r=n(21),a=n(12),i=n(9),c=n(3),s=n(89),l=n(11),u=n(90),d=n(91),p=n(92);t.style=(0,r.createStyle)(d.default,"button-div-style"),t.el=(0,r.createEl)("<div></div>"),t.vm=o.createApp({data:()=>({imgStart:l.iconStart0,imgSetting:l.iconSetting,isSettingSeen:"Greasemonkey"!==a._GM_info.scriptHandler,imgJump:l.iconJump,uiObj:(0,s.getUI)()}),methods:{startButtonClick(){if(window.downloading)return void alert("正在下载中，请耐心等待……");const e=this;e.imgStart=l.iconStart1,async function(){const e=await(0,c.getRule)();await e.run()}().then((()=>{e.imgStart=l.iconStart0})).catch((e=>i.log.error(e)))},settingButtonClick(){p.vm.openSetting()},jumpButtonClick(){this.uiObj.jumpFunction()}},template:u.default}).mount(t.el)},(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getUI=void 0;const n={type:"error"};t.getUI=function(){switch(document.location.host){case"m.shuquge.com":{const e=document.location.pathname.split("/").slice(-1)[0].match(/^(\d+)/);if(!e)return n;const t=e[0];return{type:"jump",jumpFunction(){document.location.href=`https://www.shuquge.com/txt/${t}/index.html`}}}case"m.xinwanben.com":return{type:"jump",jumpFunction(){document.location.host="www.xinwanben.com"}};default:return{type:"download"}}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o});const o='<div class="button-div" id="button-div"> <div v-if="uiObj.type !== \'error\'"> <div class="jump" v-if="uiObj.type === \'jump\'"> <button class="jump"> <img class="jump" v-bind:src="imgJump" v-on:click="jumpButtonClick"/> </button> </div> <div class="download" v-if="uiObj.type === \'download\'"> <button class="start"> <img class="start" v-bind:src="imgStart" v-on:click="startButtonClick"/> </button> <button class="setting" v-if="isSettingSeen"> <img class="setting" v-bind:src="imgSetting" v-on:click="settingButtonClick"/> </button> </div> </div> </div> '},(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>c});var o=n(23),r=n.n(o),a=n(24),i=n.n(a)()(r());i.push([e.id,".button-div {\n  position: fixed;\n  top: 15%;\n  right: 5%;\n  z-index: 5000;\n}\n.button-div button {\n  border-style: none;\n  text-align: center;\n  vertical-align: baseline;\n  background-color: rgba(128, 128, 128, 0.2);\n  padding: 3px;\n  border-radius: 12px;\n  min-width: auto;\n  min-height: auto;\n}\n.button-div img.start,\n.button-div img.jump {\n  height: 2em;\n}\n.button-div img.setting {\n  height: 1em;\n}\n",""]);const c=i},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vm=t.el=t.style=void 0;const o=n(20),r=n(1),a=n(21),i=n(13),c=n(9),s=n(7),l=n(11),u=n(93),d=n(99),p=n(100),m=n(101),h=n(102);t.style=(0,a.createStyle)(p.default),t.el=(0,a.createEl)('<div id="setting"></div>'),t.vm=o.createApp({name:"nd-setting",components:{"filter-tab":u.default,"log-ui":d.default,"test-ui":h.default},setup(e,t){const n=o.reactive({});let a={};const d=[{key:"null",value:"不使用自定义保存参数",options:{}},{key:"chapter_name",value:"将章节名称格式修改为 第xx章 xxxx",options:{getchapterName:e=>e.chapterName?`第${e.chapterNumber.toString()}章 ${e.chapterName}`:`第${e.chapterNumber.toString()}章`}},{key:"txt_space",value:"txt文档每个自然段前加两个空格",options:{genChapterText:(e,t)=>`## ${e}\n\n${t=t.split("\n").map((e=>""===e.trim()?e:e.replace(/^/,"    "))).join("\n")}\n\n`}},{key:"reverse_chapters",value:"保存章节时倒序排列",options:{chapterSort:(e,t)=>e.chapterNumber>t.chapterNumber?-1:e.chapterNumber===t.chapterNumber?0:e.chapterNumber<t.chapterNumber?1:0}}];n.enableDebug=l.enableDebug.value,n.chooseSaveOption="null",n.enableTestPage=!1,o.provide("getFilterSetting",(()=>n.filterSetting?n.filterSetting:void 0));const p=o.ref("false"),m=o.ref("tab-1"),h=e=>{!0===e?a=(0,i.deepcopy)(n):Object.assign(n,a),p.value="false"};return{openStatus:p,currentTab:m,openSetting:()=>{a=(0,i.deepcopy)(n),p.value="true"},closeSetting:h,closeAndSaveSetting:async()=>{var e;h(!0),await(0,i.sleep)(30),"boolean"==typeof(e=(0,i.deepcopy)(n)).enableDebug&&(e.enableDebug?c.log.setLevel("trace"):c.log.setLevel("info"),l.enableDebug.value=e.enableDebug,e.enableDebug&&(0,r.debug)(),c.log.info(`[Init]enableDebug: ${l.enableDebug.value}`)),unsafeWindow.saveOptions=(()=>{const e=d.find((e=>e.key===n.chooseSaveOption));return e?e.options:d[0].options})(),function(){if(e.filterSetting)if("null"===e.filterSetting.filterType)unsafeWindow.chapterFilter=void 0;else{const t=(0,u.getFilterFunction)(e.filterSetting.arg,e.filterSetting.functionBody);if(t){const e=e=>e.status!==s.Status.aborted&&t(e);unsafeWindow.chapterFilter=e}}}(),c.log.info("[Init]自定义设置："+JSON.stringify(n))},saveFilter:e=>{n.filterSetting=(0,i.deepcopy)(e)},setting:n,saveOptions:d}},template:m.default}).mount(t.el)},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.style=t.getFilterFunction=t.getFunctionBody=t.filterOptionDict=void 0;const o=n(20),r=n(21),a=n(94),i=n(97),c=n(98);function s(e){return`return (${e.toString()})(arg)`}t.filterOptionDict={null:{raw:e=>e=>!0,description:"<p>不应用任何过滤器（默认）</p>",abbreviation:"无"},number:{raw:e=>{if(/^[\s\d\-,，]+$/.test(e))return t=>{const n=t.chapterNumber;return e.split(/,|，/).map((e=>e.replace(/\s/g,"").trim())).map((e=>function(e,t){switch(!0){case/^\d+$/.test(e):{const n=e.match(/^(\d+)$/);return 2===n?.length&&Number(n[1])===t}case/^\d+\-\d+$/.test(e):{const n=e.match(/^(\d+)\-(\d+)$/);if(3===n?.length){const e=n.map((e=>Number(e)));if(t>=e[1]&&t<=e[2])return!0}return!1}case/^\d+\-$/.test(e):{const n=e.match(/^(\d+)\-$/);return 2===n?.length&&t>=Number(n[1])}case/^\-\d+$/.test(e):{const n=e.match(/^\-(\d+)$/);return 2===n?.length&&t<=Number(n[1])}default:return!1}}(e,n))).some((e=>!0===e))}},description:"<p>基于章节序号过滤，章节序号可通过章节标题悬停查看。</p><p>支持以下格式：13, 1-5, 2-, -89。可通过分号（,）使用多个表达式。</p>",abbreviation:"章节序号"},baseOnString:{raw:e=>t=>t&&t.chapterName?.includes(e)||!1,description:"<p>过滤出所有包含过滤条件字符的章节</p>",abbreviation:"章节标题"}},t.getFunctionBody=s,t.getFilterFunction=function(e,t){const n=new Function("arg",t)(e);return"function"==typeof n?n:void 0},t.default=o.defineComponent({components:{"chapter-list":a.default},emits:["filterupdate"],setup(e,{emit:n}){const r=o.ref(""),a=o.ref(!0),i=o.ref("null"),c=Object.entries(t.filterOptionDict),l=o.computed((()=>s(t.filterOptionDict[i.value].raw))),u=o.computed((()=>t.filterOptionDict[i.value].description)),d=o.computed((()=>({arg:r.value,hiddenBad:a.value,filterType:i.value,functionBody:l.value})));o.provide("filterSetting",d),o.watch(d,(()=>{n("filterupdate",d.value)}),{deep:!0});const p=o.inject("getFilterSetting");return o.onMounted((()=>{const e=p();e&&(r.value=e.arg,a.value=e.hiddenBad,i.value=e.filterType)})),{arg:r,hiddenBad:a,filterType:i,filterOptionList:c,filterDescription:u}},template:c.default}),t.style=(0,r.createStyle)(i.default)},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.style=void 0;const o=n(20),r=n(21),a=n(7),i=n(3),c=n(16),s=n(95),l=n(96),u=n(93);t.style=(0,r.createStyle)(l.default),t.default=o.defineComponent({name:"ChapterList",setup(e,t){const n=o.reactive([]),r=o.ref(!0);o.onMounted((async()=>{if(0===n.length){const e=await async function(){if(window._sections)return window._sections;{const e=await(0,i.getRule)(),t=await e.bookParse();return window._book=t,window._sections=(0,c.getSectionsObj)(t.chapters),window._sections}}();Object.assign(n,e)}r.value=!1}));const s=o.inject("filterSetting"),l=e=>{if(e.status===a.Status.aborted)return!1;if(s.value){const t=(0,u.getFilterFunction)(s.value.arg,s.value.functionBody);if("function"==typeof t)return t(e)}return!0},d=e=>!s.value.hiddenBad||!1!==l(e);return{sectionsObj:n,loading:r,filter:l,warningFilter:e=>!0===e.isVIP&&!0!==e.isPaid,isChapterDisabled:e=>!e?.chapterUrl,isChapterSeen:d,isSectionSeen:e=>e.chpaters.some((e=>!0===d(e)))}},template:s.default})},(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o});const o='<div> <div v-if="loading"> <div class="chapter-list-loading"> <h2>正在载入章节列表中，请耐心等待……</h2> </div> </div> <div class="chapter-list" v-else> <div v-for="sectionObj in sectionsObj" v-show="isSectionSeen(sectionObj)" v-bind:key="sectionObj.sectionNumber" class="section"> <h3 class="section-label" v-if="sectionObj.sectionName"> {{ sectionObj.sectionName }} </h3> <div v-for="chapter in sectionObj.chpaters" v-show="isChapterSeen(chapter)" v-bind:key="chapter.chapterNumber" class="chapter" v-bind:class="{\n              good: this.filter(chapter),\n              bad: !this.filter(chapter),\n              warning: this.warningFilter(chapter)\n            }" v-bind:title="chapter.chapterNumber"> <a v-bind:href="chapter.chapterUrl" v-bind:class="{\n                disabled: this.isChapterDisabled(chapter),\n              }" target="_blank" rel="noopener noreferrer">{{ chapter.chapterName }}</a> </div> </div> </div> </div> '},(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>c});var o=n(23),r=n.n(o),a=n(24),i=n.n(a)()(r());i.push([e.id,":root {\n  --good-chapter-color: #41b883;\n  --bad-chapter-color: #e73838;\n  --warning-chapter-color: #ff9900;\n}\ndiv.chapter-list-loading {\n  padding-top: 5em;\n  padding-bottom: 5em;\n  text-align: center;\n}\ndiv.chapter-list {\n  max-height: 200px;\n  overflow-y: scroll;\n}\ndiv.chapter-list .section {\n  margin-top: 1.5em;\n  display: grid;\n  grid-template-columns: 32% 32% 32%;\n}\ndiv.chapter-list .section > h3:first-child {\n  grid-column-end: span 3;\n  text-align: center;\n}\ndiv.chapter-list .section > div.chapter {\n  text-align: center;\n  padding-top: 0.5em;\n  padding-bottom: 0.3em;\n  padding-left: 23px;\n  padding-right: 20px;\n  border: 1px solid #d9d9d9;\n  border-radius: 5px;\n  margin-left: 10px;\n  margin-top: 5px;\n  margin-right: 0;\n  margin-bottom: 0;\n}\ndiv.chapter-list .section a.disabled {\n  pointer-events: none;\n  cursor: default;\n}\ndiv.chapter-list .section a {\n  text-decoration: none;\n}\ndiv.chapter-list div.chapter.good {\n  background: var(--good-chapter-color);\n}\ndiv.chapter-list div.chapter.bad {\n  background: var(--bad-chapter-color);\n}\ndiv.chapter-list div.chapter.good.warning {\n  background: var(--warning-chapter-color);\n}\ndiv.chapter-list div.chapter.bad a,\ndiv.chapter-list div.chapter.good a {\n  color: white;\n}\n.nd-setting-body span.good {\n  color: var(--good-chapter-color);\n}\n.nd-setting-body span.bad {\n  color: var(--bad-chapter-color);\n}\n.nd-setting-body span.warning {\n  color: var(--warning-chapter-color);\n}\n",""]);const c=i},(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>c});var o=n(23),r=n.n(o),a=n(24),i=n.n(a)()(r());i.push([e.id,".filter-setting {\n  padding-top: 0.4em;\n  padding-bottom: 0.8em;\n  text-align: center;\n}\n.filter-input + .filter-setter {\n  margin-top: 1em;\n}\n.filter-description {\n  font-size: larger;\n  color: cornflowerblue;\n}\n",""]);const c=i},(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o});const o='<div> <div class="filter-setting"> <div v-if="filterType !== \'null\'" class="filter-input"> <p>请输入过滤的条件：<input type="text" v-model="arg"/></p> </div> <div class="filter-setter"> <div> <span>当前过滤方法：</span> <select v-model="filterType"> <option v-for="filterOption in filterOptionList" v-bind:value="filterOption[0]"> {{ filterOption[1]["abbreviation"] }} </option> </select> </div> <input type="checkbox" id="hiddenBad" v-model="hiddenBad"/> <label for="hiddenBad">只显示符合条件章节</label> <div class="filter-description" v-html="filterDescription"></div> <div v-if="false"> <span class="good"></span> <span class="warning"></span> <span class="bad"></span> </div> </div> </div> <chapter-list/> </div> '},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(20),r=n(9);t.default=o.defineComponent({name:"LogUI",setup(e,t){const n=o.ref("");let a;return o.onMounted((()=>{n.value=(0,r.getLogText)(),a=globalThis.setInterval((()=>{n.value=(0,r.getLogText)()}),100)})),o.onUnmounted((()=>{a&&globalThis.clearInterval(a)})),{logText:n}},template:'<div class="log"><pre v-html="logText" id="novel-downloader-log"></per></div>'})},(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>c});var o=n(23),r=n.n(o),a=n(24),i=n.n(a)()(r());i.push([e.id,'.nd-setting-body input[type="checkbox"],\n.nd-setting-body input[type="radio"],\n.nd-setting-body input[type="text"] {\n  position: static;\n  opacity: 1;\n  all: revert;\n}\n.nd-setting-body {\n  background: #e0e0e0;\n  padding: 1em;\n  border-top-right-radius: 3px;\n}\n.nd-setting-body hr {\n  margin-top: 0.8em;\n  margin-bottom: 0.8em;\n}\n\n.tab-button {\n  padding: 6px 10px;\n  border-top-left-radius: 3px;\n  border-top-right-radius: 3px;\n  border: 1px solid #ccc;\n  cursor: pointer;\n  background: #f0f0f0;\n  margin-bottom: -1px;\n  margin-right: -1px;\n}\n.tab-button:hover {\n  background: #e0e0e0;\n}\n.tab-button.active {\n  background: #e0e0e0;\n}\n\n.nd-setting-footer {\n  background: #e0e0e0;\n  padding-bottom: 0.7em;\n  text-align: center;\n  border-bottom-left-radius: 3px;\n  border-bottom-right-radius: 3px;\n}\n.nd-setting-footer > button {\n  all: revert;\n}\n\n/* 彩色斜纹 来自：https://www.zhangxinxu.com/wordpress/2021/05/css-html-hr/ */\n.hr-twill-colorful {\n  all: revert;\n  border: 0;\n  padding: 3px;\n  background: linear-gradient(135deg, red, orange, green, blue, purple);\n  --mask-image: repeating-linear-gradient(\n    135deg,\n    #000 0px,\n    #000 1px,\n    transparent 1px,\n    transparent 6px\n  );\n  -webkit-mask-image: var(--mask-image);\n  mask-image: var(--mask-image);\n}\n/* 两头虚 来自：https://www.zhangxinxu.com/wordpress/2021/05/css-html-hr/ */\n.hr-edge-weak {\n  all: revert;\n  border: 0;\n  padding-top: 1px;\n  background: linear-gradient(to right, transparent, #d0d0d5, transparent);\n}\n\n/* 日志页面 */\n#novel-downloader-log {\n  max-height: 300px;\n  overflow: scroll;\n}\n',""]);const c=i},(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o});const o='<div> <dialog-ui dialog-title="设置" v-bind:status="openStatus" v-on:dialogclose="closeSetting" v-if="openStatus === \'true\'"> <div class="nd-setting"> <div class="nd-setting-tab"> <button v-bind:class="[\'tab-button\', { active: currentTab === \'tab-1\'}]" v-on:click="currentTab = \'tab-1\'"> 基本设置 </button> <button v-bind:class="[\'tab-button\', { active: currentTab === \'tab-2\'}]" v-on:click="currentTab = \'tab-2\'"> 自定义筛选条件 </button> <button v-if="setting.enableTestPage" v-bind:class="[\'tab-button\', { active: currentTab === \'tab-3\'}]" v-on:click="currentTab = \'tab-3\'"> 抓取测试 </button> <button v-if="setting.enableTestPage" v-bind:class="[\'tab-button\', { active: currentTab === \'tab-4\'}]" v-on:click="currentTab = \'tab-4\'"> 日志 </button> </div> <div class="nd-setting-body"> <div id="nd-setting-tab-1" class="tab-page" v-show="currentTab === \'tab-1\'"> <div> <input type="checkbox" id="debug" v-model="setting.enableDebug"/> <label for="debug">启用调式模式。（输出更详细日志）</label> <input type="checkbox" id="test-page" v-model="setting.enableTestPage"/> <label for="test-page">启用测试视图</label> </div> <hr class="hr-twill-colorful"/> <div> <h3>自定义保存参数</h3> <ul> <li v-for="item of saveOptions"> <input type="radio" v-bind:id="item.key" v-bind:value="item.key" v-model="setting.chooseSaveOption"/> <label v-bind:for="item.key">{{ item.value }}</label> </li> </ul> </div> </div> <div id="nd-setting-tab-2" class="tab-page" v-show="currentTab === \'tab-2\'"> <filter-tab v-on:filterupdate="saveFilter"/> </div> <div v-if="setting.enableTestPage" id="nd-setting-tab-3" class="tab-page" v-show="currentTab === \'tab-3\'"> <test-ui></test-ui> </div> <div v-if="setting.enableTestPage" id="nd-setting-tab-4" class="tab-page" v-show="currentTab === \'tab-4\'"> <log-ui></log-ui> </div> </div> <div class="nd-setting-footer"> <button v-on:click="closeAndSaveSetting">Save</button> <button v-on:click="closeSetting">Cancel</button> </div> </div> </dialog-ui> </div> '},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.style=void 0;const o=n(20),r=n(21),a=n(13),i=n(7),c=n(11),s=n(103),l=n(104);t.default=o.defineComponent({name:"TestUI",setup(e,t){const n=o.reactive({}),r=o.reactive({});async function s(e){const t=window._book;return t?(Object.assign(n,t),t):e>0?(await(0,a.sleep)(2**(c.retryLimit-e)*500),s(e)):void 0}const l=o.reactive({});return o.onMounted((async()=>{if(await s(c.retryLimit),n){const e=await async function(e){const t=e.chapters,n=t[Math.min(17,t.length)];return await n.init(),n}(n);Object.assign(r,e);const t={封面:n.additionalMetadate?.cover?.url??"",题名:n.bookname??"None",作者:n.author??"None",网址:n.bookUrl,简介:n.introductionHTML??""};Object.assign(l,t)}})),{metaData:l,getData:function(e,t){return"封面"===e?`<img src="${t}">`:"简介"===e?t.outerHTML:"网址"===e?`<a href="${t}">${t}</a>`:t},chapter:r,isSeenChapter:function(e){return e.status===i.Status.finished},isChapterFailed:function(e){return e.status===i.Status.failed}}},template:s.default}),t.style=(0,r.createStyle)(l.default)},(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o});const o='<div> <div id="test-page-div"> <h2>元数据</h2> <table> <tbody> <tr v-for="(value, key) in metaData"> <td>{{ key }}</td> <td v-html="getData(key, value)"></td> </tr> </tbody> </table> <hr class="hr-edge-weak"/> <h2>章节测试</h2> <div v-if="this.isSeenChapter(chapter)"> <h4> <a v-bind:href="chapter.chapterUrl" target="_blank" rel="noopener noreferrer">{{ chapter.chapterName }}</a> </h4> <div class="chapter" v-html="chapter.contentHTML.outerHTML"></div> </div> <div v-else> <p v-if="this.isChapterFailed(chapter)">章节加载失败！</p> <p v-else>正在加载章节中……</p> </div> </div> </div> '},(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>c});var o=n(23),r=n.n(o),a=n(24),i=n.n(a)()(r());i.push([e.id,"#test-page-div {\n  max-height: 300px;\n  overflow-y: scroll;\n}\n#test-page-div table {\n  text-align: center;\n}\n#test-page-div td {\n  all: revert;\n  padding-top: 0.3em;\n}\n#test-page-div td > img {\n  max-height: 15em;\n}\n#test-page-div tr > td:nth-child(1) {\n  font-weight: bold;\n  min-width: 7em;\n}\n#test-page-div tr > td:nth-child(2) div,\n#test-page-div tr > td:nth-child(2) p {\n  text-align: left;\n}\n#test-page-div hr {\n  margin-top: 1.5em;\n  margin-bottom: 1.5em;\n}\n#test-page-div h2 {\n  text-align: center;\n  margin-bottom: 1.3em;\n}\n#test-page-div h4 {\n  text-align: center;\n}\n#test-page-div .chapter p {\n  line-height: 1.4;\n}\n",""]);const c=i},(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(20),r=n(106),a=n(107);t.default=o.defineCustomElement({name:"Dialog",props:{dialogTitle:String,status:String},emits:["dialogclose"],data(){return{myPrivateStatus:"true"===this.status}},methods:{dialogClose(){this.myPrivateStatus=!1,this.$emit("dialogclose")}},mounted(){this.myPrivateStatus="true"===this.status},watch:{status(){this.myPrivateStatus="true"===this.status}},template:a.default,styles:[r.default]})},(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>c});var o=n(23),r=n.n(o),a=n(24),i=n.n(a)()(r());i.push([e.id,".overlay {\n  visibility: hidden;\n  opacity: 0;\n  z-index: 100000;\n  position: fixed;\n  top: -50%;\n  left: -50%;\n  height: 200%;\n  width: 200%;\n  background-color: black;\n}\n.overlay.open {\n  opacity: 0.8;\n  visibility: visible;\n  transition: opacity 0.2s ease-in;\n}\n.overlay:not(.open) {\n  transition: visibility 0.2s step-end, opacity 0.2s ease-in;\n}\n\n.out {\n  position: fixed;\n  top: 0;\n  left: 0;\n  height: 100%;\n  width: 100%;\n\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  z-index: 100001;\n}\n\n.dialog {\n  width: 720px;\n  max-height: 70%;\n  display: none;\n  opacity: 0;\n  z-index: 100100;\n  position: fixed;\n  margin: 0;\n  padding: 0;\n}\n.dialog.open {\n  opacity: 1;\n  display: block;\n  transition: opacity 0.2s ease-in;\n}\n\n.dialog > * {\n  box-sizing: border-box;\n}\n.dialog > .titlebar {\n  background-color: white;\n  min-height: 24px;\n  position: relative;\n}\n.dialog-title {\n  padding: 10px;\n  text-transform: uppercase;\n  background: #ff7bac;\n  color: #ffffff;\n  margin: 0;\n  font-size: 1.5em;\n  text-align: center;\n}\n.dialog-close {\n  background: #ff7bac;\n  color: #ffffff;\n\n  font-style: normal;\n  font-weight: 400;\n  font-variant: normal;\n  text-transform: none;\n  line-height: 1;\n  user-select: none;\n\n  cursor: pointer;\n  font-size: 120%;\n  margin: 0;\n  padding: 0;\n  width: 3.6em;\n  height: 92%;\n  border: 1px solid transparent;\n  transition-duration: 0.2s;\n  display: block;\n\n  position: absolute;\n  right: 0;\n  top: 0;\n  white-space: nowrap;\n}\n\n.dialog > .body {\n  background-color: white;\n  border: 1px solid rgb(255 125 175 / 80%);\n  text-align: left;\n\n  line-height: 1.5;\n  padding: 1em;\n\n  overflow: auto;\n  min-width: 280px;\n\n  height: calc(100% - 2.1em);\n  max-height: 900px;\n}\n",""]);const c=i},(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>o});const o='<div class="overlay" v-bind:class="{ open: myPrivateStatus }" v-if="myPrivateStatus"></div> <div class="out" v-if="myPrivateStatus"> <div id="dialog" class="dialog" v-bind:class="{ open: myPrivateStatus }"> <div class="titlebar"> <h1 class="dialog-title">{{ dialogTitle }}</h1> <button class="dialog-close" v-on:click="dialogClose">❌</button> </div> <div class="body"> <slot></slot> </div> </div> </div> '}],t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var a=t[o]={id:o,exports:{}};return e[o].call(a.exports,a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";const e=n(1),t=n(84),o=n(85),r=n(9),a=n(11);n(86);const i=n(87);function c(){r.log.info("[Init]开始载入小说下载器……"),Object.entries(t.environments).forEach((e=>r.log.info("[Init]"+e.join("：")))),(0,o.init)(),(0,i.init)(),a.enableDebug.value&&setTimeout(e.debug,3e3)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(e=>{c()})):c()})()})();