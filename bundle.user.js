// ==UserScript==
// @name           小说下载器
// @version        4.8.0.501
// @author         bgme
// @description    一个可扩展的通用型小说下载器。
// @supportURL     https://github.com/yingziwu/novel-downloader
// @match          *://www.ciweimao.com/chapter-list/*
// @match          *://www.ciweimao.com/book/*
// @match          *://book.sfacg.com/Novel/*/MainIndex/
// @match          *://book.sfacg.com/Novel/*/
// @match          *://m.sfacg.com/b/*/
// @match          *://book.qidian.com/info/*
// @match          *://www.jjwxc.net/onebook.php?novelid=*
// @match          *://www.gongzicp.com/novel-*.html
// @match          *://gongzicp.com/novel-*.html
// @match          *://book.zongheng.com/showchapter/*.html
// @match          *://huayu.zongheng.com/showchapter/*.html
// @match          *://www.linovel.net/book/*.html
// @match          *://www.17k.com/list/*.html
// @match          *://www.shuhai.com/book/*.htm
// @match          *://mm.shuhai.com/book/*.htm
// @match          *://www.tadu.com/book/*
// @match          *://www.qimao.com/shuku/*/
// @match          *://sosad.fun/threads/*/profile*
// @match          *://wenzhan.org/threads/*/profile*
// @match          *://sosadfun.com/threads/*/profile*
// @match          *://xn--pxtr7m5ny.com/threads/*/profile*
// @match          *://xn--pxtr7m.com/threads/*/profile*
// @match          *://xn--pxtr7m5ny.net/threads/*/profile*
// @match          *://xn--pxtr7m.net/threads/*/profile*
// @match          *://sosadfun.link/threads/*/profile*
// @match          *://www.sosad.fun/threads/*/profile*
// @match          *://www.wenzhan.org/threads/*/profile*
// @match          *://www.sosadfun.com/threads/*/profile*
// @match          *://www.xn--pxtr7m5ny.com/threads/*/profile*
// @match          *://www.xn--pxtr7m.com/threads/*/profile*
// @match          *://www.xn--pxtr7m5ny.net/threads/*/profile*
// @match          *://www.xn--pxtr7m.net/threads/*/profile*
// @match          *://www.sosadfun.link/threads/*/profile*
// @match          *://www.uukanshu.com/b/*/
// @match          *://www.yruan.com/article/*.html
// @match          *://www.biquwoo.com/bqw*/
// @match          *://www.biquwo.org/bqw*/
// @match          *://www.shuquge.com/txt/*/index.html
// @match          *://wap.shuquge.com/s/*.html
// @match          *://wap.shuquge.com/d/*.html
// @match          *://www.sizhicn.com/txt/*/index.html
// @match          *://www.dingdiann.net/ddk*/
// @match          *://www.xkzw.org/xkzw*/
// @match          *://www.lewenn.com/lw*/
// @match          *://www.klxs.la/info-*/
// @match          *://www.266ks.com/*_*/
// @match          *://www.266ks.com/*_*/index*.html
// @match          *://www.hetushu.com/book/*/index.html
// @match          *://hetushu.com/book/*/index.html
// @match          *://www.shouda88.com/*/
// @match          *://www.gebiqu.com/biquge_*/
// @match          *://www.viviyzw.com/book*.html
// @match          *://www.1pwx.com/*.htm
// @match          *://www.81book.com/book/*/
// @match          *://www.81zw.com/book/*/
// @match          *://m.yuzhaige.cc/*/*/
// @match          *://m.yushuge123.com/*/*/
// @match          *://www.xinwanben.com/*/
// @match          *://m.xinwanben.com/*/
// @match          *://www.idejian.com/book/*/
// @match          *://www.wenku8.net/novel/*/*/index.htm
// @match          *://www.dmzj.com/info/*.html
// @match          *://manhua.dmzj.com/*
// @match          *://www.westnovel.com/*/*/
// @match          *://www.mht99.com/*/
// @match          *://www.bz01.org/*_*/
// @match          *://www.banzhuer.org/*_*/
// @match          *://www.xbiquge.so/book/*/
// @match          *://www.hongyeshuzhai.com/shuzhai/*/
// @match          *://www.linovelib.com/novel/*/catalog
// @match          *://www.luoqiuzw.com/book/*/
// @match          *://www.yibige.cc/*/
// @match          *://www.fushuwang.org/*/*/*/*.html
// @match          *://www.fushuwang.org/*/*/*/*.html?*
// @match          *://www.soxscc.net/*/
// @match          *://www.soxscc.org/*/
// @match          *://www.soxs.cc/*/
// @match          *://www.soshuw.com/*/
// @match          *://www.soshuwu.org/*/
// @match          *://www.soxscc.cc/*/
// @match          *://www.soshuwu.com/*/
// @match          *://www.kubiji.net/*/
// @match          *://www.shubaowa.org/*_*/
// @match          *://www.fuguoduxs.com/*_*/
// @match          *://www.xyqxs.cc/html/*/*/index.html
// @match          *://www.630shu.net/shu/*.html
// @match          *://www.qingoo.cn/details?bookId=*
// @match          *://www.trxs.cc/tongren/*.html
// @match          *://www.trxs123.com/tongren/*.html
// @match          *://www.jpxs123.com/*/*.html
// @match          *://trxs.cc/tongren/*.html
// @match          *://trxs123.com/tongren/*.html
// @match          *://jpxs123.com/*/*.html
// @match          *://www.tongrenquan.org/tongren/*.html
// @match          *://www.tongrenquan.me/tongren/*.html
// @match          *://tongrenquan.me/tongren/*.html
// @match          *://www.imiaobige.com/read/*/
// @match          *://www.256wxc.com/read/*/index.html
// @match          *://www.256wxc.com/read/*/
// @match          *://www.256wenku.com/read/*/index.html
// @match          *://www.256wenku.com/read/*/
// @match          *://www.biquge66.com/biquge*/
// @match          *://*.lofter.com/
// @match          *://*.lofter.com/?page=*
// @match          *://www.lwxs9.org/*/*/
// @match          *://www.shubl.com/book/book_detail/*
// @match          *://www.ujxs.net/read/*/
// @match          *://m.haitangtxt.net/*/*/
// @match          *://ebook.longmabook.com/*
// @match          *://www.longmabookcn.com/*
// @match          *://ebook.lmbooks.com/*
// @match          *://www.lmebooks.com/*
// @match          *://www.haitbook.com/*
// @match          *://www.htwhbook.com/*
// @match          *://www.myhtebook.com/*
// @match          *://www.lovehtbooks.com/*
// @match          *://www.myhtebooks.com/*
// @match          *://www.myhtlmebook.com/*
// @match          *://jp.myhtebook.com/*
// @match          *://jp.myhtlmebook.com/*
// @match          *://ebook.urhtbooks.com/*
// @match          *://www.urhtbooks.com/*
// @match          *://www.newhtbook.com/*
// @match          *://www.lvhtebook.com/*
// @match          *://jp.lvhtebook.com/*
// @match          *://www.htlvbooks.com/*
// @match          *://dijiubook.net/*_*
// @match          *://www.biquwx.la/*_*/
// @match          *://www.25zw.com/*/
// @match          *://www.tycqxs.com/*_*/
// @match          *://www.kanunu8.com/*
// @match          *://www.ciyuanji.com/bookDetails/*
// @match          *://ciyuanji.com/bookDetails/*
// @match          *://m.wanben.org/*/
// @match          *://www.wanben.org/*/
// @match          *://www.ranwen.la/files/article/*/*/
// @match          *://www.washuge.com/books/*/*/
// @match          *://m.baihexs.com/info-*/
// @match          *://www.quanshuzhai.com/book/*.html
// @match          *://masiro.me/admin/novelView?novel_id=*
// @match          *://www.pixiv.net/novel/show.php?*
// @match          *://www.pixiv.net/novel/series/*
// @match          *://kakuyomu.jp/works/*
// @match          *://ncode.syosetu.com/*/
// @match          *://novel18.syosetu.com/*/
// @match          *://syosetu.org/novel/*/
// @match          *://houhuayuan.xyz/*
// @match          *://zhaoze.art/*/
// @match          *://www.myrics.com/novels/*
// @match          *://m.lusetxt.com/ebook/*.html
// @match          *://www.lstxt.cc/ebook/*.html
// @match          *://www.a7xs.com/*/*/
// @match          *://www.shencou.com/books/read_*.html
// @match          *://www.tianyabooks.com/*/*/
// @match          *://www.aixiawx.com/*/*/
// @match          *://jingcaiyuedu6.com/novel/*.html
// @match          *://www.hanwujinian.com/book/*
// @match          *://www.biqu55.com/*_*/
// @match          *://manga.bilibili.com/detail/mc*
// @match          *://www.aixdzs.com/novel/*
// @match          *://www.liuxs.la/bookinfo-*/
// @match          *://www.cool18.com/bbs4/index.php?*
// @match          *://www.b5200.net/*_*/
// @match          *://www.yqxs.cc/html/*/*/index.html
// @match          *://www.dushu369.com/*/*/
// @match          *://www.18kanshu.com/*/*/info.html
// @match          *://www.18kanshu.com/module/novel/info.php?*
// @match          *://www.bxwx333.org/txt/*/
// @match          *://www.xiaoshuowu.com/html/*/*/
// @match          *://www.xrzww.com/bookdetail/*
// @name:en        novel-downloader
// @name:ja        小説ダウンローダー
// @description:en An scalable universal novel downloader.
// @description:ja スケーラブルなユニバーサル小説ダウンローダー。
// @namespace      https://blog.bgme.me
// @homepageURL    https://github.com/yingziwu/novel-downloader
// @icon           https://cdn.jsdelivr.net/gh/yingziwu/novel-downloader/assets/icon.png
// @license        AGPL-3.0
// @run-at         document-start
// @noframes       
// @compatible     Firefox 77+
// @compatible     Chrome 85+
// @compatible     Edge 85+
// @compatible     Opera 71+
// @compatible     Safari 13.1+
// @incompatible   Internet Explorer
// @exclude        *://www.jjwxc.net/onebook.php?novelid=*&chapterid=*
// @exclude        *://www.viviyzw.com/book/*.html
// @exclude        *://www.yruan.com/article/*/*.html
// @exclude        *://m.yuzhaige.cc/tag/*/
// @exclude        *://m.yuzhaige.cc/sort/*/
// @exclude        *://m.yuzhaige.cc/top/*/
// @exclude        *://m.yuzhaige.cc/full/*/
// @exclude        *://m.yuzhaige.cc/book/*/
// @exclude        *://m.yushuge123.com/tag/*/
// @exclude        *://m.yushuge123.com/sort/*/
// @exclude        *://m.yushuge123.com/top/*/
// @exclude        *://m.yushuge123.com/full/*/
// @exclude        *://m.yushuge123.com/book/*/
// @exclude        *://m.haitangtxt.net/tag/*/
// @exclude        *://m.haitangtxt.net/sort/*/
// @exclude        *://m.haitangtxt.net/top/*/
// @exclude        *://m.haitangtxt.net/full/*/
// @exclude        *://m.haitangtxt.net/book/*/
// @exclude        *://www.linovel.net/book/*/*.html
// @exclude        *://www.qimao.com/shuku/*-*/
// @exclude        *://www.trxs.cc/tongren/*/*.html
// @exclude        *://www.trxs123.com/tongren/*/*.html
// @exclude        *://www.tongrenquan.org/tongren/*/*.html
// @exclude        *://tongrenquan.org/tongren/*/*.html
// @exclude        *://www.jpxs123.com/*/*/*.html
// @exclude        *://www.25zw.com/lastupdate/
// @exclude        *://www.25zw.com/postdate/
// @exclude        *://www.25zw.com/monthvisit/
// @exclude        *://www.25zw.com/goodnum/
// @exclude        *://www.25zw.com/goodnew/
// @exclude        *://www.myrics.com/novels/*/chapters/*
// @exclude        *://dijiubook.net/*_*/*.html
// @grant          unsafeWindow
// @grant          GM_info
// @grant          GM_xmlhttpRequest
// @grant          GM_setValue
// @grant          GM_getValue
// @grant          GM_deleteValue
// @grant          GM.info
// @grant          GM.xmlHttpRequest
// @grant          GM.setValue
// @grant          GM.getValue
// @grant          GM.deleteValue
// @connect        self
// @connect        shouda8.com
// @connect        shouda88.com
// @connect        qidian.com
// @connect        yuewen.com
// @connect        kuangxiangit.com
// @connect        sinaimg.cn
// @connect        jjwxc.net
// @connect        image.gebiqu.com
// @connect        qpic.cn
// @connect        zongheng.com
// @connect        17k.com
// @connect        img.uukanshu.com
// @connect        aliyuncs.com
// @connect        cdn.bcebos.com
// @connect        rs.sfacg.com
// @connect        shuhai.com
// @connect        ch-intel.com
// @connect        huluxia.com
// @connect        linovel.net
// @connect        ax1x.com
// @connect        tadu.com
// @connect        zhangyue01.com
// @connect        cdn.wtzw.com
// @connect        wenku8.com
// @connect        dmzj.com
// @connect        hongyeshuzhal.com
// @connect        hongyeshuzhai.com
// @connect        linovelib.com
// @connect        soxscc.net
// @connect        soxscc.org
// @connect        soxs.cc
// @connect        soshuw.com
// @connect        soxscc.cc
// @connect        soshuwu.com
// @connect        kubiji.net
// @connect        idejian.com
// @connect        img.imiaobige.com
// @connect        postimg.cc
// @connect        lofter.com
// @connect        lf127.net
// @connect        126.net
// @connect        shubl.com
// @connect        loli.net
// @connect        alicdn.com
// @connect        toutiaoimg.com
// @connect        imgdb.cn
// @connect        meego.cn
// @connect        poco.cn
// @connect        dijiuzww.com
// @connect        25zw.com
// @connect        sina.com.cn
// @connect        ciyuanji.com
// @connect        wanben.org
// @connect        baihexs.com
// @connect        masiro.me
// @connect        pximg.net
// @connect        mitemin.net
// @connect        myrics.com
// @connect        a7xs.com
// @connect        jingcaiyuedu6.com
// @connect        aixdzs.com
// @connect        b5200.net
// @connect        xrzww.com
// @connect        *
// @require        https://cdn.jsdelivr.net/npm/crypto-js@4.1.1/crypto-js.js#sha512-NQVmLzNy4Lr5QTrmXvq/WzTMUnRHmv7nyIT/M6LyGPBS+TIeRxZ+YQaqWxjpRpvRMQSuYPQURZz/+pLi81xXeA==
// @require        https://cdn.jsdelivr.net/npm/fflate@0.7.2/umd/index.js#sha512-b4i2Ut2Tho5Qrzt3pWKCkt9Q+4ECSNPdX0JsVzudNFXR2kIbV0ndgkm3fDlGvp2A6JG9tcH3ND38y+y0DrM/jQ==
// @require        https://cdn.jsdelivr.net/npm/idb-keyval@6.0.3/dist/umd.js#sha512-+PXdWKx8apEQ52dxoVrQIwhLZj96Gde37eq+CXYQvG059IC5VF+nQ1DvD3JKqUVPL0k+TAJ8DDunVXjzKrlrHg==
// @require        https://cdn.jsdelivr.net/npm/loglevel@1.8.0/lib/loglevel.js#sha512-95U0EjHdDBH1jc1rMsOaY4CV3tVISgHr+7i5rFVvhWDRbsj2o0RlEdWMmDmQzoR8lJV7/6VbPZT6c3pQvkW+0Q==
// @require        https://cdn.jsdelivr.net/npm/nunjucks@3.2.3/browser/nunjucks.min.js#sha512-Uj8C5szr1tnKPNZb6ps5gFYtTGskzsUCiwY35QP/s2JIExZl7iYNletcmOJ8D6ocuaMRi9JGVrWRePaX9raujA==
// @require        https://cdn.jsdelivr.net/npm/vue@3.2.26/dist/vue.global.prod.js#sha512-IBbcf9iFu71zDGm4uuX3WOKuWTBZSFOaj9YWTZzCytQ15Ku3MfyOxxeJWQBwOOI/Fbc80FLXEFKrfMjj6MAw+Q==
// @downloadURL    https://github.com/yingziwu/novel-downloader/raw/gh-pages/bundle.user.js
// @updateURL      https://github.com/yingziwu/novel-downloader/raw/gh-pages/bundle.meta.js
// ==/UserScript==

(()=>{var e=[,(e,t,n)=>{"use strict";n.d(t,{C1:()=>a,_v:()=>i,X8:()=>c,K$:()=>s,HP:()=>l});var o=n(2),r=n(3);function a(e,t,n,r={}){const{signal:a,reason:i}=r,c=[...e],s=[];for(;t--;)s.push(l(c));return Promise.all(s);async function l(e){if(a?.aborted)throw i?new o.K2(i):new o.K2("concurrencyRun was aborted!");return await n(e.shift()),0!==e.length?l(e):"finish!"}}function i(e){return new Promise((t=>setTimeout(t,e)))}function c(e){return JSON.parse(JSON.stringify(e))}async function s(e){const t=await fetch("https://save.bgme.bid/save",{body:JSON.stringify({url:e}),headers:{"content-type":"application/json; charset=utf-8","x-requested-with":`novel-downloader ${r._p.script.version}; ${r._p.scriptHandler} ${r._p.version}`},method:"POST"});return await t.json()}function l(){return"function"==typeof crypto.randomUUID?crypto.randomUUID():function(){const e=new Array(36),t="0123456789abcdef";for(let n=0;n<36;n++)e[n]=t.substr(Math.floor(16*Math.random()),1);return e[14]="4",e[19]=t.substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-",e.join("")}()}},(e,t,n)=>{"use strict";var o,r;n.d(t,{qb:()=>o,n6:()=>r,K2:()=>a}),function(e){e[e.pending=0]="pending",e[e.downloading=1]="downloading",e[e.failed=2]="failed",e[e.finished=3]="finished",e[e.aborted=4]="aborted",e[e.saved=5]="saved"}(o||(o={})),function(e){e[e.keep=0]="keep",e[e.none=1]="none",e[e.self=2]="self",e[e.custom=3]="custom"}(r||(r={}));class a extends Error{}},(e,t,n)=>{"use strict";n.d(t,{_p:()=>o,UX:()=>r,_u:()=>a,QG:()=>i,jF:()=>c});const o=function(){if("undefined"!=typeof GM_info)return GM_info;if("undefined"!=typeof GM&&void 0!==GM.info)return GM.info;throw new Error("Not found: GM_info and GM.info!")}();function r(e){if("function"!=typeof GM_xmlhttpRequest){if("undefined"==typeof GM||"function"!=typeof GM.xmlHttpRequest)throw new Error("Not found: GM_xmlhttpRequest or GM.xmlHttpRequest!");GM.xmlHttpRequest(e)}else GM_xmlhttpRequest(e)}async function a(e,t){if("function"==typeof GM_setValue)return GM_setValue(e,t);if("undefined"!=typeof GM&&"function"==typeof GM.setValue)return await GM.setValue(e,t);throw new Error("Not found: GM_setValue or GM.setValue!")}async function i(e,t){if("function"==typeof GM_getValue)return GM_getValue(e,t);if("undefined"!=typeof GM&&"function"==typeof GM.getValue)return await GM.getValue(e,t);throw new Error("Not found: GM_getValue or GM.getValue!")}async function c(e){if("function"==typeof GM_deleteValue)return GM_deleteValue(e);if("undefined"!=typeof GM&&"function"==typeof GM.deleteValue)return await GM.deleteValue(e);throw new Error("Not found: GM_deleteValue or GM.deleteValue!")}},(e,t,n)=>{"use strict";n.d(t,{o:()=>a,Z:()=>i});var o=n(5),r=n.n(o);function a(e){let t;try{t=window[e];const n="__storage_test__";return t.setItem(n,n),t.removeItem(n),!0}catch(e){return e instanceof DOMException&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&t&&0!==t.length}}class i{storage;constructor(){if(!a("localStorage"))throw new Error("当前浏览器不支持 localStorage");this.storage=window.localStorage,this.init()}init(){const e=new RegExp("__expires__$"),t=this.storage;Object.keys(t).forEach((t=>{e.test(t)||this.get(t)}))}set(e,t,n){const o=this.storage;try{o[e]=JSON.stringify(t),n&&(o[`${e}__expires__`]=Date.now()+1e3*n)}catch(e){r().error(e)}}get(e){const t=this.storage,n=t[`${e}__expires__`]??!1,o=Date.now();if(n&&o>=n)this.remove(e);else{if(!n)return t[e];try{return JSON.parse(t[e])}catch(n){return t[e]}}}remove(e){const t=this.storage;t[e]&&(delete t[e],t[`${e}__expires__`]&&delete t[`${e}__expires__`])}}},e=>{"use strict";e.exports=log},e=>{"use strict";e.exports=Vue},(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var o=n(8),r=n.n(o),a=n(9),i=n.n(a)()(r());i.push([e.id,".button-div {\n  position: fixed;\n  top: 15%;\n  right: 5%;\n  z-index: 10000;\n}\n.button-div button {\n  border-style: none;\n  text-align: center;\n  vertical-align: baseline;\n  background-color: rgba(128, 128, 128, 0.2);\n  padding: 3px;\n  border-radius: 12px;\n  min-width: auto;\n  min-height: auto;\n}\n.button-div img.start,\n.button-div img.jump {\n  height: 2em;\n}\n.button-div img.setting {\n  height: 1em;\n}\n",""]);const c=i},e=>{"use strict";e.exports=function(e){return e[1]}},e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",o=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),o&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),o&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,o,r,a){"string"==typeof e&&(e=[[null,e,void 0]]);var i={};if(o)for(var c=0;c<this.length;c++){var s=this[c][0];null!=s&&(i[s]=!0)}for(var l=0;l<e.length;l++){var d=[].concat(e[l]);o&&i[d[0]]||(void 0!==a&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=a),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),r&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=r):d[4]="".concat(r)),t.push(d))}},t}},(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var o=n(8),r=n.n(o),a=n(9),i=n.n(a)()(r());i.push([e.id,":root {\n  --good-chapter-color: #41b883;\n  --bad-chapter-color: #e73838;\n  --warning-chapter-color: #ff9900;\n}\ndiv.chapter-list-loading {\n  padding-top: 5em;\n  padding-bottom: 5em;\n  text-align: center;\n}\ndiv.chapter-list {\n  max-height: 200px;\n  overflow-y: scroll;\n}\ndiv.chapter-list .section {\n  margin-top: 1.5em;\n  display: grid;\n  grid-template-columns: 32% 32% 32%;\n}\ndiv.chapter-list .section > h3:first-child {\n  grid-column-end: span 3;\n  text-align: center;\n}\ndiv.chapter-list .section > div.chapter {\n  text-align: center;\n  padding-top: 0.5em;\n  padding-bottom: 0.3em;\n  padding-left: 23px;\n  padding-right: 20px;\n  border: 1px solid #d9d9d9;\n  border-radius: 5px;\n  margin-left: 10px;\n  margin-top: 5px;\n  margin-right: 0;\n  margin-bottom: 0;\n}\ndiv.chapter-list .section a.disabled {\n  pointer-events: none;\n  cursor: default;\n}\ndiv.chapter-list .section a {\n  text-decoration: none;\n}\ndiv.chapter-list div.chapter.good {\n  background: var(--good-chapter-color);\n}\ndiv.chapter-list div.chapter.bad {\n  background: var(--bad-chapter-color);\n}\ndiv.chapter-list div.chapter.good.warning {\n  background: var(--warning-chapter-color);\n}\ndiv.chapter-list div.chapter.bad a,\ndiv.chapter-list div.chapter.good a {\n  color: white;\n}\n.nd-setting-body span.good {\n  color: var(--good-chapter-color);\n}\n.nd-setting-body span.bad {\n  color: var(--bad-chapter-color);\n}\n.nd-setting-body span.warning {\n  color: var(--warning-chapter-color);\n}\n",""]);const c=i},(e,t,n)=>{"use strict";function o(e,t=((e,t)=>e.chapterNumber-t.chapterNumber)){const n={};for(const t of e){let e=null;e=t.sectionNumber&&t.sectionName?t.sectionNumber:-99999999,n[e]?n[e].chpaters.push(t):n[e]={sectionName:t.sectionName,sectionNumber:t.sectionNumber,chpaters:[t]}}const o=Object.values(n);return o.sort((function(e,n){const o=e.chpaters[0],r=n.chpaters[0];return t(o,r)})),o.forEach((e=>e.chpaters.sort(t))),o}n.d(t,{f:()=>o})},(e,t,n)=>{"use strict";function o(e,t=!1,n){if(t)n.querySelectorAll(e).forEach((e=>e.remove()));else{const t=n.querySelector(e);t&&t.remove()}}function r(e,t){!function e(n){Array.from(n.childNodes).forEach((n=>{let o="";if(o="#text"===n.nodeName?n.textContent??"":n.innerText,o.length<200||n instanceof Text)for(const e of t)e instanceof RegExp&&e.test(o)&&n.remove(),"string"==typeof e&&o.includes(e)&&n.remove();else e(n)}))}(e)}function a(e,t){for(const n of e)"string"==typeof n?t.innerHTML=t.innerHTML.replaceAll(n,""):n instanceof RegExp&&(t.innerHTML=t.innerHTML.replace(n,""));return t}function i(e,t){Array.from(e.childNodes).forEach((e=>t.appendChild(e)))}function c(e){const t=e.querySelectorAll("*"),n=Array.from(t).filter((e=>0===e.childElementCount)).map((e=>o(e,0)));return Math.max(...n);function o(t,n){if(e.isSameNode(t))return n;{const e=t.parentElement;return e?o(e,n+1):n}}}function s(e){return Array.from(e.childNodes).filter((e=>"#text"===e.nodeName)).reduce(((e,t)=>(e||(e=0),e+(t.textContent?.trim().length??0))),0)}function l(e){const t=document.createElement("iframe");if(document.body.appendChild(t),t.contentWindow){const n=t.contentWindow.Function,o=Object.keys(t.contentWindow).join();return document.body.removeChild(t),n(o,e)()}}function d(e){const t=document.createElement("div");if(t.innerHTML=e,1===t.childElementCount&&t.firstElementChild)return t.firstElementChild;throw new Error("Create HTMLElement Failed!")}function u(e,t){const n=d(`<style>${e}</style>`);return t&&(n.id=t),n}function h(e){return e.nextSibling instanceof HTMLElement?e.nextSibling:e.nextSibling instanceof Text?""!==e.nextSibling.textContent?.trim()?e.nextSibling:e.nextSibling.nextSibling:void 0}function m(e){return e.previousSibling instanceof HTMLElement?e.previousSibling:e.previousSibling instanceof Text?""!==e.previousSibling.textContent?.trim()?e.previousSibling:e.previousSibling.previousSibling:void 0}function p(e){const t=m(e);return t instanceof HTMLBRElement?p(t)+1:0}function g(e){const t=m(e);return e instanceof HTMLBRElement&&e.remove(),t instanceof HTMLBRElement?g(t):void 0}function f(e){return Array.from(e).reduce(((e,t)=>{const n=t.codePointAt(0);return void 0===n?e:n<128?e+.5:e+1}),0)}function b(e){let t;if("string"==typeof e&&(t=(new DOMParser).parseFromString(e,"text/html")),e instanceof Document&&(t=e),t instanceof Document)return(new XMLSerializer).serializeToString(t);throw new Error("input format error!")}n.d(t,{rm:()=>o,vS:()=>r,up:()=>a,vR:()=>i,wd:()=>c,MK:()=>s,J0:()=>l,ut:()=>d,wj:()=>u,d9:()=>h,U:()=>m,$N:()=>p,Fe:()=>g,sp:()=>f,fI:()=>b})},(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var o=n(8),r=n.n(o),a=n(9),i=n.n(a)()(r());i.push([e.id,".filter-setting {\n  padding-top: 0.4em;\n  padding-bottom: 0.8em;\n  text-align: center;\n}\n.filter-input + .filter-setter {\n  margin-top: 1em;\n}\n.filter-description {\n  font-size: larger;\n  color: cornflowerblue;\n}\n",""]);const c=i},(e,t,n)=>{"use strict";n.d(t,{KC:()=>i,mZ:()=>c,qS:()=>l});var o=n(15),r=n(5),a=n.n(r);n(16).Cy.value?a().setLevel("trace"):a().setLevel("info");let i="";function c(){return i}const s=a().methodFactory;function l(){(0,o.saveAs)(new Blob([i],{type:"text/plain; charset=UTF-8"}),`novel-downloader-${Date.now().toString()}.log`)}a().methodFactory=(e,t,n)=>{const o=s(e,t,n);return e=>{try{"object"==typeof e?e instanceof Error?i+=e.stack:i+=JSON.stringify(e,void 0,2)+"\n":i+=e+"\n"}catch(e){a().error(e)}o(e)}},a().setLevel(a().getLevel())},function(e,t,n){var o;void 0===(o=function(){"use strict";function t(e,t,n){var o=new XMLHttpRequest;o.open("GET",e),o.responseType="blob",o.onload=function(){c(o.response,t,n)},o.onerror=function(){console.error("could not download file")},o.send()}function o(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function r(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var a="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n.g&&n.g.global===n.g?n.g:void 0,i=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),c=a.saveAs||("object"!=typeof window||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!i?function(e,n,i){var c=a.URL||a.webkitURL,s=document.createElement("a");n=n||e.name||"download",s.download=n,s.rel="noopener","string"==typeof e?(s.href=e,s.origin===location.origin?r(s):o(s.href)?t(e,n,i):r(s,s.target="_blank")):(s.href=c.createObjectURL(e),setTimeout((function(){c.revokeObjectURL(s.href)}),4e4),setTimeout((function(){r(s)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,n,a){if(n=n||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}(e,a),n);else if(o(e))t(e,n,a);else{var i=document.createElement("a");i.href=e,i.target="_blank",setTimeout((function(){r(i)}))}}:function(e,n,o,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),"string"==typeof e)return t(e,n,o);var c="application/octet-stream"===e.type,s=/constructor/i.test(a.HTMLElement)||a.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||c&&s||i)&&"undefined"!=typeof FileReader){var d=new FileReader;d.onloadend=function(){var e=d.result;e=l?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=e:location=e,r=null},d.readAsDataURL(e)}else{var u=a.URL||a.webkitURL,h=u.createObjectURL(e);r?r.location=h:location.href=h,r=null,setTimeout((function(){u.revokeObjectURL(h)}),4e4)}});a.saveAs=c.saveAs=c,e.exports=c}.apply(t,[]))||(e.exports=o)},(e,t,n)=>{"use strict";n.d(t,{o5:()=>r,Cy:()=>a,Vo:()=>i,Td:()=>c,EI:()=>s,Z3:()=>l,CA:()=>d,cl:()=>u,wE:()=>h,d7:()=>m,y6:()=>p,Qd:()=>g});var o=n(3);const r=5,a={value:!1},i=!0,c=!0,s=!0,l=!0,d=!0,u="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAFYElEQVR4nO2dIUxkORyHP4XD4E6RYNZgUGvWonAnVqxDbbJiNWLNOsQ65Oo1CMQIFAnJJiQIcgY7YhIEbgTJiEkm4USPuyNh3pv2tf33tb9f8kl4fe3H0Pm37xXi50/gHJgBC+C5YB6Bv4AL4CuwH7872skBcI/9oA5lBpwAO1F7p/IcUf5fuy8L4AzYjthPVWYfeMJ+wFLxABxG660K8xv7QcrBWawOqykfsB+YnEzQv4RXOcV+UHJzD+zF6LwaMsF+QCyYo3kBALfYD4YVK+DL8C4cd+6wHwhrfgJbQztyrJEAjhvgj4F9OcrUKMA33Me778/NaLCUXKMA27ivt48BP7vArYU0k1oFAPeRHjrJPQ3u0ZGlZgHATe5+Bv6ecxooGtUuwEuOCVvsugd2vXp0ZGlFAHDL3bOA3zfHzSmqTEsCgNsjcBXwO5e4T5Hq0poA4OYFoWsg1RWNWhTgJZ8ImxdcUdFuo5YFADcvmAZcY0olRaPWBQD313wZcJ0n3Fa6UUcC/JfvAdda4TagjjYS4HWOcF/7fK/5i5FODmvcDzC0eveOsO3xt4xwRVECvJ1t3MMmvtd+AN5HuH62SIDunOC/tLxgREUjCdCf0HnBKFYUJcBm2SNsXnCZqD3RIgE2zzZuidi3PVPcxLLISAD/fMYtDvm0qdht6BIgLIf4zwuWOHmKigQIzy5hhbSiKocSYFi2cFVA3zZ+ytjGztQogMVS7Vf85gVPFLLVrEYBrGbcvlvRJzbNfJ0aBbDc1++7Fd28bFyjAOdRe8g/PlvOfhm18d/UKMCKMjZqHNM/L1hiXCmsUYBn3ILMZ+zX6N/jVgi72mr6KFqtArzwiJtsneE+li3oezLJdNGodgHGgOm3AQlgz03vKCWMBLDnrneUEkYC2CMBGkcCNI4EaBwJ0DgSYEMecE/mbkLIA59NCnCzplElEbqfLvTJXwlQGEN2z+zjv4GzKQFK/xewZPiCTumS6xOgg4cI9xiyZ08CFIIESBwJYI8E6EACJI4EsEcCdCABEkcC2CMBOpAAiSMB7JEAHUiAxJEA9kiADiRA4kgAeyRABxIgcSSAPRKgAwmQOBLAHgnQgQRIHAlgjwToQAIkjgSwRwJ0IAESRwLYYyrA7zWNKgUJkDgSwB4J0IEESBwJYE8zAqxwr0T7webv2Ivxbv2PHtc7xb1qNucDpc0I8DHTPcXIB/yPi5MAHcT4KM+dXH3ThADzXDcUMSHHxEmADr5kuqcYOSJfvzQjwIKCz8/7X3bof8O3BAjkDvtXuPcl5HBICeDB9yx3FpZj8vdHcwKsKOCsnDeyhzvNSwJkYEp5hypfY9MXTQrwjDtJo5ScYNcPzQrwTBmHOx1g+y7BpgV4xJ21Z5Ut8hV8JMAaLpPf5fqcdbRLAmTE4lj1wwHtlQCRyV0l3MHvnF8JkIGcVcLc1T4JsCE5qoQW1T4JsCGpq4RW1b5iBbhe0yhLUlYJS7xfCfAGKaqE3wq4LwngQcxTta2rfRIggDlxqoQlVPskQCAxqoQlVPskwACG7CUspdonAQYQWiUsqdonAQYSUiUsqdonASLgUyUsrdonASKwwj2y1ZcSq30SIBKbVAlLK29LgMh0VQlLrfZJgMi89aRxydU+CRCZOe5g6JfsMo6TwiVARJbABe7r3pgmfRJASAAhAQQSQCABmsdUgKs1jRL5uO0dpYSRAPZMekcpYS7WNErk47R3lBLmx5pGiXyYvi1lDFumaua6f4jS5w77jmiRBa/XM8zyjnHX0sfIkrjPPQzOAeNdTRsbUzbb2ZQ9W7i9dBNghltyjUHrny4r3JtHJ//0b9RH4P8GSxsCzEN/51YAAAAASUVORK5CYII=",h="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAESElEQVR4nO2cLUxcQRSFv4QgEBiSKgQCh6pCouvQlbVVdaRuTFUNoqaqEkktCoVD4HBITBMMosmaVsxu+kL3l3lv7p13z5ccyc68OSf3sLtvHwghhBBCjJM/hRKNowAERwEIjgIQHAUgOApAcBSA4CgAwVEAgqMABEcBCI4CEBwFIDgKQHAUgOAoAMFRAIKjAARHAQiOAhAcBSA4CkBwFIDgKADBUQCCowAERwEIjgIQHAUgOApAcBSA4CgAzkmUm9SqUvHpjYSEvRky35iEvSky35iEvTky35iEvUky35iEvVky35iEvWky35iEvXky35iEvYky35iEvZky35iEvaky35iEvbky35iEvcky35iEvdky35iEveky35iEzA9PQuaHJyHzm2e78O8T7Zhfeq2j4i1wDvyi/GAT/s1P5Gs9J197SN4An4A7hjlgz+a/fM078lm8KXxt92wDp8BPYEL9g/ZoflcT8tmcMrKK6I54TwfueS/NV8SyEe/54D3uoZmK2GTEt2KA5dov5bYiXjvivRthsea6Mq+Ivka8V0NqrlWqahUx1IjfRGeF15DWWCMVrnG2xhpDaLCKqDHiV+ka+ADs9nA9ack6qYfX3yXv9XrJOkOruCIsRvxLPZANOXztRSwhzVkvDbDO4fR1H+asV0trV4SHEf8M/ABOVm22B1Jn3VRhvRPytT1jc7YLK8LTiN/Z/FyLSNT/Vm8HZxVhtYnZiD8oOc3GOcC+Iqou9gx8p86Ib40T8tnUrogqi1wB76k/4ltkh3xWVzQegHvgM7Df6/HEYp98hvc0EoAn8hg7HuAwonNMPtsnnAVggkZ8TboV0cfb9aIRf4ZGvCX7ZA9KKmLjEf8NjXiPHJO92bQiFICRUCUAqgBfVK+AedI/gXVx80/goorQ28BhcPs2cFlF6IOgMpr7IGiRVBHrM5qPguep5vf9rWF1v0DVxbrS18EBvw5epGv6u+fPOx7uGXQXgJnGXBHWt4Q1EYCuhrwptBYebgptNgBd3dBORcxG/A325zaaAMz0G7gA3gFbaxpSgy3yni7Ie7Q+p9EGoKtH4AtwtNqfwTia7uER+/MIF4CuboCPwN5Su/phb7pWKyM+RABmGqoiWh7xoQLQ1SPwlbKKOJq+RssjPmwAurpl/YqYjfhbB/tWAHrWBLjk/9/HzX4XeYnd7yIVgMqa/T7O+neR1jLfgKQASIYy34CkAEiGcvGACKmu5j5DKPJboQha9BZ4Lh4eEiX1o+LnCKoi2tMgTxJVRfjWRiO+FFWEH5k/TVwVUV/mD4ueh4cHTY5ZVUd8KaqI/mQ+4ktRRWwulyO+FFXEcjU14ktRRfxT8yO+lIgVMcoRX8rYP2gKNeJLGVNFhB/xpbRYERrxA+C9IjTiK+KpIjTijbGoCI14hwxdERrxDdFnRWjEN85rKkIjfoSsqgiN+EB0K0IjXgghhBDh+Avri3imoU6g/AAAAABJRU5ErkJggg==",m="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAABmJLR0QA/wD/AP+gvaeTAAAIxElEQVR4nO2dW4wWRRbHfzArzAIioFxk4oMKjLgqug9k2UUi3g0YYwKId59UXnaj0ejDamLUxTWi8cEbglFJvL7hLfFuHBGNVxBXjFGZWVC8jIoDOzPLTPtwvk+GoafOqe6qntbpf1LJZKrr1L+quqtOnXOqPqhQoUKFChUqVKhQoUKF8uDvQBIoXVUwdzOGDzYBB44JKOtPAWUFRZkHYFZAWUcHlDUk0ADsJNwUtKsms3Qo6xcwAxgVUN4fgcMCyguGsg5AyPm/jlJOQ0NpAI6KIDM3yjoAIRfgOko5AGVFG+5F9fiUMqcrZT6Ozvp3goOAXtydOT6lXJNS5v9AY2Tuv2mcAKwCfsDdkVscMtqVsiuAA+PQ/+3iNGA9dp3+KYes1wzlfwZuASbm4LxfjrJRcASwGXnD5mJb3A8BnsF/U3WTQ+ZdHnI6gFuBA4xtbEBeljXIVzrTWK4QPMvejfsauA9ZGEekPH8x8BP+nZ8ASxw8lmWQtw041yFzFvJibetX7jlHmUKxAHcDfwQeARYDE4B7lOe11OzgMjeH3Bf7yG4CrgY2KGUW+HVVeIwAPsHeSE270dKnuG0643LK7wReB3qMz28m/QsvDFemkAqduoAngFOwrS0n157vKoBbUuuDQcFEdJUxa+pB3sQrgMkZ+U0GrgFaI3Gspx+BSRk55sJ9GchqaTdwP3BoQJ4jkcV5SwS+9bQyIF8TjkU6K2QjNgGzI3IeAVwGfBOYd/3FOTYi933wauAGPAqMLoj7OOBOwr9ALcCwIhqwyEDmv8Db2LSeFUWQTsFsRKuydG478K3hucWxSTcCXxiILKo9fwhwKWI+6E557vbYhBVMRqa+gaaVF4CLEO+c5cVrJawnbx/800DiddI/xQlIY55AzACD3fl1TEZM1X3XomtI12xeQW//dbGINiGGrBCLUZb5fixwHqIlvY0spt219E3tfyuBpcD+nrKbkI6boTxnUT46avKC42Gl4gS4N0K9zcBqJLLBuiDuREzb0yPwsajfa0JX+hdsC+pJAescBdyGOFKsHd8/dSMWz5COmAsN9fYCc0JVOAy7vb49UMXTgY3GOi3pTeDgALwuxf5CvEVAn/vV2A1pP5PvSziOOJulNrJHWwwDbvSs7w4CBz1cht1K2AmclaGO6cTp/L6D4Psl7Ac86FFHD2LDioKlpOvzaWk3cImH7EbgA6PsPOkdJFLOgjHs62zSXrylHm3OhDOB/xkJ9QCXG+XeZpQZIt1g4NMIvO8hs530cJkomA/sMBLrRY9EaMa2uPUCTwMXILGeo2rpcEQ7edrIqQOYonAajl31/ZJB8BHPBr43kNtqkLXaIKcV+KtB1lz0wK4EuNsg612DnPcIo2FlwlHs66zun9YqMsaih6K34tfIqeiD0IHM8S6sUWS04L/r3gt51aSPkFgcF95V8hfiNmAlyML2lQcvLdIBxByiOdU3KfmtiNqdGSH0VC3o9T0lf76S/wywzk7nV7QgGowLJyr52gDkPvoUYgCmKvmblXwtEvpxDy6+ZbW6Ne5a2wuBppJqlk/N0ZHnZMs0RfZ2pfxopfyuHNyCQdsda2eztPCRPA4OrQM7lfJ/UMrvzsENKOaARpKzfB4/ayE+2jwIMQBdSr4WObZDyc8aFwT6ZusnJX+kkt/twSUVIQagQ8nXOvBzJf9vHlx8y2p1a56tnR5cUhFiAFwHJkAPsvpQyT/Hg0t/aIYxrW5XIDDYdvlOhBgA7S06Usl/WclfgJgXfDEPCY934SUl/89K/n/sdOJgDOJtcmkKqxUZ+6ObItrw07mbkNikvKaItYqMHcCpHryCYgo2Y9UHBlmrDHLasH0J89A7P8EWz7nVIKcbP79HEMzEFqCVIGZmzQEyHbuj51kkvmgaouePrv19MXbnSRf6Bm+SUVaCmMmvV+QFw/HYzND19D42i+GtHjLzpuXGtl6L36GSVcjmLRrOxi8+50Xsh+Aa0deTEGkdun7fF4uwewAT4HnExB4c/8DulE+Ah/A/zjmFuAcqtpItam0+chDDWs+HGetJxXAkxMKnoTeS3QxwDDaPlm9qJd+NKUd78tpEIFPIMCTIyFLpbuxOeBcmYjt07TPtaGYJC6Zid9S7zjN7Yw62xejCgHU2ItELHYZ6B0pdwL/wm/M1nGCodzsR1gHNP5oggauhMQVxoPsMREeNS4xbsl4y1L8sQr00oXeCJTx9BhIK7rtIjUHsQvcisarbkTe8q/b3euQQ+BL0HW4aLCHzC9E7/2MiqqLXGQiknZUajwS2trBnKvuUSHH0GbAcUTVfQLS9tPWiAQlC0Nq/MCZRnyNKI5EoOteh6TIMwnLSv+QW5KTMtNpzlnsoXimC8GIDkW/R7+7pOwgxj6e6sMLAr5c9J3Jcz/WgW0+DIfQx1V7kBM5BBfEfAzwWuA0PFsQdiHNQO0HessuJewHGHMSOH5L3LuREaKFYGYD4QGkLMueG1N+nAQ8Q58W5OSBPMybhZx/JktqQhTDPhR1XAG/gZ8fySVE2XVYUcV1Nwp4ra042cBqOXG1T1JU1UTZdVoxAwvcsROtX0HQanx8ojXPwacB+/cBAycf+H3XTZYV2ZdkG5JBfXd9vRjY8WTvI5ZZsziE3QS79m4Co2o+g32sXddPlg+fYm9g2RMd2Bb8uxeZz9fnkl2SQlyBr2fkp8kYCZyAKx/Z+ZbRojkIxE7k9aw1ytaP1rv6xwL/xM7Td5ZB3k4ecelqLbTfegDj870BCcQrbdFmR5zLTiYhJwHLuzHUg5ClD+Xp6A9uiPqRwILp5oN1RXruW7Afkso95cej/PtCIfmIybcoYr5TppThThxll/P2ATuAz5Zm0Y1HaNQRtwHeZGA1BPEk+dXKgxbZ0KOMXAOL4CA0tEnpQMJQGYEMEmblR1gHYGEFmKQegrGjALwRSS9UPuXmih7CHHzbWZJYOZR0ACDsNlXIBhnIPQMiFuJr/K1SoUKFChQoVKlSoUBr8Ah3QujNKRJdpAAAAAElFTkSuQmCC",p="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAG6wAABusBTDGeSgAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAeVSURBVHic7VpvTBNpHv6901L+yQU3nCfrByU9IRYrWrCVGkVzgu4ZCSFSMBDJrhcTP+iqMdlcLvFyl7sPftn9diZsiHterpYz8TxuCXsauBNy2VVoXIEIXV2hAYt/WqF/mMGZ6fzugwxXSjudlnYHWJ5kMm+n7/zmeZ55531/7ztDEBF+zKCUJqA01gxQmoDSWDNAaQJKY80ApQkojTUDlCawFNTU1Pzk3LlzzYQQkmiMFW0AABzRarVfXLx40UYISUjLijaA4zjNunXrQK/XWy5dutS5b98+dbwxVrQB4jwmIyMDtm/fXrV3796eQ4cOZcYTY0UbEAqNRgM6na7caDTeP3r0aI7c81aNAQAAaWlpsG3bNr3BYHhYW1v7npxzVpUBAABqtRoKCwu1er1+sK6uLj9W/RVtQLS1DJVKBVu3bn1fr9cPWCyWAqkYK9oAKVAUBVqtNq+kpORRQ0ODLlo9kooVoVOnTv0yOzv7F1J1Yl1XDi+e53++e/fu6uzs7AX1w8sTExPMo0eP9lmtVnt4jKQbQAhJv3z58rDBYJhveuI1pEjKLSd6nsvlYh8+fFhptVp7Qvmm4hFQAUDCqWmqkJ+frykrK+tubGz8IPR4SvqA5brQumHDBpXJZPqyqampTjy2KjvBYDAILMsCwzAQCATA5/OB1+uFqakpAACqsLDQ1tzcfAoAIO7cWQ5S3QIEQYDZ2VngOA6CwSDwPA88z8+XAQDECWKkfVZWFqXVaj9vaGiYTYkByQbP80DTNDAMAwzDAMuyABBZnJRwcY+IMDMz4x8eHuYTNoAQQk6fPn1yYmLi7x0dHb7Q/5baAliWBZqm5zc5d1WOcJGby+V6cevWrY+dTudXCRlACKHOnj17o6ioyPL8+XMGAP6WSBwRgiCAz+cDn88HDMNAMBiUJSYe4YQQCAaD4HQ6v2tra/vY7Xb3ICIdtwFms1l9/vz5DpPJVMXzPLAsqwmvg4goipj7vWAP8K6jCgQCMD09DYFAICJpKcQjnBACLMvCkydPHlit1osMw/Qj4luAODvBAwcOZJrN5i6j0Vienp4OPp8vUjX+7t27nz5+/NgoFSsZmWBWVtZPi4uLj6Snp0u2jtnZWRgaGuq02Wy/EQRhEBF5MYZsAw4fPpxjMpn+W1paqtdoNICIEUkiIksI+UtfX9+SHgs5OHjw4NHi4uIj4Y9CaDkQCEBfX9+f29vbrwCAAxGF0BiyDDh27Nh7ZWVlD0pKSrRpaWnz4qPdJUT0LkWYXFRWVnKi4Ej9gdfrFXp6ej7r7u7+EwCMYgTCMQ2oqanJ37lzZ79er39frVaDIPzfwNCyUiCEAEVR82URr1+/Zru6un53//79LxDRFe18SQNqa2sLdu3a9UCn0+VRFDUveLmkuiKP8DF+cnLS39nZ+cng4OBNRHRLxYhqwPHjx3UGg+GboqKiHACIKH65tADRAEEQYHx8/OXt27cvjI6OdiBixF46FBENsFgspaWlpb1arTYz1jR0y5YtdWfOnNkVSihSWeo/OWW/3/+v1tbWO+FcRQM4joPR0dHvb968ee7Vq1f/QUQ6suSFWGRAfX39/rKysrubN2/WSIlHRMjMzASz2Vw9PT0NDMNEHMfjGa+l9uPj45WEkN3i+B0an2VZcDgc9ra2tgt+v/9BeB3ZBtTX139gNBr/uWnTJlV4Lx9eRkSYmpoCv98fNXGJJSoezF1fFXYMaZqGp0+f3rHZbL8WBGEgdIyXg3kDTpw4Ubdnzx7bxo0bqdBnO5IJHMeBx+MBlmWXJE7u3Y8Gu93+Lcdxf+zt7bUCwEj4GC8HagCAxsbGX5WXl7fk5eWRaOJF0DQNHo8n5kiQzLsf7Ryv1+vo7e29AgCBSGO8HKgtFkvj/v37P8/NzY3Zq79582ZBk0+GqKXEmmvu/rgvHgJqeHiY93g8tJT4YDAILpcL/H7pay21SUvFEpOdZIMaGhrqvHbt2ocOh8MTOoMTEQwG4cWLF8BxXERiSt39ZIFCRJ/T6fyypaWlaWBgYEwUCrBYvBRS8cz/EMZQAACISLvd7n9fvXq1yW63f8uy7ALxUoRCJ0ZSm1g31h4RQRCERVuq0u8FL0YIIWqKovQnT568UlBQUBk+yQjfcxwHIyMjXzEM8zpicIlMMNrxaHXGxsa+7u/vb0VEVpYymVj0Zoi8+9SkqLq6+pMdO3Y0Z2RkLCAWSpDjOLh3795H3d3dHckkFQVvUzHNXpQKI6JACBlpb2///czMjNtkMl3Iyspa1AWLRqhUKg4RXyWb2A+FiJOhuaTiGSHk05mZmTcVFRW/zcnJ0SjRS6cakusBiOgihLTQND1VVVV1Zf369TkAyg5byUbMFSFEdBNC/hoIBKarq6s/y8vL+5lKpYp12oqBrPQKEX3Pnj37x40bNz6anJz8XhCEVXH3AeJ4OYqI9MuXL7uuX7/+4djYmF1OcrQSEFeCjYhv/X7/162tracdDseduXd0y2OBMFHIzeTCsjoKAHQVFRV/yM3NLU4kxnLZEv5EhrzrBNYBABPvKsxyQko+klpJWJVfiMSDNQOUJqA01gxQmoDSWDNAaQJK40dvwP8AKk+/HC2PJW8AAAAASUVORK5CYII=";async function g(){const e="novel-downloader-enableSaveToArchiveOrg",t=await(0,o.QG)(e);if(void 0===t){const t=confirm("欢迎使用小说下载器脚本！\n本脚本为404小说文库项目的组成部分之一。404小说文库项目致力于存档、保存、恢复因种种原因被删除的网络小说。\n您是否同意将当前书页存档至互联网档案馆（archive.org），以备日后（被删除后）查看？\n\n如您同意，小说下载器脚本将会发送当前书籍详情页URL及目录页URL（如果存在）至存档服务后端。\n该过程将会搜集并上报您如下信息：IP地址、User-Agent、Referer、当前书籍详情页URL、当前书籍目录页URL（如果存在）、当前小说下载器脚本版本、当前脚本管理器版本。\n除上述信息外，不会搜集您任何其他信息。\n\n本存档功能为主体功能以外的附加功能，同意与否并不影响小说下载功能的正常使用。");return await(0,o._u)(e,JSON.stringify(t)),t}try{const e=JSON.parse(t);if("boolean"!=typeof e)throw new Error("value is not boolean");return e}catch(t){return await(0,o.jF)(e),!1}}},(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var o=n(8),r=n.n(o),a=n(9),i=n.n(a)()(r());i.push([e.id,'.nd-setting-body {\n  background: #e0e0e0;\n  padding: 1em;\n  border-top-right-radius: 3px;\n}\n.nd-setting-body hr {\n  margin-top: 0.8em;\n  margin-bottom: 0.8em;\n}\n.nd-setting-body input[type="checkbox"],\n.nd-setting-body input[type="radio"],\n.nd-setting-body input[type="text"] {\n  position: static;\n  opacity: 1;\n  all: revert;\n}\ndialog-ui .tab-button {\n  padding: 6px 10px;\n  border-top-left-radius: 3px;\n  border-top-right-radius: 3px;\n  border: 1px solid #ccc;\n  cursor: pointer;\n  background: #f0f0f0;\n  margin-bottom: -1px;\n  margin-right: -1px;\n  color: black;\n  line-height: normal;\n  display: inline-block;\n  text-align: center;\n  font-weight: bold;\n  max-width: 9em;\n  box-sizing: initial;\n}\ndialog-ui .tab-button:hover {\n  background: #e0e0e0;\n}\ndialog-ui .tab-button.active {\n  background: #e0e0e0;\n}\ndialog-ui #nd-setting-tab-1 input + label {\n  all: revert;\n}\ndialog-ui #nd-setting-tab-2 select {\n  all: revert;\n}\n.nd-setting-footer {\n  background: #e0e0e0;\n  padding-bottom: 0.7em;\n  text-align: center;\n  border-bottom-left-radius: 3px;\n  border-bottom-right-radius: 3px;\n}\n.nd-setting-footer > button {\n  all: revert;\n}\n/* 日志页面 */\n#novel-downloader-log {\n  max-height: 300px;\n  overflow: scroll;\n}\n/* 彩色斜纹 来自：https://www.zhangxinxu.com/wordpress/2021/05/css-html-hr/ */\n.hr-twill-colorful {\n  all: revert;\n  border: 0;\n  padding: 3px;\n  background: linear-gradient(135deg, red, orange, green, blue, purple);\n  --mask-image: repeating-linear-gradient(135deg, #000 0px, #000 1px, transparent 1px, transparent 6px);\n  -webkit-mask-image: var(--mask-image);\n  mask-image: var(--mask-image);\n}\n/* 两头虚 来自：https://www.zhangxinxu.com/wordpress/2021/05/css-html-hr/ */\n.hr-edge-weak {\n  all: revert;\n  border: 0;\n  padding-top: 1px;\n  background: linear-gradient(to right, transparent, #d0d0d5, transparent);\n}\n',""]);const c=i},(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var o=n(8),r=n.n(o),a=n(9),i=n.n(a)()(r());i.push([e.id,"#test-page-div {\n  max-height: 300px;\n  overflow-y: scroll;\n}\n#test-page-div table {\n  text-align: center;\n}\n#test-page-div td {\n  all: revert;\n  padding-top: 0.3em;\n}\n#test-page-div td > img {\n  max-height: 15em;\n}\n#test-page-div tr > td:nth-child(1) {\n  font-weight: bold;\n  min-width: 7em;\n}\n#test-page-div tr > td:nth-child(2) div,\n#test-page-div tr > td:nth-child(2) p {\n  text-align: left;\n}\n#test-page-div hr {\n  margin-top: 1.5em;\n  margin-bottom: 1.5em;\n}\n#test-page-div h2 {\n  text-align: center;\n  margin-bottom: 1.3em;\n}\n#test-page-div h4 {\n  text-align: center;\n}\n#test-page-div .chapter p {\n  line-height: 1.4;\n}\n#test-page-div .chapter img {\n  max-width: 95%;\n}\n#test-page-div .preview-chapter-setting {\n  text-align: center;\n}\n",""]);const c=i},(e,t,n)=>{"use strict";n.d(t,{gc:()=>l,dK:()=>d,pN:()=>u,CE:()=>h,VO:()=>m,r6:()=>p});var o=n(20),r=n(22),a=n(5),i=n.n(a),c=n(1);let s=[];function l(e){return s.find((t=>t.url===e))}function d(e){return s.push(e),!0}function u(){s=[]}async function h(e,t,n="",a=!1,c=m(),s){if("naive"===t){const t=new URL(e);"https:"===document.location.protocol&&"http:"===t.protocol&&(t.protocol=document.location.protocol,e=t.href)}const u=l(e);if(u)return u;const h=new o.J(e,c,t,s?.referrerMode,s?.customReferer);h.comments=c;const g=await h.init();if(g)if(a)h.name=function(e){const t=new URL(e).pathname;return t.substring(t.lastIndexOf("/")+1)}(e);else{const t=await(0,r.K)(g),o=p(g,e);h.name=[n,t,".",o].join("")}return d(h),i().debug(`[attachment]下载附件完成！ url:${h.url}, name: ${h.name}`),h}function m(){return`__${(0,c.HP)()}__`}function p(e,t){const n=e.type.split(";")[0].split("/")[1];return["octet-stream"].includes(n)?function(e){const t=new URL(e).pathname;return t.substring(t.lastIndexOf(".")+1)}(t):n}},(e,t,n)=>{"use strict";n.d(t,{J:()=>l});var o=n(21),r=n(1),a=n(5),i=n.n(a),c=n(16),s=n(2);class l{url;name;mode;referrerMode;customReferer;status=s.qb.pending;retryTime=0;defaultHeader={Referer:document.location.origin};imageBlob;comments;constructor(e,t,n,o=s.n6.keep,r=""){this.url=e,this.name=t,this.mode=n,this.referrerMode=o,this.customReferer=r}async init(){return"naive"===this.mode?this.imageBlob=await this.downloadImage():this.imageBlob=await this.tmDownloadImage(),this.imageBlob&&i().info(`[attachment] ${this.url} 下载完成。`),this.imageBlob}downloadImage(){this.status=s.qb.downloading;const e={headers:this.defaultHeader};return this.referrerMode===s.n6.none&&(e.headers={},e.referrerPolicy="no-referrer"),fetch(this.url,e).then((e=>{if(e.ok)return this.status=s.qb.finished,e.blob();throw 404===e.status&&(this.status=s.qb.failed),new Error(`Bad response!\nRequest url: ${this.url}\nStatus code: ${e.status}`)})).catch((async e=>(this.retryTime++,i().error(`[attachment]下载 ${this.url} 出错，第${this.retryTime}次重试，下载模式：${this.mode}`),this.status!==s.qb.failed&&this.retryTime<c.o5?(await(0,r._v)(1500*this.retryTime),this.downloadImage()):(this.status=s.qb.failed,i().error(e),i().trace(e),null))))}tmDownloadImage(){this.status=s.qb.downloading;let e=this.defaultHeader;if(this.referrerMode===s.n6.none&&(e={}),this.referrerMode===s.n6.self){const t=new URL(this.url).origin;e.Referer=t}this.referrerMode===s.n6.custom&&this.customReferer.startsWith("http")&&(e.Referer=this.customReferer);const t={headers:this.defaultHeader,responseType:"blob"};return(0,o.GF)(this.url,t).then((e=>{if(e.status>=200&&e.status<=299)return this.status=s.qb.finished,e.response;throw 404===e.status&&(this.status=s.qb.failed),new Error(`Bad response!\nRequest url: ${this.url}\nStatus code: ${e.status}`)})).catch((async e=>(this.retryTime++,i().error(`[attachment]下载 ${this.url} 出错，第${this.retryTime}次重试，下载模式：${this.mode}`),this.status!==s.qb.failed&&this.retryTime<c.o5?(await(0,r._v)(1e3*this.retryTime),this.tmDownloadImage()):(this.status=s.qb.failed,i().error(e),i().trace(e),null))))}toJSON(){return{url:this.url,name:this.name,mode:this.mode,status:this.status,retryTime:this.retryTime}}}},(e,t,n)=>{"use strict";n.d(t,{q4:()=>s,GF:()=>l,dL:()=>d,rf:()=>u,_7:()=>h,Fz:()=>m,jt:()=>p});var o=n(5),r=n.n(o),a=n(16),i=n(3),c=n(1);async function s(e,t){let n=a.o5;for(;n>0;){const o=await fetch(e,t);if(o.ok)return o;await(0,c._v)(1e3*(a.o5-n)),n--}throw new Error(`Fetch with retry failed! Url: ${e}`)}function l(e,{method:t="GET",headers:n,data:o,cookie:a,binary:c,nocache:s,revalidate:l,timeout:d,context:u,responseType:h,overrideMimeType:m,anonymous:p,user:g,password:f}={}){return new Promise(((b,w)=>{r().debug("[debug]gfetch:"),r().debug(Array.from(arguments)),(0,i.UX)({url:e,method:t,headers:n,data:o,cookie:a,binary:c,nocache:s,revalidate:l,timeout:d,context:u,responseType:h,overrideMimeType:m,anonymous:p,user:g,password:f,onload:e=>{b(e)},onerror:e=>{w(e)}})}))}async function d(e,t,n){const o=await async function(e,t,n){const o=new URL(e);return"https:"===document.location.protocol&&"http:"===o.protocol&&(o.protocol="https:",e=o.toString()),void 0===t?fetch(e,n).then((t=>{if(t.ok)return t.text();throw new Error(`Bad response! ${e}`)})).catch((e=>r().error(e))):fetch(e,n).then((t=>{if(t.ok)return t.arrayBuffer();throw new Error(`Bad response! ${e}`)})).then((e=>new TextDecoder(t).decode(e))).catch((e=>r().error(e)))}(e,t,n);if(!o)throw new Error("Fetch Content failed!");return(new DOMParser).parseFromString(o,"text/html")}async function u(e,t,n){let o=a.o5,i=null;for(;o>0;)try{i=await d(e,t,n),o=0}catch(t){r().error(`抓取${e}失败，重试第${a.o5-o}次。`),r().error(t),o--,await(0,c._v)(1e3*(a.o5-o))}return i}async function h(e,t,n){return void 0===t?l(e,n).then((t=>{if(t.status>=200&&t.status<=299)return t.responseText;throw new Error(`Bad response! ${e}`)})).catch((e=>r().error(e))):(n?n.responseType="arraybuffer":n={responseType:"arraybuffer"},l(e,n).then((t=>{if(t.status>=200&&t.status<=299)return t.response;throw new Error(`Bad response! ${e}`)})).then((e=>new TextDecoder(t).decode(e))).catch((e=>r().error(e))))}async function m(e,t,n){const o=await h(e,t,n);if(!o)throw new Error("Fetch Content failed!");return(new DOMParser).parseFromString(o,"text/html")}async function p(e){const t=document.createElement("iframe");t.src=e,t.width="1",t.height="1";const n=new Promise(((e,n)=>{t.addEventListener("load",(function(t){const n=this.contentWindow?.document??null;this.remove(),e(n)}))}));return r().debug("[debug]getFrameContent:"+e),document.body.appendChild(t),n}globalThis.fetch=new Proxy(globalThis.fetch,{apply:(e,t,n)=>(r().debug("[debug]fetch:"),r().debug(n),Reflect.apply(e,t,n))})},(e,t,n)=>{"use strict";n.d(t,{K:()=>r});var o=n(23);async function r(e){if("function"==typeof crypto?.subtle?.digest){const t=await e.arrayBuffer(),n=await crypto.subtle.digest("SHA-1",t);return Array.from(new Uint8Array(n)).map((e=>e.toString(16).padStart(2,"0"))).join("")}return new Promise(((t,n)=>{const r=new FileReader;r.readAsArrayBuffer(e),r.onloadend=()=>{if(r.result){const e=o.lib.WordArray.create(r.result),n=o.SHA1(e).toString();t(n)}else n(Error("计算MD5值出错"))}}))}},e=>{"use strict";e.exports=CryptoJS},(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var o=n(8),r=n.n(o),a=n(9),i=n.n(a)()(r());i.push([e.id,".overlay {\n  visibility: hidden;\n  opacity: 0;\n  z-index: 100000;\n  position: fixed;\n  top: -50%;\n  left: -50%;\n  height: 200%;\n  width: 200%;\n  background-color: black;\n}\n.overlay.open {\n  opacity: 0.8;\n  visibility: visible;\n  transition: opacity 0.2s ease-in;\n}\n.overlay:not(.open) {\n  transition: visibility 0.2s step-end, opacity 0.2s ease-in;\n}\n\n.out {\n  position: fixed;\n  top: 0;\n  left: 0;\n  height: 100%;\n  width: 100%;\n\n  display: flex;\n  justify-content: center;\n  align-items: center;\n\n  z-index: 100001;\n}\n\n.dialog {\n  width: 720px;\n  max-height: 70%;\n  display: none;\n  opacity: 0;\n  z-index: 100100;\n  position: fixed;\n  margin: 0;\n  padding: 0;\n}\n.dialog.open {\n  opacity: 1;\n  display: block;\n  transition: opacity 0.2s ease-in;\n}\n\n.dialog > * {\n  box-sizing: border-box;\n}\n.dialog > .titlebar {\n  background-color: white;\n  min-height: 24px;\n  position: relative;\n}\n.dialog-title {\n  padding: 10px;\n  text-transform: uppercase;\n  background: #ff7bac;\n  color: #ffffff;\n  margin: 0;\n  font-size: 1.5em;\n  text-align: center;\n}\n.dialog-close {\n  background: #ff7bac;\n  color: #ffffff;\n\n  font-style: normal;\n  font-weight: 400;\n  font-variant: normal;\n  text-transform: none;\n  line-height: 1;\n  user-select: none;\n\n  cursor: pointer;\n  font-size: 120%;\n  margin: 0;\n  padding: 0;\n  width: 3.6em;\n  height: 92%;\n  border: 1px solid transparent;\n  transition-duration: 0.2s;\n  display: block;\n\n  position: absolute;\n  right: 0;\n  top: 0;\n  white-space: nowrap;\n}\n\n.dialog > .body {\n  background-color: white;\n  border: 1px solid rgb(255 125 175 / 80%);\n  text-align: left;\n\n  line-height: 1.5;\n  padding: 1em;\n\n  overflow: auto;\n  min-width: 280px;\n\n  height: calc(100% - 2.1em);\n  max-height: 900px;\n}\n",""]);const c=i},(e,t,n)=>{"use strict";n.d(t,{el:()=>c,o:()=>i,vm:()=>s});var o=n(6),r=n(12),a=n(26);const i=(0,r.wj)(a.Z),c=(0,r.ut)('<div id="progress-bar"></div>'),s=(0,o.createApp)({data:()=>({totalChapterNumber:0,finishedChapterNumber:0}),computed:{chapterPercent(){return 0!==this.totalChapterNumber&&0!==this.finishedChapterNumber?this.finishedChapterNumber/this.totalChapterNumber*100:0},chapterProgressSeen(){return 0!==this.chapterPercent},ntProgressSeen(){return!(!this.chapterProgressSeen&&!this.zipProgressSeen)},chapterProgressTitle(){return`章节：${this.finishedChapterNumber}/${this.totalChapterNumber}`}},methods:{reset(){this.totalChapterNumber=0,this.finishedChapterNumber=0}},template:'<div> <div id="nd-progress" v-if="ntProgressSeen"> <div v-if="chapterProgressSeen" id="chapter-progress" v-bind:style="{\'--position\': chapterPercent+\'%\'}" v-bind:title="chapterProgressTitle"></div> </div> </div> '}).mount(c)},(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var o=n(8),r=n.n(o),a=n(9),i=n.n(a)()(r());i.push([e.id,"#nd-progress {\n  position: fixed;\n  bottom: 8%;\n  right: 3%;\n  z-index: 2147483647;\n  border-style: none;\n  text-align: center;\n  vertical-align: baseline;\n  background-color: rgba(210, 210, 210, 0.2);\n  padding: 6px;\n  border-radius: 12px;\n}\n#chapter-progress {\n  --color: green;\n  --position: 0%;\n  width: 200px;\n  height: 10px;\n  border-radius: 30px;\n  background-color: #ccc;\n  background-image: radial-gradient(\n      closest-side circle at var(--position),\n      var(--color),\n      var(--color) 100%,\n      transparent\n    ),\n    linear-gradient(var(--color), var(--color));\n  background-image: -webkit-radial-gradient(\n      var(--position),\n      circle closest-side,\n      var(--color),\n      var(--color) 100%,\n      transparent\n    ),\n    -webkit-linear-gradient(var(--color), var(--color));\n  background-size: 100%, var(--position);\n  background-repeat: no-repeat;\n}\n#zip-progress {\n  --color: yellow;\n  --position: 0%;\n  width: 200px;\n  height: 10px;\n  border-radius: 30px;\n  background-color: #ccc;\n  background-image: radial-gradient(\n      closest-side circle at var(--position),\n      var(--color),\n      var(--color) 100%,\n      transparent\n    ),\n    linear-gradient(var(--color), var(--color));\n  background-image: -webkit-radial-gradient(\n      var(--position),\n      circle closest-side,\n      var(--color),\n      var(--color) 100%,\n      transparent\n    ),\n    -webkit-linear-gradient(var(--color), var(--color));\n  background-size: 100%, var(--position);\n  background-repeat: no-repeat;\n  margin-top: 5px;\n}\n",""]);const c=i},(e,t,n)=>{"use strict";n.d(t,{yt:()=>c,Cm:()=>s,Ty:()=>l});var o=n(3),r=n(4),a=n(16);function i(e){const t=window[e],n=t.toString().length,o=t.prototype,r=/function \w+\(\) {\n?(\s+)?\[native code\]\n?(\s+)?}/;try{if(void 0===o||Boolean(t.toString().match(r)))return[!0,n].join(", ")}catch{return[!0,n].join(", ")}return[!1,n].join(", ")}function c(){return"undefined"!=typeof ReadableStream&&"undefined"!=typeof WritableStream&&"undefined"!=typeof TransformStream}function s(e){return new Promise(((t,n)=>{fetch(e).then((e=>t(!0))).catch((e=>t(!1)))}))}const l=async()=>({当前时间:(new Date).toISOString(),当前页URL:document.location.href,workerId:window.workerId,当前页Referrer:document.referrer,浏览器UA:navigator.userAgent,浏览器语言:navigator.languages,设备运行平台:navigator.platform,设备内存:navigator.deviceMemory??"",CPU核心数:navigator.hardwareConcurrency,eval:i("eval"),fetch:i("fetch"),XMLHttpRequest:i("XMLHttpRequest"),streamSupport:c(),window:Object.keys(window).length,localStorage:(0,r.o)("localStorage"),sessionStorage:(0,r.o)("sessionStorage"),Cookie:navigator.cookieEnabled,doNotTrack:navigator.doNotTrack??0,enableDebug:a.Cy.value,ScriptHandler:o._p.scriptHandler,"ScriptHandler version":o._p.version,"Novel-downloader version":o._p.script.version})},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Ciweimao:()=>f});var o=n(23),r=n(19),a=n(36),i=n(21),c=n(12),s=n(35),l=n(5),d=n.n(l),u=n(2),h=n(20),m=n(37),p=n(38),g=n(29);class f extends g.c{constructor(){super(),this.imageMode="TM",this.charset="UTF-8",this.concurrencyLimit=1,this.maxRunLimit=1}async bookParse(){const e=`https://www.ciweimao.com/book/${unsafeWindow.HB.book.book_id}`,t=document.querySelector(".book-catalog .hd h3").innerText.trim(),n=document.querySelector(".book-catalog .hd > p > a").innerText.trim(),o=await(0,i.dL)(e,void 0),a=o.querySelector(".book-intro-cnt .book-desc"),[c,l]=await(0,s.SN)(a),h={},g=o.querySelector(".cover > img").src;g&&(0,r.CE)(g,this.imageMode,"cover-").then((e=>{h.cover=e})).catch((e=>d().error(e))),h.tags=Array.from(o.querySelectorAll(".label-box > .label")).map((e=>e.innerText.trim()));const f=[],b=document.querySelectorAll(".book-chapter > .book-chapter-box");let w=0;for(let n=0;n<b.length;n++){const o=b[n],r=n+1,a=o.querySelector(".sub-tit").innerText;let i=0;const c=o.querySelectorAll(".book-chapter-list > li > a");for(const n of Array.from(c)){w++,i++;const o=n.innerText.trim(),c=n.href;let s=!1,l=!1;n.childElementCount&&(s=!0,"icon-unlock"===n.firstElementChild?.className&&(l=!0));const d=new m.W({bookUrl:e,bookname:t,chapterUrl:c,chapterNumber:w,chapterName:o,isVIP:s,isPaid:l,sectionName:a,sectionNumber:r,sectionChapterNumber:i,chapterParse:this.chapterParse,charset:this.charset,options:{}}),h=1===document.querySelector(".login-info.ly-fr")?.childElementCount;!s||h&&l||(d.status=u.qb.aborted),f.push(d)}}const y=new p.f({bookUrl:e,bookname:t,author:n,introduction:c,introductionHTML:l,additionalMetadate:h,chapters:f});return y.ToCUrl=document.location.href,y}async chapterParse(e,t,n,r,s,l){function m(e){let t=e.content;const n=e.keys,r=e.keys.length,a=e.accessKey.split(""),i=a.length,c=[];c.push(n[a[i-1].charCodeAt(0)%r]),c.push(n[a[0].charCodeAt(0)%r]);for(let e=0;e<c.length;e++){t=atob(t);const n=c[e],r=btoa(t.substr(0,16)),a=btoa(t.substr(16)),i=o.format.OpenSSL.parse(a);t=o.AES.decrypt(i,o.enc.Base64.parse(n),{iv:o.enc.Base64.parse(r),format:o.format.OpenSSL}),e<c.length-1&&(t=t.toString(o.enc.Base64),t=atob(t))}return t.toString(o.enc.Utf8)}async function p(){const t=(await(0,i.dL)(e,void 0)).querySelectorAll("#J_BookCnt .chapter.author_say");let n;if(0!==t.length){const e=document.createElement("hr");n=document.createElement("div"),n.appendChild(e);for(const e of Array.from(t))(0,c.rm)("i",!0,e),n.appendChild(e)}return n}const g=e.split("/").slice(-1)[0];return n?async function(){if(1===document.querySelector(".login-info.ly-fr")?.childElementCount&&r){const n=await p(),o=await async function(e,t){const n=unsafeWindow.HB,o=n.config.rootPath+"chapter/ajax_get_image_session_code";d().debug(`[Chapter]请求 ${o} Referer ${t}`);const r=await(0,i.GF)(o,{method:"POST",headers:{Accept:"application/json, text/javascript, */*; q=0.01",Referer:t,Origin:"https://www.ciweimao.com","X-Requested-With":"XMLHttpRequest"},responseType:"json"}).then((e=>e.response)).catch((e=>d().error(e)));if(1e5!==r.code)throw d().error(r),new Error(`下载 ${t} 失败`);const a=m({content:r.image_code,keys:r.encryt_keys,accessKey:r.access_key});return n.config.rootPath+"chapter/book_chapter_image?chapter_id="+e+"&area_width=871&font=undefined&font_size=14&image_code="+a+"&bg_color_name=white&text_color_name=white"}(g,e);d().debug(`[Chapter]请求 ${o} Referer ${e}`);const r=await(0,i.GF)(o,{method:"GET",headers:{Referer:e,Accept:"image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8"},responseType:"blob"}).then((e=>e.response)).catch((e=>d().error(e))),c=`vipCHapter${g}.png`,s=new h.J(o,c,"TM");r&&(s.imageBlob=r,s.status=u.qb.finished);const l=[s];let f,b;if(n){const{dom:e,text:t,images:o}=await(0,a.zM)(n,"TM");[f,b]=[e,t,o]}const w=document.createElement("img");w.src=c,w.alt=o;const y=document.createElement("div");y.appendChild(w),f&&y.appendChild(f);let v=`VIP章节，请打开HTML文件查看。\n![${o}](${c})`;return b&&(v=v+"\n\n"+b),{chapterName:t,contentRaw:y,contentText:v,contentHTML:y,contentImages:l,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}():async function(){const n=await p(),o=document.createElement("div"),r=await async function(e,t){const n="https://www.ciweimao.com/",o=n+"chapter/ajax_get_session_code",r=n+"chapter/get_book_chapter_detail_info";d().debug(`[Chapter]请求 ${o} Referer ${t}`);const a=(await(0,i.GF)(o,{method:"POST",headers:{Accept:"application/json, text/javascript, */*; q=0.01","Content-Type":"application/x-www-form-urlencoded; charset=UTF-8",Referer:t,Origin:"https://www.ciweimao.com","X-Requested-With":"XMLHttpRequest"},data:`chapter_id=${e}`,responseType:"json"}).then((e=>e.response)).catch((e=>d().error(e)))).chapter_access_key;d().debug(`[Chapter]请求 ${r} Referer ${t}`);const c=await(0,i.GF)(r,{method:"POST",headers:{Accept:"application/json, text/javascript, */*; q=0.01","Content-Type":"application/x-www-form-urlencoded; charset=UTF-8",Referer:t,Origin:"https://www.ciweimao.com","X-Requested-With":"XMLHttpRequest"},data:`chapter_id=${e}&chapter_access_key=${a}`,responseType:"json"}).then((e=>e.response)).catch((e=>d().error(e)));if(1e5!==c.code)throw d().error(c),new Error(`下载 ${t} 失败`);return m({content:c.chapter_content,keys:c.encryt_keys,accessKey:a})}(g,e);o.innerHTML=r,(0,c.rm)(".chapter span",!0,o),n&&o.appendChild(n);const{dom:s,text:l,images:u}=await(0,a.zM)(o,"TM");return{chapterName:t,contentRaw:o,contentText:l,contentHTML:s,contentImages:u,additionalMetadate:null}}()}}},(e,t,n)=>{"use strict";n.d(t,{c:()=>z});var o=n(19),r=n(1),a=n(14),i=n(5),c=n.n(i),s=n(2),l=n(16),d=n(34),u=n(3);const h=fflate;var m=n(15),p=n(33),g=n.n(p),f=n(27);class b{filename;stream;zcount=0;count=0;filenameList=[];zipOut=new Blob([],{type:"application/zip"});savedZip;constructor(e,t){c().info(`[fflateZip] filename: ${e}, stream: ${t}, streamSaver.supported: ${g().supported}`);const n=this;let o;if(this.filename=e,g().supported?this.stream=t:this.stream=!1,this.stream){const e=g().createWriteStream(n.filename);o=e.getWriter()}this.savedZip=new h.Zip(((e,t,r)=>{if(e)throw c().error(e),c().trace(e),n.stream&&o.abort(),e;n.stream?o.write(t):n.zipOut=new Blob([n.zipOut,t],{type:"application/zip"}),r&&(n.stream?(o.close(),c().info("[fflateZip] ZIP生成完毕")):function(){c().info("[fflateZip] ZIP生成完毕，文件大小："+n.zipOut.size);try{(0,m.saveAs)(n.zipOut,n.filename),n.zipOut=new Blob([],{type:"application/zip"})}catch(e){c().error("[fflateZip]"+e),c().trace(e)}}())}))}async file(e,t,n=!1){if(this.filenameList.includes(e))return void c().warn(`filename ${e} has existed on zip.`);this.filenameList.push(e),this.count++;const o=await t.arrayBuffer(),r=new Uint8Array(o);if(t.type.includes("image/")||n){const t=new h.ZipPassThrough(e);this.savedZip.add(t),t.push(r,!0),this.zcount++}else{const t=new h.AsyncZipDeflate(e,{level:9});this.savedZip.add(t),t.push(r,!0),this.zcount++}}async generateAsync(){for(;this.count!==this.zcount;)await(0,r._v)(100);this.savedZip.end()}}var w=n(30),y=n(31),v=n(12);class x extends class{genMetaDateTxt(e){let t=`题名：${e.bookname}\n作者：${e.author}`;return e.additionalMetadate.tags&&(t+=`\nTag列表：${e.additionalMetadate.tags.join("、")}`),t+=`\n原始网址：${e.bookUrl}`,e.additionalMetadate.cover&&(t+=`\n封面图片地址：${e.additionalMetadate.cover.url}`),e.introduction&&(t+=`\n简介：${e.introduction}`),t+=`\n下载时间：${(new Date).toISOString()}\n本文件由小说下载器生成，软件地址：https://github.com/yingziwu/novel-downloader\n\n`,t}getChapterNumberToSave(e,t){return`${"0".repeat(t.length.toString().length-Math.trunc(e.chapterNumber).toString().length)}${e.chapterNumber.toString()}`}}{mainStyleText=w.Z;tocStyleText=y.Z;getchapterName(e){return e.chapterName?e.chapterName:e.chapterNumber.toString()}genSectionText(e){return`${"=".repeat(20)}\n\n\n\n# ${e}\n\n\n\n${"=".repeat(20)}\n\n`}genChapterText(e,t){return`${e}\n${"=".repeat(2*(0,v.sp)(e)+10)}\n\n${t}\n\n`}chapterSort(e,t){return e.chapterNumber-t.chapterNumber}}var T=n(32),S=n(11);const A=nunjucks,k=new A.Environment(void 0,{autoescape:!1}),N=new A.Template('<!DOCTYPE html> <html> <head> <meta charset="UTF-8"/> <meta name="viewport" content="width=device-width,initial-scale=1"/> <meta name="referrer" content="same-origin"/> <meta name="generator" content="https://github.com/yingziwu/novel-downloader"/> <link href="style.css" rel="stylesheet"/> <title>{{ sectionName }}</title> </head> <body> <div class="main"><h1>{{ sectionName }}</h1></div> </body> </html> ',k,void 0,!0),M=new A.Template('<!DOCTYPE html> <html> <head> <meta charset="UTF-8"/> <meta name="viewport" content="width=device-width,initial-scale=1"/> <meta name="referrer" content="same-origin"/> <meta name="generator" content="https://github.com/yingziwu/novel-downloader"/> <meta name="source" content="{{ chapterUrl }}"/> <link href="style.css" rel="stylesheet"/> <title>{{ chapterName }}</title> </head> <body> <div class="main"> <h2>{{ chapterName }}</h2> {{ outerHTML }} </div> </body> </html> ',k,void 0,!0),C=new A.Template('<!DOCTYPE html> <html> <head> <meta charset="UTF-8"/> <meta name="viewport" content="width=device-width,initial-scale=1"/> <meta name="referrer" content="same-origin"/> <meta name="generator" content="https://github.com/yingziwu/novel-downloader"/> <meta name="date-creation" content="{{ creationDate }}"/> <link href="style.css" rel="stylesheet"/> <link href="web.css" rel="stylesheet"/> <link href="toc.css" rel="stylesheet"/> <title>{{ bookname }}</title> </head> <body> <div class="main"> <h1>{{ bookname }}</h1> <h3 class="author">{{ author }}</h3> <div class="info"> {% if cover -%} <img class="cover" data-src-address="{{ cover.name }}"/> {%- endif %} {% if introductionHTML -%} <div> <h3>简介</h3> <div class="introduction">{{ introductionHTML }}</div> </div> {%- endif %} </div> <div class="bookurl"> <a href="{{ bookUrl }}">打开原始网站</a> </div> <hr/> {% for sectionObj in sectionsObj -%} <div id="section{{ sectionObj.sectionNumber }}" class="section"> {% if sectionObj.sectionName %} <h2 class="section-label">{{ sectionObj.sectionName }}</h2> {% endif %} {% for chapter in sectionObj.chpaters -%} <div class="chapter"> {% if not (chapter.contentHTML or chapter.status === Status.saved) -%} <a class="disabled" href="{{ chapter.chapterHtmlFileName }}">{{ chapter.chapterName }}</a> {%- else -%} <a href="{{ chapter.chapterHtmlFileName }}">{{ chapter.chapterName }}</a> {%- endif %} </div> {%- endfor %} </div> {%- endfor %} </div> </body> </html>',k,void 0,!0);class E extends x{book;chapters;savedZip;constructor(e,t,n){super(),this.book=e,this.chapters=this.book.chapters;const o=`[${this.book.author}]${this.book.bookname}.zip`;this.savedZip=new b(o,t),n&&Object.assign(this,n)}async saveLog(){await this.savedZip.file("debug.log",new Blob([a.KC],{type:"text/plain; charset=UTF-8"}))}async saveZip(){const e=this;c().debug("[save]保存元数据文本");const t=this.genMetaDateTxt(this.book);if(await this.savedZip.file("info.txt",new Blob([t],{type:"text/plain;charset=utf-8"})),c().debug("[save]保存样式"),await this.savedZip.file("style.css",new Blob([this.mainStyleText],{type:"text/css;charset=utf-8"})),await this.savedZip.file("web.css",new Blob([T.Z],{type:"text/css;charset=utf-8"})),e.book.additionalMetadate.cover?e.tocStyleText=`${e.tocStyleText}\n  .info {\n    display: grid;\n    grid-template-columns: 30% 70%;\n  }`:e.tocStyleText=`${e.tocStyleText}\n  .info {\n    display: grid;\n    grid-template-columns: 100%;\n  }`,await this.savedZip.file("toc.css",new Blob([this.tocStyleText],{type:"text/css;charset=utf-8"})),this.book.additionalMetadate.cover&&(c().debug("[save]保存封面"),await this.addAttachmentToZip(this.book.additionalMetadate.cover,this.savedZip)),this.book.additionalMetadate.attachments){c().debug("[save]保存书籍附件");for(const e of this.book.additionalMetadate.attachments)await this.addAttachmentToZip(e,this.savedZip)}function n(t){const n=N.render({sectionName:t.sectionName}),o=e.addWebCSS(n),r=(0,v.fI)(o);return new Blob([r.replaceAll("data-src-address","src")],{type:"application/xhtml+xml; charset=UTF-8"})}c().debug("[save]开始生成并保存卷文件"),await async function(){c().debug("[save]对 chapters 排序"),e.chapters.sort(e.chapterSort);const t=[];for(const o of e.chapters){const r=`No${e.getChapterNumberToSave(o,e.chapters)}Section.xhtml`;if(o.sectionName&&!t.includes(o.sectionName)){t.push(o.sectionName),c().debug(`[save]保存卷HTML文件：${o.sectionName}`);const a=n(o);await e.savedZip.file(r,a)}}}(),c().debug("[save]保存已完成章节文件"),await async function(t){const n=t.filter((e=>e.status===s.qb.finished));for(const t of n)await e.addChapter(t)}(this.chapters),c().debug("[save]开始生成并保存 index.html"),await async function(){c().debug("[save]对 chapters 排序"),e.chapters.sort(e.chapterSort);const t=(0,S.f)(e.chapters,e.chapterSort),n=C.render({creationDate:Date.now(),bookname:e.book.bookname,author:e.book.author,cover:e.book.additionalMetadate.cover,introductionHTML:e.book.introductionHTML?.outerHTML,bookUrl:e.book.bookUrl,sectionsObj:Object.values(t),Status:s.qb}),o=(0,v.fI)(n);await e.savedZip.file("index.xhtml",new Blob([o.replaceAll("data-src-address","src")],{type:"application/xhtml+xml; charset=UTF-8"}))}(),c().debug("[save]开始保存 Meta Data Json"),await async function(){await e.savedZip.file("book.json",new Blob([JSON.stringify(e.book)],{type:"application/json; charset=utf-8"})),await e.savedZip.file("chapters.json",new Blob([JSON.stringify(e.book.chapters)],{type:"application/json; charset=utf-8"}))}(),c().debug("[save]保存仅标题章节文件"),await async function(t){t=t.filter((e=>e.status!==s.qb.saved));for(const n of t)n.status===s.qb.finished?await e.addChapter(n):await e.addChapter(n,"Stub")}(this.chapters),c().info("[save]开始保存ZIP文件"),l.Cy.value&&await e.saveLog(),await this.savedZip.generateAsync()}async addChapter(e,t=""){const n=this.getchapterName(e),o=`No${this.getChapterNumberToSave(e,this.chapters)}Chapter${t}.xhtml`;c().debug(`[save]保存章HTML文件：${n}`);const r=this.genChapterHtmlFile(e);if(await this.savedZip.file(o,r),e.chapterHtmlFileName=o,e.contentImages&&0!==e.contentImages.length){c().debug(`[save]保存章节附件：${n}`);for(const t of e.contentImages)await this.addAttachmentToZip(t,this.savedZip)}}genChapterHtmlFile(e){const t=M.render({chapterUrl:e.chapterUrl,chapterName:e.chapterName,outerHTML:e.contentHTML?.outerHTML??""}),n=this.addWebCSS(t),o=(0,v.fI)(n);return new Blob([o.replaceAll("data-src-address","src")],{type:"application/xhtml+xml; charset=UTF-8"})}addWebCSS(e){const t=(new DOMParser).parseFromString(e,"text/html"),n=document.createElement("link");return n.href="web.css",n.type="text/css",n.rel="stylesheet",t.head.appendChild(n),t}async addAttachmentToZip(e,t){e.status===s.qb.finished&&e.imageBlob?(c().debug(`[save]添加附件，文件名：${e.name}，对象`,e.imageBlob),await t.file(e.name,e.imageBlob)):e.status===s.qb.saved?c().debug(`[save]附件${e.name}已添加`):(c().warn(`[save]添加附件${e.name}失败，该附件未完成或内容为空。`),c().warn(e))}}function P(){const e=new Date,t=e.getFullYear(),n=(new Date).getMonth()+1,o=n<10?`0${n}`:n,r=e.getDate();return`${t}-${o}-${r<10?`0${r}`:r}`}const q=(0,r.HP)(),L=`<?xml version="1.0" encoding="utf-8"?>\n<package version="2.0" unique-identifier="BookId" xmlns="http://www.idpf.org/2007/opf">\n  <metadata xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:opf="http://www.idpf.org/2007/opf">\n    <dc:identifier id="BookId" opf:scheme="UUID">urn:uuid:${q}</dc:identifier>\n    <meta content="${u._p.script.version}" name="novel-downloader version"/>\n    <dc:date opf:event="creation">${P()}</dc:date>\n    <dc:date opf:event="modification" xmlns:opf="http://www.idpf.org/2007/opf">${P()}</dc:date>\n  </metadata>\n  <manifest>\n    <item id="ncx" href="toc.ncx" media-type="application/x-dtbncx+xml"/>\n    <item id="sgc-toc.css" href="sgc-toc.css" media-type="text/css"/>\n    <item id="style.css" href="style.css" media-type="text/css"/>\n    <item id="cover.xhtml" href="cover.xhtml" media-type="application/xhtml+xml"/>\n    <item id="info.xhtml" href="info.xhtml" media-type="application/xhtml+xml"/>\n    <item id="TOC.xhtml" href="TOC.xhtml" media-type="application/xhtml+xml"/>\n  </manifest>\n  <spine toc="ncx">\n    <itemref idref="cover.xhtml"/>\n    <itemref idref="info.xhtml"/>\n    <itemref idref="TOC.xhtml"/>\n  </spine>\n  <guide>\n    <reference type="cover" title="Cover" href="cover.xhtml"/>\n    <reference type="toc" title="Table of Contents" href="TOC.xhtml"/>\n  </guide>\n</package>`,_=`<?xml version="1.0" encoding="utf-8" ?>\n<!DOCTYPE ncx PUBLIC "-//NISO//DTD ncx 2005-1//EN"\n "http://www.daisy.org/z3986/2005/ncx-2005-1.dtd">\n<ncx version="2005-1" xmlns="http://www.daisy.org/z3986/2005/ncx/">\n  <head>\n    <meta content="urn:uuid:${q}" name="dtb:uid"/>\n    <meta content="2" name="dtb:depth"/>\n    <meta content="0" name="dtb:totalPageCount"/>\n    <meta content="0" name="dtb:maxPageNumber"/>\n  </head>\n  <docTitle>\n    <text></text>\n  </docTitle>\n  <navMap>\n  </navMap>\n</ncx>`,U=(e,t)=>`<?xml version="1.0" encoding="utf-8"?>\n<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"\n  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">\n\n<html xmlns="http://www.w3.org/1999/xhtml">\n<head>\n  <title>信息页</title>\n  <link href="style.css" type="text/css" rel="stylesheet"/>\n</head>\n\n<body>\n  <div class="main">\n    <h1>${e}</h1>\n\n    ${t?`<h2>作者：${t}</h2>`:""}\n  </div>\n</body>\n</html>`;class I extends x{contentOpf=(new DOMParser).parseFromString(L,"application/xml");metadata=this.contentOpf.querySelector("metadata");manifest=this.contentOpf.querySelector("manifest");spine=this.contentOpf.querySelector("spine");guide=this.contentOpf.querySelector("guide");ncx=(new DOMParser).parseFromString(_,"application/xml");navMap=this.ncx.querySelector("navMap");toc=(new DOMParser).parseFromString('<?xml version="1.0" encoding="utf-8"?>\n<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"\n  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">\n\n<html xmlns="http://www.w3.org/1999/xhtml">\n<head>\n  <title>Table of Contents</title>\n  <link href="sgc-toc.css" rel="stylesheet" type="text/css"/>\n</head>\n<body>\n  <div class="sgc-toc-title">\n    目录\n  </div>\n</body>\n</html>',"application/xhtml+xml");tocBody=this.toc.body;book;chapters;epubZip;constructor(e,t,n){super(),this.book=e,this.chapters=this.book.chapters;const o=`[${this.book.author}]${this.book.bookname}.epub`;this.epubZip=new b(o,t),n&&Object.assign(this,n)}async addAttachment(e){if(e.status===s.qb.finished&&e.imageBlob){c().debug(`[save-epub]添加附件，文件名：${e.name}，对象`,e.imageBlob),await this.epubZip.file(`OEBPS/${e.name}`,e.imageBlob);const t=document.createElement("item");t.id=e.name,t.setAttribute("href",e.name),t.setAttribute("media-type",e.imageBlob.type),this.manifest.querySelector(`itme[id="${e.name}"]`)||this.manifest.appendChild(t)}else e.status===s.qb.saved?c().debug(`[save-epub]附件${e.name}已添加`):(c().warn(`[save-epub]添加附件${e.name}失败，该附件未完成或内容为空。`),c().warn(e))}async addChapter(e,t=""){const n=this.getchapterName(e),o=`No${this.getChapterNumberToSave(e,this.chapters)}Chapter${t}.xhtml`;c().debug(`[save-epub]保存章HTML文件：${n}`);const r=this.genChapterHtmlFile(e);await this.epubZip.file(`OEBPS/${o}`,r);const a=document.createElement("item");if(a.id=o,a.setAttribute("href",o),a.setAttribute("media-type","application/xhtml+xml"),this.manifest.querySelector(`itme[id="${o}"]`)||this.manifest.appendChild(a),e.contentImages&&0!==e.contentImages.length){c().debug(`[save-epub]保存章节附件：${n}`);for(const t of e.contentImages)await this.addAttachment(t)}}genChapterHtmlFile(e){const t=M.render({chapterUrl:e.chapterUrl,chapterName:e.chapterName,outerHTML:e.contentHTML?.outerHTML??""}),n=(0,v.fI)(t);return new Blob(['<?xml version="1.0" encoding="utf-8"?>\n    <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"\n      "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">',n.replaceAll("data-src-address","src").replace("<!DOCTYPE html>","")],{type:"application/xhtml+xml"})}async saveEpub(){const e=this;if(c().debug("[save-epub]保存epub基本文件"),await async function(){await e.epubZip.file("mimetype",new Blob(["application/epub+zip"]),!0),await e.epubZip.file("META-INF/container.xml",new Blob(['<?xml version="1.0" encoding="UTF-8"?>\n<container version="1.0" xmlns="urn:oasis:names:tc:opendocument:xmlns:container">\n    <rootfiles>\n        <rootfile full-path="OEBPS/content.opf" media-type="application/oebps-package+xml"/>\n    </rootfiles>\n</container>']))}(),c().debug("[save-epub]保存样式文件"),await async function(){await e.epubZip.file("OEBPS/style.css",new Blob([e.mainStyleText])),await e.epubZip.file("OEBPS/sgc-toc.css",new Blob([d.Z]))}(),c().debug("[save-epub]更新Metadata"),await async function(){const t=document.createElement("dc:title");t.innerText=e.book.bookname,e.metadata.appendChild(t),e.ncx.querySelector("docTitle > text").innerHTML=e.book.bookname;const n=document.createElement("dc:creator");n.setAttribute("opf:role",""),n.innerText=e.book.author,e.metadata.appendChild(n);const o=document.createElement("dc:source");if(o.innerText=e.book.bookUrl,e.metadata.appendChild(o),e.book.introduction){const t=document.createElement("dc:description");t.innerText=e.book.introduction,e.metadata.appendChild(t)}if(e.book.additionalMetadate.cover){await e.addAttachment(e.book.additionalMetadate.cover);const t=document.createElement("meta");t.name="cover",t.content=e.book.additionalMetadate.cover.name,await e.epubZip.file("OEBPS/cover.xhtml",new Blob([(r=e.book.additionalMetadate.cover.name,`<?xml version="1.0" encoding="utf-8"?>\n<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"\n  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">\n\n<html xmlns="http://www.w3.org/1999/xhtml">\n<head>\n  <title>Cover</title>\n</head>\n\n<body>\n  <div style="text-align: center; padding: 0pt; margin: 0pt;">\n    <svg xmlns="http://www.w3.org/2000/svg" height="100%" preserveAspectRatio="xMidYMid meet" version="1.1" viewBox="0 0 368 460" width="100%" xmlns:xlink="http://www.w3.org/1999/xlink"><image width="368" height="460" xlink:href="${r}"/></svg>\n  </div>\n</body>\n</html>`)]))}else e.manifest.querySelector('item[id="cover.xhtml"]')?.remove(),e.spine.querySelector('itemref[idref="cover.xhtml"]')?.remove(),e.guide.querySelector('reference[type="cover"]')?.remove();var r;if(e.book.additionalMetadate.tags)for(const t of e.book.additionalMetadate.tags){const n=document.createElement("dc:subject");n.innerText=t,e.metadata.appendChild(n)}await e.epubZip.file("OEBPS/info.xhtml",new Blob([U(e.book.bookname,e.book.author)]))}(),this.book.additionalMetadate.attachments){c().debug("[save]保存书籍附件");for(const e of this.book.additionalMetadate.attachments)await this.addAttachment(e)}c().debug("[save-epub]保存仅标题章节文件"),await async function(t){t=t.filter((e=>e.status!==s.qb.saved));for(const n of t)n.status===s.qb.finished?await e.addChapter(n):await e.addChapter(n,"Stub")}(this.chapters),c().debug("[save-epub]保存目录文件"),await async function(){c().debug("[save-epub]对 chapters 排序"),e.chapters.sort(e.chapterSort);const t=(0,S.f)(e.chapters,e.chapterSort);let n,o,r,a=0;for(const h of t){const{sectionName:t,sectionNumber:m,chpaters:p}=h;if(m!==n){const h=`No${e.getChapterNumberToSave(p[0],e.chapters)}Section.xhtml`;if(t){n=m,c().debug(`[save-epub]保存卷HTML文件：${t}`);const p=u(t);await e.epubZip.file(`OEBPS/${h}`,p),i(h),s(h),a++;const g=l(a,t,h);o&&e.navMap.appendChild(o),o=g;const f=d("sgc-toc-level-1",t,h);r&&e.tocBody.appendChild(r),r=f}}for(const n of p){const i=n.chapterHtmlFileName;if(t){s(i),a++;const e=l(a,n.chapterName??"",i);o?.appendChild(e);const t=d("sgc-toc-level-2",n.chapterName??"",i);r?.appendChild(t)}else{s(i),a++;const t=l(a,n.chapterName??"",i);e.navMap.appendChild(t);const o=d("sgc-toc-level-2",n.chapterName??"",i);e.tocBody.appendChild(o)}}}function i(t){const n=document.createElement("item");n.id=t,n.setAttribute("href",t),n.setAttribute("media-type","application/xhtml+xml"),e.manifest.querySelector(`itme[id="${t}"]`)||e.manifest.appendChild(n)}function s(t){const n=document.createElement("itemref");n.setAttribute("idref",t),e.spine.appendChild(n)}function l(e,t,n){const o="urn:v",r=document.createElementNS(o,"navPoint");r.id=`navPoint-${e}`,r.setAttributeNS(o,"playOrder",e.toString());const a=document.createElementNS(o,"navLabel"),i=document.createElement("text");i.innerText=t;const c=document.createElement("content");return c.setAttribute("src",n),a.appendChild(i),r.appendChild(a),r.appendChild(c),r}function d(e,t,n){const o=document.createElement("div");o.className=e;const r=document.createElement("a");return r.href=n,r.innerText=t,o.appendChild(r),o}function u(e){const t=N.render({sectionName:e}),n=(0,v.fI)(t);return new Blob(['<?xml version="1.0" encoding="utf-8"?>\n        <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"\n          "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">',n.replaceAll("data-src-address","src").replace("<!DOCTYPE html>","")],{type:"application/xhtml+xml"})}await e.epubZip.file("OEBPS/content.opf",new Blob([(new XMLSerializer).serializeToString(e.contentOpf)])),await e.epubZip.file("OEBPS/toc.ncx",new Blob([(new XMLSerializer).serializeToString(e.ncx)])),await e.epubZip.file("OEBPS/TOC.xhtml",new Blob([(new XMLSerializer).serializeToString(e.toc)]))}(),await this.epubZip.generateAsync()}}class V extends x{book;savedTextArray=[];saveFileNameBase;constructor(e,t){super(),this.book=e,this.saveFileNameBase=`[${this.book.author}]${this.book.bookname}`,t&&Object.assign(this,t)}saveTxt(){const e=this.book.chapters,t=this.genMetaDateTxt(this.book);this.savedTextArray.push(t),c().debug("[save]对 chapters 排序"),e.sort(this.chapterSort);const n=[];for(const t of e){const e=this.getchapterName(t);if(t.sectionName&&!n.includes(t.sectionName)){n.push(t.sectionName);const e=this.genSectionText(t.sectionName);this.savedTextArray.push(e)}const o=this.genChapterText(e,t.contentText??"");this.savedTextArray.push(o),l.Cy.value||(t.contentText=null)}c().info("[save]保存TXT文件");const o=this.savedTextArray.join("\n").replaceAll("\n","\r\n");(0,m.saveAs)(new Blob([o],{type:"text/plain;charset=utf-8"}),`${this.saveFileNameBase}.txt`)}}class R{txt;zip;epub;constructor(e,t,n){const o={};void 0!==n&&Object.assign(o,n),void 0!==e.saveOptions&&Object.assign(o,e.saveOptions),this.txt=new V(e,o),this.zip=new E(e,t,o),this.epub=new I(e,t,o)}async addChapter(e){if(await this.zip.addChapter(e),await this.epub.addChapter(e),l.Cy.value||(e.contentRaw=null,e.contentHTML=null,e.contentImages=null),e.contentImages&&0!==e.contentImages.length)for(const t of e.contentImages)t.status=s.qb.saved,l.Cy.value||(t.imageBlob=null);e.status=s.qb.saved}saveTxt(){this.txt.saveTxt()}async saveZip(){await this.zip.saveZip()}async saveEpub(){await this.epub.saveEpub()}}const H="novel-downloader-22932304826849026",D=document.location.hostname;async function O(){const e=await(0,u.QG)(H);let t;return t=e?JSON.parse(e):{success:{},failed:{}},t}const B=async e=>{const t=await O(),n=t[e];return n[D]?n[D]=n[D]+1:n[D]=1,(async e=>{const t=JSON.stringify(e);return await(0,u._u)(H,t),e})(t)};var j=n(25);class z{imageMode="TM";charset=document.characterSet;concurrencyLimit=10;streamZip=!1;needLogin=!1;nsfw=!1;maxRunLimit;saveOptions;bcWorker=new BroadcastChannel("novel-downloader-worker");bcWorkerMessages=[];book;audio;constructor(){const e=this.bcWorker,t=this.bcWorkerMessages;e.onmessage=n=>{const o=n.data;if("ping"===o.type){const t={type:"pong",src:o.workerId,workerId:window.workerId,url:document.location.href};e.postMessage(t)}"pong"===o.type&&t.push(o),o.type}}async run(){c().info("[run]下载开始");const e=this;try{await e.preHook(),await async function(){window._book&&window._url===document.location.href?e.book=window._book:(e.book=await e.bookParse(),window._book=e.book,window._url=document.location.href),c().debug("[book]Book object:\n"+JSON.stringify(e.book))}();const t=function(t){if(c().debug("[run]保存数据"),l.EI&&"object"==typeof unsafeWindow.saveOptions&&function(e){const t=["mainStyleText","tocStyleText"],n=["getchapterName","genSectionText","genChapterText","chapterSort"];function o(e){return!![...t,...n].includes(e)}function r(n){return!(!t.includes(n)||"string"!=typeof e[n])}function a(t){return!(!n.includes(t)||"function"!=typeof e[t])}if("object"!=typeof e)return!1;if(0===Object.keys(e).length)return!1;for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){if(!o(t))return!1;if(!r(t)&&!a(t))return!1}return!0}(unsafeWindow.saveOptions)){const n=unsafeWindow.saveOptions;if(n)return c().info("[run]发现自定义保存参数，内容如下\n",n),new R(t,e.streamZip,n)}return new R(t,e.streamZip)}(e.book);return async function(){if(l.CA&&!1===e.needLogin&&e.book?.bookUrl&&void 0===window.localStorageExpired.get(`${e.book.bookUrl}_saveToArchiveOrg`)&&await(0,l.Qd)()){console.log("[saveToArchiveOrg]保存当前书页至 archive.org");try{window.localStorageExpired.set(`${e.book.bookUrl}_saveToArchiveOrg`,!0,86400)}catch(e){}(0,r.K$)(e.book.bookUrl),e.book.ToCUrl&&(0,r.K$)(e.book.ToCUrl)}}(),await e.initChapters(e.book,t).catch((e=>{if(!(e instanceof s.K2))throw e;console.warn(e)})),await async function(e){c().debug("[run]开始保存文件"),e.saveTxt(),await e.saveZip(),await e.saveEpub()}(t),e.postHook(),e.book}catch(t){e.catchError(t)}}async preHook(){const e=this;if(!await async function(){const t=e.bcWorker,n=e.bcWorkerMessages,o={type:"ping",workerId:window.workerId,url:document.location.href};t.postMessage(o),await(0,r._v)(300);const a=n.filter((e=>"pong"===e.type&&e.src===window.workerId&&e.workerId!==window.workerId)).map((e=>({id:e.workerId,url:e.url})));c().info(JSON.stringify(a,void 0,4));const i=a.length;return c().info(`[preTest]nowRunning: ${i}`),!e.maxRunLimit||i<e.maxRunLimit}()){const t=`当前网站目前最多允许${e.maxRunLimit}个下载任务同时进行。\n请待其它下载任务完成后，再行尝试。`;throw alert(t),c().info(`[run]${t}`),new s.K2(t)}await async function(){const e=new URL(g().mitm),t=new URL("https://cors.bgme.me/");t.pathname=e.origin+e.pathname,g().mitm=t.href,g().supported=(0,f.yt)()&&await(0,f.Cm)(t.href)}(),e.audio=new Audio("data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU3LjcxLjEwMAAAAAAAAAAAAAAA/+M4wAAAAAAAAAAAAEluZm8AAAAPAAAAEAAABVgANTU1NTU1Q0NDQ0NDUFBQUFBQXl5eXl5ea2tra2tra3l5eXl5eYaGhoaGhpSUlJSUlKGhoaGhoaGvr6+vr6+8vLy8vLzKysrKysrX19fX19fX5eXl5eXl8vLy8vLy////////AAAAAExhdmM1Ny44OQAAAAAAAAAAAAAAACQCgAAAAAAAAAVY82AhbwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+MYxAALACwAAP/AADwQKVE9YWDGPkQWpT66yk4+zIiYPoTUaT3tnU487uNhOvEmQDaCm1Yz1c6DPjbs6zdZVBk0pdGpMzxF/+MYxA8L0DU0AP+0ANkwmYaAMkOKDDjmYoMtwNMyDxMzDHE/MEsLow9AtDnBlQgDhTx+Eye0GgMHoCyDC8gUswJcMVMABBGj/+MYxBoK4DVpQP8iAtVmDk7LPgi8wvDzI4/MWAwK1T7rxOQwtsItMMQBazAowc4wZMC5MF4AeQAGDpruNuMEzyfjLBJhACU+/+MYxCkJ4DVcAP8MAO9J9THVg6oxRMGNMIqCCTAEwzwwBkINOPAs/iwjgBnMepYyId0PhWo+80PXMVsBFzD/AiwwfcKGMEJB/+MYxDwKKDVkAP8eAF8wMwIxMlpU/OaDPLpNKkEw4dRoBh6qP2FC8jCJQFcweQIPMHOBtTBoAVcwOoCNMYDI0u0Dd8ANTIsy/+MYxE4KUDVsAP8eAFBVpgVVPjdGeTEWQr0wdcDtMCeBgDBkgRgwFYB7Pv/zqx0yQQMCCgKNgonHKj6RRVkxM0GwML0AhDAN/+MYxF8KCDVwAP8MAIHZMDDA3DArAQo3K+TF5WOBDQw0lgcKQUJxhT5sxRcwQQI+EIPWMA7AVBoTABgTgzfBN+ajn3c0lZMe/+MYxHEJyDV0AP7MAA4eEwsqP/PDmzC/gNcwXUGaMBVBIwMEsmB6gaxhVuGkpoqMZMQjooTBwM0+S8FTMC0BcjBTgPwwOQDm/+MYxIQKKDV4AP8WADAzAKQwI4CGPhWOEwCFAiBAYQnQMT+uwXUeGzjBWQVkwTcENMBzA2zAGgFEJfSPkPSZzPXgqFy2h0xB/+MYxJYJCDV8AP7WAE0+7kK7MQrATDAvQRIwOADKMBuA9TAYQNM3AiOSPjGxowgHMKFGcBNMQU1FMy45OS41VVU/31eYM4sK/+MYxKwJaDV8AP7SAI4y1Yq0MmOIADGwBZwwlgIJMztCM0qU5TQPG/MSkn8yEROzCdAxECVMQU1FMy45OS41VTe7Ohk+Pqcx/+MYxMEJMDWAAP6MADVLDFUx+4J6Mq7NsjN2zXo8V5fjVJCXNOhwM0vTCDAxFpMYYQU+RlVMQU1FMy45OS41VVVVVVVVVVVV/+MYxNcJADWAAP7EAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV/+MYxOsJwDWEAP7SAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV/+MYxPMLoDV8AP+eAFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV/+MYxPQL0DVcAP+0AFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV"),e.audio.loop=!0,e.audio.play(),window.onbeforeunload=e=>(e.preventDefault(),e.returnValue="您正尝试离开本页面，当前页面有下载任务正在运行，是否确认离开？"),window.downloading=!0}async initChapters(e,t){const n=this;c().info("[initChapters]开始初始化章节"),Object.entries(n).forEach((e=>c().info(`[initChapters] ${e[0]}: ${e[1]}`)));const o=function(e){let t=e.chapters.filter((e=>e.status===s.qb.pending));return function(){if(l.Td&&"function"==typeof unsafeWindow.chapterFilter){let e="[initChapters]发现自定义筛选函数，自定义筛选函数内容如下：\n";return e+=unsafeWindow.chapterFilter?.toString(),c().info(e),!0}return!1}()&&(c().debug("[initChapters]筛选需下载章节"),t=t.filter((e=>function(e){let t=!0;try{const n=unsafeWindow.chapterFilter?.(e);"boolean"==typeof n&&(t=n)}catch(e){c().error("运行自定义筛选函数时出错。",e),c().trace(e)}return t}(e)))),t}(e);if(0===o.length)return c().error("[initChapters]初始化章节出错，未找到需初始化章节"),[];if(j.vm.totalChapterNumber=o.length,1===n.concurrencyLimit)for(const e of o){if(window.stopFlag.aborted)throw new s.K2("[chapter]收到停止信号，停止继续下载。");try{let n=await e.init();n=await a(n,t)}catch(e){c().error(e),c().trace(e)}}else{const e=async e=>{if(void 0===e)return null;try{let n=await e.init();return n=await a(n,t),n}catch(e){c().error(e),c().trace(e)}};await(0,r.C1)(o,n.concurrencyLimit,e,{signal:window.stopFlag,reason:"[chapter]收到停止信号，停止继续下载。"})}return c().info("[initChapters]章节初始化完毕"),o;async function a(e,t){return void 0!==e.contentHTML&&(await t.addChapter(e),j.vm.finishedChapterNumber++),e}}postHook(){const e=this;(0,o.pN)(),e.audio?.pause(),e.audio?.remove();const t={type:"close",workerId:window.workerId,url:document.location.href};e.bcWorker?.postMessage(t),e.bcWorker?.close(),e.bcWorkerMessages.splice(0,e.bcWorkerMessages.length),window.onbeforeunload=null,window.downloading=!1,j.vm.reset(),window._book=void 0,window._url=void 0,function(){if(l.Vo&&"function"==typeof unsafeWindow.customFinishCallback){const e=unsafeWindow.customFinishCallback;e&&(c().info(`发现自定义结束回调函数，内容如下：\n${e.toString()}`),e())}}(),B("success"),(async()=>{const e=await O();c().info("[stat]小说下载器脚本运行情况统计："),c().info(e);for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)){c().info(`[stat]${t}:`);const n=e[t];for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&c().info(`    ${e}: ${n[e]}`)}})()}catchError(e){c().error(e),c().trace(e),this.postHook(),e instanceof s.K2||(document.getElementById("button-div")?.remove(),c().error("运行过程出错，请附上相关日志至支持地址进行反馈。\n支持地址：https://github.com/yingziwu/novel-downloader"),B("failed"),alert("运行过程出错，请附上相关日志至支持地址进行反馈。\n支持地址：https://github.com/yingziwu/novel-downloader"),(0,a.qS)())}}},(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var o=n(8),r=n.n(o),a=n(9),i=n.n(a)()(r());i.push([e.id,"h1 {\n  line-height: 130%;\n  text-align: center;\n  font-weight: bold;\n  font-size: xxx-large;\n  margin-top: 3.2em;\n  margin-bottom: 3.3em;\n}\nh2 {\n  line-height: 130%;\n  text-align: center;\n  font-weight: bold;\n  font-size: x-large;\n  margin-top: 1.2em;\n  margin-bottom: 2.3em;\n}\ndiv {\n  margin: 0px;\n  padding: 0px;\n  text-align: justify;\n}\np {\n  text-indent: 2em;\n  display: block;\n  line-height: 1.3em;\n  margin-top: 0.4em;\n  margin-bottom: 0.4em;\n}\nimg {\n  vertical-align: text-bottom;\n  max-width: 90%;\n}\n.title {\n  margin-bottom: 0.7em;\n}\n",""]);const c=i},(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var o=n(8),r=n.n(o),a=n(9),i=n.n(a)()(r());i.push([e.id,'img {\n  max-width: 100%;\n  max-height: 15em;\n}\n.introduction {\n  font-size: smaller;\n  max-height: 18em;\n  overflow-y: scroll;\n}\n.introduction p {\n  text-indent: 0;\n}\n.bookurl {\n  text-align: center;\n  font-size: smaller;\n  padding-top: 1em;\n  padding-bottom: 0.5em;\n  margin-top: 0.4em;\n}\n.bookurl > a {\n  color: gray;\n}\n.info h3 {\n  padding-left: 0.5em;\n  margin-top: -1.2em;\n  margin-bottom: 0.5em;\n}\n.section {\n  margin-top: 1.5em;\n  display: grid;\n  grid-template-columns: 33% 33% 33%;\n}\n.section > h2:first-child {\n  grid-column-end: span 3;\n}\n.section > .chapter {\n  padding-bottom: 0.3em;\n  text-align: center;\n}\n.main > h1 {\n  margin-top: 1.5em;\n  margin-bottom: 1.5em;\n}\na.disabled {\n  pointer-events: none;\n  cursor: default;\n  color: gray;\n}\n.author::before {\n  content: "作者：";\n}\n.author {\n  text-align: center;\n  margin-top: -3em;\n  margin-bottom: 3em;\n}\n',""]);const c=i},(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var o=n(8),r=n.n(o),a=n(9),i=n.n(a)()(r());i.push([e.id,'body {\n  background-color: #f0f0f2;\n  margin: 0;\n  padding: 0;\n  font-family: -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI",\n    "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;\n}\ndiv.main {\n  width: 900px;\n  margin: 5em auto;\n  padding: 2em;\n  background-color: #fdfdff;\n  border-radius: 0.5em;\n  box-shadow: 2px 3px 7px 2px rgba(0, 0, 0, 0.02);\n}\n@media (max-width: 700px) {\n  div.main {\n    margin: 0 auto;\n    width: auto;\n  }\n}\n',""]);const c=i},function(e){var t;t=()=>{"use strict";const e="object"==typeof window?window:this;e.HTMLElement||console.warn("streamsaver is meant to run on browsers main thread");let t=null,n=!1;const o=e.WebStreamsPolyfill||{},r=e.isSecureContext;let a=/constructor/i.test(e.HTMLElement)||!!e.safari||!!e.WebKitPoint;const i=r||"MozAppearance"in document.documentElement.style?"iframe":"navigate",c={createWriteStream:function(o,l,d){let u={size:null,pathname:null,writableStrategy:void 0,readableStrategy:void 0},h=0,m=null,p=null,g=null;if(Number.isFinite(l)?([d,l]=[l,d],console.warn("[StreamSaver] Depricated pass an object as 2nd argument when creating a write stream"),u.size=d,u.writableStrategy=l):l&&l.highWaterMark?(console.warn("[StreamSaver] Depricated pass an object as 2nd argument when creating a write stream"),u.size=d,u.writableStrategy=l):u=l||{},!a){t||(t=r?s(c.mitm):function(t){const n=document.createDocumentFragment(),o={frame:e.open(t,"popup","width=200,height=100"),loaded:!1,isIframe:!1,isPopup:!0,remove(){o.frame.close()},addEventListener(...e){n.addEventListener(...e)},dispatchEvent(...e){n.dispatchEvent(...e)},removeEventListener(...e){n.removeEventListener(...e)},postMessage(...e){o.frame.postMessage(...e)}},r=t=>{t.source===o.frame&&(o.loaded=!0,e.removeEventListener("message",r),o.dispatchEvent(new Event("load")))};return e.addEventListener("message",r),o}(c.mitm)),p=new MessageChannel,o=encodeURIComponent(o.replace(/\//g,":")).replace(/['()]/g,escape).replace(/\*/g,"%2A");const a={transferringReadable:n,pathname:u.pathname||Math.random().toString().slice(-6)+"/"+o,headers:{"Content-Type":"application/octet-stream; charset=utf-8","Content-Disposition":"attachment; filename*=UTF-8''"+o}};u.size&&(a.headers["Content-Length"]=u.size);const l=[a,"*",[p.port2]];if(n){const e="iframe"===i?void 0:{transform(e,t){if(!(e instanceof Uint8Array))throw new TypeError("Can only wirte Uint8Arrays");h+=e.length,t.enqueue(e),m&&(location.href=m,m=null)},flush(){m&&(location.href=m)}};g=new c.TransformStream(e,u.writableStrategy,u.readableStrategy);const t=g.readable;p.port1.postMessage({readableStream:t},[t])}p.port1.onmessage=e=>{e.data.download&&("navigate"===i?(t.remove(),t=null,h?location.href=e.data.download:m=e.data.download):(t.isPopup&&(t.remove(),t=null,"iframe"===i&&s(c.mitm)),s(e.data.download)))},t.loaded?t.postMessage(...l):t.addEventListener("load",(()=>{t.postMessage(...l)}),{once:!0})}let f=[];return!a&&g&&g.writable||new c.WritableStream({write(e){if(!(e instanceof Uint8Array))throw new TypeError("Can only wirte Uint8Arrays");a?f.push(e):(p.port1.postMessage(e),h+=e.length,m&&(location.href=m,m=null))},close(){if(a){const e=new Blob(f,{type:"application/octet-stream; charset=utf-8"}),t=document.createElement("a");t.href=URL.createObjectURL(e),t.download=o,t.click()}else p.port1.postMessage("end")},abort(){f=[],p.port1.postMessage("abort"),p.port1.onmessage=null,p.port1.close(),p.port2.close(),p=null}},u.writableStrategy)},WritableStream:e.WritableStream||o.WritableStream,supported:!0,version:{full:"2.0.5",major:2,minor:0,dot:5},mitm:"https://jimmywarting.github.io/StreamSaver.js/mitm.html?version=2.0.0"};function s(e){if(!e)throw new Error("meh");const t=document.createElement("iframe");return t.hidden=!0,t.src=e,t.loaded=!1,t.name="iframe",t.isIframe=!0,t.postMessage=(...e)=>t.contentWindow.postMessage(...e),t.addEventListener("load",(()=>{t.loaded=!0}),{once:!0}),document.body.appendChild(t),t}try{new Response(new ReadableStream),r&&!("serviceWorker"in navigator)&&(a=!0)}catch(e){a=!0}return(e=>{try{(()=>{const{readable:e}=new TransformStream,t=new MessageChannel;t.port1.postMessage(e,[e]),t.port1.close(),t.port2.close(),n=!0,Object.defineProperty(c,"TransformStream",{configurable:!1,writable:!1,value:TransformStream})})()}catch(e){}})(),c},e.exports=t()},(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var o=n(8),r=n.n(o),a=n(9),i=n.n(a)()(r());i.push([e.id,"div.sgc-toc-title {\n  font-size: 2em;\n  font-weight: bold;\n  margin-bottom: 1em;\n  text-align: center;\n}\n\ndiv.sgc-toc-level-1 {\n  margin-left: 0em;\n}\n\ndiv.sgc-toc-level-2 {\n  margin-left: 2em;\n}\n\ndiv.sgc-toc-level-3 {\n  margin-left: 2em;\n}\n\ndiv.sgc-toc-level-4 {\n  margin-left: 2em;\n}\n\ndiv.sgc-toc-level-5 {\n  margin-left: 2em;\n}\n\ndiv.sgc-toc-level-6 {\n  margin-left: 2em;\n}\n",""]);const c=i},(e,t,n)=>{"use strict";n.d(t,{SN:()=>c,I2:()=>s,$d:()=>l,$4:()=>d,uh:()=>u});var o=n(5),r=n.n(o),a=n(36),i=n(21);async function c(e,t){if(null===e)return[null,null,null];{t&&(e=t(e.cloneNode(!0)));const{dom:n,text:o,images:r}=await(0,a.zM)(e,"TM");return[o,n,r]}}async function s({chapterName:e,chapterUrl:t,charset:n,selector:o,contentPatch:c,getNextPage:s,continueCondition:l,enableCleanDOM:d}){r().debug(`[Chapter]请求 ${t}`);let u=t,h=await(0,i.dL)(t,n);const m=document.createElement("div");let p,g,f,b=!1;do{let e=h.querySelector(o);const t=s(h);l(e,t)?t!==u?b=!0:(r().error("网站页面出错，URL： "+u),b=!1):b=!1,e=c(e,h);for(const t of Array.from(e.childNodes))m.appendChild(t.cloneNode(!0));b&&(r().debug(`[Chapter]请求 ${t}`),u=t,h=await(0,i.dL)(t,n))}while(b);if(d||void 0===d){const e=await(0,a.zM)(m,"TM");p=e.dom,g=e.text,f=e.images}else p=null,g=null,f=null;return{chapterName:e,contentRaw:m,contentText:g,contentHTML:p,contentImages:f,additionalMetadate:null}}function l(e,t,n){const o=Array.from(t);let r="";for(const t of o){const o=e.compareDocumentPosition(t);if(o&Node.DOCUMENT_POSITION_DISCONNECTED)return null;if(o&Node.DOCUMENT_POSITION_PRECEDING&&(r=n(t)),o&Node.DOCUMENT_POSITION_FOLLOWING)break}return r}function d(e){const t=document.documentElement,n=document.body,o=Math.min(t.clientWidth,window.innerWidth),r=.15*o,a=.1*n.scrollHeight,i=e.getBoundingClientRect(),c=window.scrollY+i.top,s=n.scrollHeight-c,l=Math.abs(o-i.right),d=e.scrollHeight/n.scrollHeight;return i.left<r||l<r||c<a||s<a?[!1,e,d]:[!0,e,d]}function u(e){const t=e.reduce(((e,t)=>{const n=t.chapterUrl;return void 0===e[n]?e[n]=t:Array.isArray(e[n])?e[n].push(t):e[n]=[e[n],t],e}),{}),n=Object.values(t).reduce(((e,t)=>(Array.isArray(t)?""===t[0].chapterUrl?e.push(...t):e.push(t.sort(((e,t)=>e.chapterNumber-t.chapterNumber)).slice(-1)[0]):e.push(t),e)),[]);return function(e){let t=0;e=e.sort(((e,t)=>e.chapterNumber-t.chapterNumber));for(const n of e)t++,n.chapterNumber=t}(n),n}},(e,t,n)=>{"use strict";n.d(t,{zM:()=>p,iA:()=>g,d1:()=>b,FZ:()=>w,Kg:()=>y});var o=n(5),r=n.n(o),a=n(19),i=n(12);const c=["address","article","aside","blockquote","details","dialog","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","li","main","nav","ol","p","pre","section","table","ul"],s=["a","abbr","acronym","audio","b","bdi","bdo","big","br","button","canvas","cite","code","data","datalist","del","dfn","em","embed","i","iframe","img","input","ins","kbd","label","map","mark","meter","noscript","object","output","picture","progress","q","ruby","s","samp","script","select","slot","small","span","font","strong","sub","sup","svg","template","textarea","time","u","tt","var","video","wbr"],l=["aside","blockquote","details","figure","h1","h2","h3","h4","h5","h6","hr","ul","ol","li","pre"],d=["#comment","fieldset","legend","input","label","form","audio","button","canvas","datalist","embed","iframe","map","meter","noscript","object","output","progress","script","style","link","select","slot","svg","template","video","wbr","table"];function u(e){const t=e.nodeName.toLowerCase();return e instanceof Text||0===e.childElementCount||!!s.includes(t)||Array.from(e.children).every((e=>{const t=e.nodeName.toLowerCase();return s.includes(t)}))}function h(e){const t=e.nodeName.toLowerCase();return!!l.includes(t)||u(e)}function*m(e,t=!0){let n;n=t?h:u;const o=Array.from(e.childNodes).filter((e=>{if(e instanceof Text){const t=e.textContent;if(null===t)return!1;if(""===t.trim())return!1}return!0}));for(const e of o){const o=e.nodeName.toLowerCase();!1===d.includes(o)&&(n(e)?yield e:yield*m(e,t))}}async function p(e,t,n){const o=[...m(e)],i=await u(o,document.createElement("div"));return function({dom:e,text:t,images:n}){return g(e),e=f(e),Array.from(e.children).forEach((e=>e.replaceWith(f(e)))),function(e){Array.from(e.querySelectorAll("p")).filter((e=>""===e.innerText.trim()&&0===e.childElementCount)).forEach((e=>e.remove()))}(e),{dom:e,text:t=t.trim(),images:n}}(await async function({dom:e,text:t,images:n}){const o=await Promise.all(n);return o.forEach((n=>{e.innerHTML=e.innerHTML.replaceAll(n.comments,n.name),t=t.replaceAll(n.comments,n.name)})),{dom:e,text:t,images:o}}(i));async function l(e){const t=new Map;function n(e){return e instanceof HTMLElement?u([...m(e)],document.createElement("div")):null}function o(e){return e instanceof HTMLElement?u([...m(e)],document.createElement("p")):null}async function r(e){if(e instanceof HTMLElement){const t=[...m(e)],{dom:n,text:o,images:r}=await u(t,document.createElement("blockquote"));return{dom:n,text:o.split("\n").map((e=>e.replace(/^/,"> "))).join("\n"),images:r}}return null}function a(e){if(e instanceof HTMLElement){const t=e.nodeName.toLowerCase(),n=parseInt(t.substring(1)),o=document.createElement(t);return o.innerHTML=e.innerHTML,{dom:o,text:"#".repeat(n)+" "+e.innerText,images:[]}}return null}function i(e){if(e instanceof HTMLElement){const t=document.createElement("pre");return t.innerHTML=e.innerHTML,{dom:t,text:"```\n"+e.innerText+"\n```",images:[]}}return null}async function c(e,t,n){const o=n.querySelector(e);let r,a="";o instanceof HTMLElement&&(r=document.createElement(e),r.innerHTML=o.innerHTML,a="**"+o.innerText+"**",o.remove());const i=document.createElement(t);r&&i.appendChild(r);const c=[...m(n)],{dom:s,text:l,images:d}=await u(c,i);return{dom:s,text:a+"\n\n"+l,images:d}}function s(e){const t=e.nodeName.toLowerCase();if(e instanceof HTMLUListElement||e instanceof HTMLOListElement){const n=document.createElement(t);return u([...m(e)],n)}return null}["article","dialog","div","footer","header","main","section","hgroup"].forEach((e=>t.set(e,n))),["address","p","dd","dt","figcaption","dl"].forEach((e=>t.set(e,o))),["aside","blockquote"].forEach((e=>t.set(e,r))),["h1","h2","h3","h4","h5","h6"].forEach((e=>t.set(e,a))),["pre","textarea"].forEach((e=>t.set(e,i))),t.set("hr",(function(e){return{dom:document.createElement("hr"),text:"-".repeat(20),images:[]}})),t.set("details",(function(e){return c("summary","details",e)})),t.set("figure",(function(e){return c("figcaption","figure",e)})),t.set("li",(function(e){if(e instanceof HTMLLIElement){const t=document.createElement("li");t.innerHTML=e.innerHTML;let n="-   ";const o=e.parentNode;if(o instanceof HTMLOListElement){const t=o.getAttribute("start"),r=Array.prototype.indexOf.call(o.children,e);n=(t?Number(t)+r:r+1)+".  "}return{dom:t,text:n+e.innerText,images:[]}}return null})),["ul","ol"].forEach((e=>t.set(e,s)));const l=e.nodeName.toLowerCase(),d=t.get(l);return d?d(e):o(e)}async function d(e){const o=new Map;async function i(e){if(e instanceof HTMLElement&&0===e.childElementCount||e instanceof Text){let t;if(e instanceof HTMLElement&&(t=e.innerText.trim()),e instanceof Text&&(t=e.textContent?.trim()??""),"string"==typeof t){const e=[];return{dom:new Text(t),text:t.replaceAll("\n",""),images:e}}}if(e instanceof HTMLElement&&0!==e.childElementCount){const t=[...m(e)],{dom:n,text:o,images:r}=await u(t,document.createElement(e.nodeName.toLowerCase()));return{dom:n,text:o,images:r}}return null}function c(e){const o=(0,a.gc)(e);if(o){const t=document.createElement("img");return t.setAttribute("data-src-address",o.name),t.alt=e,{dom:t,text:`![${e}](${o.name})`,images:[o]}}{const o=(0,a.VO)(),r=n?.keepImageName??!1,i={referrerMode:n?.referrerMode,customReferer:n?.customReferer},c=(0,a.CE)(e,t,"chapter-",r,o,i),s=document.createElement("img");return s.setAttribute("data-src-address",o),s.alt=e,{dom:s,text:`![${e}](${o})`,images:[c]}}}async function s(e,t,n){if(n instanceof HTMLElement){if(0===n.childElementCount){const o=n.innerText.trim(),r=document.createElement(e);return r.innerText=o,{dom:r,text:t(o),images:[]}}{const t=[...m(n)],{dom:o,text:r,images:a}=await u(t,document.createElement(e));return{dom:o,text:r,images:a}}}return null}function l(e){return s("strong",(e=>`**${e.replaceAll("\n","**\n**")}**`),e)}function d(e){return s("code",(e=>`\`${e}\``),e)}function h(e){return s("s",(e=>`~~${e}~~`),e)}function p(e){return s("em",(e=>`*${e}*`),e)}["abbr","acronym","bdi","bdo","cite","data","dfn","span","font","time","u","tt","#text"].forEach((e=>o.set(e,i))),o.set("a",(async function(e){if(e instanceof HTMLAnchorElement){if(0!==e.childElementCount){const t=document.createElement("a");(e.href.startsWith("https://")||e.href.startsWith("http://"))&&(t.href=e.href);const n=[...m(e)],{dom:o,text:r,images:a}=await u(n,t);return{dom:o,text:r,images:a}}if(e.href.startsWith("https://")||e.href.startsWith("http://")){const{href:t,textContent:n}=e,o=document.createElement("a");return o.href=t,o.textContent=n,{dom:o,text:`[${n}](${t})`,images:[]}}}return null})),o.set("img",(function(e){return e instanceof HTMLImageElement?c(e.src):null})),o.set("picture",(function(e){if(e instanceof HTMLPictureElement){const t=e.querySelector("img");return t?c(t.src):(r().warn("[cleanDom][picture]未发现<img>",e),null)}return null})),o.set("ruby",(function(e){return e instanceof HTMLElement?{dom:e.cloneNode(!0),text:e.innerText,images:[]}:null})),o.set("br",(function(e){return{dom:document.createElement("br"),text:"\n",images:[]}})),["b","big","mark","samp","strong"].forEach((e=>o.set(e,l))),["code","kbd"].forEach((e=>o.set(e,d))),["del","s"].forEach((e=>o.set(e,h))),["em","i","q","var"].forEach((e=>o.set(e,p))),o.set("ins",(function(e){return s("ins",(e=>`++${e}++`),e)})),o.set("small",(function(e){return s("small",(e=>`<small>${e}</small>`),e)})),o.set("sup",(function(e){return s("sup",(e=>`<sup>${e}</sup>`),e)})),o.set("sub",(function(e){return s("sub",(e=>`<sub>${e}</sub>`),e)}));const g=e.nodeName.toLowerCase(),f=o.get(g);if(f)return f(e);{const t=i(e);return r().warn("[cleanDom]发现未知行内元素！"),r().warn([e.nodeName.toLowerCase(),e]),t}}async function u(e,t){let n="",o=[];for(const r of e){const e=r.nodeName.toLowerCase();if(("textarea"===e||c.includes(e))&&r instanceof HTMLElement){const e=await l(r);if(e){const{dom:r,text:a,images:i}=e;t.appendChild(r),n=n+"\n"+a+"\n",o=o.concat(i);continue}}if(r instanceof Text||s.includes(e)){const e=await d(r);if(e){const{dom:r,text:a,images:i}=e;t.appendChild(r),n+=a,o=o.concat(i);continue}}}return{dom:t,text:n,images:o}}}function g(e){function t(e){for(const t of e){if(t instanceof Text){if(""===t.textContent?.trim()){t.remove();continue}break}if(t instanceof HTMLBRElement)t.remove();else if(t instanceof HTMLElement&&"br"!==t.nodeName.toLowerCase())break}}t(Array.from(e.childNodes)),t(Array.from(e.childNodes).reverse())}function f(e){if(t=e,Array.from(t.childNodes).map((e=>e.nodeName.toLowerCase())).every((e=>["#text","br"].includes(e)))&&function(e){return Array.from(e.childNodes).filter((e=>e instanceof HTMLBRElement)).length}(e)>4){const t=document.createElement("div"),n=e.childNodes;let o=0;for(const e of Array.from(n)){if(e instanceof Text){if(o>2){let e=o-2;const n=document.createElement("p");for(;e>0;){e--;const t=document.createElement("br");n.appendChild(t)}t.appendChild(n)}o=0;const n=document.createElement("p");n.innerText=e.textContent??"",t.appendChild(n)}e instanceof HTMLBRElement&&o++}return t}return e;var t}function b(e,t=35,n=document.createElement("div")){const o=e.textContent?.split("\n")??[];let r="";for(const e of o)""!==e?(0,i.sp)(e)>t-5&&(0,i.sp)(e)<t+5?r+=e:""===r?(n.appendChild(new Text(e)),n.appendChild(document.createElement("br"))):(r+=e,n.appendChild(new Text(r)),n.appendChild(document.createElement("br")),r=""):(n.appendChild(new Text(r)),n.appendChild(document.createElement("br")),r="");return""!==r&&(n.appendChild(new Text(r)),n.appendChild(document.createElement("br")),r=""),g(n),f(n)}function w(e,t=35){Array.from(e.querySelectorAll("br")).forEach((e=>{const n=e.previousSibling,o=e.nextSibling;n instanceof Text&&o instanceof Text&&(n.textContent?(0,i.sp)(n.textContent):0)>t-5&&(n.textContent?(0,i.sp)(n.textContent):0)<t+5&&e.remove()}));if((e=>{for(const t of e){const e=t[0],n=new Text(e.wholeText);e.replaceWith(n),t.forEach((e=>e.remove()))}})((e=>{const t=[];let n=[],o="";for(const r of e){const e=r.wholeText;o!==e?(0!==n.length&&t.push(n),o=e,n=[r]):n.push(r)}return 0!==n.length&&t.push(n),t})(Array.from(e.childNodes).filter((e=>e instanceof Text&&e.wholeText!==e.textContent)))),Array.from(e.childNodes).filter((e=>e instanceof Text)).forEach((e=>{const n=document.createElement("p");b(e,t,n),e.replaceWith(n)})),Array.from(e.querySelectorAll("p")).filter((e=>""===e.innerText.trim()&&(0,i.U)(e)instanceof HTMLElement&&(0,i.d9)(e)instanceof HTMLElement)).forEach((e=>e.remove())),Array.from(e.querySelectorAll("p")).filter((e=>2===(0,i.$N)(e))).forEach((e=>(0,i.Fe)(e))),function(e){return Array.from(e.querySelectorAll("p")).map((e=>(0,i.sp)(e.innerText.trim()))).filter((e=>e>t+5)).length<5}(e)){const n=Array.from(e.querySelectorAll("p"));let o="";for(const e of n){const n=e.innerText.trim();if((0,i.sp)(n)>t-5&&(0,i.sp)(n)<t+5)o+=n,e.remove();else if(""===o);else{o+=n;const t=document.createElement("p");t.innerText=o,e.replaceWith(t),o=""}}}}function y(e,t=35){let n;if(e instanceof Text&&(n=e.textContent?.split("\n").map((e=>e.trim()))??[]),e instanceof HTMLElement){const t=(e,t)=>{if(t instanceof Text){const n=t.textContent?.trim()??"";return n.includes("\n")?(n.split("\n").map((e=>e.trim())).forEach((t=>e.push(t))),e):(e.push(n),e)}return e};n=Array.from(e.childNodes).reduce(t,[])}if(!n)throw new Error("ns is null");return n.map((e=>(0,i.sp)(e))).filter((e=>e>t+5)).length<5}},(e,t,n)=>{"use strict";n.d(t,{W:()=>s});var o=n(1),r=n(5),a=n.n(r),i=n(16),c=n(2);class s{bookUrl;bookname;chapterUrl;chapterNumber;chapterName;isVIP;isPaid;sectionName;sectionNumber;sectionChapterNumber;chapterParse;charset;options;status=c.qb.pending;retryTime=0;contentRaw;contentText;contentHTML;contentImages;additionalMetadate;chapterHtmlFileName;book;constructor({bookUrl:e,bookname:t,chapterUrl:n,chapterNumber:o,chapterName:r,isVIP:a,isPaid:i,sectionName:c,sectionNumber:s,sectionChapterNumber:l,chapterParse:d,charset:u,options:h}){this.bookUrl=e,this.bookname=t,this.chapterUrl=n,this.chapterNumber=o,this.chapterName=r,this.isVIP=a,this.isPaid=i,this.sectionName=c,this.sectionNumber=s,this.sectionChapterNumber=l,this.chapterParse=d,this.charset=u,this.options=h}async init(){const{chapterName:e,contentRaw:t,contentText:n,contentHTML:o,contentImages:r,additionalMetadate:i}=await this.parse();return this.chapterName=e,this.contentRaw=t,this.contentText=n,this.contentHTML=o,this.contentImages=r,this.additionalMetadate=i,this.status===c.qb.failed?a().error(`[Chapter]章节名：${this.chapterName}, 分卷名：${this.sectionName}, URL:${this.chapterUrl}, VIP:${this.isVIP}, Paid:${this.isPaid}, isNull:${!this.contentHTML} 解析出错。`):a().info(`[Chapter]章节名：${this.chapterName}, 分卷名：${this.sectionName}, URL:${this.chapterUrl}, VIP:${this.isVIP}, Paid:${this.isPaid}, isNull:${!this.contentHTML} 解析成功。`),this}async parse(){return this.status=c.qb.downloading,this.chapterParse(this.chapterUrl,this.chapterName,this.isVIP,this.isPaid,this.charset,this.options).then((async e=>{const t=e.contentImages;if(t){let e=t.filter((e=>e.status===c.qb.downloading));for(;e.length;)await(0,o._v)(500),e=t.filter((e=>e.status===c.qb.downloading))}return this.status=c.qb.finished,e})).catch((async e=>(this.retryTime++,a().error(`[Chapter]${this.chapterName}解析出错，第${this.retryTime}次重试，章节地址：${this.chapterUrl}`),this.status!==c.qb.failed&&this.retryTime<i.o5?(await(0,o._v)(1500*this.retryTime),this.parse()):(this.status=c.qb.failed,a().error(e),a().trace(e),{chapterName:this.chapterName,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}))))}toJSON(){return{bookUrl:this.bookUrl,bookname:this.bookname,chapterUrl:this.chapterUrl,chapterNumber:this.chapterNumber,chapterName:this.chapterName,isVIP:this.isPaid,isPaid:this.isPaid,sectionName:this.sectionName,sectionNumber:this.sectionNumber,sectionChapterNumber:this.sectionChapterNumber,status:this.status,retryTime:this.retryTime,chapterHtmlFileName:this.chapterHtmlFileName}}}},(e,t,n)=>{"use strict";n.d(t,{f:()=>s});const o=["nx_source","_zucks_suid","cmpid","asgtbndr","guccounter","guce_referrer","guce_referrer_sig","_openstat","action_object_map","action_ref_map","action_type_map","fb_action_ids","fb_action_types","fb_comment_id","fb_ref","fb_source","fbclid","xtor","utm_campaign","utm_channel","utm_cid","utm_content","utm_id","utm_medium","utm_name","utm_place","utm_pubreferrer","utm_reader","utm_referrer","utm_serial","utm_social","utm_social-type","utm_source","utm_swu","utm_term","utm_userid","utm_viz_id","utm_product","utm_campaignid","utm_ad","utm_brand","utm_emcid","utm_emmid","utm_umguk","gbraid","wbraid","gclsrc","gclid","yclid","dpg_source","dpg_campaign","dpg_medium","dpg_content","admitad_uid","adjust_tracker","adjust_adgroup","adjust_campaign","bsft_clkid","bsft_eid","bsft_mid","bsft_uid","bsft_aaid","bsft_ek","mtm_campaign","mtm_cid","mtm_content","mtm_group","mtm_keyword","mtm_medium","mtm_placement","mtm_source","pk_campaign","pk_medium","pk_source","_branch_match_id","vc_lpp","ml_subscriber","ml_subscriber_hash","rb_clickid","oly_anon_id","oly_enc_id","dt_dapp","dt_platform","spm","scm"],r={"bilibili.com":["from","seid","share_source","spm_id_from","from_spm_id","share_medium","share_plat","share_session_id","share_source","share_tag","timestamp","unique_k","from_source","refer_from"]};function a(e){const t=new URL(e),n=t.hostname,a=t.searchParams;o.forEach((e=>a.delete(e)));const i=function(e){let t=0,n=e;for(;t>=0;){if(r[n])return r[n];t=e.indexOf(".",t+1),n=e.slice(t+1)}}(n);return i&&i.forEach((e=>a.delete(e))),t.hash="",t.href}var i=n(5),c=n.n(i);class s{_bookUrl="";_ToCUrl;bookname;author;introduction;introductionHTML;additionalMetadate;chapters;saveOptions;constructor({bookUrl:e,bookname:t,author:n,introduction:o,introductionHTML:r,additionalMetadate:a,chapters:i}){this.bookUrl=e,this.bookname=t,this.author=n,this.introduction=o,this.introductionHTML=r,this.additionalMetadate=a,this.chapters=i,c().debug("[Book]初始化完成")}set bookUrl(e){this._bookUrl=a(e)}get bookUrl(){return this._bookUrl}set ToCUrl(e){e&&(this._ToCUrl=a(e))}get ToCUrl(){return this._ToCUrl}toJSON(){return{bookUrl:this.bookUrl,ToCUrl:this.ToCUrl,bookname:this.bookname,author:this.author,introduction:this.introduction,introductionHTML:this.introductionHTML?this.introductionHTML.outerHTML:this.introductionHTML,additionalMetadate:this.additionalMetadate}}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Uukanshu:()=>m});var o=n(19),r=n(36),a=n(21),i=n(12),c=n(35),s=n(5),l=n.n(s),d=n(37),u=n(38),h=n(29);class m extends h.c{constructor(){super(),this.imageMode="TM",this.charset="GBK"}async bookParse(){const e=document.location.href,t=document.querySelector("dd.jieshao_content > h1 > a").innerText.replace("最新章节","").trim(),n=document.querySelector("dd.jieshao_content > h2 > a").innerText.trim(),r=document.querySelector("dd.jieshao_content > h3"),[a,s]=await(0,c.SN)(r,(e=>((0,i.up)([/^.+简介：\s+www\.uukanshu\.com\s+/,/\s+https:\/\/www\.uukanshu\.com/,/－+/],e),e))),h={},m=document.querySelector("a.bookImg > img").src;m&&(0,o.CE)(m,this.imageMode,"cover-").then((e=>{h.cover=e})).catch((e=>l().error(e)));const p=[],g=document.querySelector('span[onclick="javascript:reverse(this);"]'),f=unsafeWindow.reverse;"顺序排列"===g.innerText&&f(g);const b=document.getElementById("chapterList")?.childNodes;if(b&&0!==b.length){let n=0,o=0,r=null,a=0;for(const i of Array.from(b))if("volume"===i.className)o++,a=0,r=i.innerText;else{n++,a++;const c=i.firstElementChild,s=c.innerText,l=c.href,u=!1,h=!1,m=new d.W({bookUrl:e,bookname:t,chapterUrl:l,chapterNumber:n,chapterName:s,isVIP:u,isPaid:h,sectionName:r,sectionNumber:o,sectionChapterNumber:a,chapterParse:this.chapterParse,charset:this.charset,options:{}});p.push(m)}}return new u.f({bookUrl:e,bookname:t,author:n,introduction:a,introductionHTML:s,additionalMetadate:h,chapters:p})}async chapterParse(e,t,n,o,c,s){const l=await(0,a.dL)(e,c);t=l.querySelector("#timu").innerText.trim();const d=l.querySelector("#contentbox");if(d){(0,i.rm)(".ad_content",!0,d);const e=[/[ＵｕUu]+看书\s*[wｗ]+.[ＵｕUu]+[kｋ][aａ][nｎ][ｓs][hｈ][ＵｕUu].[nｎ][eｅ][tｔ]/g,/[ＵｕUu]+看书\s*[wｗ]+.[ＵｕUu]+[kｋ][aａ][nｎ][ｓs][hｈ][ＵｕUu].[cＣｃ][oＯｏ][mＭｍ]/g,/[UＵ]*看书[（\\(].*?[）\\)]文字首发。/,/请记住本书首发域名：。?/g,/笔趣阁手机版阅读网址：/g,/小说网手机版阅读网址：/g,/https:\/\//g,/http:\/\//g,/UU看书\s+欢迎广大书友光临阅读，最新、最快、最火的连载作品尽在UU看书！UU看书。;?/g];(0,i.up)(e,d);const{dom:n,text:o,images:a}=await(0,r.zM)(d,"TM");return{chapterName:t,contentRaw:d,contentText:o,contentHTML:n,contentImages:a,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{common:()=>i,gebiqu:()=>c,luoqiuzw:()=>s,lwxs9:()=>l,biquwx:()=>d,tycqxs:()=>u,dijiubook:()=>h,c25zw:()=>m,xbiquge:()=>p,yruan:()=>g,ranwen:()=>f,b5200:()=>b,bxwx333:()=>w});var o=n(1),r=n(12),a=n(41);const i=()=>(0,a.R)((e=>e),(e=>e)),c=()=>(0,a.R)((e=>((0,r.up)([/如果您喜欢.+，别忘记分享给朋友/g],e),(0,r.rm)('a[href^="http://down.gebiqu.com"]',!1,e),e)),(e=>((0,r.up)([/"www.gebiqu.com"/g],e),e))),s=()=>(0,a.R)((e=>e),(e=>{const t=e.firstElementChild;return t.innerText.includes("天才一秒记住本站地址：")&&t.remove(),(0,r.up)(["记住网址m.luoqｉｕｘｚｗ．ｃｏｍ"],e),e})),l=()=>(0,a.R)((e=>e),(e=>((0,r.rm)("div[align]",!1,e),e))),d=()=>(0,a.R)((e=>((0,r.up)([/本站提示：各位书友要是觉得《.+》还不错的话请不要忘记向您QQ群和微博里的朋友推荐哦！/],e),e)),(e=>e),1),u=()=>(0,a.R)((e=>e),(e=>((0,r.up)([/推荐都市大神老施新书:<a href="https:\/\/www\.tycqxs\.com\/[\d_]+\/" target="_blank">.+<\/a>/],e),e))),h=()=>(0,a.R)((e=>((0,r.up)(["本书网址："],e),e)),(e=>((0,r.rm)("a",!0,e),(0,r.rm)('img[src$="alipay.png"]',!0,e),e)),1,(e=>{e.maxRunLimit=1;const t=e.chapterParse;e.chapterParse=async(...e)=>{const n=await t(...e);return await(0,o._v)(3e3*Math.random()),n}}),(e=>{const t=new URL(e.chapterUrl);if("m.dijiubook.net"!==t.host&&!t.href.endsWith(".apk"))return e})),m=()=>(0,a.R)((e=>(e.querySelector("font")?.parentElement?.remove(),(0,r.up)(["简介:"],e),e)),(e=>((0,r.rm)(".bottem",!1,e),e))),p=()=>(0,a.R)((e=>e),(e=>((0,r.up)(["笔趣阁 www.xbiquge.so，最快更新.+ ！"],e),e))),g=()=>(0,a.R)((e=>((0,r.vS)(e,["本站提示：各位书友要是觉得"]),e)),(e=>e),3),f=()=>(0,a.R)((e=>((0,r.vS)(e,["还不错的话请不要忘记向您QQ群和微博里的朋友推荐哦！"]),e)),(e=>e)),b=()=>(0,a.R)((e=>e),(e=>e),1),w=()=>(0,a.R)((e=>e),(e=>(e.querySelector("#xuanchuan")?.parentElement?.remove(),(0,r.rm)("div[style]",!0,e),(0,r.rm)(".bottem2",!0,e),e)),void 0,void 0,void 0,"#zjneirong")},(e,t,n)=>{"use strict";n.d(t,{R:()=>a,y:()=>i});var o=n(35),r=n(42);function a(e,t,n,a,i,c="#content"){return(0,r.x)({bookUrl:document.location.href,bookname:document.querySelector("#info h1, .info > h2").innerText.trim().replace(/最新章节$/,""),author:document.querySelector("#info > p:nth-child(2), #info > div:nth-child(2), .small > span:nth-child(1)").innerText.replace(/作(\s+)?者[：:]/,"").trim(),introDom:document.querySelector("#intro, .intro"),introDomPatch:e,coverUrl:document.querySelector("#fmimg > img, .info > .cover > img")?.src??null,aList:document.querySelectorAll("#list a, .listmain a"),sections:document.querySelectorAll("#list dt, .listmain dt"),getSName:e=>{const t=e.querySelector("b");return t?t.innerText:e.innerText},postHook:e=>(e.sectionName&&(e.sectionName.includes("《")?e.sectionName=e.sectionName.replace(`《${e.bookname}》`,"").trim():e.sectionName=e.sectionName.replace(e.bookname,"").trim()),i?i(e):e),getContent:e=>e.querySelector(c),contentPatch:t,concurrencyLimit:n,overrideConstructor:e=>{const t=e.bookParse;return e.bookParse=async()=>{const n=await Reflect.apply(t,e,[]),r=n.chapters;return n.chapters=(0,o.uh)(r),n},a&&a(e),e}})}function i(e,t,n,a,i,c,s,l="#content"){return(0,r.x)({bookUrl:document.location.href,bookname:document.querySelector("#info h1, .info > h2").innerText.trim().replace(/最新章节$/,""),author:document.querySelector("#info > p:nth-child(2), #info > div:nth-child(2), .small > span:nth-child(1)").innerText.replace(/作(\s+)?者[：:]/,"").trim(),introDom:document.querySelector("#intro, .intro"),introDomPatch:e,coverUrl:document.querySelector("#fmimg > img, .info > .cover > img")?.src??null,aList:document.querySelectorAll("#list a, .listmain a"),sections:document.querySelectorAll("#list dt, .listmain dt"),getSName:e=>{const t=e.querySelector("b");return t?t.innerText:e.innerText},postHook:e=>(e.sectionName&&(e.sectionName.includes("《")?e.sectionName=e.sectionName.replace(`《${e.bookname}》`,"").trim():e.sectionName=e.sectionName.replace(e.bookname,"").trim()),s?s(e):e),getContentFromUrl:async(e,r,i)=>{const{contentRaw:c}=await(0,o.I2)({chapterName:r,chapterUrl:e,charset:i,selector:l,contentPatch:t,getNextPage:n,continueCondition:a,enableCleanDOM:!1});return c},contentPatch:e=>e,concurrencyLimit:i,overrideConstructor:e=>{const t=e.bookParse;return e.bookParse=async()=>{const n=await Reflect.apply(t,e,[]),r=n.chapters;return n.chapters=(0,o.uh)(r),n},c&&c(e),e}})}},(e,t,n)=>{"use strict";n.d(t,{x:()=>h});var o=n(19),r=n(36),a=n(21),i=n(35),c=n(5),s=n.n(c),l=n(37),d=n(38),u=n(29);function h({bookUrl:e,bookname:t,author:n,introDom:c,introDomPatch:h,coverUrl:m,additionalMetadatePatch:p,aList:g,getAName:f,sections:b,getSName:w,postHook:y,getContentFromUrl:v,getContent:x,contentPatch:T,concurrencyLimit:S,needLogin:A,nsfw:k,cleanDomOptions:N,overrideConstructor:M}){return class extends u.c{constructor(){super(),this.imageMode="TM",S&&(this.concurrencyLimit=S),A&&(this.needLogin=A),k&&(this.nsfw=k),M&&M(this)}async bookParse(){let r=null,a=null;c&&h&&([r,a]=await(0,i.SN)(c,h));const u={};m&&(0,o.CE)(m,this.imageMode,"cover-").then((e=>{u.cover=e})).catch((e=>s().error(e))),p&&Object.assign(u,p(u));const v=[];let x=0,T=0,S=0,A=null,k=!1;b&&b instanceof NodeList&&"function"==typeof w&&(k=!0);for(const n of Array.from(g)){let o;o=f?f(n):n.innerText;const r=n.href;if(k&&b&&w){const e=(0,i.$d)(n,b,w);e!==A&&(A=e,T++,S=0)}x++,S++;const a=!1,c=!1;let s=new l.W({bookUrl:e,bookname:t,chapterUrl:r,chapterNumber:x,chapterName:o,isVIP:a,isPaid:c,sectionName:A,sectionNumber:k?T:null,sectionChapterNumber:k?S:null,chapterParse:this.chapterParse,charset:this.charset,options:{bookname:t}});"function"==typeof y&&(s=y(s)),s&&v.push(s)}return new d.f({bookUrl:e,bookname:t,author:n,introduction:r,introductionHTML:a,additionalMetadate:u,chapters:v})}async chapterParse(e,t,n,o,i,c){let s;if(void 0!==v)s=await v(e,t,i);else if(void 0!==x){const t=await(0,a.dL)(e,i);s=x(t)}if(s){s=T(s);const{dom:e,text:n,images:o}=await(0,r.zM)(s,"TM",N);return{chapterName:t,contentRaw:s,contentText:n,contentHTML:e,contentImages:o,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{shuquge:()=>i,xyqxs:()=>c,lusetxt:()=>s,yqxs:()=>l});var o=n(36),r=n(12),a=n(41);const i=()=>(0,a.R)((e=>(document.querySelector(".noshow")?.classList.remove("noshow"),document.querySelector(".showall")&&(document.querySelector(".showall").innerHTML=""),(0,r.up)([/作者：.+所写的《.+》无弹窗免费全文阅读为转载作品,章节由网友发布。/,/推荐地址：https?:\/\/www\.shuquge\.com\/txt\/\d+\/index\.html/g],e),e)),(e=>((0,r.vS)(e,["请记住本书首发域名：","www.shuquge.com"]),e)),1),c=()=>(0,a.R)((e=>((0,r.up)([/推荐地址：https:\/\/www.xyqxs.cc\/html\/\d+\/\d+\/index\.html/g],e),e)),(e=>((0,r.rm)("div[style]",!0,e),(0,r.rm)("script",!0,e),(0,r.rm)('div[align="center"]',!1,e),(0,r.up)(["请记住本书首发域名：www.xyqxs.cc。笔趣阁手机版阅读网址：m.xyqxs.cc",/\(https:\/\/www.xyqxs.cc\/html\/\d+\/\d+\/\d+\.html\)/],e),e))),s=()=>(0,a.R)((e=>((0,r.vS)(e,["无弹窗免费全文阅读为转载作品","无弹窗推荐地址","简介："]),e)),(e=>((0,r.rm)("script",!0,e),(0,r.rm)("div[style]",!0,e),(0,r.rm)("div[align]",!0,e),(0,r.vS)(e,["https://www.lusetxt.com/books","请记住本书首发域名"]),(0,o.iA)(e),e))),l=()=>(0,a.R)((e=>((0,r.up)(["<span>简介：</span>"],e),(0,r.vS)(e,["推荐地址："]),e)),(e=>((0,r.rm)("script",!0,e),(0,r.rm)('div[align="center"]',!1,e),(0,r.vS)(e,["//www.yqxs.cc/html/","请记住本书首发域名"]),e)))},(e,t,n)=>{"use strict";n.r(t),n.d(t,{dingdiann:()=>i,mht:()=>c,xinwanben:()=>s,biqu55:()=>l});var o=n(36),r=n(12),a=n(41);const i=()=>(0,a.y)((e=>e),((e,t)=>((0,r.rm)("div[align]",!1,e),(0,r.rm)("script",!0,e),(0,r.up)(["一秒记住，精彩小说无弹窗免费阅读！","&lt;/a　:&gt;","--&gt;&gt;","本章未完，点击下一页继续阅读"],e),(0,o.iA)(e),e)),(e=>e.querySelector(".bottem2 > a:nth-child(4)").href),((e,t)=>e.innerText.includes("本章未完，点击下一页继续阅读"))),c=()=>(0,a.y)((e=>e),((e,t)=>((0,r.rm)("p[data-id]",!0,e),(0,o.iA)(e),e)),(e=>e.querySelector(".bottem2 > a:nth-child(4)").href),((e,t)=>new URL(t).pathname.includes("_"))),s=()=>(0,a.y)((e=>{const t=e.innerHTML.match(/《(.*)》/);let n;return 2===t?.length&&(n=t[1]),(0,r.vS)(e,["还不错的话请不要忘记向您QQ群和微博里的朋友推荐哦！","小说免费阅读地址："]),(0,r.up)([`${n}小说简介：`],e),e}),((e,t)=>((0,r.vS)(e,["手机用户输入地址","提示：浏览器搜索","把本站分享那些需要的小伙伴！找不到书请留言！"]),(0,o.iA)(e),e)),(e=>e.querySelector("#next_url").href),((e,t)=>new URL(t).pathname.includes("_"))),l=()=>(0,a.y)((e=>e),((e,t)=>((0,r.vS)(e,["精彩小说无弹窗免费阅读！"]),(0,o.iA)(e),e)),(e=>e.querySelector('div.bottem2 > a[rel="next"]:nth-child(3)').href),((e,t)=>/[\d_]+\.html$/.exec(t)?.[0].includes("_")??!1))},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Xkzw:()=>m});var o=n(23),r=n(19),a=n(36),i=n(21),c=n(35),s=n(5),l=n.n(s),d=n(37),u=n(38),h=n(29);class m extends h.c{constructor(){super(),this.imageMode="TM"}async bookParse(){const e=document.location.href,t=document.querySelector("#info > h1:nth-child(1)").innerText.trim(),n=document.querySelector("#info > p:nth-child(2)").innerText.replace(/作(\s+)?者[：:]/,"").trim(),o=document.querySelector("#intro"),[a,i]=await(0,c.SN)(o),s={},h=document.querySelector("#fmimg > img").src;h&&(0,r.CE)(h,this.imageMode,"cover-").then((e=>{s.cover=e})).catch((e=>l().error(e)));const m=[],p=unsafeWindow.bookId,g=[document.location.origin,"action.php"].join("/");l().debug(`[chapter]正在请求${g}`);const f=await fetch(g,{headers:{accept:"application/json, text/javascript, */*","content-type":"application/x-www-form-urlencoded","x-requested-with":"XMLHttpRequest"},body:`action=clist&bookid=${p}`,method:"POST",mode:"cors",credentials:"include"}).then((e=>e.json())).catch((e=>l().error(e))),b=document.querySelector("#wrapper > div.box_con:nth-child(7) > div:nth-child(1) > dl:nth-child(1)"),w=document.querySelector("#wrapper > div.box_con:nth-child(11) > div:nth-child(1) > dl:nth-child(1)"),y=e=>{let n="";const o=[];let r=[];if(e?.childElementCount){const a=Array.from(e.children);for(let i=0;i<e.childElementCount;i++){const e=a[i];if(0!==i){if("DD"===e.nodeName){const t=e.firstElementChild,n=t.innerText,o=t.href.split("/").slice(-1)[0].replace(".html","");r.push({chapterid:parseInt(o)-11*p,chaptername:n,isempty:0,originalurl:"",currenturl:""})}else if("DT"===e.nodeName){const a={columnname:n,columnid:0,chapterlist:r};o.push(a),n=e.innerText.replace(`《${t}》`,"").trim(),r=[]}}else n=e.innerText.replace(`《${t}》`,"").trim()}}return[o,r]},[v,x]=y(b),T=x.length;for(let e=0;e<T;e++){const e=x.pop();e&&f.columnlist[0].chapterlist.unshift(e)}if(0!==v.length){const e=v.length;for(let t=0;t<e;t++){const e=v.pop();e&&f.columnlist.unshift(e)}}const[S,A]=y(w),k=A.length,N=f.columnlist.length;for(let e=0;e<k;e++){const e=A.shift();e&&f.columnlist[N-1].chapterlist.push(e)}if(0!==S.length){const e=S.length;for(let t=0;t<e;t++){const e=S.shift();e&&f.columnlist.push(e)}}let M=0,C=0,E=null,P=0;for(const n of f.columnlist){C++,E=n.columnname;for(const o of n.chapterlist){M++,P++;const n=o.chaptername,r=e+(o.chapterid+11*p)+".html",a=!1,i=!1,c=new d.W({bookUrl:e,bookname:t,chapterUrl:r,chapterNumber:M,chapterName:n,isVIP:a,isPaid:i,sectionName:E,sectionNumber:C,sectionChapterNumber:P,chapterParse:this.chapterParse,charset:this.charset,options:{}});m.push(c)}}return new u.f({bookUrl:e,bookname:t,author:n,introduction:a,introductionHTML:i,additionalMetadate:s,chapters:m})}async chapterParse(e,t,n,r,c,s){const l=await(0,i.dL)(e,c);!function(e){!function(t){const n=t.getElementById("other"),o=t.getElementById("contenttips");if(n){let t=n.innerHTML.trim();const r=parseInt(t.substring(0,1),10);let a,i;1===r?(a=t.substring(1,9),i=t.substring(9,17),t=t.substring(17),n.innerHTML=function(t,n,o){const r=e.enc.Utf8.parse(n),a=e.enc.Utf8.parse(o),i=e.enc.Hex.parse(t),c=e.enc.Base64.stringify(i);return e.DES.decrypt(c,r,{iv:a,mode:e.mode.CBC,padding:e.pad.Pkcs7}).toString(e.enc.Utf8).toString()}(t,a,i),n.style.display="block",o&&o.remove()):2===r?(a=t.substring(1,33),i=t.substring(33,49),t=t.substring(49),n.innerHTML=function(t,n,o){const r=e.enc.Utf8.parse(n),a=e.enc.Utf8.parse(o),i=e.enc.Hex.parse(t),c=e.enc.Base64.stringify(i);return e.AES.decrypt(c,r,{iv:a,mode:e.mode.CBC,padding:e.pad.Pkcs7}).toString(e.enc.Utf8).toString()}(t,a,i),n.style.display="block",o&&o.remove()):3===r?(a=t.substring(1,9),i=t.substring(9,17),t=t.substring(17),n.innerHTML=function(t,n,o){const r=e.enc.Utf8.parse(n),a=e.enc.Utf8.parse(o),i=e.enc.Hex.parse(t),c=e.enc.Base64.stringify(i);return e.RC4.decrypt(c,r,{iv:a,mode:e.mode.CBC,padding:e.pad.Pkcs7}).toString(e.enc.Utf8).toString()}(t,a,i),n.style.display="block",o&&o.remove()):(a=t.substring(1,25),i=t.substring(25,33),t=t.substring(33),n.innerHTML=function(t,n,o){const r=e.enc.Utf8.parse(n),a=e.enc.Utf8.parse(o),i=e.enc.Hex.parse(t),c=e.enc.Base64.stringify(i);return e.TripleDES.decrypt(c,r,{iv:a,mode:e.mode.CBC,padding:e.pad.Pkcs7}).toString(e.enc.Utf8).toString()}(t,a,i),n.style.display="block",o&&o.remove())}}(l)}(o),t=l.querySelector(".bookname > h1:nth-child(1)").innerText.trim();const d=l.querySelector("#content");if(d){const{dom:e,text:n,images:o}=await(0,a.zM)(d,"TM");return{chapterName:t,contentRaw:d,contentText:n,contentHTML:e,contentImages:o,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{c226ks:()=>i});var o=n(12),r=n(35),a=n(47);const i=()=>(0,a.x)({bookUrl:document.location.href.replace(/index_\d+\.html/,"index_1.html"),bookname:document.querySelector(".info > .top > h1").innerText.trim(),author:document.querySelector(".info > .top > .fix > p:nth-child(1)").innerText.replace(/作(\s+)?者[：:]/,"").trim(),introDom:document.querySelector(".desc"),introDomPatch:e=>e,coverUrl:document.querySelector(".imgbox > img").src,getIndexUrls:()=>Array.from(document.querySelectorAll('[name="pageselect"] > option')).map((e=>document.location.origin+e.getAttribute("value"))),getAList:e=>e.querySelectorAll("div.section-box:nth-child(4) > ul:nth-child(1) > li > a"),getContentFromUrl:async(e,t,n)=>{const{contentRaw:a}=await(0,r.I2)({chapterName:t,chapterUrl:e,charset:n,selector:"#content",contentPatch:(e,t)=>((0,o.rm)("script",!0,e),(0,o.rm)("div.posterror",!1,e),(0,o.rm)("div[onclick]",!0,e),(0,o.up)(['<div class="posterror"><a href="javascript:postError();" class="red">章节错误,点此举报(免注册)</a>,举报后维护人员会在两分钟内校正章节内容,请耐心等待,并刷新页面。</div>'],e),e),getNextPage:e=>e.querySelector("div.section-opt.m-bottom-opt > a:nth-child(5)").href,continueCondition:(e,t)=>t.split("/").slice(-1)[0].includes("_"),enableCleanDOM:!1});return a},contentPatch:e=>e})},(e,t,n)=>{"use strict";n.d(t,{x:()=>m});var o=n(19),r=n(36),a=n(21),i=n(1),c=n(35),s=n(5),l=n.n(s),d=n(37),u=n(38),h=n(29);function m({bookUrl:e,bookname:t,author:n,introDom:s,introDomPatch:m,coverUrl:p,getIndexUrls:g,getAList:f,getAName:b,postHook:w,getContentFromUrl:y,getContent:v,contentPatch:x,concurrencyLimit:T,needLogin:S,nsfw:A,cleanDomOptions:k,overrideConstructor:N}){return class extends h.c{constructor(){super(),this.imageMode="TM",T&&(this.concurrencyLimit=T),S&&(this.needLogin=S),A&&(this.nsfw=A),N&&N(this)}async bookParse(){const[r,h]=await(0,c.SN)(s,m),y={};p&&(0,o.CE)(p,this.imageMode,"cover-").then((e=>{y.cover=e})).catch((e=>l().error(e)));const v=await g(),x=[];await(0,i.C1)(v,this.concurrencyLimit,(async e=>{l().info(`[BookParse]抓取目录页：${e}`);const t=await(0,a.rf)(e);return x.push([t,e]),t}));const T=x.sort(((e,t)=>{const n=e[1],o=t[1];return v.indexOf(n)-v.indexOf(o)})).map((e=>e[0])).map((e=>e?f(e):(l().error("[bookParse]部分目录页抓取失败！"),null))).filter((e=>null!==e)),S=[];T.forEach((e=>Array.from(e).forEach((e=>S.push(e)))));const A=[];let k=0;for(const n of Array.from(S)){let o;k++,o=b?b(n):n.innerText;const r=n.href,a=!1,i=!1;let c=new d.W({bookUrl:e,bookname:t,chapterUrl:r,chapterNumber:k,chapterName:o,isVIP:a,isPaid:i,sectionName:null,sectionChapterNumber:null,sectionNumber:null,chapterParse:this.chapterParse,charset:this.charset,options:{bookname:t}});"function"==typeof w&&(c=w(c)),c&&A.push(c)}return new u.f({bookUrl:e,bookname:t,author:n,introduction:r,introductionHTML:h,additionalMetadate:y,chapters:A})}async chapterParse(e,t,n,o,i,c){let s;if(void 0!==y)s=await y(e,t,i);else if(void 0!==v){const t=await(0,a.dL)(e,i);s=v(t)}if(s){s=x(s);const{dom:e,text:n,images:o}=await(0,r.zM)(s,"TM",k);return{chapterName:t,contentRaw:s,contentText:n,contentHTML:e,contentImages:o,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Sfacg:()=>f});var o=n(19),r=n(36),a=n(21),i=n(12),c=n(35),s=n(5),l=n.n(s),d=n(2),u=n(20),h=n(37),m=n(38),p=n(29),g=n(16);class f extends p.c{constructor(){super(),this.imageMode="TM",this.concurrencyLimit=1}async bookParse(){const e=document.location.href.replace("/MainIndex/",""),t=document.querySelector("h1.story-title").innerText.trim(),n=await(0,a.dL)(e,void 0),r=n.querySelector(".author-name").innerText.trim(),s=n.querySelector(".introduce"),[p,g]=await(0,c.SN)(s),f={},b=n.querySelector("#hasTicket div.pic img").src;if(b&&(0,o.CE)(b,this.imageMode,"cover-").then((e=>{f.cover=e})).catch((e=>l().error(e))),f.tags=Array.from(n.querySelectorAll("ul.tag-list > li.tag > a")).map((e=>((0,i.rm)("span.icn",!1,e),e.innerText.trim().replace(/\(\d+\)$/,"")))),n.querySelector(".d-banner")){const e=n.querySelector(".d-banner")?.style.backgroundImage.split('"');if(3===e?.length){const t=e[1],n=new u.J(t,`beitou.${t.split(".").slice(-1)[0]}`,"TM");n.init(),f.attachments=[n]}}const w=[],y=document.querySelectorAll(".story-catalog"),v=document.querySelectorAll(".catalog-list a"),x=e=>e.querySelector(".catalog-title").innerText.replace(`【${t}】`,"").trim();let T=0,S=0,A=0,k="";for(const n of Array.from(v)){const o=n.getAttribute("title")?.trim()??"",r=n.href,a=(0,c.$d)(n,y,x);a&&k!==a&&(k=a,S++,A=0),T++,A++;const i=()=>0!==n.childElementCount&&"icn_vip"===n.firstElementChild?.getAttribute("class"),s=null,l=new h.W({bookUrl:e,bookname:t,chapterUrl:r,chapterNumber:T,chapterName:o,isVIP:i(),isPaid:s,sectionName:a,sectionNumber:S,sectionChapterNumber:A,chapterParse:this.chapterParse,charset:this.charset,options:{}}),u=!document.querySelector(".user-bar > .top-link > .normal-link")?.innerHTML.includes("您好，SF游客");l.isVIP&&!1===u&&(l.status=d.qb.aborted),w.push(l)}const N=new m.f({bookUrl:e,bookname:t,author:r,introduction:p,introductionHTML:g,additionalMetadate:f,chapters:w});return N.ToCUrl=document.location.href,N}async chapterParse(e,t,n,o,i,c){const s=e.split("/").slice(-2,-1)[0];async function h(){const n=await(0,a.dL)(e,i);t=n.querySelector("h1.article-title").innerText.trim();const o=n.querySelector(".article-content");if(o){const{dom:e,text:n,images:a}=await(0,r.zM)(o,"TM");return{chapterName:t,contentRaw:o,contentText:n,contentHTML:e,contentImages:a,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}return n?async function(){if(3===document.querySelector(".user-bar > .top-link > .normal-link")?.childElementCount){const t=await(0,a.dL)(e,i),n=t.querySelector("h1.article-title").innerText.trim();if(null===t.querySelector(".pay-section")){const o=t.querySelector(".article-content > #vipImage");if(o){const t=o.src,r=`vipCHapter${s}.gif`,a=await async function(t,n){let o=0;const r=await function t(n){return l().debug(`[Chapter]请求 ${n} Referer ${e} 重试次数 ${o}`),fetch(n,{headers:{accept:"image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8"},referrer:e,body:null,method:"GET",mode:"cors",credentials:"include"}).then((e=>e.blob())).then((r=>53658===r.size||42356===r.size?(l().error(`[Chapter]请求 ${n} 失败 Referer ${e}`),o<g.o5?(o++,t(n)):null):r)).catch((e=>l().error(e)))}(t),a=new u.J(t,n,"naive");return r?(a.imageBlob=r,a.status=d.qb.finished):a.status=d.qb.failed,a}(t,r),i=[a],c=document.createElement("img");c.src=r,c.alt=t;const h=document.createElement("div");return h.appendChild(c),{chapterName:n,contentRaw:h,contentText:`VIP章节，请打开HTML文件查看。\n![${t}](${r})`,contentHTML:h,contentImages:i,additionalMetadate:null}}return h()}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}():h()}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Hetushu:()=>m});var o=n(19),r=n(36),a=n(21),i=n(12),c=n(35),s=n(5),l=n.n(s),d=n(37),u=n(38),h=n(29);class m extends h.c{constructor(){super(),this.imageMode="TM"}async bookParse(){const e=document.location.href,t=document.querySelector(".book_info > h2").innerText.trim(),n=document.querySelector(".book_info > div:nth-child(3) > a:nth-child(1)").innerText.trim(),r=document.querySelector(".intro"),[a,i]=await(0,c.SN)(r),s={},h=document.querySelector(".book_info > img").src;h&&(0,o.CE)(h,this.imageMode,"cover-").then((e=>{s.cover=e})).catch((e=>l().error(e)));const m=[],p=document.querySelector("#dir")?.childNodes;if(p&&0!==p.length){let n=0,o=0,r=null,a=0;for(const i of p)if("DT"===i.nodeName)o++,a=0,r=i.innerText.trim();else if("DD"===i.nodeName){n++,a++;const c=i.firstElementChild,s=c.innerText,l=c.href,u=!1,h=!1,p=new d.W({bookUrl:e,bookname:t,chapterUrl:l,chapterNumber:n,chapterName:s,isVIP:u,isPaid:h,sectionName:r,sectionNumber:o,sectionChapterNumber:a,chapterParse:this.chapterParse,charset:this.charset,options:{}});m.push(p)}}return new u.f({bookUrl:e,bookname:t,author:n,introduction:a,introductionHTML:i,additionalMetadate:s,chapters:m})}async chapterParse(e,t,n,o,c,s){const d=await(0,a.dL)(e,c);t=d.querySelector("#content .h2").innerText.trim(),await async function(){let t,n,o;if(!/\/(book[0-9]?)\/([0-9]+)\/([0-9]+)\.html(\?position=([0-9]+))?$/.test(e))return!1;t=RegExp.$1,n=RegExp.$2,o=RegExp.$3;const r=[document.location.origin,t,n,"r"+o+".json"].join("/");l().debug(`[Chapter]请求 ${r} Referer ${e}`);const a=await fetch(r,{headers:{accept:"*/*","cache-control":"no-cache","content-type":"application/x-www-form-urlencoded",pragma:"no-cache","x-requested-with":"XMLHttpRequest"},referrer:e,method:"GET",mode:"cors",credentials:"include"}).then((e=>e.headers.get("token"))).catch((e=>l().error(e)));if(a){const e=atob(a).split(/[A-Z]+%/).map((e=>parseInt(e))),t=d.querySelector("#content");(0,i.rm)(".mask.mask2",!1,t);let n=0,o=0;for(let e=0;e<t.childNodes.length&&("H2"===t.childNodes[e].nodeName&&(o=e+1),"DIV"!==t.childNodes[e].nodeName||"chapter"===t.childNodes[e].className);e++);const r=[];for(let a=0;a<e.length;a++)e[a]<5?(r[e[a]]=t.childNodes[a+o],n++):r[e[a]-n]=t.childNodes[a+o];for(const e of r)e&&t.appendChild(e)}}();const u=d.querySelector("#content");if(u){"h2, acronym, bdo, big, cite, code, dfn, kbd, q, s, samp, strike, tt, u, var".split(", ").forEach((e=>{(0,i.rm)(e,!0,u)})),Array.from(u.querySelectorAll("div")).map((e=>{const t=document.createElement("p");t.innerHTML=e.innerHTML,e.parentNode?.replaceChild(t,e)}));const{dom:e,text:n,images:o}=await(0,r.zM)(u,"TM");return{chapterName:t,contentRaw:u,contentText:n,contentHTML:e,contentImages:o,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{shouda8:()=>a});var o=n(12),r=n(42);const a=()=>(0,r.x)({bookUrl:document.location.href,bookname:document.querySelector(".bread-crumbs > li:nth-child(4)").innerText.trim(),author:document.querySelector("div.bookname > h1 > em").innerText.replace("作者：","").trim(),introDom:document.querySelector(".intro"),introDomPatch:e=>((0,o.rm)(".book_keywords",!0,e),(0,o.rm)("script",!0,e),e),coverUrl:document.querySelector(".pic > img:nth-child(1)").src,aList:document.querySelectorAll(".link_14 dd > a"),sections:document.querySelectorAll(".link_14 dt > b"),getSName:e=>e.innerText.trim(),getContent:e=>e.querySelector("#content"),contentPatch:e=>((0,o.vS)(e,["手打吧更新速度最快。","www.shouda88.com"]),e)})},(e,t,n)=>{"use strict";n.r(t),n.d(t,{viviyzw:()=>r});var o=n(52);const r=()=>{const e=document.location.href.replace("/book","/info");return(0,o.x)({bookUrl:e,anotherPageUrl:e,getBookname:e=>e.querySelector("article.info > header > h1").innerText.trim(),getAuthor:e=>e.querySelector("article.info > p.detail.pt20 > i:nth-child(1) > a").innerText.trim(),getIntroDom:e=>e.querySelector("article.info > p.desc"),introDomPatch:e=>e,getCoverUrl:e=>e.querySelector("article.info > div.cover > img").src,getAList:e=>document.querySelectorAll("ul.mulu > li.col3 > a"),getSections:e=>document.querySelectorAll("li.col1.volumn"),getSName:e=>e.innerText,postHook:e=>{if(!e.sectionName?.includes("最新九章"))return e},getContent:e=>e.querySelector("#content"),contentPatch:e=>e})}},(e,t,n)=>{"use strict";n.d(t,{x:()=>h});var o=n(19),r=n(36),a=n(21),i=n(35),c=n(5),s=n.n(c),l=n(37),d=n(38),u=n(29);function h({bookUrl:e,anotherPageUrl:t,ToCUrl:n,getBookname:c,getAuthor:h,getIntroDom:m,introDomPatch:p,getCoverUrl:g,getAList:f,getAName:b,getSections:w,getSName:y,postHook:v,getContentFromUrl:x,getContent:T,contentPatch:S,concurrencyLimit:A,needLogin:k,nsfw:N,cleanDomOptions:M,overrideConstructor:C}){return class extends u.c{constructor(){super(),this.imageMode="TM",A&&(this.concurrencyLimit=A),k&&(this.needLogin=k),N&&(this.nsfw=N),C&&C(this)}async bookParse(){const r=await(0,a.dL)(t,this.charset),u=document.createElement("base");u.href=t,r.head.appendChild(u);const x=c(r),T=h(r),S=m(r),[A,k]=await(0,i.SN)(S,p),N=g(r),M={};let C;N&&(0,o.CE)(N,this.imageMode,"cover-").then((e=>{M.cover=e})).catch((e=>s().error(e))),"function"==typeof w&&(C=w(r));const E=[];let P=0,q=0,L=0,_=null,U=!1;C&&C instanceof NodeList&&"function"==typeof y&&(U=!0);const I=f(r);for(const t of Array.from(I)){let n;n=b?b(t):t.innerText;const o=t.href;if(U&&C&&y){const e=(0,i.$d)(t,C,y);e!==_&&(_=e,q++,L=0)}P++,L++;const r=!1,a=!1;let c=new l.W({bookUrl:e,bookname:x,chapterUrl:o,chapterNumber:P,chapterName:n,isVIP:r,isPaid:a,sectionName:_,sectionNumber:U?q:null,sectionChapterNumber:U?L:null,chapterParse:this.chapterParse,charset:this.charset,options:{bookname:x}});"function"==typeof v&&(c=v(c)),c&&E.push(c)}const V=new d.f({bookUrl:e,bookname:x,author:T,introduction:A,introductionHTML:k,additionalMetadate:M,chapters:E});return n?V.ToCUrl=n:e!==t&&(V.ToCUrl=t),V}async chapterParse(e,t,n,o,i,c){let s;if(void 0!==x)s=await x(e,t,i);else if(void 0!==T){const t=await(0,a.dL)(e,i);s=T(t)}if(s){s=S(s);const{dom:e,text:n,images:o}=await(0,r.zM)(s,"TM",M);return{chapterName:t,contentRaw:s,contentText:n,contentHTML:e,contentImages:o,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{xiaoshuodaquan:()=>a});var o=n(12),r=n(52);const a=()=>(0,r.x)({bookUrl:document.location.href,anotherPageUrl:document.querySelector(".viewalllinks").href,getBookname:e=>document.querySelector(".r420 > h1").innerText.trim(),getAuthor:e=>document.querySelector(".author a").innerText.trim(),getIntroDom:e=>e.querySelector(".bookintro"),introDomPatch:e=>e,getCoverUrl:e=>document.querySelector(".con_limg > img")?.src,getAList:e=>e.querySelectorAll("div.clearfix li > a"),getSections:e=>e.querySelectorAll("div.dirtitone > h2"),getSName:e=>e.innerText.trim(),postHook:e=>(e.sectionName=e.sectionName?.replace(e.bookname,"").trim()??null,e),getContent:e=>e.querySelector("#content"),contentPatch:e=>{(0,o.rm)("div",!0,e),(0,o.rm)("script",!0,e);const t=document.createElement("div");return t.innerHTML=e.innerHTML.replace(/\n/g,"<br/><br/>"),t}})},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Qidian:()=>g});var o=n(19),r=n(36),a=n(21),i=n(1),c=n(12),s=n(35),l=n(5),d=n.n(l),u=n(2),h=n(37),m=n(38),p=n(29);class g extends p.c{constructor(){super(),this.imageMode="TM",this.concurrencyLimit=1}async bookParse(){let e=document.getElementById("bookImg");if(!e)throw new Error("未发现 bookId");e=e.getAttribute("data-bid");const t=document.getElementById("authorId")?.getAttribute("data-authorid"),n=unsafeWindow.jQuery.ajaxSettings.data._csrfToken,r=document.location.href,a=document.querySelector(".book-info > h1 > em").innerText.trim(),c=document.querySelector(".book-info .writer").innerText.replace(/作\s+者:/,"").trim(),l=document.querySelector(".book-info-detail .book-intro"),[p,g]=await(0,s.SN)(l),f={},b=document.querySelector("#bookImg > img").src;b&&(0,o.CE)(b,this.imageMode,"cover-").then((e=>{f.cover=e})).catch((e=>d().error(e))),f.tags=Array.from(document.querySelectorAll(".book-info > .tag > a, .tag-wrap > .tags")).map((e=>e.innerText.trim()));const w=Boolean(document.querySelector(".book-information .flag"));d().info(`[Book]限免书籍 ${w}`);const y=[],v=document.querySelectorAll("#j-catalogWrap li").length;v&&(()=>{const e=document.querySelector("#J-catalogCount").innerText.match(/\d+/);if(e)return parseInt(e[0])})()===v||await(0,i._v)(3e3);const x=document.querySelectorAll("#j-catalogWrap > .volume-wrap > .volume");let T=0;for(let o=0;o<x.length;o++){const i=x[o],c=o+1,s=i.querySelector("h3").innerText.trim().split("\n").slice(-1)[0].split("·")[0].trim();let l=0;const d=i.querySelectorAll("ul.cf > li");for(const o of Array.from(d)){const i=o.querySelector("a");T++,l++;const d=i.innerText.trim(),m=i.href,p=()=>"vipreader.qidian.com"===new URL(m).host,g=()=>!!p()&&2!==o.childElementCount;let f;f=p()?/(\d+)\/?$/.exec(m)?.slice(-1)[0]??null:null;const b=new h.W({bookUrl:r,bookname:a,chapterUrl:m,chapterNumber:T,chapterName:d,isVIP:p(),isPaid:g(),sectionName:s,sectionNumber:c,sectionChapterNumber:l,chapterParse:this.chapterParse,charset:this.charset,options:{_csrfToken:n,bookId:e,authorId:t,chapterId:f,limitFree:w}}),v=()=>{const e=document.querySelector(".sign-in"),t=document.querySelector(".sign-out");return!!(e&&t&&Array.from(t.classList).includes("hidden"))};p()&&(b.status=u.qb.aborted,w&&(b.status=u.qb.pending),v()&&b.isPaid&&(b.status=u.qb.pending)),y.push(b)}}return new m.f({bookUrl:r,bookname:a,author:c,introduction:p,introductionHTML:g,additionalMetadate:f,chapters:y})}async chapterParse(e,t,n,o,i,s){const l={chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null};return async function(){let o;if(o=n?await(0,a.jt)(e):await(0,a.Fz)(e,i),o){if(t=o.querySelector(".j_chapterName > .content-wrap").innerText.trim(),o.querySelector(".vip-limit-wrap"))return l;const e=document.createElement("div");let n="";const a=o.querySelector(".read-content");(0,c.rm)("span.review-count",!0,a),Array.from(a.querySelectorAll("span.content-wrap")).forEach((e=>{const t=e.parentElement;t&&(t.innerHTML=e.innerHTML)}));const i=o.querySelector(".author-say-wrap");if(a){const{dom:o,text:s,images:l}=await(0,r.zM)(a,"TM");if((0,r.iA)(o),e.appendChild(o),n+=s,i){const t=i.querySelector("div.author-say");if(t){(0,c.rm)("a.avatar",!1,t),(0,c.rm)("h4",!1,t);const{dom:o,text:a,images:s}=await(0,r.zM)(i,"TM");(0,r.iA)(o),o.className="authorSay";const d=document.createElement("hr");e.appendChild(d),e.appendChild(t),n=n+"\n\n"+"-".repeat(10)+"\n\n"+a,l.push(...s)}}return{chapterName:t,contentRaw:e,contentText:n,contentHTML:e,contentImages:l,additionalMetadate:null}}}return l}()}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Jjwxc:()=>w});var o=n(19),r=n(36),a=n(21),i=n(1),c=n(12),s=n(35),l=n(5),d=n.n(l),u=n(2),h=n(20),m=n(37),p=n(38),g=n(29),f=n(16);async function b(e,t){let n=t;const o=await async function(e){return f.Z3?await async function(e){const t=`https://jjwxc.bgme.bid/${e}.json`;d().info(`[jjwxc-font]开始请求远程字体对照表 ${e}`);let n=f.o5;for(;n>0;){let o;try{o=await fetch(t)}catch(t){if(d().error(t),n--,n>0){await(0,i._v)(5e3);continue}return void d().info(`[jjwxc-font]远程字体对照表 ${e} 下载失败`)}if(o.ok)return d().info(`[jjwxc-font]远程字体对照表 ${e} 下载成功`),await o.json();if(n--,!(n>0))return void d().info(`[jjwxc-font]远程字体对照表 ${e} 下载失败`);await(0,i._v)(5e3)}}(e):void 0}(e);if(o){for(const e in o)if(Object.prototype.hasOwnProperty.call(o,e)){const t=o[e];n=n.replaceAll(e,t)}n=n.replace(/\u200c/g,"")}return n}idbKeyval;class w extends g.c{constructor(){super(),this.imageMode="TM",this.concurrencyLimit=5,this.charset="GB18030"}async bookParse(){const e=document.location.href;let t="";const n={};let r="",c=null,l=null,h=null;if(0===Array.from(document.querySelectorAll(".smallreadbody")).filter((e=>e.innerText.includes("文案信息审核未通过，等待作者修改后重新审核"))).length){t=document.querySelector('h1[itemprop="name"] > span').innerText.trim(),r=document.querySelector("td.sptd h2 a span").innerText.replace(/作\s+者:/,"").trim();const e=document.querySelector("#novelintro");[c,l,h]=await(0,s.SN)(e),h&&(n.attachments=[...h]);const a=document.querySelector(".noveldefaultimage").src;a&&(0,o.CE)(a,this.imageMode,"cover-").then((e=>{n.cover=e})).catch((e=>d().error(e)));let i=document.querySelector("table > tbody > tr > td.readtd > div.righttd > ul.rightul > li:nth-child(1) > span:nth-child(2)").innerText.split("-");i=i.concat(Array.from(document.querySelectorAll("div.smallreadbody:nth-child(3) > span > a")).map((e=>e.innerText)));const u=document.querySelector("table > tbody > tr > td.readtd > div.righttd > ul.rightul > li:nth-child(2)").innerText.replace("\n",""),m=document.querySelector("table > tbody > tr > td.readtd > div.righttd > ul.rightul > li:nth-child(3)").innerText.replace("\n","");i.push(u),i.push(m),n.tags=i}else{if(window.scrollTo(0,document.body.scrollHeight),await(0,i._v)(3e3),t=document.querySelector("td[id^=comment_] span.coltext > a")?.innerText.trim().replace(/《|》/g,""),window.scrollTo(0,0),!t)throw new Error("抓取书名出错");const e=document.querySelector("#oneboolt > tbody > tr:nth-child(1) > td > div > h2 > a")?.href;e&&(r=(await(0,a.dL)(e,this.charset)).querySelector('span[itemprop="name"]')?.innerText??r)}const g=[],f=document.querySelectorAll("#oneboolt > tbody > tr");let b=0,w=0,y=null,v=0;for(const n of Array.from(f))if(n.getAttribute("bgcolor"))w++,v=0,y=n.querySelector("b.volumnfont")?.innerText.trim();else if(n.getAttribute("itemprop")){b++,v++;const o=n.querySelector("td:nth-child(2)"),r=o?.querySelector("a:nth-child(1)"),a=()=>!!r?.getAttribute("onclick");if("[锁]"===o?.innerText.trim()){const n="[锁]",o="",r=new m.W({bookUrl:e,bookname:t,chapterUrl:o,chapterNumber:b,chapterName:n,isVIP:!1,isPaid:null,sectionName:y,sectionNumber:w,sectionChapterNumber:v,chapterParse:this.chapterParse,charset:this.charset,options:{}});r.status=u.qb.aborted,g.push(r)}else if(a()){const n=r.innerText.trim(),o=r.getAttribute("rel");if(o){const r=new m.W({bookUrl:e,bookname:t,chapterUrl:o,chapterNumber:b,chapterName:n,isVIP:a(),isPaid:null,sectionName:y,sectionNumber:w,sectionChapterNumber:v,chapterParse:this.chapterParse,charset:this.charset,options:{}}),i=()=>!document.getElementById("jj_login");a()&&!i()&&(r.status=u.qb.aborted),g.push(r)}}else{const n=r.innerText.trim(),o=r.href,i=new m.W({bookUrl:e,bookname:t,chapterUrl:o,chapterNumber:b,chapterName:n,isVIP:a(),isPaid:null,sectionName:y,sectionNumber:w,sectionChapterNumber:v,chapterParse:this.chapterParse,charset:this.charset,options:{}}),c=()=>!document.getElementById("jj_login");a()&&!c()&&(i.status=u.qb.aborted),g.push(i)}}return new p.f({bookUrl:e,bookname:t,author:r,introduction:c,introductionHTML:l,additionalMetadate:n,chapters:g})}async chapterParse(e,t,n,i,s,l){return n?async function(){const n=await(0,a.Fz)(e,s);if(!n.querySelector("#buy_content")&&n.querySelector("div.noveltext")){const t=n.querySelector("div.noveltext h2").innerText.trim(),i=n.querySelector("div.noveltext");if(i){(0,c.rm)("hr",!0,i);const s=i.querySelector(".readsmall");let l,m;if(s){const{dom:e,text:t}=await(0,r.zM)(s,"TM");[l,m]=[e,t]}(0,c.rm)("div",!0,i),(0,c.up)(["@无限好文，尽在晋江文学城"],i);let{dom:p,text:g,images:w}=await(0,r.zM)(i,"TM");if(s&&l&&m){const e=document.createElement("hr");l.className="authorSay",p.appendChild(e),p.appendChild(l),g=g+"\n\n"+"-".repeat(20)+"\n\n"+m}let y=p,v=g;const[x,T,S]=await async function(){let t=0;const[r,i]=function(){const e=n.querySelectorAll("body > style")[1];let t,o;if(e.sheet){const n=e.sheet.cssRules[e.sheet.cssRules.length-2],r=n.cssText.match(/jjwxcfont_[\d\w]+/),a=n.cssText.match(/{(.*)}/);if(r&&a){t=r[0];const e=a[1];for(const n of e.split(","))if(n.includes('format("woff2")')){const e=n.match(/url\("(.*)"\)\s/);if(e)return o=document.location.protocol+e[1],[t,o]}}}const r=document.querySelector("div.noveltext")?.classList[1];return r?(t=r,o=document.location.protocol+`//static.jjwxc.net/tmp/fonts/${t}.woff2?h=my.jjwxc.net`,[t,o]):[null,null]}();if(r&&i){const n=`${r}.woff2`;let c;const s=(0,o.gc)(i);if(s)c=s;else{const r=await function n(o){return d().debug(`[Chapter]请求 ${o} Referer ${e} 重试次数 ${t}`),(0,a.GF)(o,{headers:{accept:"*/*",Referer:e},responseType:"blob"}).then((r=>r.status>=200&&r.status<=299?r.response:(d().error(`[Chapter]请求 ${o} 失败 Referer ${e}`),t<f.o5?(t++,n(o)):null))).catch((e=>d().error(e)))}(i);c=new h.J(i,n,"TM"),c.imageBlob=r,c.status=u.qb.finished,(0,o.dK)(c)}const l=document.createElement("style");return l.innerHTML=`.${r} {\n  font-family: ${r}, 'Microsoft YaHei', PingFangSC-Regular, HelveticaNeue-Light, 'Helvetica Neue Light', sans-serif !important;\n}\n@font-face {\n  font-family: ${r};\n  src: url('${n}') format('woff2');\n}\n.hide {\n  display: none;\n}`,[r,c,l]}return[null,null,null]}();if(x&&T&&S){v=await b(x,g),w.push(T),y=document.createElement("div");const e=document.createElement("div");e.innerHTML=await b(x,p.innerHTML),y.appendChild(S),p.className=`${x} hide`,y.appendChild(p),y.appendChild(e)}return{chapterName:t,contentRaw:i,contentText:v,contentHTML:y,contentImages:w,additionalMetadate:null}}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}():async function(){const n=await(0,a.dL)(e,s);t=n.querySelector("div.noveltext h2").innerText.trim();const o=n.querySelector("div.noveltext");if(o){(0,c.rm)("hr",!0,o);const e=o.querySelector(".readsmall");let n,a;if(e){const{dom:t,text:o}=await(0,r.zM)(e,"TM");[n,a]=[t,o]}(0,c.rm)("div",!0,o),(0,c.up)(["@无限好文，尽在晋江文学城"],o);let{dom:i,text:s,images:l}=await(0,r.zM)(o,"TM");if(e&&n&&a){const e=document.createElement("hr");n.className="authorSay",i.appendChild(e),i.appendChild(n),s=s+"\n\n"+"-".repeat(20)+"\n\n"+a}return{chapterName:t,contentRaw:o,contentText:s,contentHTML:i,contentImages:l,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}()}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Zongheng:()=>m});var o=n(19),r=n(36),a=n(21),i=n(35),c=n(5),s=n.n(c),l=n(2),d=n(37),u=n(38),h=n(29);class m extends h.c{constructor(){super(),this.imageMode="TM",this.concurrencyLimit=5}async bookParse(){const e=document.location.href.replace("/showchapter/","/book/"),t=document.querySelector("div.book-meta > h1").innerText.trim(),n=document.querySelector("div.book-meta > p > span:nth-child(1) > a").innerText.trim(),r=await(0,a.dL)(e,void 0),c=r.querySelector("div.book-info > div.book-dec"),[h,m]=await(0,i.SN)(c),p={},g=r.querySelector("div.book-img > img").src;g&&(0,o.CE)(g,this.imageMode,"cover-").then((e=>{p.cover=e})).catch((e=>s().error(e))),p.tags=Array.from(r.querySelectorAll(".book-info>.book-label a")).map((e=>e.innerText.trim()));const f=[],b=document.querySelectorAll(".volume-list");let w=0;for(let n=0;n<b.length;n++){const o=b[n],r=n+1,a=o.querySelector("div.volume");Array.from(a.children).forEach((e=>e.remove()));const i=a.innerText.trim();let c=0;const s=o.querySelectorAll("ul.chapter-list > li");for(const n of Array.from(s)){const o=n.querySelector("a");w++,c++;const a=o.innerText.trim(),s=o.href,u=()=>!!n.className.includes("vip"),h=()=>!1,m=new d.W({bookUrl:e,bookname:t,chapterUrl:s,chapterNumber:w,chapterName:a,isVIP:u(),isPaid:h(),sectionName:i,sectionNumber:r,sectionChapterNumber:c,chapterParse:this.chapterParse,charset:this.charset,options:{}}),p=()=>!1;!u()||p()&&m.isPaid||(m.status=l.qb.aborted),f.push(m)}}return new u.f({bookUrl:e,bookname:t,author:n,introduction:h,introductionHTML:m,additionalMetadate:p,chapters:f})}async chapterParse(e,t,n,o,i,c){return n?async function(){return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}():async function(){const t=await(0,a.Fz)(e,i),n=t.querySelector("div.title_txtbox").innerText.trim(),o=t.querySelector("div.content");if(o){const{dom:e,text:t,images:a}=await(0,r.zM)(o,"TM");return{chapterName:n,contentRaw:o,contentText:t,contentHTML:e,contentImages:a,additionalMetadate:null}}return{chapterName:n,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}()}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{C17k:()=>p});var o=n(19),r=n(36),a=n(21),i=n(12),c=n(35),s=n(5),l=n.n(s),d=n(2),u=n(37),h=n(38),m=n(29);class p extends m.c{constructor(){super(),this.imageMode="TM",this.charset="UTF-8",this.concurrencyLimit=5}async bookParse(){const e=document.location.href.replace("/list/","/book/"),t=document.querySelector("h1.Title").innerText.trim(),n=document.querySelector("div.Author > a").innerText.trim(),r=await(0,a.dL)(e,void 0),i=r.querySelector("#bookInfo p.intro > a"),[s,m]=await(0,c.SN)(i),p={},g=r.querySelector("#bookCover img.book").src;g&&(0,o.CE)(g,this.imageMode,"cover-").then((e=>{p.cover=e})).catch((e=>l().error(e)));const f=[],b=document.querySelectorAll("dl.Volume");let w=0;for(let n=0;n<b.length;n++){const o=b[n],r=n+1,a=o.querySelector("dt > span.tit").innerText.trim();let i=0;const c=o.querySelectorAll("dd > a");for(const n of Array.from(c)){const o=n.firstElementChild;w++,i++;const c=o.innerText.trim(),s=n.href,l=()=>!!o?.className.includes("vip"),h=()=>!1,m=new u.W({bookUrl:e,bookname:t,chapterUrl:s,chapterNumber:w,chapterName:c,isVIP:l(),isPaid:h(),sectionName:a,sectionNumber:r,sectionChapterNumber:i,chapterParse:this.chapterParse,charset:this.charset,options:{}}),p=()=>!1;!l()||p()&&m.isPaid||(m.status=d.qb.aborted),f.push(m)}}const y=new h.f({bookUrl:e,bookname:t,author:n,introduction:s,introductionHTML:m,additionalMetadate:p,chapters:f});return y.ToCUrl=document.location.href,y}async chapterParse(e,t,n,o,c,s){return n?async function(){return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}():async function(){const n=await(0,a.dL)(e,c);t=n.querySelector("#readArea > div.readAreaBox.content > h1").innerText.trim();const o=n.querySelector("#readArea > div.readAreaBox.content > div.p");if(o){(0,i.rm)("p.copy",!1,o),(0,i.rm)("#banner_content",!1,o),(0,i.rm)("div.qrcode",!1,o),(0,i.rm)("div.chapter_text_ad",!1,o);const{dom:e,text:n,images:a}=await(0,r.zM)(o,"TM");return{chapterName:t,contentRaw:o,contentText:n,contentHTML:e,contentImages:a,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}()}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Shuhai:()=>g});var o=n(19),r=n(36),a=n(21),i=n(1),c=n(12),s=n(35),l=n(5),d=n.n(l),u=n(2),h=n(37),m=n(38),p=n(29);class g extends p.c{constructor(){super(),this.imageMode="TM",this.concurrencyLimit=5,this.charset="GBK"}async bookParse(){const e=document.location.href,t=document.querySelector("div.book-info-bookname > span:nth-child(1)").innerText.trim(),n=document.querySelector("div.book-info-bookname > span:nth-child(2)").innerText.replace("作者: ","").trim(),r=document.querySelector("div.book-info-bookintro")||document.querySelector("div.book-info-bookintro-all"),[a,c]=await(0,s.SN)(r),l={},p=document.querySelector(".book-cover-wrapper > img").getAttribute("data-original");p&&(0,o.CE)(p,this.imageMode,"cover-").then((e=>{l.cover=e})).catch((e=>d().error(e))),l.tags=Array.from(document.querySelectorAll(".book-info-bookstate > .tag")).map((e=>e.innerText.trim()));const g=[];0===document.querySelectorAll("#catalog > .chapter-item").length&&await(0,i._v)(3e3);const f=document.querySelectorAll("#catalog > .chapter-item");let b=0,w=0,y=null,v=0;for(const n of Array.from(f))if("SPAN"===n.nodeName)w++,v=0,y=n?.innerText.trim();else if("DIV"===n.nodeName){b++,v++;const o=n.querySelector("a"),r=()=>2===n.childElementCount,a=()=>!1,i=o.innerText.trim(),c=o.href,s=new h.W({bookUrl:e,bookname:t,chapterUrl:c,chapterNumber:b,chapterName:i,isVIP:r(),isPaid:a(),sectionName:y,sectionNumber:w,sectionChapterNumber:v,chapterParse:this.chapterParse,charset:this.charset,options:{}}),l=()=>!1;!r()||l()&&s.isPaid||(s.status=u.qb.aborted),g.push(s)}return new m.f({bookUrl:e,bookname:t,author:n,introduction:a,introductionHTML:c,additionalMetadate:l,chapters:g})}async chapterParse(e,t,n,o,i,s){return n?async function(){return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}():async function(){const n=await(0,a.Fz)(e,i);t=n.querySelector("div.chapter-name").innerText.replace("正文 ","").trim();const o=n.querySelector("#reader-content > div:nth-child(1)");if(o){(0,c.rm)("div.chaper-info",!1,o);const{dom:e,text:n,images:a}=await(0,r.zM)(o,"TM");return{chapterName:t,contentRaw:o,contentText:n,contentHTML:e,contentImages:a,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}()}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Gongzicp:()=>p});var o=n(23),r=n(19),a=n(1),i=n(35),c=n(5),s=n.n(c),l=n(2),d=n(37),u=n(38),h=n(29),m=n(16);class p extends h.c{constructor(){super(),this.imageMode="TM",this.concurrencyLimit=1}async bookParse(){const e=document.location.href,t=document.querySelector("span.id").innerText.replace("CP","");if(!t)throw new Error("获取bookID出错");const n=new URL("https://webapi.gongzicp.com/novel/novelGetInfo");n.searchParams.set("id",t),s().debug(`请求地址: ${n.toString()}`);const o=await fetch(n.toString(),{credentials:"include",headers:{Accept:"application/json, text/plain, */*",Client:"pc",Lang:"cn","Content-Type":"application/json;charset=utf-8"},referrer:e,method:"GET",mode:"cors"}).then((e=>e.json())).catch((e=>s().error(e)));if(200!==o.code)throw new Error(`数据接口请求失败，URL:${n.toString()}`);const a=o.data,c=a.novelInfo.novel_name,h=a.novelInfo.author_nickname,m=document.createElement("div");m.innerHTML=a.novelInfo.novel_info;const[p,g]=await(0,i.SN)(m),f={},b=a.novelInfo.novel_cover;b&&(0,r.CE)(b,this.imageMode,"cover-").then((e=>{f.cover=e})).catch((e=>s().error(e))),f.tags=a.novelInfo.tag_list;const w=await async function(){const e="https://webapi.gongzicp.com/user/getUserInfo";return s().debug(`正在请求: ${e}`),200===(await fetch(e,{headers:{accept:"application/json, text/javascript, */*; q=0.01","x-requested-with":"XMLHttpRequest"},method:"GET",mode:"cors",credentials:"include"}).then((e=>e.json())).catch((e=>s().error(e)))).code}(),y=[],v=a.chapterList;let x=0,T=null,S=0;for(const t of v)if("volume"===t.type)x=t.vid,T=t.name,S=0;else if("item"===t.type){const n=[document.location.origin,"v4",`read-${t.id}.html`].join("/"),o=parseInt(t.order),r=t.name,i=t.pay,s=t.is_sub,u=t.lock;S++;const h={novel_id:a.novelInfo.novel_id,chapter_id:t.id},m=new d.W({bookUrl:e,bookname:c,chapterUrl:n,chapterNumber:o,chapterName:r,isVIP:i,isPaid:s,sectionName:T,sectionNumber:x,sectionChapterNumber:S,chapterParse:this.chapterParse,charset:this.charset,options:h});(!i||w&&m.isPaid)&&!u||(m.status=l.qb.aborted),y.push(m)}return new u.f({bookUrl:e,bookname:c,author:h,introduction:p,introductionHTML:g,additionalMetadate:f,chapters:y})}async chapterParse(e,t,n,r,i,c){function l(){if(s().info("[chapter]随机翻页中……"),document.location.pathname.includes("novel")&&document.querySelector(".chapter-list > .chapter > a").click(),document.location.pathname.includes("read")){const e=document.querySelector(".right-menu");6===e?.childElementCount?document.querySelector(".right-menu > div:nth-child(3) > a:nth-child(1)").click():7===e?.childElementCount&&(document.querySelector("div.content.unpaid")||Math.random()<.3?document.querySelector(".right-menu > div:nth-child(3) > a:nth-child(1)").click():document.querySelector(".right-menu > div:nth-child(4) > a:nth-child(1)").click())}}return async function(){return await async function(){Math.random()<.2&&l(),await(0,a._v)(3e3+Math.round(4e3*Math.random()))}(),async function(){const n=c.novel_id,r=c.chapter_id,i=new URL("https://webapi.gongzicp.com/novel/chapterGetInfo");i.searchParams.set("cid",r.toString()),i.searchParams.set("nid",n.toString());let d=0;const u=await async function t(n){s().debug(`请求地址: ${n}, Referrer: ${e}，retryTime：${d}`);const o=await fetch(n,{credentials:"include",headers:{Accept:"application/json, text/plain, */*",Client:"pc",Lang:"cn","Content-Type":"application/json;charset=utf-8"},referrer:e,method:"GET",mode:"cors"}).then((e=>e.json())).catch((e=>s().error(e)));if(0!==o.data.chapterInfo.content.length&&o.data.chapterInfo.content.length<30){if(d++,m.o5>m.o5)throw s().error(`请求 ${n} 失败`),new Error(`请求 ${n} 失败`);return s().warn("[chapter]疑似被阻断，进行随机翻页……"),l(),await(0,a._v)(3e3),l(),await(0,a._v)(7e3),l(),await(0,a._v)(3e3),t(n)}return d=0,o}(i.toString());if(200===u.code){const e=u.data.chapterInfo;if(0!==e.chapterPrice&&0===e.content.length)return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null};if(0===e.chapterPrice||0!==e.chapterPrice&&0!==e.content.length){const n=function(e){let t;t=unsafeWindow.__NUXT__.state.CpST.LCngpxaF.substr(1,10);const n=(r="iGzsYn",r+=parseInt("165455",14).toString(32),o.enc.Utf8.parse("$h$b3!"+r));var r,a,i;return((e,t,n)=>{const r=o.AES.decrypt(e,t,n);return o.enc.Utf8.stringify(r).toString()})(e,(i=t,i+=parseInt("4d5a6c8",14).toString(36),o.enc.Utf8.parse(i+"A")),(a=n,{mode:o.mode.CBC,padding:o.pad.Pkcs7,iv:a}))}(e.content),r=document.createElement("pre");r.innerHTML=n;let a,i=n.split("\n").map((e=>e.trim())).join("\n\n");const c=document.createElement("div");if(c.innerHTML=n.split("\n").map((e=>e.trim())).map((e=>0===e.length?"<p><br/></p>":`<p>${e}</p>`)).join("\n"),0===e.postscript.length)a=c;else{a=document.createElement("div"),a.className="main";const t=document.createElement("hr"),n=document.createElement("div");n.innerHTML=e.postscript.split("\n").map((e=>0===e.length?"<p><br/></p>":`<p>${e}</p>`)).join("\n"),a.appendChild(c),a.appendChild(t),a.appendChild(n),r.innerHTML=[r.innerHTML,"-".repeat(20),e.postscript].join("\n\n"),i=[i,"-".repeat(20),e.postscript].join("\n\n")}return{chapterName:t,contentRaw:r,contentText:i,contentHTML:a,contentImages:null,additionalMetadate:null}}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}()}()}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Linovel:()=>m});var o=n(19),r=n(36),a=n(21),i=n(35),c=n(5),s=n.n(c),l=n(2),d=n(37),u=n(38),h=n(29);class m extends h.c{constructor(){super(),this.imageMode="TM",this.concurrencyLimit=5}async bookParse(){const e=document.location.href,t=document.querySelector(".book-title").innerText.trim(),n=document.querySelector(".author-frame > .novelist > div:nth-child(3) > a").innerText.trim(),r=document.querySelector(".about-text"),[a,c]=await(0,i.SN)(r),h={},m=[],p=document.querySelector(".book-cover > a").href;p&&(m.push(p),(0,o.CE)(p,this.imageMode,"cover-").then((e=>{h.cover=e})).catch((e=>s().error(e)))),h.attachments=[];const g=Array.from(document.querySelectorAll(".section-list > .section > .volume-info > .volume-cover a")).map((e=>e.href));for(const e of g)m.includes(e)||(m.push(e),(0,o.CE)(e,this.imageMode,"volumeCover-").then((e=>{h.attachments?.push(e)})).catch((e=>s().error(e))));h.tags=Array.from(document.querySelectorAll("div.meta-info > div.book-cats.clearfix > a")).map((e=>e.innerText.trim()));const f=[],b=document.querySelectorAll(".section-list > .section");let w=0;for(let n=0;n<b.length;n++){const o=b[n],r=n+1,a=o.querySelector(".volume-info > h2.volume-title > a").innerText.trim();let i=0;const c=o.querySelectorAll(".chapter-list > .text-content-actual div.chapter");for(const n of Array.from(c)){const o=n.firstElementChild;w++,i++;const c=o.innerText.trim(),s=o.href,u=()=>!!n.className.includes("lock")&&!n.className.includes("unlock"),h=()=>!1,m=new d.W({bookUrl:e,bookname:t,chapterUrl:s,chapterNumber:w,chapterName:c,isVIP:u(),isPaid:h(),sectionName:a,sectionNumber:r,sectionChapterNumber:i,chapterParse:this.chapterParse,charset:this.charset,options:{}}),p=()=>!1;!u()||p()&&m.isPaid||(m.status=l.qb.aborted),f.push(m)}}return new u.f({bookUrl:e,bookname:t,author:n,introduction:a,introductionHTML:c,additionalMetadate:h,chapters:f})}async chapterParse(e,t,n,o,i,c){return n?async function(){return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}():async function(){const t=await(0,a.dL)(e,i),n=t.querySelector(".article-title").innerText.trim(),o=t.querySelector(".article-text");if(o){const{dom:e,text:t,images:a}=await(0,r.zM)(o,"TM");return{chapterName:n,contentRaw:o,contentText:t,contentHTML:e,contentImages:a,additionalMetadate:null}}return{chapterName:n,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}()}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Tadu:()=>m});var o=n(19),r=n(36),a=n(21),i=n(35),c=n(5),s=n.n(c),l=n(2),d=n(37),u=n(38),h=n(29);class m extends h.c{constructor(){super(),this.imageMode="TM",this.concurrencyLimit=5}async bookParse(){const e=document.location.href,t=document.querySelector("div.bookNm > a.bkNm").innerText.trim(),n=document.querySelector("div.authorInfo > a.author > span").innerText.trim(),r=document.querySelector("div.boxCenter.boxT.clearfix > div.lf.lfO > p.intro"),[a,c]=await(0,i.SN)(r),h={},m=document.querySelector("a.bookImg > img").getAttribute("data-src");m&&(0,o.CE)(m,this.imageMode,"cover-").then((e=>{h.cover=e})).catch((e=>s().error(e)));const p=[],g=document.querySelectorAll("div.lf.lfT > li > div > a");let f=0;for(const n of Array.from(g)){f++;const o=n.innerText,r=n.href,a=()=>!!n.childElementCount,i=()=>!1,c=new d.W({bookUrl:e,bookname:t,chapterUrl:r,chapterNumber:f,chapterName:o,isVIP:a(),isPaid:i(),sectionName:null,sectionNumber:null,sectionChapterNumber:null,chapterParse:this.chapterParse,charset:this.charset,options:{}}),s=()=>!1;!a()||s()&&c.isPaid||(c.status=l.qb.aborted),p.push(c)}return new u.f({bookUrl:e,bookname:t,author:n,introduction:a,introductionHTML:c,additionalMetadate:h,chapters:p})}async chapterParse(e,t,n,o,i,c){return n?async function(){return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}():async function(){s().debug(`[Chapter]请求 ${e}`);const n=await(0,a.dL)(e,i),o=document.createElement("div"),c=n.getElementById("bookPartResourceUrl")?.getAttribute("value");if(c){const e=new URL(c);e.searchParams.set("callback","callback"),s().debug(`[Chapter]请求 ${e.toString()}`);const n=await(0,a.GF)(e.toString(),{headers:{accept:"*/*",Referer:document.location.origin}}).then((t=>{if(t.status>=200&&t.status<=299)return t.responseText;throw new Error(`Bad response! ${e.toString()}`)})).catch((e=>s().error(e)));if(!n)throw new Error("jsonp request failed!");const i=new Function(`function callback(obj) { return obj; } return ${n};`)();if("object"==typeof i){o.innerHTML=i.content;const{dom:e,text:n,images:a}=await(0,r.zM)(o,"TM");return{chapterName:t,contentRaw:o,contentText:n,contentHTML:e,contentImages:a,additionalMetadate:null}}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}()}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Idejian:()=>m});var o=n(19),r=n(36),a=n(21),i=n(12),c=n(35),s=n(5),l=n.n(s),d=n(37),u=n(38),h=n(29);class m extends h.c{constructor(){super(),this.imageMode="TM",this.maxRunLimit=5}async bookParse(){const e=document.location.href,t=e.match(/\/(\d+)\/$/),n=t&&t[1],r=document.querySelector(".detail_bkname > a").innerText.trim(),a=document.querySelector(".detail_bkauthor").childNodes[0];let i="佚名";a&&a.textContent&&(i=a.textContent.trim());const s=document.querySelector(".brief_con"),[h,m]=await(0,c.SN)(s),p={},g=document.querySelector(".book_img > img").src;g&&(0,o.CE)(g,this.imageMode,"cover-").then((e=>{p.cover=e})).catch((e=>l().error(e))),p.tags=Array.from(document.querySelectorAll("div.detail_bkgrade > span")).map((e=>e.innerText.trim()));const f=[],b=document.querySelectorAll(".catelog_list > li > a");let w=0;for(const t of Array.from(b)){w++;const o=t.innerText,a=t.href,i=!1,c=!1,s=new d.W({bookUrl:e,bookname:r,chapterUrl:a,chapterNumber:w,chapterName:o,isVIP:i,isPaid:c,sectionName:null,sectionNumber:null,sectionChapterNumber:null,chapterParse:this.chapterParse,charset:this.charset,options:{bookID:n}});f.push(s)}return document.cookie="",new u.f({bookUrl:e,bookname:r,author:i,introduction:h,introductionHTML:m,additionalMetadate:p,chapters:f})}async chapterParse(e,t,n,o,c,s){const d=new URL(e);d.hostname="m.idejian.com",e=d.toString();const u=new URL("https://m.idejian.com/catalog");u.searchParams.set("bookId",s.bookID);const h=u.toString(),m="Mozilla/5.0 (iPhone; CPU iPhone OS 13_3_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.5 Mobile/15E148 Snapchat/10.77.5.59 (like Safari/604.1)";""===document.cookie&&(await(0,a._7)(h,c,{headers:{"User-Agent":m}}),await(0,a._7)(e,c,{headers:{"User-Agent":m,Referer:h}})),l().debug(`[Chapter]请求 ${e}，Refer：${h}`);const p=await(0,a.Fz)(e,c,{headers:{"User-Agent":m,Referer:h}});let g;if(t=p.querySelector(".text-title-1").innerText.trim(),g=1===p.querySelectorAll("div.h5_mainbody").length?p.querySelector("div.h5_mainbody"):p.querySelectorAll("div.h5_mainbody")[1],g){(0,i.rm)("h1",!1,g);const{dom:e,text:n,images:o}=await(0,r.zM)(g,"TM");return{chapterName:t,contentRaw:g,contentText:n,contentHTML:e,contentImages:o,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Qimao:()=>m});var o=n(19),r=n(36),a=n(21),i=n(35),c=n(5),s=n.n(c),l=n(2),d=n(37),u=n(38),h=n(29);class m extends h.c{constructor(){super(),this.imageMode="TM"}async bookParse(){const e=document.location.href,t=document.querySelector("h2.tit").innerText.trim(),n=document.querySelector(".p-name > a").innerHTML.trim(),r=document.querySelector(".book-introduction .article"),[a,c]=await(0,i.SN)(r),h={},m=document.querySelector(".poster-pic > img").src;m&&(0,o.CE)(m,this.imageMode,"cover-").then((e=>{h.cover=e})).catch((e=>s().error(e))),h.tags=Array.from(document.querySelectorAll(".qm-tags > a")).map((e=>e.innerText.trim()));const p=[],g=document.querySelectorAll('.chapter-directory > dd > div[sort-type="ascending"] a');let f=0;for(const n of Array.from(g)){f++;const o=n.innerText,r=n.href,a=()=>!!n.childElementCount,i=()=>!1,c=new d.W({bookUrl:e,bookname:t,chapterUrl:r,chapterNumber:f,chapterName:o,isVIP:a(),isPaid:i(),sectionName:null,sectionNumber:null,sectionChapterNumber:null,chapterParse:this.chapterParse,charset:this.charset,options:{}}),s=()=>!1;!a()||s()&&c.isPaid||(c.status=l.qb.aborted),p.push(c)}return new u.f({bookUrl:e,bookname:t,author:n,introduction:a,introductionHTML:c,additionalMetadate:h,chapters:p})}async chapterParse(e,t,n,o,i,c){return n?async function(){return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}():async function(){s().debug(`[Chapter]请求 ${e}`);const n=await(0,a.dL)(e,i);t=n.querySelector(".title").innerText.trim();const o=n.querySelector(".article");if(o){const{dom:e,text:n,images:a}=await(0,r.zM)(o,"TM");return{chapterName:t,contentRaw:o,contentText:n,contentHTML:e,contentImages:a,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}()}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Wenku8:()=>m});var o=n(19),r=n(36),a=n(21),i=n(12),c=n(35),s=n(5),l=n.n(s),d=n(37),u=n(38),h=n(29);class m extends h.c{constructor(){super(),this.imageMode="TM",this.charset="GBK"}async bookParse(){const e=document.location.pathname.split("/").slice(-2,-1)[0],t=[document.location.origin,"book",`${e}.htm`].join("/"),n=document.querySelector("#title").innerText.trim(),r=await(0,a.dL)(t,"GBK"),i=r.querySelector("#content > div:nth-child(1) > table:nth-child(1) > tbody:nth-child(1) > tr:nth-child(2) > td:nth-child(2)").innerText.replace("小说作者：","").trim(),s=r.querySelector("#content > div:nth-child(1) > table:nth-child(4) > tbody:nth-child(1) > tr:nth-child(1) > td:nth-child(2) > span:nth-child(11)"),[h,m]=await(0,c.SN)(s),p={},g=r.querySelector("#content > div:nth-child(1) > table:nth-child(4) > tbody:nth-child(1) > tr:nth-child(1) > td:nth-child(1) > img:nth-child(1)").src;g&&(0,o.CE)(g,this.imageMode,"cover-").then((e=>{p.cover=e})).catch((e=>l().error(e)));const f=[],b=Array.from(document.querySelectorAll(".css > tbody td")).filter((e=>e.innerText.trim()));let w=0,y=0,v=null,x=0;for(const e of Array.from(b))if("vcss"===e.className)y++,x=0,v=e.innerText.trim();else if("ccss"===e.className){w++,x++;const o=e.firstElementChild,r=o.innerText.trim(),a=o.href,i=new d.W({bookUrl:t,bookname:n,chapterUrl:a,chapterNumber:w,chapterName:r,isVIP:!1,isPaid:!1,sectionName:v,sectionNumber:y,sectionChapterNumber:x,chapterParse:this.chapterParse,charset:this.charset,options:{}});f.push(i)}const T=new u.f({bookUrl:t,bookname:n,author:i,introduction:h,introductionHTML:m,additionalMetadate:p,chapters:f});return T.ToCUrl=document.location.href,T}async chapterParse(e,t,n,o,c,s){const l=(await(0,a.dL)(e,c)).querySelector("#content");if(l){(0,i.rm)("#contentdp",!0,l);const{dom:e,text:n,images:o}=await(0,r.zM)(l,"TM");return{chapterName:t,contentRaw:l,contentText:n,contentHTML:e,contentImages:o,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Dmzj:()=>m});var o=n(19),r=n(36),a=n(21),i=n(35),c=n(5),s=n.n(c),l=n(37),d=n(38),u=n(29),h=n(12);class m extends u.c{constructor(){super(),this.imageMode="TM",this.streamZip=!0,this.concurrencyLimit=1,this.maxRunLimit=1}async bookParse(){const e=document.location.href,t="www.dmzj.com"===document.location.host,n=(t?document.querySelector(".comic_deCon > h1 > a"):document.querySelector(".anim_title_text > a > h1")).innerText.trim(),r=(t?document.querySelector(".comic_deCon_liO > li:nth-child(1)"):document.querySelector(".anim-main_list > table:nth-child(1) > tbody:nth-child(1) > tr:nth-child(3) > td:nth-child(2) > a:nth-child(1)")).innerText.replace("作者：","").trim(),a=t?document.querySelector(".comic_deCon_d"):document.querySelector(".line_height_content"),[c,u]=await(0,i.SN)(a),h={},m=(t?document.querySelector(".comic_i_img > a > img"):document.querySelector("#cover_pic")).src;m&&(0,o.CE)(m,this.imageMode,"cover-").then((e=>{h.cover=e})).catch((e=>s().error(e)));const p=[],g=t?document.querySelectorAll("div.zj_list_con:nth-child(4) > ul.list_con_li > li"):document.querySelectorAll(".cartoon_online_border > ul > li");let f=0;for(const o of Array.from(g)){f++;const r=o.firstElementChild;let a;a=t?r.lastElementChild.innerText:r.innerText;const i=r.href,c=!1,s=!1,d=new l.W({bookUrl:e,bookname:n,chapterUrl:i,chapterNumber:f,chapterName:a,isVIP:c,isPaid:s,sectionName:null,sectionNumber:null,sectionChapterNumber:null,chapterParse:this.chapterParse,charset:this.charset,options:{}});p.push(d)}return new d.f({bookUrl:e,bookname:n,author:r,introduction:c,introductionHTML:u,additionalMetadate:h,chapters:p})}async chapterParse(e,t,n,o,i,c){s().debug(`[Chapter]请求 ${e}`);const l="www.dmzj.com"===document.location.host,d=function(e){const t="https://images.dmzj.com/",n=Array.from(e.querySelectorAll("head > script")).filter((e=>e.innerHTML.includes("eval(")))[0];let o=(0,h.J0)(n.innerText+";return pages;");o=o.replace(/\n/g,""),o=o.replace(/\r/g,"|");const r=(0,h.J0)("return ("+o+")");if(r){let e;return e=l?r.page_url.split("|").map((e=>t+e)):r.map((e=>t+e)),e}}(await(0,a.dL)(e,i));if(d){const e=document.createElement("div");for(const t of d){const n=document.createElement("p"),o=document.createElement("img");o.src=t,n.appendChild(o),e.appendChild(n)}const{dom:n,text:o,images:a}=await(0,r.zM)(e,"TM");return{chapterName:t,contentRaw:e,contentText:o,contentHTML:n,contentImages:a,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Sosadfun:()=>l});var o=n(36),r=n(21),a=n(2),i=n(37),c=n(38),s=n(29);class l extends s.c{constructor(){super(),this.imageMode="TM"}async bookParse(){const e=document.location.origin+document.location.pathname,t=document.querySelector(".font-1").innerText.trim(),n=document.querySelector("div.h5:nth-child(1) > div:nth-child(1) > a:nth-child(1)");let r;r=n?n.innerText.trim():"匿名咸鱼";const s={};let l,d,u;if(s.tags=Array.from(document.querySelectorAll("div.h5:nth-child(1) > div:nth-child(3) > a")).map((e=>e.innerText.trim())),"主楼隐藏，请登录后查看"===document.querySelector(".col-xs-12 > .main-text.no-selection").innerText.trim())throw alert("本小说需要登录后浏览！"),new a.K2("本小说需要登录后浏览！");{u=document.createElement("div");const e=document.querySelector("div.article-title div.h5"),t=document.querySelector(".col-xs-12 > .main-text.no-selection");if(e){const t=document.createElement("p");t.innerText=e.innerText,u.appendChild(t)}if(t)for(const e of Array.from(t.cloneNode(!0).children))u.appendChild(e)}if(null===u)l=null,d=null;else{const{dom:e,text:t,images:n}=await(0,o.zM)(u,"TM");l=t,d=e,n&&(s.attachments=[...n])}const h=[],m=document.querySelectorAll(".table > tbody:nth-child(2) > tr > th:nth-child(1) > a");let p=0;for(const n of Array.from(m)){p++;const o=n.innerText.trim(),r=n.href,a=new i.W({bookUrl:e,bookname:t,chapterUrl:r,chapterNumber:p,chapterName:o,isVIP:!1,isPaid:!1,sectionName:null,sectionNumber:null,sectionChapterNumber:null,chapterParse:this.chapterParse,charset:this.charset,options:{}});h.push(a)}return new c.f({bookUrl:e,bookname:t,author:r,introduction:l,introductionHTML:d,additionalMetadate:s,chapters:h})}async chapterParse(e,t,n,a,i,c){const s=await(0,r.dL)(e,i);t=s.querySelector("strong.h3").innerText.trim();const l=document.createElement("div"),d=s.querySelector(".main-text.no-selection > span[id^=full]"),u=s.querySelector(".main-text.no-selection > .grayout");if(d)for(const e of Array.from(d.cloneNode(!0).children))l.appendChild(e);if(d){let{dom:e,text:n,images:r}=await(0,o.zM)(l,"TM");if(u){const{dom:t,text:a,images:i}=await(0,o.zM)(u,"TM"),c=document.createElement("hr"),s=document.createElement("div");s.className="authorSay";for(const e of Array.from(t.cloneNode(!0).children))s.appendChild(e);l.appendChild(c),l.appendChild(s),e.appendChild(c),e.appendChild(s),n=n+"\n\n"+"-".repeat(20)+"\n\n"+a,i.forEach((e=>r.push(e)))}return{chapterName:t,contentRaw:l,contentText:n,contentHTML:e,contentImages:r,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{westnovel:()=>a});var o=n(12),r=n(42);const a=()=>(0,r.x)({bookUrl:document.location.href,bookname:document.querySelector(".btitle > h1 > a").innerText.trim(),author:document.querySelector(".btitle > em:nth-child(2)").innerText.replace("作者：","").trim(),introDom:document.querySelector(".intro-p > p:nth-child(1)"),introDomPatch:e=>e,coverUrl:document.querySelector(".img-img")?.src,aList:document.querySelectorAll(".chapterlist > dd > a"),getContent:e=>e.querySelector("#BookText"),contentPatch:e=>((0,o.rm)("div.ads",!0,e),(0,o.rm)("div.link",!0,e),(0,o.rm)("h4",!0,e),e)})},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Linovelib:()=>m});var o=n(19),r=n(21),a=n(12),i=n(35),c=n(5),s=n.n(c),l=n(2),d=n(37),u=n(38),h=n(29);class m extends h.c{constructor(){super(),this.imageMode="TM"}async bookParse(){const e=document.location.href.replace(/\/catalog$/,".html"),t=document.querySelector(".book-meta > h1").innerText.trim(),n=document.querySelector(".book-meta > p:nth-child(2) > span:nth-child(1) > a:nth-child(2)").innerText.trim(),a=await(0,r.dL)(e,void 0),c=a.querySelector(".book-dec > p:nth-child(1)"),[h,m]=await(0,i.SN)(c),p={},g=a.querySelector(".book-img > img").src;g&&(0,o.CE)(g,this.imageMode,"cover-").then((e=>{p.cover=e})).catch((e=>s().error(e))),p.tags=Array.from(a.querySelectorAll(".book-label a")).map((e=>e.innerText.trim()));const f=[],b=document.querySelector(".chapter-list");if(!b)throw new Error("获取章节失败！");const w=b.children;let y=0,v=0,x=null,T=0;for(const n of Array.from(w)){const o=n.nodeName.toLowerCase();if("div"===o)v++,T=0,x=n.innerText.trim();else if("li"===o){y++,T++;const o=n.firstElementChild,r=o.innerText.trim(),a=o.href,i=new d.W({bookUrl:e,bookname:t,chapterUrl:a,chapterNumber:y,chapterName:r,isVIP:!1,isPaid:!1,sectionName:x,sectionNumber:v,sectionChapterNumber:T,chapterParse:this.chapterParse,charset:this.charset,options:{}});a.startsWith("javascript")&&(i.status=l.qb.aborted),f.push(i)}}const S=new u.f({bookUrl:e,bookname:t,author:n,introduction:h,introductionHTML:m,additionalMetadate:p,chapters:f});return S.ToCUrl=document.location.href,S}async chapterParse(e,t,n,o,r,c){return(0,i.I2)({chapterName:t,chapterUrl:e,charset:r,selector:"#TextContent",contentPatch:(e,t)=>((0,a.rm)(".tp",!0,e),(0,a.rm)(".bd",!0,e),e),getNextPage:e=>e.querySelector(".mlfy_page > a:nth-child(5)").href,continueCondition:(e,t)=>new URL(t).pathname.includes("_")})}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{yibige:()=>c});var o=n(36),r=n(12),a=n(35),i=n(52);const c=()=>(0,i.x)({bookUrl:document.location.href,anotherPageUrl:document.location.href+"index.html",getBookname:e=>document.querySelector("#info h1:nth-of-type(1)").innerText.trim(),getAuthor:e=>document.querySelector("#info > p:nth-child(2)").innerText.replace(/作(\s+)?者[：:]/,"").trim(),getIntroDom:e=>document.querySelector("#intro > p:nth-child(1)"),introDomPatch:e=>e,getCoverUrl:e=>document.querySelector("#fmimg > img")?.src??"",getAList:e=>e.querySelectorAll("#list dd > a"),getContent:e=>e.querySelector("#content"),getContentFromUrl:async(e,t,n)=>{const{contentRaw:i}=await(0,a.I2)({chapterName:t,chapterUrl:e,charset:n,selector:"#content",contentPatch:(e,t)=>((0,r.rm)("script",!0,e),(0,r.rm)("div[style]",!0,e),(0,o.iA)(e),e),getNextPage:e=>e.querySelector(".bottem1 > a:nth-child(4)").href,continueCondition:(e,t)=>t.split("/").slice(-1)[0].includes("_"),enableCleanDOM:!1});return i},contentPatch:e=>e})},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Fushuwang:()=>l});var o=n(36),r=n(21),a=n(12),i=n(37),c=n(38),s=n(29);class l extends s.c{saveOptions;constructor(){super(),this.imageMode="TM",this.charset="GBK",this.maxRunLimit=5,this.saveOptions={genChapterText:(e,t)=>`${t}\n`}}async bookParse(){const e=(document.location.origin+document.location.pathname).replace(/(_\d+)\.html$/,".html"),[t,n]=document.querySelector(".title_info > tbody:nth-child(1) > tr:nth-child(1) > td:nth-child(1) > h1:nth-child(1)").innerText.split("——"),[o,r]=[null,null],a=document.querySelectorAll("p.pageLink > select > option"),s=Array.from(a).map((e=>document.location.origin+e.getAttribute("value"))),l=[];for(let n=0;n<s.length;n++){const o=s[n],r=`page${n}`,a=!1,c=!1,d=new i.W({bookUrl:e,bookname:t,chapterUrl:o,chapterNumber:n+1,chapterName:r,isVIP:a,isPaid:c,sectionName:null,sectionNumber:null,sectionChapterNumber:null,chapterParse:this.chapterParse,charset:this.charset,options:{}});l.push(d)}const d=new c.f({bookUrl:e,bookname:t,author:n,introduction:o,introductionHTML:r,additionalMetadate:{},chapters:l});return d.saveOptions=this.saveOptions,d}async chapterParse(e,t,n,i,c,s){const l=(await(0,r.dL)(e,c)).querySelector("#text");if(l){(0,a.rm)("span",!0,l),(0,a.rm)("p.pageLink",!0,l),(0,a.rm)("script",!0,l);const{dom:e,text:n,images:r}=await(0,o.zM)(l,"TM");return{chapterName:t,contentRaw:l,contentText:n,contentHTML:e,contentImages:r,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Soxscc:()=>m});var o=n(19),r=n(36),a=n(21),i=n(12),c=n(35),s=n(5),l=n.n(s),d=n(37),u=n(38),h=n(29);class m extends h.c{constructor(){super(),this.imageMode="TM"}async bookParse(){const e=document.location.href,t=document.querySelector(".xiaoshuo > h1").innerText.trim(),n=document.querySelector(".xiaoshuo > h6:nth-child(3) > a").innerText.trim(),r=document.querySelector("#intro"),[a,s]=await(0,c.SN)(r,(e=>((0,i.rm)("span.tags",!1,e),(0,i.rm)("q",!0,e),e))),h={},m=document.querySelector(".book_cover > img").src;m&&(0,o.CE)(m,this.imageMode,"cover-").then((e=>{h.cover=e})).catch((e=>l().error(e)));const p=[],g=document.querySelector("div.novel_list[id]"),f=Array.from(g.children);let b=0;for(let n=0;n<f.length;n++){const o=f[n],r=o.querySelector("dt > b")?.innerText,a=Array.from(o.querySelectorAll("dd > a"));let i=0;for(const o of a){b++,i++;const a=o.href,c=o.innerText,s=!1,l=!1,u=new d.W({bookUrl:e,bookname:t,chapterUrl:a,chapterNumber:b,chapterName:c,isVIP:s,isPaid:l,sectionName:r,sectionNumber:n+1,sectionChapterNumber:i,chapterParse:this.chapterParse,charset:this.charset,options:{bookname:t}});p.push(u)}}return new u.f({bookUrl:e,bookname:t,author:n,introduction:a,introductionHTML:s,additionalMetadate:h,chapters:p})}async chapterParse(e,t,n,o,c,s){const l=await(0,a.dL)(e,c),d=s.bookname;t=l.querySelector(".read_title > h1").innerText.trim();const u=l.querySelector("div.content[id]");if(u){const e=`您可以在百度里搜索“${d} .+(${document.location.hostname})”查找最新章节！`;(0,i.up)([e],u),Array.from(u.querySelectorAll("p")).forEach((e=>{const t=["最新章节地址：","全文阅读地址：","txt下载地址：","手机阅读：",'为了方便下次阅读，你可以点击下方的"收藏"记录本次',"请向你的朋友（QQ、博客、微信等方式）推荐本书"];for(const n of t)e.innerText.includes(n)&&e.remove()}));const{dom:n,text:o,images:a}=await(0,r.zM)(u,"TM");return{chapterName:t,contentRaw:u,contentText:o,contentHTML:n,contentImages:a,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{c630shu:()=>r});var o=n(12);const r=(0,n(42).x)({bookUrl:document.location.href,bookname:document.querySelector("#info > h1").innerText.trim(),author:document.querySelector("div.options > span.item:nth-child(1) > a").innerText.trim(),introDom:document.querySelector("#intro"),introDomPatch:e=>e,coverUrl:document.querySelector(".img_in > img").src,aList:document.querySelectorAll(".zjlist > dd > a"),getContent:e=>e.querySelector("#content"),contentPatch:e=>((0,o.up)([/恋上你看书网 WWW.630SHU.NET ，最快更新.+最新章节！/],e),e)})},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Qingoo:()=>p});var o=n(19),r=n(36),a=n(21),i=n(12),c=n(35),s=n(5),l=n.n(s),d=n(2),u=n(37),h=n(38),m=n(29);class p extends m.c{constructor(){super(),this.imageMode="TM"}async bookParse(){const e=document.location.href,t=document.querySelector(".title > dl > dd > h1").innerText.trim(),n=document.querySelector("#author").innerText.replace("作者：","").trim(),r=document.querySelector("#allDesc"),[a,i]=await(0,c.SN)(r),s={},m=document.querySelector(".title > dl > dt > img:nth-child(1)").src;m&&(0,o.CE)(m,this.imageMode,"cover-").then((e=>{s.cover=e})).catch((e=>l().error(e)));const p=[],g=unsafeWindow.data,f=document.querySelector("#chapterItem")?.firstElementChild?.href,b=new URL(f);for(const n of g){const o=n.status,r=n.sn,a=n.name;b.searchParams.set("index",(r-1).toString());const i=b.toString(),c=!1,s=!1,l=new u.W({bookUrl:e,bookname:t,chapterUrl:i,chapterNumber:r,chapterName:a,isVIP:c,isPaid:s,sectionName:null,sectionNumber:null,sectionChapterNumber:null,chapterParse:this.chapterParse,charset:this.charset,options:{}});o||(l.status=d.qb.aborted),p.push(l)}return new h.f({bookUrl:e,bookname:t,author:n,introduction:a,introductionHTML:i,additionalMetadate:s,chapters:p})}async chapterParse(e,t,n,o,c,s){const l=await(0,a.dL)(e,c);t=l.querySelector("#content > h1").innerText.trim();const d=l.querySelector("#content");if(d){(0,i.rm)("div.header",!1,d),(0,i.rm)("h1",!1,d),(0,i.rm)("h6",!1,d);const{dom:e,text:n,images:o}=await(0,r.zM)(d,"TM");return{chapterName:t,contentRaw:d,contentText:n,contentHTML:e,contentImages:o,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{trxs:()=>r,tongrenquan:()=>a});var o=n(42);const r=()=>(0,o.x)({bookUrl:document.location.href,bookname:document.querySelector(".infos > h1").innerText.split("(")[0].trim(),author:document.querySelector(".date > span > a").innerText.trim(),introDom:document.querySelector(".infos > p"),introDomPatch:e=>e,coverUrl:document.querySelector(".pic > img").src,aList:document.querySelectorAll("div.book_list > ul.clearfix > li > a"),getContent:e=>e.querySelector(".read_chapterDetail"),contentPatch:e=>e}),a=()=>(0,o.x)({bookUrl:document.location.href,bookname:document.querySelector(".infos > h1").innerText.split("(")[0].trim(),author:document.querySelector(".date > span").innerText.replace("作者：","").trim(),introDom:document.querySelector(".infos > p"),introDomPatch:e=>e,coverUrl:document.querySelector(".pic > img").src,aList:document.querySelectorAll("div.book_list > ul.clearfix > li > a"),getContent:e=>e.querySelector(".read_chapterDetail"),contentPatch:e=>e})},(e,t,n)=>{"use strict";n.r(t),n.d(t,{imiaobige:()=>a});var o=n(12),r=n(52);const a=()=>{const e=document.location.href.replace("/read/","/novel/").replace(/\/$/,".html");return(0,r.x)({bookUrl:e,anotherPageUrl:e,getBookname:e=>e.querySelector(".booktitle > h1").innerText.trim(),getAuthor:e=>e.querySelector("#author > a").innerText.trim(),getIntroDom:e=>e.querySelector("#bookintro"),introDomPatch:e=>e,getCoverUrl:e=>e.querySelector("#bookimg > img").src,getSections:e=>document.querySelectorAll("#readerlists > ul"),getAList:e=>document.querySelectorAll("#readerlists  a"),getSName:e=>e.firstElementChild?.innerText.split(" ").slice(-1)?.[0]??"",postHook:e=>{if(!e.sectionName?.includes("最新章节"))return e.sectionName=e.sectionName?.replace(e.bookname,"").trim()??null,e},getContent:e=>e.querySelector("#content"),contentPatch:e=>((0,o.vS)(e,["您可以在百度里搜索“"]),e)})}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{c256wxc:()=>o});const o=(0,n(42).x)({bookUrl:document.location.href,bookname:document.querySelector(".art_tit").innerText.trim(),author:(document.querySelector("span.bookinfo:nth-child(1) > a")??document.querySelector("span.bookinfo:nth-child(1)")).innerText.replace(/^作者：/,"").trim(),introDom:document.querySelector(".infotype > p"),introDomPatch:e=>e,coverUrl:null,aList:document.querySelectorAll(".catalog > li > a"),getContent:e=>e.querySelector(".book_con"),contentPatch:e=>e})},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Lofter:()=>h});var o=n(19),r=n(36),a=n(21),i=n(5),c=n.n(i),s=n(37),l=n(38),d=n(29),u=n(12);class h extends d.c{constructor(){super(),this.imageMode="TM",this.concurrencyLimit=5,this.streamZip=!0}async bookParse(){const e=document.location.origin,t=document.title,n=t+"的Lofter",r=document.querySelector('meta[name="Description"]')?.getAttribute("content")?.replace(new RegExp(`^${t} - `),"")??null;let i=null;r&&(i=document.createElement("p"),i.innerText=r);const d={},u=document.querySelector('link[rel="shortcut icon"]')?.getAttribute("href");if(u){const e=new URL(u);e.search="";const t=e.toString();(0,o.CE)(t,this.imageMode,"avatar-").then((e=>{d.cover=e})).catch((e=>c().error(e)))}const h=[],m=new Set,p=[],g=async e=>{c().info(`[chapter]正在抓取目录页：${e}`);const t=await(0,a.dL)(e,void 0),n=`a[href^="${[document.location.origin,"post"].join("/")}"]`;new Set(Array.from(t.querySelectorAll(n)).map((e=>e.href))).forEach((e=>m.add(e))),new Set(Array.from(t.querySelectorAll('a[href^="https://www.lofter.com/lpost"]')).map((e=>e.href))).forEach((e=>m.add(e)));const o=e=>{const t=new URL(e).searchParams.get("page")??"1";return Number(t)},r=o(e),i=t.querySelectorAll('a[href^="?page"]');for(const e of Array.from(i)){const t=e.href,n=new URL(t);n.searchParams.delete("t");const a=n.toString();o(t)!==r&&(p.includes(a)||(p.push(a),await g(t)))}};await g(document.location.href);let f=0;for(const o of Array.from(m)){const r=new s.W({bookUrl:e,bookname:n,chapterUrl:o,chapterNumber:f,chapterName:null,isVIP:!1,isPaid:!1,sectionName:null,sectionNumber:null,sectionChapterNumber:null,chapterParse:this.chapterParse,charset:this.charset,options:{author:t}});h.push(r),f++}return new l.f({bookUrl:e,bookname:n,author:t,introduction:r,introductionHTML:i,additionalMetadate:d,chapters:h})}async chapterParse(e,t,n,o,i,s){return new URL(e).pathname.startsWith("/lpost/")?async function(){c().debug(`[chapter]请求页面：${e}`);const n=await(0,a.Fz)(e,i);t=n.querySelector("#title")?.innerText.trim();const o=n.querySelector("#m-cnt .long-text");if(o){const{dom:e,text:n,images:a}=await(0,r.zM)(o,"TM");return{chapterName:t,contentRaw:o,contentText:n,contentHTML:e,contentImages:a,additionalMetadate:null}}throw new Error(`[chapter]未发现内容，url：${e}`)}():async function(){c().debug(`[chapter]请求页面：${e}`);const n=await(0,a.dL)(e,i);t=n.querySelector("title")?.innerText.replace(new RegExp(`-${s.author}$`),"").replaceAll("\n","").trim()??null;const o=[".ct .ctc",".main .content",".m-post .text",".content"];let l;for(const e of o){const t=n.querySelector(e);if(null!==t){l=t;break}}if(l){(0,u.rm)(".otherinfo",!0,l);const{dom:e,text:n,images:o}=await(0,r.zM)(l,"TM");return{chapterName:t,contentRaw:l,contentText:n,contentHTML:e,contentImages:o,additionalMetadate:null}}throw new Error(`[chapter]未发现内容，url：${e}`)}()}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Shubl:()=>f});var o=n(23),r=n(19),a=n(36),i=n(21),c=n(12),s=n(35),l=n(5),d=n.n(l),u=n(2),h=n(20),m=n(37),p=n(38),g=n(29);class f extends g.c{constructor(){super(),this.imageMode="TM",this.concurrencyLimit=1,this.maxRunLimit=1}async bookParse(){const e=document.location.href,t=document.querySelector(".book-title > span").innerText.trim(),n=document.querySelector("div.username").innerText.trim(),o=document.querySelector(".book-brief"),[a,i]=await(0,s.SN)(o,(e=>((0,c.up)(["简介："],e),e))),l={},h=document.querySelector(".book-img").src;h&&(0,r.CE)(h,this.imageMode,"cover-").then((e=>{l.cover=e})).catch((e=>d().error(e))),l.tags=Array.from(document.querySelectorAll("div.row > span.tag")).map((e=>e.innerText.trim()));const g=[],f=Array.from(document.querySelectorAll("#chapter_list > div.chapter > div.chapter-title")).map((e=>e.innerText.trim())),b=document.querySelectorAll("#chapter_list > div.chapter > div.articles"),w=f.length;let y=0;for(let n=0;n<w;n++){const o=b[n],r=n+1,a=f[n];let i=0;const c=o.querySelectorAll("span.chapter_item");for(const n of Array.from(c)){y++,i++;const o=n.querySelector("a");if(o){const c=o.innerText.trim(),s=o.href,l=()=>2===n.childElementCount,d=()=>!(!l()||"unlock"!==n.querySelector("i")?.className),h=()=>3===document.querySelector("#header > div.container > div.right.pull-right")?.childElementCount,p=new m.W({bookUrl:e,bookname:t,chapterUrl:s,chapterNumber:y,chapterName:c,isVIP:l(),isPaid:d(),sectionName:a,sectionNumber:r,sectionChapterNumber:i,chapterParse:this.chapterParse,charset:this.charset,options:{}});!l()||h()&&d()||(p.status=u.qb.aborted),g.push(p)}}}return new p.f({bookUrl:e,bookname:t,author:n,introduction:a,introductionHTML:i,additionalMetadate:l,chapters:g})}async chapterParse(e,t,n,r,s,l){function m(e){let t=e.content;const n=e.keys,r=e.keys.length,a=e.accessKey.split(""),i=a.length,c=[];c.push(n[a[i-1].charCodeAt(0)%r]),c.push(n[a[0].charCodeAt(0)%r]);for(let e=0;e<c.length;e++){t=atob(t);const n=c[e],r=btoa(t.substr(0,16)),a=btoa(t.substr(16)),i=o.format.OpenSSL.parse(a);t=o.AES.decrypt(i,o.enc.Base64.parse(n),{iv:o.enc.Base64.parse(r),format:o.format.OpenSSL}),e<c.length-1&&(t=t.toString(o.enc.Base64),t=atob(t))}return t.toString(o.enc.Utf8)}const p="https://www.shubl.com/",g=e.split("/").slice(-1)[0];return n?async function(){if(r){const n=await async function(e,t){const n=p+"chapter/ajax_get_image_session_code";d().debug(`[Chapter]请求 ${n} Referer ${t}`);const o=await(0,i.GF)(n,{method:"POST",headers:{Accept:"application/json, text/javascript, */*; q=0.01",Referer:t,Origin:document.location.origin,"X-Requested-With":"XMLHttpRequest"},responseType:"json"}).then((e=>e.response)).catch((e=>d().error(e)));if(1e5!==o.code)throw d().error(o),new Error(`下载 ${t} 失败`);const r=m({content:o.image_code,keys:o.encryt_keys,accessKey:o.access_key});return p+"chapter/book_chapter_image?chapter_id="+e+"&area_width=939.2&font=undefined&font_size=18&image_code="+r+"&bg_color_name=white&text_color_name=white"}(g,e);d().debug(`[Chapter]请求 ${n} Referer ${e}`);const o=await(0,i.GF)(n,{method:"GET",headers:{Referer:e,Accept:"image/avif,image/webp,image/apng,image/svg+xml,image/*,*/*;q=0.8"},responseType:"blob"}).then((e=>e.response)).catch((e=>d().error(e))),r=`vipCHapter${g}.png`,a=new h.J(n,r,"TM");o&&(a.imageBlob=o,a.status=u.qb.finished);const c=[a],s=document.createElement("img");s.src=r,s.alt=n;const l=document.createElement("div");return l.appendChild(s),{chapterName:t,contentRaw:l,contentText:`VIP章节，请打开HTML文件查看。\n![${n}](${r})`,contentHTML:l,contentImages:c,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}():async function(){const n=document.createElement("div"),o=await async function(e,t){const n=p+"chapter/ajax_get_session_code",o=p+"chapter/get_book_chapter_detail_info";d().debug(`[Chapter]请求 ${n} Referer ${t}`);const r=(await(0,i.GF)(n,{method:"POST",headers:{Accept:"application/json, text/javascript, */*; q=0.01","Content-Type":"application/x-www-form-urlencoded; charset=UTF-8",Referer:t,Origin:document.location.origin,"X-Requested-With":"XMLHttpRequest"},data:`chapter_id=${e}`,responseType:"json"}).then((e=>e.response)).catch((e=>d().error(e)))).chapter_access_key;d().debug(`[Chapter]请求 ${o} Referer ${t}`);const a=await(0,i.GF)(o,{method:"POST",headers:{Accept:"application/json, text/javascript, */*; q=0.01","Content-Type":"application/x-www-form-urlencoded; charset=UTF-8",Referer:t,Origin:document.location.origin,"X-Requested-With":"XMLHttpRequest"},data:`chapter_id=${e}&chapter_access_key=${r}`,responseType:"json"}).then((e=>e.response)).catch((e=>d().error(e)));if(1e5!==a.code)throw d().error(a),new Error(`下载 ${t} 失败`);return m({content:a.chapter_content,keys:a.encryt_keys,accessKey:r})}(g,e);n.innerHTML=o,(0,c.rm)(".chapter span",!0,n);const{dom:r,text:s,images:l}=await(0,a.zM)(n,"TM");return{chapterName:t,contentRaw:n,contentText:s,contentHTML:r,contentImages:l,additionalMetadate:null}}()}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{ujxs:()=>a});var o=n(12),r=n(52);const a=()=>{const e=document.location.origin+document.location.pathname.replace(/^\/read/,"/book");return(0,r.x)({bookUrl:e,anotherPageUrl:e,getBookname:e=>document.querySelector("#smallcons > h1").innerText.trim(),getAuthor:e=>document.querySelector("#smallcons > span:nth-child(3) > a").innerText.trim(),getIntroDom:e=>e.querySelector("#bookintro"),introDomPatch:e=>e,getCoverUrl:e=>e.querySelector(".img > img")?.src,getAList:e=>document.querySelectorAll("#readerlist  li > a"),getSections:e=>document.querySelectorAll("#readerlist  li.fj > h3"),getSName:e=>e.innerText,postHook:e=>(e.sectionName=e.sectionName?.replace(e.bookname,"")??null,e),getContent:e=>e.querySelector(".read-content"),contentPatch:e=>((0,o.rm)("script",!0,e),(0,o.vS)(e,["免费小说无弹窗免费阅读！","全集TXT电子书免费下载！"]),e)})}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{haitangtxt:()=>b,yuzhaige:()=>w});var o=n(36),r=n(21),a=n(12),i=n(35),c=n(5),s=n.n(c),l=n(37),d=n(38),u=n(29);function h(e){let t=e;for(const e in m)if(Object.prototype.hasOwnProperty.call(m,e)){const n=m[e],o=`<img src="${document.location.origin}/wzbodyimg/${e}">`;t=t.replaceAll(o,n)}return t}const m={};function p(e){let t=e;for(const e in g)if(Object.prototype.hasOwnProperty.call(g,e)){const n=g[e],o=`<img src="${document.location.origin}/wzbodyimg/${e}">`;t=t.replaceAll(o,n)}return t}const g={"wc5pDq.png":"勃","wEwIpN.png":"萄","WFOBXF.png":"伦","WFuqEG.png":"滚","WNTyYB.png":"菊","WrI5St.png":"戴","WSYLdq.png":"宠","wvHBh4.png":"奶","wWVoto.png":"巴","wz2cGb.png":"乳","wZicAt.png":"道","WzS8He.png":"戴","X6QTS9.png":"胯","XBTII5.png":"腿","XBv6rP.png":"跳","xFVZW9.png":"殖","XhuslD.png":"鸡","xIFlai.png":"食","XK7taQ.png":"爽","xljRqd.png":"顶","xo18Yq.png":"尿","xOIyuf.png":"塞","xQ2ZWb.png":"股","XqsaJY.png":"软","xrbxqL.png":"裸","xw7cLW.png":"蚌","xwkwQW.png":"精","XXlZMA.png":"殖","y3FgRm.png":"柱","y4Afmt.png":"腿","Y4aXzR.png":"粗","Y7G6Lu.png":"呻","YGnnuo.png":"蜜","ygqjgt.png":"捏","yGwSy7.png":"骚","yjX9oi.png":"揉","YNmgYJ.png":"肛","yuo7sA.png":"摩","yWAu0U.png":"催","yWhRNI.png":"娇","YZ4EAh.png":"喉","yzS8NJ.png":"胯","z0DZro.png":"吮","Z7byDx.png":"润","ZatUU6.png":"奴","zCtJCx.png":"润","ZDJHkT.png":"泌","ZKDja5.png":"龟","ZqyamF.png":"屄","ZzsV7x.png":"睾","0bErVo.png":"深","0ShNwM.png":"吹","0uCAgc.png":"强","1AMfxw.png":"干","1EmzV7.png":"性","1RbeKi.png":"头","1RIz6c.png":"感","1ZkZsI.png":"欲","2AXYPX.png":"泄","2gwsiE.png":"湿","2LQHtR.png":"根","2wePG6.png":"体","2Xijao.png":"捏","3ha4Fq.png":"欢","3RfcEA.png":"高","3uNZxG.png":"胸","4bu7Gr.png":"蒂","4T4DPM.png":"擦","4XjmUQ.png":"进","5hjo9r.png":"下","5ueElb.png":"宫","5yFlDm.png":"宫","6UsGer.png":"瓣","6w928M.png":"挺","6YavUk.png":"暖","7dKm1T.png":"进","7tzEqy.png":"点","8Q4cTQ.png":"部","9Ns27O.png":"阳","9pAfcz.png":"头","9Xkn86.png":"唇","62TB7X.png":"紧","668QKT.png":"下","aedVOS.png":"露","AI15xh.png":"娇","AikKsW.png":"肠","AJcH1b.png":"出","ALnkng.png":"喘","anzcle.png":"道","apsw0Z.png":"子","azRZNn.png":"水","B38zEI.png":"水","BAVYZd.png":"阴","BBioQd.png":"暖","BBZnCY.png":"唇","bE6LV6.png":"美","bF30CY.png":"吸","bihdjA.png":"唇","BPQcCZ.png":"具","BpYip0.png":"管","BrY1ZI.png":"腿","BvbcsW.png":"紧","bXRYQt.png":"处","Caqk3D.png":"眼","CBylOX.png":"道","ClFBCD.png":"处","CLS5cG.png":"坚","cPjFxZ.png":"种","CUJkGk.png":"情","CZL2OC.png":"皮","D3I7u1.png":"蒂","d5KjC5.png":"体","d7fjCZ.png":"露","df6AnM.png":"出","dhAaVT.png":"坚","dkuDIk.png":"舌","DSiSlL.png":"爱","dTnQ9K.png":"魔","dXMpnD.png":"晕","DXtzqf.png":"身","DXXixh.png":"套","DZYaDR.png":"阳","e5QAQ1.png":"强","ECcmqT.png":"春","eeYwrN.png":"水","eGWHWT.png":"慰","eOOKlp.png":"触","EvHzor.png":"欲","ewwRMT.png":"逼","EZW46f.png":"深","FBosfH.png":"性","fC5MmR.png":"户","ffTW4v.png":"抽","ffZqua.png":"性","FgN2Tl.png":"乱","fHvZK9.png":"缝","fj7veK.png":"长","fkPlzo.png":"食","fKWetR.png":"管","FUmeqN.png":"□","Fus88J.png":"牛","G4uOno.png":"喷","g7bVzL.png":"高","GBmlnw.png":"跳","gCWM61.png":"精","GdAidg.png":"筋","GLZIqA.png":"子","gqDVGg.png":"巨","gu5ykL.png":"轮","GULUze.png":"高","h2FI8R.png":"胸","h4WPDX.png":"晕","hCztH8.png":"露","hfI2uM.png":"坚","hGHijB.png":"器","hIhWai.png":"高","HIUVkJ.png":"射","HkcQea.png":"交","hm5O6l.png":"套","hpFE8s.png":"流","HPxfmS.png":"含","hVxPKi.png":"触","Ia3sI1.png":"乱","IA8APJ.png":"巴","IlUZRn.png":"坚","iN7Lri.png":"食","iQMM3x.png":"感","ISfDuf.png":"体","isWxov.png":"马","ITILdU.png":"执","IU731r.png":"顶","IUanTB.png":"融","IUUwWq.png":"入","Ixqere.png":"流","J9AEU9.png":"入","JBfhPp.png":"操","jDxrrX.png":"子","jE4V2B.png":"深","jF1KPd.png":"□","jFACnh.png":"毛","jiyfGR.png":"根","JLkmp8.png":"股","jWwTqU.png":"情","K00hgA.png":"入","KaFnqe.png":"滚","Kaqaq0.png":"阴","kDOkxJ.png":"长","kSkOOe.png":"按","KtjQU3.png":"捏","kWmDQN.png":"处","kZQ8K6.png":"下","l0kRFF.png":"物","L9dqnM.png":"欲","Ldo3hW.png":"肉","ljppnW.png":"感","lNGSuh.png":"肠","lRfqbE.png":"精","lUzsIi.png":"轮","LZraJy.png":"春","mBpVnV.png":"乱","MEM8Wx.png":"干","MO2VKV.png":"液","ModDMS.png":"抽","mOZJWk.png":"马","mpgh5T.png":"出","nj29a6.png":"执","NOEnvb.png":"跳","nrSIO8.png":"深","o2xN3U.png":"花","O3b3KR.png":"暖","o5uSeU.png":"宫","OaBMS5.png":"拔","OB7KzU.png":"眼","oCH7SV.png":"魔","oeeXig.png":"马","OgBVeb.png":"软","oHc3dE.png":"物","OLHWRr.png":"点","onuRXa.png":"蒂","oqLfcR.png":"滑","oUntUm.png":"浓","OXOdsf.png":"道","p3ARaM.png":"流","p068ps.png":"宫","PLwxDG.png":"种","PmCTBy.png":"色","pMlQBk.png":"汁","pQypTa.png":"进","PtUVdN.png":"抽","PW1WSi.png":"湿","Pw3ezj.png":"配","pXy3UL.png":"交","Q7jy4x.png":"内","q07XV1.png":"器","Q9OBtA.png":"潮","QbYFBI.png":"阴","qEI00x.png":"下","qewOBk.png":"滑","QfXoIi.png":"肉","qJIAe3.png":"按","QkWjrV.png":"身","QnFF9j.png":"根","qNFYq4.png":"干","QU7Lcv.png":"□","qwsVcX.png":"抽","qxb6Lz.png":"点","QzP4Nz.png":"眼","R8uNPt.png":"内","R9tjeh.png":"出","rFr75w.png":"胸","rGA9Cq.png":"交","RjCFQu.png":"紧","RLNC0G.png":"点","rocNQb.png":"做","Rpp7lC.png":"蒂","rUJMTx.png":"色","RZZBiZ.png":"眼","S2Dvd4.png":"泄","s8DZGN.png":"情","s560YT.png":"具","SeKcc0.png":"色","sFFl4b.png":"宠","SiAa7G.png":"头","slAZvO.png":"色","sTPB8l.png":"触","sV6OrY.png":"长","syPCmu.png":"轮","Sz5U6E.png":"器","SZn6xB.png":"物","T6sDn9.png":"情","t9WGXQ.png":"逼","TCRQtC.png":"滑","TGkFFQ.png":"逼","tNjFEZ.png":"花","tOUYgC.png":"魔","TSjC0C.png":"庭","TSp4f1.png":"拔","TWIhpT.png":"爱","TxaWbU.png":"融","ua2bew.png":"顶","UbTLa5.png":"挺","uDN4sP.png":"入","ueMquS.png":"身","UEVcqG.png":"身","UIFeaH.png":"配","unR6fo.png":"阳","Upc9Pu.png":"交","UukBzP.png":"洞","UvCU0f.png":"宠","VAOIqQ.png":"美","vMf2zS.png":"配","VnXHdX.png":"做","vpHmyj.png":"内","Vql6Ev.png":"姐","vrkjXi.png":"种","vtnLR7.png":"水","wkUtOc.png":"□","WOHLvx.png":"奶","WppxBg.png":"美","WRtMHz.png":"囊","WTAi5O.png":"揉","wtwCbu.png":"牛","WXf8jT.png":"具","xpWTjp.png":"物","XqFPrk.png":"做","XrHw7R.png":"体","XskrJT.png":"阳","xubhKq.png":"毛","xxqGbU.png":"胸","y2rhls.png":"做","y8TJ26.png":"种","YbmlHp.png":"花","YpcoIg.png":"美","yruS8G.png":"虐","YTWiNM.png":"花","YvzoUL.png":"喉","YY1gAh.png":"融","yYS2XJ.png":"进","ZaWg8Q.png":"浓","zbUsFu.png":"热","zGqroA.png":"子","zhogXd.png":"露","zM4vGZ.png":"滚","ZMyXfX.png":"硬","Znemv4.png":"马","ZnORLb.png":"头","zovunx.png":"穴","ZpcLFr.png":"爱","4KLtoP.png":"蚌","k2hzhi.png":"蕊","OpOeoc.png":"雏","D6GjNJ.png":"邦","nSh1y5.png":"邦","ZD1bga.png":"膜","0JNnRt.png":"裆","0laGrG.png":"勃","0sEWeF.png":"爽","0X07Oj.png":"长","0ZBaBv.png":"穴","1WoJda.png":"挺","1yUGqq.png":"套","2ABT9u.png":"管","2BcI5e.png":"核","2dfEmL.png":"肏","2LdPZ9.png":"巴","2VLZTT.png":"吸","2WgKu9.png":"春","03PhNV.png":"摩","3preuJ.png":"潮","3tNh88.png":"插","4m7wbi.png":"晕","4mO3Bj.png":"妓","4P4bWw.png":"烫","4qJrgq.png":"催","4xMdlq.png":"捅","5aHMLF.png":"浓","5caAaX.png":"含","5IL1sE.png":"腺","5qxLLo.png":"萄","5rXkkk.png":"弄","5uAxU4.png":"揉","5XAgwu.png":"奸","6A9MvV.png":"勃","6jL6AP.png":"荡","6ontyx.png":"葡","6VRwjR.png":"粗","6zcWUT.png":"泄","7aWXdF.png":"潮","7Bz8yG.png":"棍","7fhmqV.png":"裤","7jKFaP.png":"奸","7lNejO.png":"灌","7pFdxn.png":"撸","7Q7Jrg.png":"屌","8BNYPM.png":"暖","8J5geS.png":"吟","8Kf7GD.png":"茎","8mHmVv.png":"茎","8N16Hq.png":"虐","8UniDu.png":"户","8w5K9T.png":"裸","8wm13p.png":"晕","8ZNrSv.png":"硬","9BRV3o.png":"屌","9Nqw8t.png":"瘫","9RBhTJ.png":"骚","9RvnBS.png":"肉","9TaMmD.png":"泌","9UaEDH.png":"洞","9zWVtd.png":"姐","47FrvB.png":"乳","76gAv7.png":"爽","77lL1M.png":"吟","798jja.png":"皮","a0mCeq.png":"软","ACrPlr.png":"食","aFoXhJ.png":"痒","Afr6zx.png":"殖","aHuUcm.png":"菊","AiDkbY.png":"肛","aOxG78.png":"葡","AQZ08I.png":"肛","ARAUs9.png":"屁","arEzdS.png":"奶","axdkbW.png":"壁","aYGWo2.png":"菊","b1C6Pu.png":"痒","bCQ2nL.png":"敏","BgJzfk.png":"欢","BhgFcH.png":"囊","bOoL0J.png":"淫","BqO1fa.png":"舌","bqXZDH.png":"肥","BsU6ka.png":"蕊","Bu9FZQ.png":"淫","bufT6t.png":"膜","bWdbXA.png":"滚","C4UN5R.png":"淫","CgqkFG.png":"荡","CH67yh.png":"娇","CM7jpY.png":"孕","cNghja.png":"荡","CnOBoo.png":"插","CNQW3o.png":"烫","cow4Kc.png":"强","CXC9uz.png":"肉","Cy7Ynb.png":"瘫","czWHZw.png":"雏","D0Lwo9.png":"蜜","dB0uJO.png":"舌","dHuyiO.png":"屌","DQWBph.png":"丸","DsEJTV.png":"呻","dUrJvn.png":"膜","Ea3lho.png":"臀","EboGWZ.png":"肠","eifoua.png":"孕","EiUhlF.png":"套","ENwWoX.png":"乱","EQEgJx.png":"摩","EQiUab.png":"裤","er8NJ7.png":"吮","F0WoiN.png":"具","f1YTv0.png":"潮","f2N1vL.png":"奸","F3nlmb.png":"裤","F6lW1R.png":"肿","f60BEY.png":"尿","f461mD.png":"根","fd6C8F.png":"鸡","Fdz1Vc.png":"壁","FetNxM.png":"屌","FfxOzl.png":"裸","Fge27m.png":"萄","fGpEWq.png":"呻","Fl20Ip.png":"龟","fNXZyj.png":"戴","fRmx68.png":"部","fSdsL1.png":"裆","FT9nI5.png":"菊","FVVqzv.png":"蛋","FwjZJi.png":"吸","fX4WIp.png":"伦","FXgFwc.png":"插","FXmf8I.png":"摺","fxPcW3.png":"洞","g2jVxn.png":"肏","gb3LOX.png":"胯","gDVng6.png":"宠","gImiVY.png":"弄","gJDFQC.png":"舔","gJDG8l.png":"孕","GJodYn.png":"拔","GmLjKa.png":"尉","gNlJMc.png":"棍","GppocX.png":"配","gsRjtr.png":"柱","GTOAc4.png":"挺","GzjpTS.png":"精","h8zRxr.png":"股","H17DtI.png":"屁","ha14XV.png":"触","hatLmR.png":"臀","hbrRIS.png":"蕾","hC4NbQ.png":"睾","hG0SRP.png":"擦","HhNUaw.png":"蕊","hKjWPG.png":"撸","Hn8Afh.png":"瓣","hngWaZ.png":"吸","htV3uv.png":"壁","hVaVng.png":"按","HVHPCy.png":"瓣","hVwy7k.png":"舔","i4tyrQ.png":"茎","i5s28n.png":"伦","IAloq6.png":"吮","ICHARH.png":"户","icI6Ey.png":"臀","iCRh88.png":"棒","Iej2pu.png":"妓","IkqJmu.png":"虐","imVjMj.png":"乳","iNIMEL.png":"蛋","IOjnEP.png":"欢","ip6KUM.png":"禽","IPC2R8.png":"鸡","ipVGiA.png":"捅","IpYNG3.png":"奴","ITUjFq.png":"皮","ixiion.png":"部","IZcCzq.png":"蜜","IzJ4WG.png":"茎","J1CBtB.png":"跳","j9C44i.png":"烫","JCQtUs.png":"乳","JEcz0E.png":"蜜","JfPEEe.png":"伦","jHi6Vu.png":"龟","jjfR6D.png":"葡","jktdia.png":"擦","JlkuRa.png":"萄","jnAvXp.png":"庭","jnCCk9.png":"泄","jvj3DG.png":"硬","Jy4pAI.png":"瓣","jZyPEL.png":"孕","K2AtMQ.png":"骚","K2jjT6.png":"蕾","k6X0xy.png":"肿","k9h8DR.png":"逼","k9zXwG.png":"爽","KalRLt.png":"润","kawcM7.png":"棍","kdsEv6.png":"弄","KdwL4R.png":"蛋","kPG0vR.png":"灌","KSqmoM.png":"液","kTCaM9.png":"蛋","kVLLjB.png":"荡","kygbuo.png":"牛","kZDlEj.png":"管","l0BNLC.png":"泌","l1Dmft.png":"牛","L1yl45.png":"射","L3a5ft.png":"囊","L3LaNQ.png":"吹","L9F6F8.png":"催","LB1WMg.png":"操","LBPqYj.png":"洞","LDjbfQ.png":"尿","ldo7FB.png":"紧","lErO3o.png":"柱","LFBZKA.png":"姐","lfGqdb.png":"棒","lGKjej.png":"妓","LjemA3.png":"肛","Ljh7qo.png":"插","LJSiT5.png":"屄","Lk5uQy.png":"核","lngKEo.png":"喷","lOfDdC.png":"丸","Lsq92O.png":"吟","LsyPdc.png":"吟","lVbZkd.png":"捏","lVMTQu.png":"敏","LVmymH.png":"肠","lyYo4Y.png":"呻","lZtabT.png":"阴","M3VjF9.png":"撸","m4yvu3.png":"穴","M8bV3k.png":"囊","MBhDEi.png":"痒","MC5lZn.png":"塞","Mc8JM6.png":"拔","mD7hPS.png":"屁","mExNDV.png":"灌","MKapwC.png":"肥","mKxUHv.png":"擦","Mo31Ax.png":"毛","mRFQJQ.png":"喉","MsUFfR.png":"殖","mTzxxd.png":"缝","n2ufBJ.png":"奸","n3oOgA.png":"捅","n9j6EC.png":"庭","n49ZFH.png":"裆","nCrl80.png":"瘫","NDlwhm.png":"腺","nE1Y7y.png":"瘫","neIgqc.png":"吹","NeKVfz.png":"慰","NHH9A1.png":"睾","NKN1rk.png":"吮","NKUSkP.png":"壁","NlfTkc.png":"屄","NlZDDQ.png":"腿","nmoPI2.png":"丸","NnfPEJ.png":"龟","NP33MO.png":"汁","NQ7oga.png":"感","nsDzuq.png":"邦","NsIwni.png":"巨","oaLZIg.png":"睾","oC3HDZ.png":"粗","OFx7ZU.png":"裸","OHU6tX.png":"液","olFcqI.png":"干","OMdbeV.png":"膜","On4f9C.png":"筋","oncaJq.png":"皮","Oo8iWN.png":"按","OUWXqz.png":"春","OuXWg2.png":"丸","ozF5Kr.png":"虐","p0bqZi.png":"屄","p1H9RN.png":"射","p5QCRV.png":"滑","p5zEbo.png":"蕾","P43O6G.png":"戴","PalsBW.png":"奴","PcAvOY.png":"嫩","pHfPTa.png":"巨","pi2z0b.png":"筋","plFlPb.png":"棍","pNPlu5.png":"灌","PnZNBC.png":"淫","pQ1W2F.png":"裤","PX3jJ6.png":"泌","q14YbK.png":"顶","Qc9LRh.png":"喘","qe2YZi.png":"揉","qEy1kT.png":"部","Qfs9DA.png":"催","Qg8Qwg.png":"蕾","qJ1X2h.png":"姐","qm0ZBO.png":"慰","QmcP4w.png":"敏","Qn3xBM.png":"嫩","qNGvlk.png":"尿","qPhrVf.png":"处","qPX1Ef.png":"含","qr8InI.png":"肥","QtLIGq.png":"液","QtSnzR.png":"喘","Qv3JbY.png":"缝","QYF65i.png":"筋","Qz4Txd.png":"臀","qzdvCv.png":"巴","r7NsvF.png":"弄","r8oBsP.png":"鸡","r9Gw4X.png":"核","R65BZO.png":"舔","Rf7Jf6.png":"摩","Rho2GL.png":"痒","rlVLx7.png":"爱","Rm3wex.png":"喷","RmrhKk.png":"舔","RMWsBY.png":"敏","rn9y6F.png":"塞","RnfJ8h.png":"柱","RP5Oud.png":"喘","Rp5tmA.png":"操","rpSSYK.png":"胯","rQKjMD.png":"毛","RrXcE9.png":"器","RyL5jk.png":"汁","s67RPe.png":"烫","s95kq4.png":"湿","sdXZMk.png":"勃","SGxBy7.png":"屁","smhB8j.png":"射","Srgobp.png":"户","srlW2t.png":"流","ST21xu.png":"浓","STzFJz.png":"粗","sugwEw.png":"奶","SzADhL.png":"肿","T5yzvl.png":"汁","t6K8rK.png":"性","tAIV6q.png":"操","TCFRca.png":"棒","te79V0.png":"棒","tjbhCV.png":"嫩","tNFwEz.png":"喉","tPTX1h.png":"肥","tsQMiL.png":"吹","TUZb1W.png":"欲","TWFykG.png":"妓","twLxYU.png":"软","tXNaZ2.png":"融","U3bhkh.png":"骚","u6K6ci.png":"欢","u9Tibu.png":"内","Ua2WwL.png":"娇","Uai2en.png":"强","UeWULF.png":"庭","UfXSsz.png":"后","ui0T5v.png":"禽","UqClGF.png":"股","Urv1FM.png":"肿","uwXRHd.png":"喷","v4iqzP.png":"缝","vAdmoL.png":"硬","VhA8GI.png":"嫩","VHsdy1.png":"核","vjOssT.png":"塞","vkYfGf.png":"魔","vMmUqq.png":"奴","VnvOwV.png":"润","VoAjiw.png":"湿","vrtXeW.png":"裆","VUbefT.png":"轮","vulCqw.png":"执","VYaPfX.png":"穴","VyJ2cS.png":"邦","W06Vg1.png":"巨","W7cCwn.png":"捅","W9Y9vD.png":"舌","wa54S5.png":"含","FNq1zS.png":"蚌","DDpMPK.png":"蚌","vDbU8w.png":"腺","SSoXSL.png":"葡","YB6iOy.png":"腺","kMqpt6.png":"雏","5RwMUT.png":"蕊","b94JXX.png":"脔","oxFS6J.png":"脔","H53jMR.png":"雏"};function f(e){return class extends u.c{constructor(){super(),this.imageMode="TM",this.nsfw=!0}async bookParse(){const e=document.querySelector("div.currency_head > h1 > a").href,t=e.split("/").slice(-2,-1)[0];s().debug(`[chapter]请求 ${e}`);const n=await(0,r.dL)(e,"UTF-8"),o=n.querySelector("div.cataloginfo > h3").innerText.trim(),c=n.querySelector(".infotype > p:nth-child(1) > a:nth-child(1)").innerText.trim(),u=n.querySelector(".intro"),[h,m]=await(0,i.SN)(u,(e=>((0,a.rm)("span:nth-child(1)",!1,e),e))),p=[],g=(()=>{const e=[],n=(()=>{const e=document.querySelector("div.page:nth-child(6)");if(e){const t=Array.from(e.childNodes).slice(-1)[0].textContent?.match(/第\d+\/(\d+)页/);if(t)return t[1]}})();if(void 0===n)throw new Error("getMaxPageNumber return null ");const o=parseInt(n);for(let n=1;n<=o;n++){const o=[document.location.origin,document.location.pathname.split("/")[1],`${t}_${n}`].join("/")+"/";e.push(o)}return e})();let f=[];for(const e of g){s().debug(`[chapter]请求 ${e}`);const t=(await(0,r.dL)(e,"UTF-8")).querySelector("ul.chapters");t?.childElementCount&&(f=f.concat(Array.from(t.children)))}const b=f.filter((e=>void 0!==e));let w=0;for(const t of b){w++;const n=t.firstElementChild,r=n.innerText,a=n.href,i=!1,c=!1,s=new l.W({bookUrl:e,bookname:o,chapterUrl:a,chapterNumber:w,chapterName:r,isVIP:i,isPaid:c,sectionName:null,sectionNumber:null,sectionChapterNumber:null,chapterParse:this.chapterParse,charset:this.charset,options:{}});p.push(s)}return new d.f({bookUrl:e,bookname:o,author:c,introduction:h,introductionHTML:m,additionalMetadate:{},chapters:p})}async chapterParse(t,n,a,i,c,l){function d(){function e(e,t){let n=Math.ceil((t+1)%r);return n=Math.ceil(e-n),n}const t=h.getElementsByTagName("meta")[7].getAttribute("content"),n=h.querySelector("#articlecontent");let o,r;const a=h.getElementsByTagName("script")[1].innerText.trim().match(/"(http.+)"/);if(a){o=a[1];const e=new URL(o).searchParams.get("code");e&&(r=parseInt(e))}if(t){const o=atob(t).split(/[A-Z]+%/).map((e=>parseInt(e))),r=[];if(Array.from(h.querySelectorAll("script")).filter((e=>e.src.includes("/17mb/js/article.js"))).length){for(let t=0;t<o.length;t++)r[e(o[t],t)]=n.childNodes[t];for(const e of r)1===e.nodeType&&(e.innerText.includes("本章尚未完结,请")||e.innerText.includes("本章已阅读完毕")||m.appendChild(e));return}}for(const e of Array.from(n.childNodes))e.innerText.includes("本章尚未完结,请")||e.innerText.includes("本章已阅读完毕")||m.appendChild(e)}let u=t,h=await(0,r.dL)(t,c);const m=document.createElement("div");let p=!1;do{d();const e=h.querySelector(".novelbutton .p1.p3 > a:nth-child(1)").href;new URL(e).pathname.includes("_")?e!==u?p=!0:(s().error("网站页面出错，URL： "+u),p=!1):p=!1,p&&(u=e,h=await(0,r.dL)(e,c))}while(p);if(m){const{dom:t,images:r}=await(0,o.zM)(m,"TM",{keepImageName:!0}),a=document.createElement("div");a.innerHTML=e(m.innerHTML);const{dom:i,text:c}=await(0,o.zM)(a,"TM",{keepImageName:!0}),s=document.createElement("style");s.innerHTML=".hide { display: none; }",t.className="hide";const l=document.createElement("div");return l.appendChild(s),l.appendChild(t),l.appendChild(i),{chapterName:n,contentRaw:m,contentText:c,contentHTML:l,contentImages:r,additionalMetadate:null}}return{chapterName:n,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}}const b=()=>f(h),w=()=>f(p)},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Longmabook:()=>g});var o=n(19),r=n(36),a=n(21),i=n(1),c=n(12),s=n(35),l=n(5),d=n.n(l),u=n(2),h=n(37),m=n(38),p=n(29);class g extends p.c{constructor(){super(),this.imageMode="TM",this.concurrencyLimit=5,this.nsfw=!0}async bookParse(){if(!Boolean(document.querySelector('a[href="/?act=signinlst"]')))throw alert("小说下载器：海棠文化线上文学城需登录后方可下载！请登录帐号。"),new u.K2("海棠文化线上文学城需登录后方可浏览！");const e=this,t=document.location.href,n=document.querySelector("#mypages > div:nth-child(8) > div:nth-child(1) > h4").innerText,r=document.querySelector("#writerinfos > a").innerText,l=new URLSearchParams(document.location.search),p=l.get("bookid");if(!p)throw new Error("获取 bookid 出错");const g=l.get("bookwritercode"),f=document.querySelector("#mypages > div:nth-child(8) > div:nth-child(1)")?.cloneNode(!0);let[b,w]=[null,null,null];f&&((0,c.rm)("div",!0,f),(0,c.rm)("textarea",!0,f),(0,c.rm)("font",!0,f),(0,c.rm)("b",!0,f),(0,c.rm)("span",!0,f),(0,c.rm)("h4",!0,f),(0,c.rm)("img",!0,f),(0,c.up)([/【作品编号：\d+】|【作品編號：\d+】/,"\n)\n"],f),[b,w]=await(0,s.SN)(f,void 0));const y={},v=document.querySelector("#mypages > div:nth-child(8) > div:nth-child(1) > img")?.src.replace("_s.","_b.");v&&(0,o.CE)(v,this.imageMode,"cover-").then((e=>{y.cover=e})).catch((e=>d().error(e))),y.tags=document.querySelector('#mypages > div:nth-child(8) > div:nth-child(1) > font[color="#800080"]')?.innerText.split("/").map((e=>e.trim()))??[];const x=document.location.origin+"/showbooklist.php",T={ebookid:p,pages:"1",showbooklisttype:"1"},S=e=>({headers:{"content-type":"application/x-www-form-urlencoded; charset=UTF-8","x-requested-with":"XMLHttpRequest"},body:new URLSearchParams(e).toString(),method:"POST",mode:"cors",credentials:"include"}),A=e=>e.innerText.trim(),k=e=>{const t=(e=>e.querySelectorAll('span[uk-icon="file-text"] + a'))(e),n=(e=>e.querySelectorAll('span[uk-icon="folder"] + b > font'))(e);return Array.from(t).map((e=>{const t=e.innerText,o=e.href,r=(0,s.$d)(e,n,A),a=(e=>e.parentElement?.innerText.includes("$")??!1)(e);let i=!1;return a&&(i=(e=>e.parentElement?.innerText.includes("已購買，三年內可直接閱讀")??!1)(e)),{chapterName:t,chapterUrl:o,_sectionName:r,isVip:a,isPaid:i}}))},N=[],M=await(0,a.rf)(x,e.charset,S(T));if(M){N.push(...k(M));const t=(e=>{const t=e.querySelectorAll("a[onclick^=showbooklist]"),n=Array.from(t).map((e=>{const t=e.getAttribute("onclick");if(t){const e=/'(\d+)'\)/.exec(t)?.slice(-1)[0];if(e)return parseInt(e,10)}})).filter((e=>void 0!==e));return Array.from(new Set(n)).sort()})(M);if(0!==t.length)for(const n of t){const t=(0,i.X8)(T);t.pages=n.toString();const o=await(0,a.rf)(x,e.charset,S(t));o&&N.push(...k(o))}}const C=[];let E=0,P=0,q=null,L=0;for(const{chapterName:e,chapterUrl:o,_sectionName:r,isVip:a,isPaid:i}of N){r!==q&&(q=r,P++,L=0),E++,L++;const c=new h.W({bookUrl:t,bookname:n,chapterUrl:o,chapterNumber:E,chapterName:e,isVIP:a,isPaid:i,sectionName:q,sectionNumber:P,sectionChapterNumber:L,chapterParse:this.chapterParse,charset:this.charset,options:{bookId:p,bookwritercode:g}});!0===c.isVIP&&!1===c.isPaid&&(c.status=u.qb.aborted),C.push(c)}return new m.f({bookUrl:t,bookname:n,author:r,introduction:b,introductionHTML:w,additionalMetadate:y,chapters:C})}async chapterParse(e,t,n,o,i,s){const l=this,u=await(0,a.dL)(e,i);if(u.body.innerHTML.includes("您目前正在海棠清水區，只能觀看清水認證文章。"))throw window.stopFlag||(alert("您目前正在海棠清水區，只能觀看清水認證文章。請使用海棠其他網址進入。"),window.stopController.abort()),new Error("您目前正在海棠清水區，只能觀看清水認證文章。請使用海棠其他網址進入。");const h={chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null};if(u.querySelector("#paperbuybtm"))return d().info(`[chapter]付费章节 ${t} 未购买。`),h;const m=document.createElement("div");let p="",g=[];const[f,b,w]=await async function(){const e=document.createElement("div");Array.from(u.querySelectorAll("#mypages > div:nth-child(10) > div:nth-child(2) > div:nth-child(6) > ul > li:nth-child(14) > img")).forEach((t=>e.appendChild(t.cloneNode(!0))));const{dom:t,text:n,images:o}=await(0,r.zM)(e,l.imageMode);return[t,n,o]}(),[y,v,x]=await async function(){const[t,n]=(()=>{const e=Array.from(u.querySelectorAll("script")).filter((e=>e.innerText.includes("vercodechk")))[0].innerText.match(/{\spaperid:\s'(\d+)',\svercodechk:\s'(\w+)'}/);if(3===e?.length){const[t,n]=e.slice(1);return[t,n]}return[null,null]})();if(t&&n){const o=document.location.origin+"/showpapercolor.php";d().debug(`[chapter]正在请求${o}`);const a=await fetch(o,{credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8","X-Requested-With":"XMLHttpRequest","Cache-Control":"max-age=0"},referrer:e,body:new URLSearchParams({paperid:t,vercodechk:n}).toString(),method:"POST",mode:"cors"}),i=document.createElement("div");i.innerHTML=await a.text(),(0,c.rm)('img[src="/images/fullcolor.png"]',!0,i);const{dom:s,text:u,images:h}=await(0,r.zM)(i,l.imageMode);return[s,u,h]}return[null,null,null]}(),[T,S,A]=await async function(){const e=u.querySelector("#colorpanelwritersay");if(e){const{dom:t,text:n,images:o}=await(0,r.zM)(e,l.imageMode);return[t,n,o]}return[null,null,null]}();if(f&&(m.appendChild(f),p+=b+"\n\n",w&&(g=g.concat(w))),y&&(m.appendChild(y),p+=v,x&&(g=g.concat(x))),T){const e=document.createElement("hr");T.className="authorSay",m.appendChild(e),m.appendChild(T),p+="\n\n"+"-".repeat(20)+"\n\n"+S,A&&(g=g.concat(A))}return{chapterName:t,contentRaw:m,contentText:p,contentHTML:m,contentImages:g,additionalMetadate:null}}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Kanunu8:()=>m});var o=n(19),r=n(36),a=n(12),i=n(83),c=n(35),s=n(5),l=n.n(s),d=n(37),u=n(38),h=n(29);class m extends h.c{constructor(){super(),this.imageMode="TM"}async bookParse(){const e=document.location.href,t=document.title.split(" ")[0],n=Array.from(document.querySelectorAll("a")).filter((e=>(e.href.includes("writer")||e.href.includes("/zj/"))&&e.href.includes(".html"))).map((e=>[e,e.getBoundingClientRect().top])).sort(p)?.[0][0],r=n?.innerText.replace("作品集","").replace("→","").trim()??"",i=Array.from(document.body.querySelectorAll("td, p")).filter((e=>0!==e.innerText.length)).map((e=>[e,(0,a.MK)(e)])).sort(p).slice(-1)?.[0][0];let s=null,h=null;i&&((0,a.rm)("a",!0,i),[s,h]=await(0,c.SN)(i));let m=null,g=null,f=null;function b(e){const t=["writer","/zj/","index.html"];for(const n of t)if(e.href.includes(n))return!1;return!0}if(document.querySelector("div.book"))m=Array.from(document.querySelectorAll("div.book a")).filter(b),g=document.querySelectorAll("div.book dl > dt, div.book td > strong"),f=e=>e.innerText;else{const e=document.querySelectorAll("table"),t=Array.from(e).map((e=>[e,(0,a.wd)(e)])).filter((e=>4===e[1])).filter((e=>(0,c.$4)(e[0])[0])).map((e=>[e[0],Array.from(e[0].querySelectorAll("a")).filter(b).length])).sort(p);if(0!==t.length){const e=t.slice(-1)[0][0];m=e.querySelectorAll("a"),g=e.querySelectorAll('td[align="center"]'),f=e=>e.innerText}}const w={},y=Array.from(document.querySelectorAll("img")).filter((e=>new URL(e.src).host===document.location.host));if(1===y.length){const e=y[0].src;e&&(0,o.CE)(e,this.imageMode,"cover-").then((e=>{w.cover=e})).catch((e=>l().error(e)))}const v=[];let x=0,T=0,S=0,A="";if(!m)throw Error("[BookParse]获取章节信息失败！");for(const n of Array.from(m)){const o=n.innerText.trim(),r=n.href;if(g&&f){const e=(0,c.$d)(n,g,f);e&&A!==e&&(A=e,T++,S=0),x++,S++}const a=!1,i=!1,s=new d.W({bookUrl:e,bookname:t,chapterUrl:r,chapterNumber:x,chapterName:o,isVIP:a,isPaid:i,sectionName:A,sectionNumber:T,sectionChapterNumber:S,chapterParse:this.chapterParse,charset:this.charset,options:{}});v.push(s)}return new u.f({bookUrl:e,bookname:t,author:r,introduction:s,introductionHTML:h,additionalMetadate:w,chapters:v})}async chapterParse(e,t,n,o,c,s){const l=await(0,i.fetchAndParse)(e,this.charset);if(l){const e=l.content;(0,a.rm)("a",!0,e);const{dom:n,text:o,images:i}=await(0,r.zM)(e,"TM");return{chapterName:t,contentRaw:e,contentText:o,contentHTML:n,contentImages:i,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}function p(e,t){return e[1]-t[1]}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{parse:()=>i,fetchAndParse:()=>c,gfetchAndParse:()=>s});var o=n(84),r=n(12),a=n(21);function i(e,t){const n=new o.Readability(e,t).parse();return n&&"string"==typeof n.content&&(n.content=(0,r.ut)(n.content)),n}async function c(e,t,n,o,r){let c=await(0,a.dL)(e,t,n);return"function"==typeof o&&(c=o(c)),i(c,r)}async function s(e,t,n,o,r){let c=await(0,a.Fz)(e,t,n);return"function"==typeof o&&(c=o(c)),i(c,r)}},(e,t,n)=>{var o=n(85),r=n(86);e.exports={Readability:o,isProbablyReaderable:r}},e=>{function t(e,t){if(t&&t.documentElement)e=t,t=arguments[2];else if(!e||!e.documentElement)throw new Error("First argument to Readability constructor should be a document object.");if(t=t||{},this._doc=e,this._docJSDOMParser=this._doc.firstChild.__JSDOMParser__,this._articleTitle=null,this._articleByline=null,this._articleDir=null,this._articleSiteName=null,this._attempts=[],this._debug=!!t.debug,this._maxElemsToParse=t.maxElemsToParse||this.DEFAULT_MAX_ELEMS_TO_PARSE,this._nbTopCandidates=t.nbTopCandidates||this.DEFAULT_N_TOP_CANDIDATES,this._charThreshold=t.charThreshold||this.DEFAULT_CHAR_THRESHOLD,this._classesToPreserve=this.CLASSES_TO_PRESERVE.concat(t.classesToPreserve||[]),this._keepClasses=!!t.keepClasses,this._serializer=t.serializer||function(e){return e.innerHTML},this._disableJSONLD=!!t.disableJSONLD,this._flags=this.FLAG_STRIP_UNLIKELYS|this.FLAG_WEIGHT_CLASSES|this.FLAG_CLEAN_CONDITIONALLY,this._debug){let e=function(e){if(e.nodeType==e.TEXT_NODE)return`${e.nodeName} ("${e.textContent}")`;let t=Array.from(e.attributes||[],(function(e){return`${e.name}="${e.value}"`})).join(" ");return`<${e.localName} ${t}>`};this.log=function(){if("undefined"!=typeof dump){var t=Array.prototype.map.call(arguments,(function(t){return t&&t.nodeName?e(t):t})).join(" ");dump("Reader: (Readability) "+t+"\n")}else if("undefined"!=typeof console){let t=Array.from(arguments,(t=>t&&t.nodeType==this.ELEMENT_NODE?e(t):t));t.unshift("Reader: (Readability)"),console.log.apply(console,t)}}}else this.log=function(){}}t.prototype={FLAG_STRIP_UNLIKELYS:1,FLAG_WEIGHT_CLASSES:2,FLAG_CLEAN_CONDITIONALLY:4,ELEMENT_NODE:1,TEXT_NODE:3,DEFAULT_MAX_ELEMS_TO_PARSE:0,DEFAULT_N_TOP_CANDIDATES:5,DEFAULT_TAGS_TO_SCORE:"section,h2,h3,h4,h5,h6,p,td,pre".toUpperCase().split(","),DEFAULT_CHAR_THRESHOLD:500,REGEXPS:{unlikelyCandidates:/-ad-|ai2html|banner|breadcrumbs|combx|comment|community|cover-wrap|disqus|extra|footer|gdpr|header|legends|menu|related|remark|replies|rss|shoutbox|sidebar|skyscraper|social|sponsor|supplemental|ad-break|agegate|pagination|pager|popup|yom-remote/i,okMaybeItsACandidate:/and|article|body|column|content|main|shadow/i,positive:/article|body|content|entry|hentry|h-entry|main|page|pagination|post|text|blog|story/i,negative:/-ad-|hidden|^hid$| hid$| hid |^hid |banner|combx|comment|com-|contact|foot|footer|footnote|gdpr|masthead|media|meta|outbrain|promo|related|scroll|share|shoutbox|sidebar|skyscraper|sponsor|shopping|tags|tool|widget/i,extraneous:/print|archive|comment|discuss|e[\-]?mail|share|reply|all|login|sign|single|utility/i,byline:/byline|author|dateline|writtenby|p-author/i,replaceFonts:/<(\/?)font[^>]*>/gi,normalize:/\s{2,}/g,videos:/\/\/(www\.)?((dailymotion|youtube|youtube-nocookie|player\.vimeo|v\.qq)\.com|(archive|upload\.wikimedia)\.org|player\.twitch\.tv)/i,shareElements:/(\b|_)(share|sharedaddy)(\b|_)/i,nextLink:/(next|weiter|continue|>([^\|]|$)|»([^\|]|$))/i,prevLink:/(prev|earl|old|new|<|«)/i,tokenize:/\W+/g,whitespace:/^\s*$/,hasContent:/\S$/,hashUrl:/^#.+/,srcsetUrl:/(\S+)(\s+[\d.]+[xw])?(\s*(?:,|$))/g,b64DataUrl:/^data:\s*([^\s;,]+)\s*;\s*base64\s*,/i,jsonLdArticleTypes:/^Article|AdvertiserContentArticle|NewsArticle|AnalysisNewsArticle|AskPublicNewsArticle|BackgroundNewsArticle|OpinionNewsArticle|ReportageNewsArticle|ReviewNewsArticle|Report|SatiricalArticle|ScholarlyArticle|MedicalScholarlyArticle|SocialMediaPosting|BlogPosting|LiveBlogPosting|DiscussionForumPosting|TechArticle|APIReference$/},UNLIKELY_ROLES:["menu","menubar","complementary","navigation","alert","alertdialog","dialog"],DIV_TO_P_ELEMS:new Set(["BLOCKQUOTE","DL","DIV","IMG","OL","P","PRE","TABLE","UL"]),ALTER_TO_DIV_EXCEPTIONS:["DIV","ARTICLE","SECTION","P"],PRESENTATIONAL_ATTRIBUTES:["align","background","bgcolor","border","cellpadding","cellspacing","frame","hspace","rules","style","valign","vspace"],DEPRECATED_SIZE_ATTRIBUTE_ELEMS:["TABLE","TH","TD","HR","PRE"],PHRASING_ELEMS:["ABBR","AUDIO","B","BDO","BR","BUTTON","CITE","CODE","DATA","DATALIST","DFN","EM","EMBED","I","IMG","INPUT","KBD","LABEL","MARK","MATH","METER","NOSCRIPT","OBJECT","OUTPUT","PROGRESS","Q","RUBY","SAMP","SCRIPT","SELECT","SMALL","SPAN","STRONG","SUB","SUP","TEXTAREA","TIME","VAR","WBR"],CLASSES_TO_PRESERVE:["page"],HTML_ESCAPE_MAP:{lt:"<",gt:">",amp:"&",quot:'"',apos:"'"},_postProcessContent:function(e){this._fixRelativeUris(e),this._simplifyNestedElements(e),this._keepClasses||this._cleanClasses(e)},_removeNodes:function(e,t){if(this._docJSDOMParser&&e._isLiveNodeList)throw new Error("Do not pass live node lists to _removeNodes");for(var n=e.length-1;n>=0;n--){var o=e[n],r=o.parentNode;r&&(t&&!t.call(this,o,n,e)||r.removeChild(o))}},_replaceNodeTags:function(e,t){if(this._docJSDOMParser&&e._isLiveNodeList)throw new Error("Do not pass live node lists to _replaceNodeTags");for(const n of e)this._setNodeTag(n,t)},_forEachNode:function(e,t){Array.prototype.forEach.call(e,t,this)},_findNode:function(e,t){return Array.prototype.find.call(e,t,this)},_someNode:function(e,t){return Array.prototype.some.call(e,t,this)},_everyNode:function(e,t){return Array.prototype.every.call(e,t,this)},_concatNodeLists:function(){var e=Array.prototype.slice,t=e.call(arguments),n=t.map((function(t){return e.call(t)}));return Array.prototype.concat.apply([],n)},_getAllNodesWithTag:function(e,t){return e.querySelectorAll?e.querySelectorAll(t.join(",")):[].concat.apply([],t.map((function(t){var n=e.getElementsByTagName(t);return Array.isArray(n)?n:Array.from(n)})))},_cleanClasses:function(e){var t=this._classesToPreserve,n=(e.getAttribute("class")||"").split(/\s+/).filter((function(e){return-1!=t.indexOf(e)})).join(" ");for(n?e.setAttribute("class",n):e.removeAttribute("class"),e=e.firstElementChild;e;e=e.nextElementSibling)this._cleanClasses(e)},_fixRelativeUris:function(e){var t=this._doc.baseURI,n=this._doc.documentURI;function o(e){if(t==n&&"#"==e.charAt(0))return e;try{return new URL(e,t).href}catch(e){}return e}var r=this._getAllNodesWithTag(e,["a"]);this._forEachNode(r,(function(e){var t=e.getAttribute("href");if(t)if(0===t.indexOf("javascript:"))if(1===e.childNodes.length&&e.childNodes[0].nodeType===this.TEXT_NODE){var n=this._doc.createTextNode(e.textContent);e.parentNode.replaceChild(n,e)}else{for(var r=this._doc.createElement("span");e.childNodes.length>0;)r.appendChild(e.childNodes[0]);e.parentNode.replaceChild(r,e)}else e.setAttribute("href",o(t))}));var a=this._getAllNodesWithTag(e,["img","picture","figure","video","audio","source"]);this._forEachNode(a,(function(e){var t=e.getAttribute("src"),n=e.getAttribute("poster"),r=e.getAttribute("srcset");if(t&&e.setAttribute("src",o(t)),n&&e.setAttribute("poster",o(n)),r){var a=r.replace(this.REGEXPS.srcsetUrl,(function(e,t,n,r){return o(t)+(n||"")+r}));e.setAttribute("srcset",a)}}))},_simplifyNestedElements:function(e){for(var t=e;t;){if(t.parentNode&&["DIV","SECTION"].includes(t.tagName)&&(!t.id||!t.id.startsWith("readability"))){if(this._isElementWithoutContent(t)){t=this._removeAndGetNext(t);continue}if(this._hasSingleTagInsideElement(t,"DIV")||this._hasSingleTagInsideElement(t,"SECTION")){for(var n=t.children[0],o=0;o<t.attributes.length;o++)n.setAttribute(t.attributes[o].name,t.attributes[o].value);t.parentNode.replaceChild(n,t),t=n;continue}}t=this._getNextNode(t)}},_getArticleTitle:function(){var e=this._doc,t="",n="";try{"string"!=typeof(t=n=e.title.trim())&&(t=n=this._getInnerText(e.getElementsByTagName("title")[0]))}catch(e){}var o=!1;function r(e){return e.split(/\s+/).length}if(/ [\|\-\\\/>»] /.test(t))o=/ [\\\/>»] /.test(t),r(t=n.replace(/(.*)[\|\-\\\/>»] .*/gi,"$1"))<3&&(t=n.replace(/[^\|\-\\\/>»]*[\|\-\\\/>»](.*)/gi,"$1"));else if(-1!==t.indexOf(": ")){var a=this._concatNodeLists(e.getElementsByTagName("h1"),e.getElementsByTagName("h2")),i=t.trim();this._someNode(a,(function(e){return e.textContent.trim()===i}))||(r(t=n.substring(n.lastIndexOf(":")+1))<3?t=n.substring(n.indexOf(":")+1):r(n.substr(0,n.indexOf(":")))>5&&(t=n))}else if(t.length>150||t.length<15){var c=e.getElementsByTagName("h1");1===c.length&&(t=this._getInnerText(c[0]))}var s=r(t=t.trim().replace(this.REGEXPS.normalize," "));return s<=4&&(!o||s!=r(n.replace(/[\|\-\\\/>»]+/g,""))-1)&&(t=n),t},_prepDocument:function(){var e=this._doc;this._removeNodes(this._getAllNodesWithTag(e,["style"])),e.body&&this._replaceBrs(e.body),this._replaceNodeTags(this._getAllNodesWithTag(e,["font"]),"SPAN")},_nextNode:function(e){for(var t=e;t&&t.nodeType!=this.ELEMENT_NODE&&this.REGEXPS.whitespace.test(t.textContent);)t=t.nextSibling;return t},_replaceBrs:function(e){this._forEachNode(this._getAllNodesWithTag(e,["br"]),(function(e){for(var t=e.nextSibling,n=!1;(t=this._nextNode(t))&&"BR"==t.tagName;){n=!0;var o=t.nextSibling;t.parentNode.removeChild(t),t=o}if(n){var r=this._doc.createElement("p");for(e.parentNode.replaceChild(r,e),t=r.nextSibling;t;){if("BR"==t.tagName){var a=this._nextNode(t.nextSibling);if(a&&"BR"==a.tagName)break}if(!this._isPhrasingContent(t))break;var i=t.nextSibling;r.appendChild(t),t=i}for(;r.lastChild&&this._isWhitespace(r.lastChild);)r.removeChild(r.lastChild);"P"===r.parentNode.tagName&&this._setNodeTag(r.parentNode,"DIV")}}))},_setNodeTag:function(e,t){if(this.log("_setNodeTag",e,t),this._docJSDOMParser)return e.localName=t.toLowerCase(),e.tagName=t.toUpperCase(),e;for(var n=e.ownerDocument.createElement(t);e.firstChild;)n.appendChild(e.firstChild);e.parentNode.replaceChild(n,e),e.readability&&(n.readability=e.readability);for(var o=0;o<e.attributes.length;o++)try{n.setAttribute(e.attributes[o].name,e.attributes[o].value)}catch(e){}return n},_prepArticle:function(e){this._cleanStyles(e),this._markDataTables(e),this._fixLazyImages(e),this._cleanConditionally(e,"form"),this._cleanConditionally(e,"fieldset"),this._clean(e,"object"),this._clean(e,"embed"),this._clean(e,"footer"),this._clean(e,"link"),this._clean(e,"aside");var t=this.DEFAULT_CHAR_THRESHOLD;this._forEachNode(e.children,(function(e){this._cleanMatchedNodes(e,(function(e,n){return this.REGEXPS.shareElements.test(n)&&e.textContent.length<t}))})),this._clean(e,"iframe"),this._clean(e,"input"),this._clean(e,"textarea"),this._clean(e,"select"),this._clean(e,"button"),this._cleanHeaders(e),this._cleanConditionally(e,"table"),this._cleanConditionally(e,"ul"),this._cleanConditionally(e,"div"),this._replaceNodeTags(this._getAllNodesWithTag(e,["h1"]),"h2"),this._removeNodes(this._getAllNodesWithTag(e,["p"]),(function(e){return 0===e.getElementsByTagName("img").length+e.getElementsByTagName("embed").length+e.getElementsByTagName("object").length+e.getElementsByTagName("iframe").length&&!this._getInnerText(e,!1)})),this._forEachNode(this._getAllNodesWithTag(e,["br"]),(function(e){var t=this._nextNode(e.nextSibling);t&&"P"==t.tagName&&e.parentNode.removeChild(e)})),this._forEachNode(this._getAllNodesWithTag(e,["table"]),(function(e){var t=this._hasSingleTagInsideElement(e,"TBODY")?e.firstElementChild:e;if(this._hasSingleTagInsideElement(t,"TR")){var n=t.firstElementChild;if(this._hasSingleTagInsideElement(n,"TD")){var o=n.firstElementChild;o=this._setNodeTag(o,this._everyNode(o.childNodes,this._isPhrasingContent)?"P":"DIV"),e.parentNode.replaceChild(o,e)}}}))},_initializeNode:function(e){switch(e.readability={contentScore:0},e.tagName){case"DIV":e.readability.contentScore+=5;break;case"PRE":case"TD":case"BLOCKQUOTE":e.readability.contentScore+=3;break;case"ADDRESS":case"OL":case"UL":case"DL":case"DD":case"DT":case"LI":case"FORM":e.readability.contentScore-=3;break;case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":case"TH":e.readability.contentScore-=5}e.readability.contentScore+=this._getClassWeight(e)},_removeAndGetNext:function(e){var t=this._getNextNode(e,!0);return e.parentNode.removeChild(e),t},_getNextNode:function(e,t){if(!t&&e.firstElementChild)return e.firstElementChild;if(e.nextElementSibling)return e.nextElementSibling;do{e=e.parentNode}while(e&&!e.nextElementSibling);return e&&e.nextElementSibling},_textSimilarity:function(e,t){var n=e.toLowerCase().split(this.REGEXPS.tokenize).filter(Boolean),o=t.toLowerCase().split(this.REGEXPS.tokenize).filter(Boolean);return n.length&&o.length?1-o.filter((e=>!n.includes(e))).join(" ").length/o.join(" ").length:0},_checkByline:function(e,t){if(this._articleByline)return!1;if(void 0!==e.getAttribute)var n=e.getAttribute("rel"),o=e.getAttribute("itemprop");return!(!("author"===n||o&&-1!==o.indexOf("author")||this.REGEXPS.byline.test(t))||!this._isValidByline(e.textContent)||(this._articleByline=e.textContent.trim(),0))},_getNodeAncestors:function(e,t){t=t||0;for(var n=0,o=[];e.parentNode&&(o.push(e.parentNode),!t||++n!==t);)e=e.parentNode;return o},_grabArticle:function(e){this.log("**** grabArticle ****");var t=this._doc,n=null!==e;if(!(e=e||this._doc.body))return this.log("No body found in document. Abort."),null;for(var o=e.innerHTML;;){this.log("Starting grabArticle loop");var r=this._flagIsActive(this.FLAG_STRIP_UNLIKELYS),a=[],i=this._doc.documentElement;let G=!0;for(;i;){var c=i.className+" "+i.id;if(this._isProbablyVisible(i))if(this._checkByline(i,c))i=this._removeAndGetNext(i);else if(G&&this._headerDuplicatesTitle(i))this.log("Removing header: ",i.textContent.trim(),this._articleTitle.trim()),G=!1,i=this._removeAndGetNext(i);else{if(r){if(this.REGEXPS.unlikelyCandidates.test(c)&&!this.REGEXPS.okMaybeItsACandidate.test(c)&&!this._hasAncestorTag(i,"table")&&!this._hasAncestorTag(i,"code")&&"BODY"!==i.tagName&&"A"!==i.tagName){this.log("Removing unlikely candidate - "+c),i=this._removeAndGetNext(i);continue}if(this.UNLIKELY_ROLES.includes(i.getAttribute("role"))){this.log("Removing content with role "+i.getAttribute("role")+" - "+c),i=this._removeAndGetNext(i);continue}}if("DIV"!==i.tagName&&"SECTION"!==i.tagName&&"HEADER"!==i.tagName&&"H1"!==i.tagName&&"H2"!==i.tagName&&"H3"!==i.tagName&&"H4"!==i.tagName&&"H5"!==i.tagName&&"H6"!==i.tagName||!this._isElementWithoutContent(i)){if(-1!==this.DEFAULT_TAGS_TO_SCORE.indexOf(i.tagName)&&a.push(i),"DIV"===i.tagName){for(var s=null,l=i.firstChild;l;){var d=l.nextSibling;if(this._isPhrasingContent(l))null!==s?s.appendChild(l):this._isWhitespace(l)||(s=t.createElement("p"),i.replaceChild(s,l),s.appendChild(l));else if(null!==s){for(;s.lastChild&&this._isWhitespace(s.lastChild);)s.removeChild(s.lastChild);s=null}l=d}if(this._hasSingleTagInsideElement(i,"P")&&this._getLinkDensity(i)<.25){var u=i.children[0];i.parentNode.replaceChild(u,i),i=u,a.push(i)}else this._hasChildBlockElement(i)||(i=this._setNodeTag(i,"P"),a.push(i))}i=this._getNextNode(i)}else i=this._removeAndGetNext(i)}else this.log("Removing hidden node - "+c),i=this._removeAndGetNext(i)}var h=[];this._forEachNode(a,(function(e){if(e.parentNode&&void 0!==e.parentNode.tagName){var t=this._getInnerText(e);if(!(t.length<25)){var n=this._getNodeAncestors(e,5);if(0!==n.length){var o=0;o+=1,o+=t.split(",").length,o+=Math.min(Math.floor(t.length/100),3),this._forEachNode(n,(function(e,t){if(e.tagName&&e.parentNode&&void 0!==e.parentNode.tagName){if(void 0===e.readability&&(this._initializeNode(e),h.push(e)),0===t)var n=1;else n=1===t?2:3*t;e.readability.contentScore+=o/n}}))}}}}));for(var m=[],p=0,g=h.length;p<g;p+=1){var f=h[p],b=f.readability.contentScore*(1-this._getLinkDensity(f));f.readability.contentScore=b,this.log("Candidate:",f,"with score "+b);for(var w=0;w<this._nbTopCandidates;w++){var y=m[w];if(!y||b>y.readability.contentScore){m.splice(w,0,f),m.length>this._nbTopCandidates&&m.pop();break}}}var v,x=m[0]||null,T=!1;if(null===x||"BODY"===x.tagName){x=t.createElement("DIV"),T=!0;for(var S=e.childNodes;S.length;)this.log("Moving child out:",S[0]),x.appendChild(S[0]);e.appendChild(x),this._initializeNode(x)}else if(x){for(var A=[],k=1;k<m.length;k++)m[k].readability.contentScore/x.readability.contentScore>=.75&&A.push(this._getNodeAncestors(m[k]));if(A.length>=3)for(v=x.parentNode;"BODY"!==v.tagName;){for(var N=0,M=0;M<A.length&&N<3;M++)N+=Number(A[M].includes(v));if(N>=3){x=v;break}v=v.parentNode}x.readability||this._initializeNode(x),v=x.parentNode;for(var C=x.readability.contentScore,E=C/3;"BODY"!==v.tagName;)if(v.readability){var P=v.readability.contentScore;if(P<E)break;if(P>C){x=v;break}C=v.readability.contentScore,v=v.parentNode}else v=v.parentNode;for(v=x.parentNode;"BODY"!=v.tagName&&1==v.children.length;)v=(x=v).parentNode;x.readability||this._initializeNode(x)}var q=t.createElement("DIV");n&&(q.id="readability-content");for(var L=Math.max(10,.2*x.readability.contentScore),_=(v=x.parentNode).children,U=0,I=_.length;U<I;U++){var V=_[U],R=!1;if(this.log("Looking at sibling node:",V,V.readability?"with score "+V.readability.contentScore:""),this.log("Sibling has score",V.readability?V.readability.contentScore:"Unknown"),V===x)R=!0;else{var H=0;if(V.className===x.className&&""!==x.className&&(H+=.2*x.readability.contentScore),V.readability&&V.readability.contentScore+H>=L)R=!0;else if("P"===V.nodeName){var D=this._getLinkDensity(V),O=this._getInnerText(V),B=O.length;(B>80&&D<.25||B<80&&B>0&&0===D&&-1!==O.search(/\.( |$)/))&&(R=!0)}}R&&(this.log("Appending node:",V),-1===this.ALTER_TO_DIV_EXCEPTIONS.indexOf(V.nodeName)&&(this.log("Altering sibling:",V,"to div."),V=this._setNodeTag(V,"DIV")),q.appendChild(V),U-=1,I-=1)}if(this._debug&&this.log("Article content pre-prep: "+q.innerHTML),this._prepArticle(q),this._debug&&this.log("Article content post-prep: "+q.innerHTML),T)x.id="readability-page-1",x.className="page";else{var j=t.createElement("DIV");j.id="readability-page-1",j.className="page";for(var z=q.childNodes;z.length;)j.appendChild(z[0]);q.appendChild(j)}this._debug&&this.log("Article content after paging: "+q.innerHTML);var F=!0,W=this._getInnerText(q,!0).length;if(W<this._charThreshold)if(F=!1,e.innerHTML=o,this._flagIsActive(this.FLAG_STRIP_UNLIKELYS))this._removeFlag(this.FLAG_STRIP_UNLIKELYS),this._attempts.push({articleContent:q,textLength:W});else if(this._flagIsActive(this.FLAG_WEIGHT_CLASSES))this._removeFlag(this.FLAG_WEIGHT_CLASSES),this._attempts.push({articleContent:q,textLength:W});else if(this._flagIsActive(this.FLAG_CLEAN_CONDITIONALLY))this._removeFlag(this.FLAG_CLEAN_CONDITIONALLY),this._attempts.push({articleContent:q,textLength:W});else{if(this._attempts.push({articleContent:q,textLength:W}),this._attempts.sort((function(e,t){return t.textLength-e.textLength})),!this._attempts[0].textLength)return null;q=this._attempts[0].articleContent,F=!0}if(F){var $=[v,x].concat(this._getNodeAncestors(v));return this._someNode($,(function(e){if(!e.tagName)return!1;var t=e.getAttribute("dir");return!!t&&(this._articleDir=t,!0)})),q}}},_isValidByline:function(e){return("string"==typeof e||e instanceof String)&&(e=e.trim()).length>0&&e.length<100},_unescapeHtmlEntities:function(e){if(!e)return e;var t=this.HTML_ESCAPE_MAP;return e.replace(/&(quot|amp|apos|lt|gt);/g,(function(e,n){return t[n]})).replace(/&#(?:x([0-9a-z]{1,4})|([0-9]{1,4}));/gi,(function(e,t,n){var o=parseInt(t||n,t?16:10);return String.fromCharCode(o)}))},_getJSONLD:function(e){var t=this._getAllNodesWithTag(e,["script"]),n=this._findNode(t,(function(e){return"application/ld+json"===e.getAttribute("type")}));if(n)try{var o=n.textContent.replace(/^\s*<!\[CDATA\[|\]\]>\s*$/g,""),r=JSON.parse(o),a={};return r["@context"]&&r["@context"].match(/^https?\:\/\/schema\.org$/)?(!r["@type"]&&Array.isArray(r["@graph"])&&(r=r["@graph"].find((function(e){return(e["@type"]||"").match(this.REGEXPS.jsonLdArticleTypes)}))),r&&r["@type"]&&r["@type"].match(this.REGEXPS.jsonLdArticleTypes)?("string"==typeof r.name?a.title=r.name.trim():"string"==typeof r.headline&&(a.title=r.headline.trim()),r.author&&("string"==typeof r.author.name?a.byline=r.author.name.trim():Array.isArray(r.author)&&r.author[0]&&"string"==typeof r.author[0].name&&(a.byline=r.author.filter((function(e){return e&&"string"==typeof e.name})).map((function(e){return e.name.trim()})).join(", "))),"string"==typeof r.description&&(a.excerpt=r.description.trim()),r.publisher&&"string"==typeof r.publisher.name&&(a.siteName=r.publisher.name.trim()),a):a):a}catch(e){this.log(e.message)}return{}},_getArticleMetadata:function(e){var t={},n={},o=this._doc.getElementsByTagName("meta"),r=/\s*(dc|dcterm|og|twitter)\s*:\s*(author|creator|description|title|site_name)\s*/gi,a=/^\s*(?:(dc|dcterm|og|twitter|weibo:(article|webpage))\s*[\.:]\s*)?(author|creator|description|title|site_name)\s*$/i;return this._forEachNode(o,(function(e){var t=e.getAttribute("name"),o=e.getAttribute("property"),i=e.getAttribute("content");if(i){var c=null,s=null;o&&(c=o.match(r))&&(s=c[0].toLowerCase().replace(/\s/g,""),n[s]=i.trim()),!c&&t&&a.test(t)&&(s=t,i&&(s=s.toLowerCase().replace(/\s/g,"").replace(/\./g,":"),n[s]=i.trim()))}})),t.title=e.title||n["dc:title"]||n["dcterm:title"]||n["og:title"]||n["weibo:article:title"]||n["weibo:webpage:title"]||n.title||n["twitter:title"],t.title||(t.title=this._getArticleTitle()),t.byline=e.byline||n["dc:creator"]||n["dcterm:creator"]||n.author,t.excerpt=e.excerpt||n["dc:description"]||n["dcterm:description"]||n["og:description"]||n["weibo:article:description"]||n["weibo:webpage:description"]||n.description||n["twitter:description"],t.siteName=e.siteName||n["og:site_name"],t.title=this._unescapeHtmlEntities(t.title),t.byline=this._unescapeHtmlEntities(t.byline),t.excerpt=this._unescapeHtmlEntities(t.excerpt),t.siteName=this._unescapeHtmlEntities(t.siteName),t},_isSingleImage:function(e){return"IMG"===e.tagName||1===e.children.length&&""===e.textContent.trim()&&this._isSingleImage(e.children[0])},_unwrapNoscriptImages:function(e){var t=Array.from(e.getElementsByTagName("img"));this._forEachNode(t,(function(e){for(var t=0;t<e.attributes.length;t++){var n=e.attributes[t];switch(n.name){case"src":case"srcset":case"data-src":case"data-srcset":return}if(/\.(jpg|jpeg|png|webp)/i.test(n.value))return}e.parentNode.removeChild(e)}));var n=Array.from(e.getElementsByTagName("noscript"));this._forEachNode(n,(function(t){var n=e.createElement("div");if(n.innerHTML=t.innerHTML,this._isSingleImage(n)){var o=t.previousElementSibling;if(o&&this._isSingleImage(o)){var r=o;"IMG"!==r.tagName&&(r=o.getElementsByTagName("img")[0]);for(var a=n.getElementsByTagName("img")[0],i=0;i<r.attributes.length;i++){var c=r.attributes[i];if(""!==c.value&&("src"===c.name||"srcset"===c.name||/\.(jpg|jpeg|png|webp)/i.test(c.value))){if(a.getAttribute(c.name)===c.value)continue;var s=c.name;a.hasAttribute(s)&&(s="data-old-"+s),a.setAttribute(s,c.value)}}t.parentNode.replaceChild(n.firstElementChild,o)}}}))},_removeScripts:function(e){this._removeNodes(this._getAllNodesWithTag(e,["script"]),(function(e){return e.nodeValue="",e.removeAttribute("src"),!0})),this._removeNodes(this._getAllNodesWithTag(e,["noscript"]))},_hasSingleTagInsideElement:function(e,t){return 1==e.children.length&&e.children[0].tagName===t&&!this._someNode(e.childNodes,(function(e){return e.nodeType===this.TEXT_NODE&&this.REGEXPS.hasContent.test(e.textContent)}))},_isElementWithoutContent:function(e){return e.nodeType===this.ELEMENT_NODE&&0==e.textContent.trim().length&&(0==e.children.length||e.children.length==e.getElementsByTagName("br").length+e.getElementsByTagName("hr").length)},_hasChildBlockElement:function(e){return this._someNode(e.childNodes,(function(e){return this.DIV_TO_P_ELEMS.has(e.tagName)||this._hasChildBlockElement(e)}))},_isPhrasingContent:function(e){return e.nodeType===this.TEXT_NODE||-1!==this.PHRASING_ELEMS.indexOf(e.tagName)||("A"===e.tagName||"DEL"===e.tagName||"INS"===e.tagName)&&this._everyNode(e.childNodes,this._isPhrasingContent)},_isWhitespace:function(e){return e.nodeType===this.TEXT_NODE&&0===e.textContent.trim().length||e.nodeType===this.ELEMENT_NODE&&"BR"===e.tagName},_getInnerText:function(e,t){t=void 0===t||t;var n=e.textContent.trim();return t?n.replace(this.REGEXPS.normalize," "):n},_getCharCount:function(e,t){return t=t||",",this._getInnerText(e).split(t).length-1},_cleanStyles:function(e){if(e&&"svg"!==e.tagName.toLowerCase()){for(var t=0;t<this.PRESENTATIONAL_ATTRIBUTES.length;t++)e.removeAttribute(this.PRESENTATIONAL_ATTRIBUTES[t]);-1!==this.DEPRECATED_SIZE_ATTRIBUTE_ELEMS.indexOf(e.tagName)&&(e.removeAttribute("width"),e.removeAttribute("height"));for(var n=e.firstElementChild;null!==n;)this._cleanStyles(n),n=n.nextElementSibling}},_getLinkDensity:function(e){var t=this._getInnerText(e).length;if(0===t)return 0;var n=0;return this._forEachNode(e.getElementsByTagName("a"),(function(e){var t=e.getAttribute("href"),o=t&&this.REGEXPS.hashUrl.test(t)?.3:1;n+=this._getInnerText(e).length*o})),n/t},_getClassWeight:function(e){if(!this._flagIsActive(this.FLAG_WEIGHT_CLASSES))return 0;var t=0;return"string"==typeof e.className&&""!==e.className&&(this.REGEXPS.negative.test(e.className)&&(t-=25),this.REGEXPS.positive.test(e.className)&&(t+=25)),"string"==typeof e.id&&""!==e.id&&(this.REGEXPS.negative.test(e.id)&&(t-=25),this.REGEXPS.positive.test(e.id)&&(t+=25)),t},_clean:function(e,t){var n=-1!==["object","embed","iframe"].indexOf(t);this._removeNodes(this._getAllNodesWithTag(e,[t]),(function(e){if(n){for(var t=0;t<e.attributes.length;t++)if(this.REGEXPS.videos.test(e.attributes[t].value))return!1;if("object"===e.tagName&&this.REGEXPS.videos.test(e.innerHTML))return!1}return!0}))},_hasAncestorTag:function(e,t,n,o){n=n||3,t=t.toUpperCase();for(var r=0;e.parentNode;){if(n>0&&r>n)return!1;if(e.parentNode.tagName===t&&(!o||o(e.parentNode)))return!0;e=e.parentNode,r++}return!1},_getRowAndColumnCount:function(e){for(var t=0,n=0,o=e.getElementsByTagName("tr"),r=0;r<o.length;r++){var a=o[r].getAttribute("rowspan")||0;a&&(a=parseInt(a,10)),t+=a||1;for(var i=0,c=o[r].getElementsByTagName("td"),s=0;s<c.length;s++){var l=c[s].getAttribute("colspan")||0;l&&(l=parseInt(l,10)),i+=l||1}n=Math.max(n,i)}return{rows:t,columns:n}},_markDataTables:function(e){for(var t=e.getElementsByTagName("table"),n=0;n<t.length;n++){var o=t[n];if("presentation"!=o.getAttribute("role"))if("0"!=o.getAttribute("datatable"))if(o.getAttribute("summary"))o._readabilityDataTable=!0;else{var r=o.getElementsByTagName("caption")[0];if(r&&r.childNodes.length>0)o._readabilityDataTable=!0;else if(["col","colgroup","tfoot","thead","th"].some((function(e){return!!o.getElementsByTagName(e)[0]})))this.log("Data table because found data-y descendant"),o._readabilityDataTable=!0;else if(o.getElementsByTagName("table")[0])o._readabilityDataTable=!1;else{var a=this._getRowAndColumnCount(o);a.rows>=10||a.columns>4?o._readabilityDataTable=!0:o._readabilityDataTable=a.rows*a.columns>10}}else o._readabilityDataTable=!1;else o._readabilityDataTable=!1}},_fixLazyImages:function(e){this._forEachNode(this._getAllNodesWithTag(e,["img","picture","figure"]),(function(e){if(e.src&&this.REGEXPS.b64DataUrl.test(e.src)){if("image/svg+xml"===this.REGEXPS.b64DataUrl.exec(e.src)[1])return;for(var t=!1,n=0;n<e.attributes.length;n++){var o=e.attributes[n];if("src"!==o.name&&/\.(jpg|jpeg|png|webp)/i.test(o.value)){t=!0;break}}if(t){var r=e.src.search(/base64\s*/i)+7;e.src.length-r<133&&e.removeAttribute("src")}}if(!(e.src||e.srcset&&"null"!=e.srcset)||-1!==e.className.toLowerCase().indexOf("lazy"))for(var a=0;a<e.attributes.length;a++)if("src"!==(o=e.attributes[a]).name&&"srcset"!==o.name){var i=null;if(/\.(jpg|jpeg|png|webp)\s+\d/.test(o.value)?i="srcset":/^\s*\S+\.(jpg|jpeg|png|webp)\S*\s*$/.test(o.value)&&(i="src"),i)if("IMG"===e.tagName||"PICTURE"===e.tagName)e.setAttribute(i,o.value);else if("FIGURE"===e.tagName&&!this._getAllNodesWithTag(e,["img","picture"]).length){var c=this._doc.createElement("img");c.setAttribute(i,o.value),e.appendChild(c)}}}))},_getTextDensity:function(e,t){var n=this._getInnerText(e,!0).length;if(0===n)return 0;var o=0,r=this._getAllNodesWithTag(e,t);return this._forEachNode(r,(e=>o+=this._getInnerText(e,!0).length)),o/n},_cleanConditionally:function(e,t){this._flagIsActive(this.FLAG_CLEAN_CONDITIONALLY)&&this._removeNodes(this._getAllNodesWithTag(e,[t]),(function(e){var n=function(e){return e._readabilityDataTable},o="ul"===t||"ol"===t;if(!o){var r=0,a=this._getAllNodesWithTag(e,["ul","ol"]);this._forEachNode(a,(e=>r+=this._getInnerText(e).length)),o=r/this._getInnerText(e).length>.9}if("table"===t&&n(e))return!1;if(this._hasAncestorTag(e,"table",-1,n))return!1;if(this._hasAncestorTag(e,"code"))return!1;var i=this._getClassWeight(e);if(this.log("Cleaning Conditionally",e),i+0<0)return!0;if(this._getCharCount(e,",")<10){for(var c=e.getElementsByTagName("p").length,s=e.getElementsByTagName("img").length,l=e.getElementsByTagName("li").length-100,d=e.getElementsByTagName("input").length,u=this._getTextDensity(e,["h1","h2","h3","h4","h5","h6"]),h=0,m=this._getAllNodesWithTag(e,["object","embed","iframe"]),p=0;p<m.length;p++){for(var g=0;g<m[p].attributes.length;g++)if(this.REGEXPS.videos.test(m[p].attributes[g].value))return!1;if("object"===m[p].tagName&&this.REGEXPS.videos.test(m[p].innerHTML))return!1;h++}var f=this._getLinkDensity(e),b=this._getInnerText(e).length;return s>1&&c/s<.5&&!this._hasAncestorTag(e,"figure")||!o&&l>c||d>Math.floor(c/3)||!o&&u<.9&&b<25&&(0===s||s>2)&&!this._hasAncestorTag(e,"figure")||!o&&i<25&&f>.2||i>=25&&f>.5||1===h&&b<75||h>1}return!1}))},_cleanMatchedNodes:function(e,t){for(var n=this._getNextNode(e,!0),o=this._getNextNode(e);o&&o!=n;)o=t.call(this,o,o.className+" "+o.id)?this._removeAndGetNext(o):this._getNextNode(o)},_cleanHeaders:function(e){let t=this._getAllNodesWithTag(e,["h1","h2"]);this._removeNodes(t,(function(e){let t=this._getClassWeight(e)<0;return t&&this.log("Removing header with low class weight:",e),t}))},_headerDuplicatesTitle:function(e){if("H1"!=e.tagName&&"H2"!=e.tagName)return!1;var t=this._getInnerText(e,!1);return this.log("Evaluating similarity of header:",t,this._articleTitle),this._textSimilarity(this._articleTitle,t)>.75},_flagIsActive:function(e){return(this._flags&e)>0},_removeFlag:function(e){this._flags=this._flags&~e},_isProbablyVisible:function(e){return(!e.style||"none"!=e.style.display)&&!e.hasAttribute("hidden")&&(!e.hasAttribute("aria-hidden")||"true"!=e.getAttribute("aria-hidden")||e.className&&e.className.indexOf&&-1!==e.className.indexOf("fallback-image"))},parse:function(){if(this._maxElemsToParse>0){var e=this._doc.getElementsByTagName("*").length;if(e>this._maxElemsToParse)throw new Error("Aborting parsing document; "+e+" elements found")}this._unwrapNoscriptImages(this._doc);var t=this._disableJSONLD?{}:this._getJSONLD(this._doc);this._removeScripts(this._doc),this._prepDocument();var n=this._getArticleMetadata(t);this._articleTitle=n.title;var o=this._grabArticle();if(!o)return null;if(this.log("Grabbed: "+o.innerHTML),this._postProcessContent(o),!n.excerpt){var r=o.getElementsByTagName("p");r.length>0&&(n.excerpt=r[0].textContent.trim())}var a=o.textContent;return{title:this._articleTitle,byline:n.byline||this._articleByline,dir:this._articleDir,content:this._serializer(o),textContent:a,length:a.length,excerpt:n.excerpt,siteName:n.siteName||this._articleSiteName}}},e.exports=t},e=>{var t={unlikelyCandidates:/-ad-|ai2html|banner|breadcrumbs|combx|comment|community|cover-wrap|disqus|extra|footer|gdpr|header|legends|menu|related|remark|replies|rss|shoutbox|sidebar|skyscraper|social|sponsor|supplemental|ad-break|agegate|pagination|pager|popup|yom-remote/i,okMaybeItsACandidate:/and|article|body|column|content|main|shadow/i};function n(e){return(!e.style||"none"!=e.style.display)&&!e.hasAttribute("hidden")&&(!e.hasAttribute("aria-hidden")||"true"!=e.getAttribute("aria-hidden")||e.className&&e.className.indexOf&&-1!==e.className.indexOf("fallback-image"))}e.exports=function(e,o={}){"function"==typeof o&&(o={visibilityChecker:o});var r={minScore:20,minContentLength:140,visibilityChecker:n};o=Object.assign(r,o);var a=e.querySelectorAll("p, pre"),i=e.querySelectorAll("div > br");if(i.length){var c=new Set(a);[].forEach.call(i,(function(e){c.add(e.parentNode)})),a=Array.from(c)}var s=0;return[].some.call(a,(function(e){if(!o.visibilityChecker(e))return!1;var n=e.className+" "+e.id;if(t.unlikelyCandidates.test(n)&&!t.okMaybeItsACandidate.test(n))return!1;if(e.matches("li p"))return!1;var r=e.textContent.trim().length;return!(r<o.minContentLength)&&(s+=Math.sqrt(r-o.minContentLength))>o.minScore}))}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Ciyuanji:()=>g});var o=n(23),r=n(19),a=n(36),i=n(21),c=n(35),s=n(5),l=n.n(s),d=n(2),u=n(37),h=n(38),m=n(29),p=n(12);class g extends m.c{constructor(){super(),this.imageMode="TM",this.concurrencyLimit=1}async bookParse(){const e=document.location.href,t=unsafeWindow.__NUXT__.data[0].book,n=t.bookId,o=t.bookName,a=t.authorName,i=document.createElement("div");i.innerHTML=t.notes.replace("/\n/g","<br/><br/>");const[s,m]=await(0,c.SN)(i),p={},g=t.imgUrl;g&&(0,r.CE)(g,this.imageMode,"cover-").then((e=>{p.cover=e})).catch((e=>l().error(e))),p.tags=t.tagList.map((e=>e.tagName));const f=unsafeWindow.__NUXT__.data[1].bookChapter.chapterList,b=[];let w=0,y=null,v=0,x=0;for(const t of f){const r=t.chapterId,a=`${document.location.origin}/chapter/${r}?bookId=${n}`,i=t.chapterName,c=t.title;y!==c&&(y=c,v++,x=0),w++,x++;const s="1"===t.isFee,l="1"===t.isBuy,h=new u.W({bookUrl:e,bookname:o,chapterUrl:a,chapterNumber:w,chapterName:i,isVIP:s,isPaid:l,sectionName:y,sectionNumber:v,sectionChapterNumber:x,chapterParse:this.chapterParse,charset:this.charset,options:{}});!0===h.isVIP&&!1===h.isPaid&&(h.status=d.qb.aborted),b.push(h)}return new h.f({bookUrl:e,bookname:o,author:a,introduction:s,introductionHTML:m,additionalMetadate:p,chapters:b})}async chapterParse(e,t,n,r,c,s){const l=await(0,i.dL)(e,c),d=Array.from(l.querySelectorAll("script")).filter((e=>/^window\.__NUXT__/.test(e.innerHTML)));if(1===d.length){const e=d[0].innerHTML.replace(/^window\./,"const "),n=(0,p.J0)(`${e}; return __NUXT__`).data[0].chapter,r=document.createElement("div"),i=function(e){if(e&&"string"==typeof e){e=e.replace(/\n/g,"");const t=o.enc.Utf8.parse("ZUreQN0Epkpxh3pooWOgixjTfPwumCTYWzYTQ7SMgDnqFLQ1s9tqpVhkGf02we89moQwhSQ07DVzc3LWupRgbVvm29aYeY7zyFN");return o.DES.decrypt(e,t,{mode:o.mode.ECB,padding:o.pad.Pkcs7}).toString(o.enc.Utf8)}}(n.chapterContentFormat);if(i){r.innerHTML=i;const{dom:e,text:n,images:o}=await(0,a.zM)(r,"TM");return{chapterName:t,contentRaw:r,contentText:n,contentHTML:e,contentImages:o,additionalMetadate:null}}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{wanben:()=>c});var o=n(36),r=n(12),a=n(35),i=n(42);const c=()=>(0,i.x)({bookUrl:document.location.href,bookname:document.querySelector(".detailTitle > h1").innerText.trim(),author:document.querySelector(".writer > a").innerText.trim(),introDom:document.querySelector(".detailTopMid > table:nth-child(3) > tbody:nth-child(1) > tr:nth-child(3) > td:nth-child(2)"),introDomPatch:e=>e,coverUrl:document.querySelector(".detailTopLeft > img")?.src,aList:document.querySelectorAll(".chapter li > a"),getContentFromUrl:async(e,t,n)=>{const{contentRaw:i}=await(0,a.I2)({chapterName:t,chapterUrl:e,charset:n,selector:"div.readerCon",contentPatch:(e,t)=>((0,r.rm)("script",!0,e),(0,r.rm)("div[style]",!0,e),(0,r.vS)(e,["【提示】：如果觉得此文不错，请推荐给更多小伙伴吧！分享也是一种享受。","【看书助手】","百万热门书籍终身无广告免费阅读"]),(0,o.iA)(e),e),getNextPage:e=>e.querySelector(".readPage > a:nth-child(3)").href,continueCondition:(e,t)=>t.split("/").slice(-1)[0].includes("_"),enableCleanDOM:!1});return i},contentPatch:e=>e})},(e,t,n)=>{"use strict";n.r(t),n.d(t,{wanben:()=>s});var o=n(36),r=n(21),a=n(12),i=n(35),c=n(47);const s=()=>(0,c.x)({bookUrl:document.location.href,bookname:document.querySelector("div.bookPhr > h2").innerText.trim(),author:document.querySelector("div.bookPhrMid > p:nth-child(1)").innerText.replace("作者：","").trim(),introDom:(()=>{const e=document.querySelector(".bookInfo > a");return e&&(e.click(),e.remove()),document.querySelector(".bookInfo")})(),introDomPatch:e=>e,coverUrl:document.querySelector("div.bookImg > img")?.src,getIndexUrls:async()=>{const e=document.querySelector("#contentbox > div.detailDiv > div.category > a").href,t=(await(0,r.dL)(e,document.characterSet)).querySelectorAll("div.pageBg div.pagenum a");return Array.from(t).map((e=>e.href))},getAList:e=>e.querySelectorAll("div.chapterDiv > div.chapterList > ul > a"),getContentFromUrl:async(e,t,n)=>{const{contentRaw:r}=await(0,i.I2)({chapterName:t,chapterUrl:e,charset:n,selector:"div.raderCon",contentPatch:(e,t)=>((0,a.rm)("script",!0,e),(0,a.rm)("[style]",!0,e),(0,a.vS)(e,["【提示】：如果觉得此文不错，请推荐给更多小伙伴吧！分享也是一种享受。","【看书助手】","【完本神站】","百万热门书籍终身无广告免费阅读"]),(0,o.iA)(e),e),getNextPage:e=>e.querySelector("div.page > a:nth-child(3)").href,continueCondition:(e,t)=>t.split("/").slice(-1)[0].includes("_"),enableCleanDOM:!1});return r},contentPatch:e=>e})},(e,t,n)=>{"use strict";n.r(t),n.d(t,{washuge:()=>r});var o=n(52);const r=()=>{const e=document.location.href,t=/(\d+)\/?$/.exec(e)?.[1];if(!t)throw Error("获取书籍信息出错！");const n=`${document.location.origin}/books/book${t}.html`;return(0,o.x)({bookUrl:e,anotherPageUrl:n,getBookname:e=>e.querySelector("#content > dd > h1")?.innerText.replace("全文阅读","").trim(),getAuthor:e=>e.querySelector("#at > tbody:nth-child(1) > tr:nth-child(1) > td:nth-child(4)")?.innerText.trim(),getIntroDom:e=>e.querySelector("#content > dd:nth-child(7) > p:nth-child(3)"),introDomPatch:e=>e,getCoverUrl:e=>e.querySelector(".hst > img").src,getAList:e=>document.querySelectorAll("#at > tbody td > a"),getContent:e=>e.querySelector("#contents"),contentPatch:e=>e,concurrencyLimit:1})}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{baihexs:()=>i});var o=n(21),r=n(12),a=n(47);const i=()=>{const e=document.location.href,t=/(\d+)\/?$/.exec(document.location.href)?.[1];if(!t)throw Error("获取书籍信息出错！");return(0,a.x)({bookUrl:e,bookname:document.querySelector(".block_txt2 > h2 > a").innerText.trim(),author:document.querySelector(".block_txt2 > p:nth-child(4)").innerText.replace("作者：","").trim(),introDom:document.querySelector(".intro_info"),introDomPatch:e=>e,coverUrl:document.querySelector(".block_img2 > img")?.src,getIndexUrls:async()=>{const e=`${document.location.origin}/wapbook-${t}`,n=(await(0,o.dL)(e+"/",document.characterSet)).querySelector("div.page > a:nth-last-child(1)"),r=/(\d+)\/?$/.exec(n.href)?.[1];if(!r)throw Error("获取章节列表时出错！");const a=[];for(let t=1;t<=parseInt(r,10);t++){const n=e+`_${t}/`;a.push(n)}return a},getAList:e=>e.querySelectorAll(".chapter > li > a"),getContent:e=>e.querySelector("#nr1"),contentPatch:e=>((0,r.up)([/请牢记：百合小说网.+免费最快更新无防盗无防盗/],e),e),concurrencyLimit:3})}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{quanshuzhai:()=>r});var o=n(42);const r=()=>(0,o.x)({bookUrl:document.location.href,bookname:document.querySelector(".booktitle").innerText.trim(),author:document.querySelector("a.red").innerText.trim(),introDom:document.querySelector(".bookintro"),introDomPatch:e=>e,coverUrl:null,aList:document.querySelectorAll("#list-chapterAll > dd > a"),getContent:e=>e.querySelector(".readcontent"),contentPatch:e=>e})},(e,t,n)=>{"use strict";n.r(t),n.d(t,{masiro:()=>r});var o=n(42);const r=()=>(0,o.x)({bookUrl:document.location.href,bookname:document.querySelector(".novel-title").innerText.trim(),author:document.querySelector(".author > a").innerText.trim(),introDom:document.querySelector(".brief"),introDomPatch:e=>e,coverUrl:document.querySelector("div.mailbox-attachment-icon > a > img.img").src,additionalMetadatePatch:e=>(e.tags=Array.from(document.querySelectorAll("div.n-detail > div.tags a")).map((e=>e.innerText)),e),aList:document.querySelectorAll("a.to-read"),getAName:e=>e.querySelector('span[style^="overflow: hidden;"]').innerText.trim(),sections:document.querySelectorAll("li.chapter-box > span + b"),getSName:e=>e.innerText.trim(),getContent:e=>e.querySelector("div.box-body.nvl-content"),contentPatch:e=>e,concurrencyLimit:3,needLogin:!0})},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Pixiv:()=>h});var o=n(19),r=n(36),a=n(21),i=n(5),c=n.n(i),s=n(2),l=n(37),d=n(38),u=n(29);class h extends u.c{constructor(){super(),this.imageMode="TM"}async bookParse(){const e=this,t=document.documentElement.getAttribute("lang"),n=t?{lang:t}:{};let a;if(document.location.pathname.startsWith("/novel/series")){const e=/(\d+)\/?$/.exec(document.location.pathname)?.[0];if(e){const t=parseInt(e,10);a=await i(t)}}else{const t=await m(document.location.href,e.charset);if(t){const{novel:n}=t;if(n){const t=n.seriesNavData;if(t){const e=t.seriesId;a=await i(e)}else a=await async function(t){const n=document.location.href,a=t.title,i=t.userName,u=document.createElement("div");u.innerHTML=t.description;const h=u.innerText,m={},p=t.coverUrl;p&&(0,o.CE)(p,e.imageMode,"cover-").then((e=>{m.cover=e})).catch((e=>c().error(e))),m.lastModified=new Date(t.uploadDate).getTime(),m.tags=t.tags.tags.map((e=>e.tag)),m.languages=t.language;const g=n,f=a,b=new l.W({bookUrl:n,bookname:a,chapterUrl:g,chapterNumber:1,chapterName:f,isVIP:!1,isPaid:!1,sectionName:null,sectionNumber:null,sectionChapterNumber:null,chapterParse:e.chapterParse,charset:e.charset,options:{}}),w=document.createElement("div");w.innerHTML=t.content.replace(/\n/g,"<br/>");const{dom:y,text:v,images:x}=await(0,r.zM)(w,"TM");b.contentRaw=w,b.contentHTML=y,b.contentText=v,b.contentImages=x,b.additionalMetadate={lastModified:new Date(t.uploadDate).getTime(),tags:t.tags.tags.map((e=>e.tag))},b.status=s.qb.finished;const T=[b];return new d.f({bookUrl:n,bookname:a,author:i,introduction:h,introductionHTML:u,additionalMetadate:m,chapters:T})}(n)}}}if(!a)throw new Error("初始化图书信息失败！");return a;async function i(t){const r=await async function(e){const t="https://www.pixiv.net/novel/series/"+e.toString(),o="https://www.pixiv.net/ajax/novel/series/"+e.toString()+"?"+new URLSearchParams(n).toString(),r=await fetch(o,{credentials:"include",headers:{Accept:"application/json",Pragma:"no-cache","Cache-Control":"no-cache"},referrer:t,method:"GET",mode:"cors"}),a=await r.json();if(!1===a.error)return a.body}(t);if(r){const a="https://www.pixiv.net/novel/series/"+t.toString(),i=r.title,s=r.userName,u=r.caption,h=document.createElement("div");h.innerText=u;const m={},p=r.firstEpisode.url;p&&(0,o.CE)(p,e.imageMode,"cover-").then((e=>{m.cover=e})).catch((e=>c().error(e))),m.lastModified=r.updatedTimestamp;const g=await async function(e,t){const o="https://www.pixiv.net/novel/series/"+e.toString(),r="https://www.pixiv.net/ajax/novel/series_content/"+e.toString();let a=0;const i=[];for(;a<t;){const e=r+"?"+new URLSearchParams({limit:"10",last_order:a.toString(),order_by:"asc",...n}).toString(),t=await fetch(e,{credentials:"include",headers:{Accept:"application/json"},referrer:o,method:"GET",mode:"cors"}),c=await t.json();!1===c.error&&i.push(...c.body.seriesContents),a+=10}return i}(t,r.publishedContentCount),f=[],b="https://www.pixiv.net/novel/show.php?id=";for(const t of g){const n=b+t.id,o=t.series.contentOrder,r=`#${t.series.contentOrder} ${t.title}`,c=new l.W({bookUrl:a,bookname:i,chapterUrl:n,chapterNumber:o,chapterName:r,isVIP:!1,isPaid:!1,sectionName:null,sectionNumber:null,sectionChapterNumber:null,chapterParse:e.chapterParse,charset:e.charset,options:{id:t.id}});f.push(c)}return new d.f({bookUrl:a,bookname:i,author:s,introduction:u,introductionHTML:h,additionalMetadate:m,chapters:f})}}}async chapterParse(e,t,n,o,a){const i=await m(e,a);if(i){const{novel:e}=i;if(e){const n=document.createElement("div");n.innerHTML=e.content.replace(/\n/g,"<br/>");const{dom:o,text:a,images:i}=await(0,r.zM)(n,"TM");return{chapterName:t,contentRaw:n,contentText:a,contentHTML:o,contentImages:i,additionalMetadate:{lastModified:new Date(e.uploadDate).getTime(),tags:e.tags.tags.map((e=>e.tag))}}}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}async function m(e,t){const n=(await(0,a.dL)(e,t)).querySelector("meta#meta-preload-data")?.getAttribute("content");if(n){const e=JSON.parse(n);let t;const o=Object.entries(e.novel);let r;0!==o.length&&(t=o[0][1]);const a=Object.entries(e.user);return 0!==a.length&&(r=a[0][1]),{preloadData:e,novel:t,user:r}}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{kakuyomu:()=>r});var o=n(42);const r=()=>(0,o.x)({bookUrl:document.location.href,bookname:document.querySelector("#workTitle > a").innerText.trim(),author:document.querySelector("#workAuthor-activityName > a").innerText.trim(),introDom:document.querySelector("#introduction"),introDomPatch:e=>e,coverUrl:null,additionalMetadatePatch:e=>(e.tags=Array.from(document.querySelectorAll("#workMeta-tags > li > a")).map((e=>e.innerText)),e),aList:document.querySelectorAll("li.widget-toc-episode > a"),getAName:e=>e.querySelector("span.widget-toc-episode-titleLabel").innerText.trim(),sections:document.querySelectorAll("li.widget-toc-chapter > span"),getSName:e=>e.innerText.trim(),getContent:e=>e.querySelector(".widget-episodeBody"),contentPatch:e=>e})},(e,t,n)=>{"use strict";n.r(t),n.d(t,{syosetu:()=>a,syosetuOrg:()=>i});var o=n(12),r=n(42);const a=()=>(0,r.x)({bookUrl:document.location.href,bookname:document.querySelector(".novel_title").innerText.trim(),author:document.querySelector(".novel_writername > a").innerText.trim(),introDom:(()=>{const e=document.querySelector("#novel_ex > .more");return e&&e.click(),document.querySelector("#novel_ex")})(),introDomPatch:e=>e,coverUrl:null,aList:(()=>{const e=document.querySelectorAll("dl.novel_sublist2 dd.subtitle > a");if(0!==e.length)return e;{const e=document.createElement("a");return e.href=document.location.href,e.innerText=document.querySelector(".novel_title")?.innerText,[e]}})(),sections:document.querySelectorAll("div.chapter_title"),getSName:e=>e.innerText.trim(),getContent:e=>{const t=document.createElement("div"),n=e.querySelector("#novel_p"),o=e.querySelector("#novel_honbun"),r=e.querySelector("#novel_a");if(n){t.appendChild(n);const o=e.createElement("hr");t.appendChild(o)}if(o&&t.appendChild(o),r){const n=e.createElement("hr");t.appendChild(n),t.appendChild(r)}return t},contentPatch:e=>e,nsfw:"novel18.syosetu.com"===document.location.host}),i=()=>{const e=(()=>{const e=document.querySelectorAll('tr[class^="bgcolor"] > td > a');if(0!==e.length)return e;{const e=document.createElement("a");return e.href=document.location.href,e.innerText=document.querySelector("div.ss:nth-child(1) > p:nth-child(1) > span:nth-child(1) > a:nth-child(1)")?.innerText,[e]}})();return(0,r.x)({bookUrl:document.location.href,bookname:document.querySelector('div.ss > span[itemprop="name"], div.ss:nth-child(1) > p:nth-child(1) > span:nth-child(1) > a:nth-child(1)').innerText.trim(),author:document.querySelector('div.ss span[itemprop="author"] > a, div.ss:nth-child(1) > p:nth-child(1) > a:nth-child(2)')?.innerText.trim(),introDom:(()=>{if(1!==e.length||e[0].href!==document.location.href)return document.querySelector("div.ss:nth-child(2)")})(),introDomPatch:e=>e,coverUrl:null,additionalMetadatePatch:e=>(e.tags=Array.from(document.querySelectorAll('span[itemprop="keywords"] > a, a.alert_color')).map((e=>e.innerText)),e),aList:e,sections:document.querySelectorAll('div.ss > table > tbody > tr > td[colspan="2"] > strong'),getSName:e=>e.innerText.trim(),getContent:t=>1===e.length&&e[0].href===document.location.href?t.querySelector("div#maind > div.ss:nth-child(2)"):t.querySelector("div#maind > div.ss:nth-child(1)"),contentPatch:e=>((0,o.rm)("p:nth-child(1)",!1,e),(0,o.rm)("div.novelnavi",!0,e),(0,o.rm)('div[style*="text-align:right;"]',!0,e),(0,o.rm)("div#maegaki_open",!0,e),(0,o.rm)("div#atogaki_open",!0,e),e.querySelectorAll('a[name="img"]').forEach((e=>{const t=document.createElement("img");t.src=e.href,t.alt=e.innerText,e.replaceWith(t)})),e)})}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{houhuayuan:()=>i});var o=n(21),r=n(12),a=n(42);const i=()=>{const e=document.querySelector(".seriesbox");let t,n,i=document.querySelector("h3.author")?.innerText.replace(/♥|作者: /g,"").trim();""===i&&(i="佚名");const c=[];if(e){const o=e.querySelectorAll("ul.serieslist-ul > li");for(const e of Array.from(o))if("serieslist-li"===e.className){const t=e.querySelector("a");t&&c.push(t)}else if("serieslist-li-current"===e.className){const e=document.createElement("a");e.innerText=document.querySelector(".entry-title").innerText.trim(),e.href=document.location.href,c.push(e)}const r=c[0];n=r.innerText.replace(/第.+章$|\s序$/,"").trim(),t=r.href}else{t=document.location.href,n=document.querySelector(".entry-title").innerText.trim();const e=document.createElement("a");e.innerText=n,e.href=t,c.push(e)}return(0,a.x)({bookUrl:t,bookname:n,author:i,aList:c,getContentFromUrl:async(e,t,n)=>{const a=await(0,o.dL)(e,n),i=a.querySelectorAll(".page-links > a.post-page-numbers");if(i){const e=document.createElement("div"),t=a.querySelector("header + div.entry-content");t&&(0,r.vR)(t,e);const c=Array.from(i).map((e=>e.href));for(const t of c){const a=(await(0,o.dL)(t,n)).querySelector("header + div.entry-content");a&&(0,r.vR)(a,e)}return e}return a.querySelector("header + div.entry-content")},contentPatch:e=>((0,r.rm)('div[id^="stage-"]',!0,e),(0,r.rm)('div[id^="zhaoz-"]',!0,e),(0,r.rm)("div.seriesbox",!0,e),(0,r.rm)("fieldset",!0,e),(0,r.rm)("div.wpulike",!0,e),(0,r.rm)(".simplefavorite-button",!0,e),(0,r.rm)(".page-links",!0,e),(0,r.vS)(e,[" – 蔷薇后花园"," – 黑沼泽俱乐部"]),Array.from(e.querySelectorAll("img")).forEach((e=>e.src=e.getAttribute("data-src")??"")),e),nsfw:!0})}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Myrics:()=>h});var o=n(19),r=n(36),a=n(21),i=n(5),c=n.n(i),s=n(2),l=n(37),d=n(38),u=n(29);class h extends u.c{constructor(){super(),this.imageMode="TM"}async bookParse(){const e=/^\/novels\/(\d+)/.exec(document.location.pathname)?.[1];if(!e)throw new Error("获取书籍信息出错！");const t=unsafeWindow.__INITIAL_STATE__,n=navigator.languages.join(", "),r=t.global.country,i="SUCCESS"===t.global.signIn.status,u=t.global.signIn.user?.accessToken??null,h=`https://api.myrics.com/v1/novels/${e}`,m=`https://api.myrics.com/v1/novels/${e}/chapters`,p={Authority:"api.myrics.com",Accept:"application/json",Origin:"https://www.myrics.com",Referer:"https://www.myrics.com/","X-Platform":"FRONT","X-Lang":n,"X-Country":r};u&&(p.Authorization=u);const g={headers:p,method:"GET",responseType:"json"},f=(await(0,a.GF)(h,g)).response;if(200!==f.status_code)throw new Error("获取书籍信息出错！");const b=`https://www.myrics.com/novels/${e}`,w=f.result.title,y=f.result.author.pen_name,v=f.result.long_summary,x=document.createElement("div");x.innerText=v;const T={},S=f.result.cover_image;S&&(0,o.CE)(S,this.imageMode,"cover-").then((e=>{T.cover=e})).catch((e=>c().error(e))),T.tags=f.result.genres.map((e=>e.name));const A=[];let k=0,N=1;for(;0===k||N<=k;){const t=m+`?${new URLSearchParams((M=N,{page:M.toString()})).toString()}`,n=(await(0,a.GF)(t,g)).response;if(200!==n.status_code)throw new Error("获取书籍信息出错！");k=n.result.pages,N++;for(const t of n.result.items){const n=t.id,o=`https://www.myrics.com/novels/${e}/chapters/${n}`,r=t.order,a=`${t.order} - ${t.title}`,c=0!==t.coin,d=t.is_purchased,u=t.part,h=`卷${u}`,m=t.order,p=t.is_adult,f=new l.W({bookUrl:b,bookname:w,chapterUrl:o,chapterNumber:r,chapterName:a,isVIP:c,isPaid:d,sectionName:h,sectionNumber:u,sectionChapterNumber:m,chapterParse:this.chapterParse,charset:this.charset,options:{bookId:e,chapterId:n,init:g}});!0===f.isVIP&&!1===f.isPaid&&(f.status=s.qb.aborted),!1===i&&!0===p&&(f.status=s.qb.aborted),A.push(f)}}var M;A.sort(((e,t)=>e.sectionNumber&&t.sectionNumber?e.sectionNumber!==t.sectionNumber?e.sectionNumber-t.sectionNumber:e.sectionChapterNumber&&t.sectionChapterNumber?e.sectionChapterNumber-t.sectionChapterNumber:0:e.chapterNumber-t.chapterNumber));let C=0;for(const e of A)C++,e.chapterNumber=C;return new d.f({bookUrl:b,bookname:w,author:y,introduction:v,introductionHTML:x,additionalMetadate:T,chapters:A})}async chapterParse(e,t,n,o,i,c){const{bookId:s,chapterId:l,init:d}=c,u=`https://api.myrics.com/v1/novels/${s}/chapters/${l}`,h=(await(0,a.GF)(u,d)).response;if(200!==h.status_code)throw new Error("获取章节失败！");const m=document.createElement("div");m.innerHTML=h.result.content;const{dom:p,text:g,images:f}=await(0,r.zM)(m,"TM");return{chapterName:t,contentRaw:m,contentText:g,contentHTML:p,contentImages:f,additionalMetadate:null}}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{a7xs:()=>c});var o=n(36),r=n(12),a=n(35),i=n(42);const c=()=>(0,i.x)({bookUrl:document.location.href,bookname:document.querySelector("#info > h1").innerText.trim(),author:document.querySelector("span.item:nth-child(1)").innerText.trim(),introDom:document.querySelector(".bookinfo_intro"),introDomPatch:e=>((0,r.rm)("strong",!0,e),(0,r.vS)(e,["您要是觉得《","请不要忘记向您QQ群和微博微信里的朋友推荐哦！"]),e),coverUrl:document.querySelector(".pic > img").src,aList:document.querySelectorAll(".book_list > ul > li > a"),getContentFromUrl:async(e,t,n)=>{const{contentRaw:i}=await(0,a.I2)({chapterName:t,chapterUrl:e,charset:n,selector:"#htmlContent",contentPatch:(e,t)=>((0,r.vS)(e,["免费追书小说网手机版阅读网址"]),(0,o.iA)(e),e),getNextPage:e=>e.querySelector("a.next.pager_next").href,continueCondition:(e,t)=>t.split("/").slice(-1)[0].includes("_"),enableCleanDOM:!1});return i},contentPatch:e=>e})},(e,t,n)=>{"use strict";n.r(t),n.d(t,{shencou:()=>i});var o=n(12),r=n(2),a=n(52);const i=()=>{const e=document.querySelector("#content > table:nth-child(2) > tbody:nth-child(1) > tr:nth-child(3) > td:nth-child(1) > table:nth-child(1) > tbody:nth-child(1) > tr:nth-child(1) > td:nth-child(1) > ul:nth-child(1) > li:nth-child(1) > a:nth-child(1)").href;return(0,a.x)({bookUrl:document.location.href,anotherPageUrl:e,getBookname:e=>document.querySelector("#content > table:nth-child(2) > tbody:nth-child(1) > tr:nth-child(1) > td:nth-child(1) > table:nth-child(1) > tbody:nth-child(1) > tr:nth-child(1) > td:nth-child(1) > table:nth-child(1) > tbody:nth-child(1) > tr:nth-child(1) > td:nth-child(1) > span:nth-child(1) > a:nth-child(1)").innerText.trim(),getAuthor:e=>document.querySelector("#content > table:nth-child(2) > tbody:nth-child(1) > tr:nth-child(1) > td:nth-child(1) > table:nth-child(1) > tbody:nth-child(1) > tr:nth-child(2) > td:nth-child(2)").innerText.replace("小说作者：","").trim(),getIntroDom:e=>document.querySelector("#content > table:nth-child(2) > tbody:nth-child(1) > tr:nth-child(3) > td:nth-child(1) > table:nth-child(1) > tbody:nth-child(1) > tr:nth-child(1) > td:nth-child(2)"),introDomPatch:e=>((0,o.rm)("a",!0,e),(0,o.rm)(".hottext",!0,e),(0,o.vS)(e,["论坛回帖，推荐本书，都可以得积分。每天送50积分"]),e),getCoverUrl:e=>document.querySelector("#content > table:nth-child(2) > tbody:nth-child(1) > tr:nth-child(3) > td:nth-child(1) > table:nth-child(1) > tbody:nth-child(1) > tr:nth-child(1) > td:nth-child(2) > a:nth-child(1) > img:nth-child(1)")?.src,getAList:e=>e.querySelectorAll("div.zjbox ol > li > a"),getSections:e=>e.querySelectorAll("div.zjbox div.ttname > h2"),getSName:e=>e.innerText.trim(),getContent:e=>(e.body.innerHTML=e.body.innerHTML.replace('<script language="javascript">GetFont();<\/script>','<div id="content" class="fonts_mesne">'),e.body.innerHTML=e.body.innerHTML.replace("<center>","</div>"),e.querySelector("#content")),contentPatch:e=>((0,o.rm)("h1",!0,e),(0,o.rm)("div[id^=BookSee]",!0,e),e),cleanDomOptions:{referrerMode:r.n6.custom,customReferer:"http://www.wenku8.net"}})}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{tianyabooks:()=>a});var o=n(12),r=n(42);const a=()=>(0,r.x)({bookUrl:document.location.href,bookname:document.querySelector(".book > h1")?.innerText.replace(/《|》/g,"").trim(),author:document.querySelector(".book > h2 > a").innerText.trim(),introDom:document.querySelector(".description"),introDomPatch:e=>((0,o.rm)("h3",!1,e),e),coverUrl:null,aList:document.querySelectorAll(".book > dl > dd > a"),sections:document.querySelectorAll(".book > dl > dt"),getSName:e=>e.innerText.trim(),getContent:e=>e.querySelector("#main"),contentPatch:e=>((0,o.rm)("div.crumb",!1,e),(0,o.rm)("h1",!1,e),(0,o.rm)('p[align="center"]',!1,e),(0,o.rm)("table",!0,e),e)})},(e,t,n)=>{"use strict";n.r(t),n.d(t,{jingcaiyuedu6:()=>a});var o=n(12),r=n(52);const a=()=>(0,r.x)({bookUrl:document.location.href,anotherPageUrl:document.querySelector("a.red-btn:nth-child(3)").href,getBookname:e=>document.querySelector(".book-info > h1 > em").innerText.trim(),getAuthor:e=>document.querySelector(".book-info > h1 > a").innerText.trim(),getIntroDom:e=>document.querySelector(".book-info > p.intro"),introDomPatch:e=>e,getCoverUrl:e=>document.querySelector(".book-img-cover").src,getAList:e=>e.querySelectorAll("dd.col-md-4 > a"),getContent:e=>e.querySelector("#htmlContent"),contentPatch:e=>((0,o.vS)(e,["精彩小说网最新地址"]),e)})},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Hanwujinian:()=>g});var o=n(23),r=n(19),a=n(36),i=n(21),c=n(12),s=n(35),l=n(5),d=n.n(l),u=n(2),h=n(37),m=n(38),p=n(29);class g extends p.c{constructor(){super(),this.imageMode="TM"}async bookParse(){const e=document.location.href,t=document.querySelector("a.titleText_3").href,n=await(0,i.dL)(t,this.charset),o=document.querySelector("span.titleText_1").innerText.trim(),a=document.querySelector("span.authorText_1").innerText.trim(),c=document.querySelector("#introtext"),[l,p]=await(0,s.SN)(c),g=document.querySelector(".wR_JSAS > img").src,f={};g&&(0,r.CE)(g,this.imageMode,"cover-").then((e=>{f.cover=e})).catch((e=>d().error(e))),f.tags=Array.from(document.querySelectorAll("div.labelBox_1 > span")).map((e=>e?.innerText.trim()));const b=[];let w=0,y=0,v=0,x=null;const T=null!==document.querySelector("#userMeun"),S=n.querySelectorAll('div.wR_JS > div.wR_JC[style*="margin: 30px auto;"]'),A=n.querySelectorAll("div.wR_JS > div.wR_JC > div.wR_JSAC");for(const t of Array.from(A)){const n=t.querySelector("a"),r=n.innerText.trim(),a=n.href;if(0!==S.length){const e=(0,s.$d)(n,S,(e=>e.innerText.trim()));e!==x&&(x=e,y++,v=0)}w++,v++;const i=t.querySelector("img"),c=null!==i,l=!!c&&i.src.includes("lock_2_off.png"),d=new h.W({bookUrl:e,bookname:o,chapterUrl:a,chapterNumber:w,chapterName:r,isVIP:c,isPaid:l,sectionName:x,sectionNumber:y,sectionChapterNumber:v,chapterParse:this.chapterParse,charset:this.charset,options:{bookname:o}});d.isVIP&&(T?!1===d.isPaid&&(d.status=u.qb.aborted):d.status=u.qb.aborted),b.push(d)}const k=new m.f({bookUrl:e,bookname:o,author:a,introduction:l,introductionHTML:p,additionalMetadate:f,chapters:b});return k.ToCUrl=t,k}async chapterParse(e,t,n,r,s,l){const d=await(0,i.dL)(e,s),u=Array.from(d.querySelectorAll("script")).filter((e=>e.innerHTML.includes("var chapterContent")))?.[0],h=(e,t)=>{const n=decodeURI(function(t){const n=e.enc.Latin1.parse("2018122911430000"),o=e.enc.Latin1.parse("048fe2a99140c0e6");return e.AES.decrypt(t,n,{iv:o,padding:e.pad.ZeroPadding}).toString(e.enc.Utf8)}(t)),o=document.createElement("div");return o.innerText=n,o};if(u){const e=u.innerHTML.split("\n").filter((e=>e.includes("var chapterContent")))?.[0],n=new Function("CryptoJS",`${e};return (${h.toString()})(CryptoJS, chapterContent);`)(o);(0,c.vS)(n,["更多优惠快去下载寒武纪年小说APP哦"]),n.innerHTML=n.innerHTML.replaceAll("%3A","："),n.innerHTML=n.innerHTML.replaceAll("++++【","【");const{dom:r,text:i,images:s}=await(0,a.zM)(n,"TM");return{chapterName:t,contentRaw:n,contentText:i,contentHTML:r,contentImages:s,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{MangaBilibili:()=>p});var o=n(19),r=n(21),a=n(1),i=n(22),c=n(5),s=n.n(c),l=n(20),d=n(38),u=n(37),h=n(2),m=n(29);class p extends m.c{constructor(){super(),this.imageMode="naive",this.concurrencyLimit=1,this.streamZip=!0}async bookParse(){const e=/\/mc(\d+)$/.exec(document.location.pathname)?.[1];if(!e)throw new Error("获取 comic_id 失败！");const t=parseInt(e),n=(await async function(e){const t={comic_id:e};return(await fetch("https://manga.bilibili.com/twirp/bookshelf.v1.Bookshelf/HasFavorite?device=pc&platform=web",{headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(t),method:"POST"})).ok}(t),await async function(e){const t={comic_id:e},n={headers:{accept:"application/json, text/plain, */*","content-type":"application/json;charset=UTF-8"},body:JSON.stringify(t),method:"POST"},o=await fetch("https://manga.bilibili.com/twirp/comic.v1.Comic/ComicDetail?device=pc&platform=web",n),r=await o.json();if(0===r.code)return r.data;throw new Error("获取目录失败！")}(t)),r=document.location.href,a=n.title,i=n.author_name.join(", "),c=n.evaluate,l=document.createElement("div");l.innerText=n.evaluate;const m={};(0,o.CE)(n.vertical_cover,this.imageMode,"vertical_cover-").then((e=>{m.cover=e})).catch((e=>s().error(e))),m.tags=n.styles,m.attachments=[],(0,o.CE)(n.horizontal_cover,this.imageMode,"horizontal_cover-").then((e=>{m.attachments?.push(e)})).catch((e=>s().error(e)));const p=n.ep_list.map((e=>{const n=`https://manga.bilibili.com/mc${t}/${e.id}?from=manga_detail`,o=e.ord,i=[e.short_title.trim(),e.title.trim()].join(" "),c=0!==e.pay_gold,s=!c||!e.is_locked,l={comic_id:t,ep_id:e.id},d=new u.W({bookUrl:r,bookname:a,chapterUrl:n,chapterNumber:o,chapterName:i,isVIP:c,isPaid:s,sectionName:null,sectionNumber:null,sectionChapterNumber:null,chapterParse:this.chapterParse,charset:this.charset,options:l});return(e.is_locked||6===e.type)&&(d.status=h.qb.aborted),d}));return new d.f({bookUrl:r,bookname:a,author:i,introduction:c,introductionHTML:l,additionalMetadate:m,chapters:p})}async chapterParse(e,t,n,c,d,u){const m=await async function(e){const t={ep_id:e},n={headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(t),method:"POST",mode:"cors",credentials:"include"},o=await fetch("https://manga.bilibili.com/twirp/comic.v1.Comic/GetImageIndex?device=pc&platform=web",n),r=await o.json();if(0===r.code)return r.data.images.map((e=>e.path));throw new Error(`抓取章节图片索引失败！ ep_id： ${e}, code: ${r.code}, mes: ${r.msg}`)}(u.ep_id),p=[];await(0,a.C1)(m,3,(async t=>{const n=await async function(t){const n=await async function(t){const n={urls:JSON.stringify([t])},o={headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(n),method:"POST",referrer:e},r=await fetch("https://manga.bilibili.com/twirp/comic.v1.Comic/ImageToken?device=pc&platform=web",o),a=await r.json();if(0===a.code)return a.data[0]}(t);if(n){const e=await async function(e){const t=e.url+"?token="+e.token,n={headers:{Accept:"application/json, text/plain, */*"},method:"GET"},a=await(0,r.q4)(t,n),c=await a.blob(),s=["cm-",await(0,i.K)(c),".",(0,o.r6)(c,t)].join(""),d=new l.J(t,s,"naive");return d.imageBlob=c,d.status=h.qb.finished,(0,o.dK)(d),d}(n),a=document.createElement("img");a.setAttribute("data-src-address",e.name),a.alt=e.url;const c=`![${e.url}](${e.name})`;return s().info(`ep_id: ${u.ep_id}, path: ${t} 抓取成功！`),{dom:a,text:c,images:e}}throw new Error("获取图片 "+t+" 失败！")}(t),a={path:t,obj:n};return p.push(a),a})),p.sort(((e,t)=>m.indexOf(e.path)-m.indexOf(t.path)));const g=p.map((e=>e.obj)),f=document.createElement("div");g.forEach((e=>{const t=document.createElement("p");t.appendChild(e.dom),f.appendChild(t)}));const b=g.map((e=>e.text)).join("\n\n"),w=g.map((e=>e.images));return{chapterName:t,contentRaw:f,contentText:b,contentHTML:f,contentImages:w,additionalMetadate:null}}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{aixdzs:()=>r});var o=n(42);const r=()=>(0,o.x)({bookUrl:document.location.href,bookname:document.querySelector(".d_info > h1").innerText.trim(),author:document.querySelector(".d_ac > ul:nth-child(1) > li:nth-child(1) > a:nth-child(2)").innerText.trim(),introDom:document.querySelector(".d_co"),introDomPatch:e=>e,coverUrl:document.querySelector(".d_af > img").src,aList:document.querySelectorAll("#i-chapter li.chapter > a"),sections:document.querySelectorAll("#i-chapter li.volume"),getSName:e=>e.innerText.trim(),getContent:e=>e.querySelector(".content"),contentPatch:e=>e})},(e,t,n)=>{"use strict";n.r(t),n.d(t,{liuxs:()=>a});var o=n(12),r=n(52);const a=()=>(0,r.x)({bookUrl:document.location.href,anotherPageUrl:document.querySelector(".btopt > a").href,getBookname:e=>e.querySelector("div.infot:nth-child(1) > h1:nth-child(1)").innerText.trim(),getAuthor:e=>e.querySelector("div.infot:nth-child(1) > span:nth-child(2)").innerText.replace("作者：","").trim(),getIntroDom:e=>document.querySelector(".intro"),introDomPatch:e=>e,getCoverUrl:e=>document.querySelector(".pic > img").src,getAList:e=>e.querySelectorAll("#defaulthtml4 > table > tbody  div > a"),getSections:e=>e.querySelectorAll(".j_title > b"),getSName:e=>e.innerText.trim(),postHook:e=>{const t=e.bookname;return e.sectionName&&(e.sectionName=e.sectionName.replace(`《${t}》`,"")),e},getContent:e=>e.querySelector("#content"),contentPatch:e=>((0,o.vS)(e,["--＆网--网"]),e)})},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Cool18:()=>l});var o=n(36),r=n(12),a=n(21),i=n(38),c=n(37),s=n(29);class l extends s.c{constructor(){super(),this.imageMode="TM",this.nsfw=!0}async bookParse(){const e=document.location.href,t=(await(0,a.dL)(e,this.charset)).querySelector('.show_content > center > font[size="6"] > b').innerText.trim(),n=/[【《](.+)[】》](.+)?作者：([^\s-]+)/.exec(t);let o=t,r="";n&&(o=n[1],r=n[3]);const s=Array.from(document.querySelectorAll(".show_content > pre a, body > table:nth-child(7) > tbody:nth-child(1) > tr:nth-child(1) > td:nth-child(1) > ul:nth-child(2) > li > a")),l=document.createElement("a");l.href=document.location.href,l.innerText=t,s.push(l);const d=s.filter((e=>{const t=e.href,n=new URL(t);return"threadview"===n.searchParams.get("act")&&n.searchParams.has("tid")})).filter((e=>!1===e.innerText.includes("(无内容)"))).filter(((e,t,n)=>{const o=n.map((e=>e.href)),r=e.href;return o.indexOf(r)===t})).sort(((e,t)=>{const n=new URL(e.href).searchParams.get("tid"),o=new URL(t.href).searchParams.get("tid");return parseInt(n)-parseInt(o)})).map((t=>{const n=t.href,a=t.innerText.replace(`【${o}】`,"").replace(`《${o}》`,"").replace(`作者：${r}`,"").trim();return new c.W({bookUrl:e,bookname:o,chapterUrl:n,chapterNumber:-1,chapterName:a,isVIP:!1,isPaid:!1,sectionName:null,sectionNumber:null,sectionChapterNumber:null,chapterParse:this.chapterParse,charset:this.charset,options:{bookname:o,author:r}})}));let u=0;for(const e of d)u++,e.chapterNumber=u;return new i.f({bookUrl:e,bookname:o,author:r,introduction:null,introductionHTML:null,additionalMetadate:{},chapters:d})}async chapterParse(e,t,n,i,c,s){const l=await(0,a.dL)(e,c);t=l.querySelector('.show_content > center > font[size="6"] > b').innerText.replace(`【${s.bookname}】`,"").replace(`《${s.bookname}》`,"").replace(`作者：${s.author}`,"").trim();const d=l.querySelector(".show_content > pre, .show_content > div");if(d){Array.from(d.querySelectorAll('font[color*="E6E6DD"]')).forEach((e=>e.remove()));const e=document.createElement("div"),n=Array.from(d.childNodes);if(n.length>10)(0,r.vR)(d,e),(0,r.rm)("a",!0,e),(0,o.FZ)(e);else{for(const t of n){if(t instanceof Text&&(t.textContent?.length??0)>200){if((0,o.Kg)(t)){e.appendChild((0,o.d1)(t));continue}{const n=document.createElement("div");n.innerText=t.textContent?.trim()??"",e.appendChild(n);continue}}e.appendChild(t)}Array.from(e.querySelectorAll("p")).filter((e=>""===e.innerText.trim()&&(0,r.U)(e)instanceof HTMLElement&&(0,r.d9)(e)instanceof HTMLElement)).forEach((e=>e.remove()))}const{dom:a,text:i,images:c}=await(0,o.zM)(e,"TM");return{chapterName:t,contentRaw:e,contentText:i,contentHTML:a,contentImages:c,additionalMetadate:null}}return{chapterName:t,contentRaw:null,contentText:null,contentHTML:null,contentImages:null,additionalMetadate:null}}}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{dushu369:()=>r});var o=n(42);const r=()=>{const e=document.querySelector(".cntitle"),[t,n]=/(.+)《(.+)》/.exec(e.innerText.trim())?.slice(1)??["",e.innerText.trim()];return(0,o.x)({bookUrl:document.location.href,bookname:n,author:t,introDom:document.querySelector(".Readme"),introDomPatch:e=>e,aList:document.querySelectorAll(".content a.a0"),getContent:e=>e.querySelector(".content"),contentPatch:e=>e})}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{c18kanshu:()=>a});var o=n(36),r=n(52);const a=()=>(0,r.x)({bookUrl:document.location.href,anotherPageUrl:document.querySelector("div.menu_more_black > a").href,getBookname:e=>document.querySelector(".in_textone").innerText.trim(),getAuthor:e=>{const t=document.querySelector("div.in_texttwo:nth-child(2)");return/作者：(.+)$/.exec(t.innerText.trim())?.[1]??""},getIntroDom:e=>document.querySelector(".janjie"),introDomPatch:e=>e,getCoverUrl:e=>document.querySelector(".book_top > div.img > img").src,getAList:e=>{const t=e.querySelectorAll("div.list_main.book_list");return Array.from(t).reduce(((e,t)=>{const n=t.getAttribute("onclick"),o=n?.substring(n.indexOf("'")+1,n.lastIndexOf("'"))??"",r=document.createElement("a");return r.href=o,r.innerHTML=t.innerHTML.trim(),e.push(r),e}),[])},getContent:e=>e.querySelector(".readcontent"),contentPatch:e=>(Array.from(e.childNodes).filter((e=>e instanceof Text)).forEach((e=>{e.textContent?.includes("　　")&&e.parentNode?.insertBefore(document.createElement("br"),e)})),(0,o.Kg)(e)&&(0,o.FZ)(e),e),nsfw:!0})},(e,t,n)=>{"use strict";n.r(t),n.d(t,{xiaoshuowu:()=>a});var o=n(12),r=n(52);const a=()=>{const e=document.location.href,t=e.substring(e.lastIndexOf("/",e.lastIndexOf("/")-1)+1,e.lastIndexOf("/")),n=document.location.origin+`/book/${t}/`;return(0,r.x)({bookUrl:n,ToCUrl:document.location.href,anotherPageUrl:n,getBookname:e=>e.querySelector("div.divbox:nth-child(2) > div:nth-child(2) > div:nth-child(1) > span:nth-child(1)").innerText.trim(),getAuthor:e=>e.querySelector("div.divbox:nth-child(2) > div:nth-child(2) > div:nth-child(1) > span:nth-child(2) > a").innerText.trim(),getIntroDom:e=>e.querySelector("div.tabvalue:nth-child(1) > div:nth-child(1)"),introDomPatch:e=>e,getCoverUrl:e=>e.querySelector("div.divbox:nth-child(2) > div:nth-child(1) > a:nth-child(1) > img").src,getAList:e=>document.querySelectorAll("li.chapter > a"),getSections:e=>document.querySelectorAll(".volume"),getSName:e=>e.innerText.trim(),postHook:e=>(e.sectionName&&(e.sectionName=e.sectionName.replace(e.bookname,"")),e),getContent:e=>e.querySelector("#acontent"),contentPatch:e=>((0,o.rm)("div[align]",!0,e),(0,o.rm)(".tishi",!0,e),(0,o.rm)("h1",!1,e),(0,o.up)(["(小说屋 www.xiaoshuowu.com)","小说屋 www.xiaoshuowu.com"],e),e),concurrencyLimit:1})}},(e,t,n)=>{"use strict";n.r(t),n.d(t,{Xrzww:()=>u});var o=n(5),r=n.n(o),a=n(19),i=n(38),c=n(29),s=n(37),l=n(2),d=n(36);class u extends c.c{constructor(){super(),this.imageMode="TM",this.concurrencyLimit=1}async bookParse(){const e=document.location.href,t=e.substring(e.lastIndexOf("/")+1),n="https://pre-api.xrzww.com",o=localStorage.getItem("token")?localStorage.getItem("token"):"",c={Accept:"application/json, text/plain, */*",Authorization:`Bearer ${o}`,Site:1..toString()},d=""!==o,u=new URL(`${n}/api/webNovelDetail`);u.searchParams.set("novel_id",t);const h=await fetch(u.href,{credentials:"include",headers:{"Cache-Control":"max-age=0",...c},method:"GET",mode:"cors"}),m=await h.json();if(200!==m.code)throw new Error("获取书籍信息出错！");const p=m.data.novel_name,g=m.data.novel_author,f=m.data.novel_info,b=document.createElement("div");b.innerText=f;const w={},y=`https://oss.xrzww.com${m.data.novel_cover}`;(0,a.CE)(y,this.imageMode,"cover-").then((e=>{w.cover=e})).catch((e=>r().error(e))),w.tags=m.data.novel_tags.split(",").map((e=>e.trim())),w.tags.push(m.data.type_name),w.lastModified=m.data.novel_uptime;const v=new URL(`${n}/api/directoryList`);v.searchParams.set("nid",t),v.searchParams.set("orderBy","0");const x=await fetch(v.href,{credentials:"include",headers:c,method:"GET",mode:"cors"}),T=await x.json();if(200!==T.code)throw new Error("获取目录信息失败！");const S=T.data.volume.reduce(((e,t)=>(e[t.volume_id]={name:t.volume_name,order:t.volume_order,desc:t.volume_desc},e)),{}),A=[];let k,N=0,M=0,C=0;for(const t of T.data.data){N++;const o="",r=t.chapter_name,a=N,i=1===t.chapter_ispay,u=1===t.is_subscribe,h=S[t.chapter_vid].name;k!==h&&(k=h,M++,C=0);const m=M;C++;const g=C,f={nid:t.chapter_nid,vid:t.chapter_vid,chapter_id:t.chapter_id,chapter_order:t.chapter_order,apiBase:n,headers:c},b=new s.W({bookUrl:e,bookname:p,chapterUrl:o,chapterNumber:a,chapterName:r,isVIP:i,isPaid:u,sectionName:h,sectionNumber:m,sectionChapterNumber:g,chapterParse:this.chapterParse,charset:this.charset,options:f});d?b.isVIP&&!1===b.isPaid&&(b.status=l.qb.aborted):b.isVIP&&(b.status=l.qb.aborted),A.push(b)}return new i.f({bookUrl:e,bookname:p,author:g,introduction:f,introductionHTML:b,additionalMetadate:w,chapters:A})}async chapterParse(e,t,n,o,r,a){const i=new URL(`${a.apiBase}/api/readNew`);i.searchParams.set("nid",a.nid.toString()),i.searchParams.set("vid",a.vid.toString()),i.searchParams.set("chapter_id",a.chapter_id.toString()),i.searchParams.set("chapter_order",a.chapter_order.toString()),i.searchParams.set("showpic",(!1).toString()),i.searchParams.set("is_cut","");const c=await fetch(i.href,{credentials:"include",headers:a.headers,method:"GET",mode:"cors"}),s=await c.json();if(200!==s.code)throw new Error("获取章节内容失败！ "+JSON.stringify(a));const l=document.createElement("p");l.innerText=s.data.content;const{dom:u,text:h,images:m}=await(0,d.zM)(l,"TM");return{chapterName:t,contentRaw:l,contentText:h,contentHTML:u,contentImages:m,additionalMetadate:{lastModified:s.data.chapter_uptime}}}}}],t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var a=t[o]={id:o,exports:{}};return e[o].call(a.exports,a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e=n(27),t=n(4),o=n(1),r=n(5),a=n.n(r),i=n(6);globalThis.Function=new Proxy(Function,{construct(e,t){const n=t[t.length-1];return n.includes("Vue")&&n.includes("_Vue")?(a().debug("Function hook:"+n),t[t.length-1]="with (Vue) {"+n+"}",new Proxy(new e(...["Vue",...t]),{apply(e,t,n){const o=[i,...n];return Reflect.apply(e,t,o)}})):new e(...t)}});var c=n(12),s=n(3);async function l(){const e=document.location.host;let t;switch(e){case"www.ciweimao.com":{const{Ciweimao:e}=await Promise.resolve().then(n.bind(n,28));t=e;break}case"www.uukanshu.com":{const{Uukanshu:e}=await Promise.resolve().then(n.bind(n,39));t=e;break}case"www.yruan.com":{const{yruan:e}=await Promise.resolve().then(n.bind(n,40));t=e();break}case"www.shuquge.com":case"www.sizhicn.com":{const{shuquge:e}=await Promise.resolve().then(n.bind(n,43));t=e();break}case"www.dingdiann.net":{const{dingdiann:e}=await Promise.resolve().then(n.bind(n,44));t=e();break}case"www.biquge66.com":case"www.lewenn.com":case"www.klxs.la":case"www.xkzw.org":{const{Xkzw:e}=await Promise.resolve().then(n.bind(n,45));t=e;break}case"www.266ks.com":{const{c226ks:e}=await Promise.resolve().then(n.bind(n,46));t=e();break}case"book.sfacg.com":{const{Sfacg:e}=await Promise.resolve().then(n.bind(n,48));t=e;break}case"www.hetushu.com":case"hetushu.com":{const{Hetushu:e}=await Promise.resolve().then(n.bind(n,49));t=e;break}case"www.shouda88.com":{const{shouda8:e}=await Promise.resolve().then(n.bind(n,50));t=e();break}case"www.gebiqu.com":{const{gebiqu:e}=await Promise.resolve().then(n.bind(n,40));t=e();break}case"www.viviyzw.com":{const{viviyzw:e}=await Promise.resolve().then(n.bind(n,51));t=e();break}case"www.1pwx.com":{const{xiaoshuodaquan:e}=await Promise.resolve().then(n.bind(n,53));t=e();break}case"book.qidian.com":{const{Qidian:e}=await Promise.resolve().then(n.bind(n,54));t=e;break}case"www.jjwxc.net":{const{Jjwxc:e}=await Promise.resolve().then(n.bind(n,55));t=e;break}case"www.81book.com":case"www.81zw.com":case"www.fuguoduxs.com":case"www.shubaowa.org":case"www.bz01.org":case"www.aixiawx.com":case"www.banzhuer.org":case"www.biquwoo.com":case"www.biquwo.org":case"www.hongyeshuzhai.com":{const{common:e}=await Promise.resolve().then(n.bind(n,40));t=e();break}case"book.zongheng.com":case"huayu.zongheng.com":{const{Zongheng:e}=await Promise.resolve().then(n.bind(n,56));t=e;break}case"www.17k.com":{const{C17k:e}=await Promise.resolve().then(n.bind(n,57));t=e;break}case"www.shuhai.com":case"mm.shuhai.com":{const{Shuhai:e}=await Promise.resolve().then(n.bind(n,58));t=e;break}case"www.gongzicp.com":case"gongzicp.com":{const{Gongzicp:e}=await Promise.resolve().then(n.bind(n,59));t=e;break}case"www.linovel.net":{const{Linovel:e}=await Promise.resolve().then(n.bind(n,60));t=e;break}case"www.xinwanben.com":{const{xinwanben:e}=await Promise.resolve().then(n.bind(n,44));t=e();break}case"www.tadu.com":{const{Tadu:e}=await Promise.resolve().then(n.bind(n,61));t=e;break}case"www.idejian.com":{const{Idejian:e}=await Promise.resolve().then(n.bind(n,62));t=e;break}case"www.qimao.com":{const{Qimao:e}=await Promise.resolve().then(n.bind(n,63));t=e;break}case"www.wenku8.net":{const{Wenku8:e}=await Promise.resolve().then(n.bind(n,64));t=e;break}case"manhua.dmzj.com":case"www.dmzj.com":{const{Dmzj:e}=await Promise.resolve().then(n.bind(n,65));t=e;break}case"sosad.fun":case"www.sosad.fun":case"wenzhan.org":case"www.wenzhan.org":case"sosadfun.com":case"www.sosadfun.com":case"xn--pxtr7m5ny.com":case"www.xn--pxtr7m5ny.com":case"xn--pxtr7m.com":case"www.xn--pxtr7m.com":case"xn--pxtr7m5ny.net":case"www.xn--pxtr7m5ny.net":case"xn--pxtr7m.net":case"www.xn--pxtr7m.net":case"sosadfun.link":case"www.sosadfun.link":{const{Sosadfun:e}=await Promise.resolve().then(n.bind(n,66));t=e;break}case"www.westnovel.com":{const{westnovel:e}=await Promise.resolve().then(n.bind(n,67));t=e();break}case"www.mht99.com":{const{mht:e}=await Promise.resolve().then(n.bind(n,44));t=e();break}case"www.xbiquge.so":{const{xbiquge:e}=await Promise.resolve().then(n.bind(n,40));t=e();break}case"www.linovelib.com":{const{Linovelib:e}=await Promise.resolve().then(n.bind(n,68));t=e;break}case"www.luoqiuzw.com":{const{luoqiuzw:e}=await Promise.resolve().then(n.bind(n,40));t=e();break}case"www.yibige.cc":{const{yibige:e}=await Promise.resolve().then(n.bind(n,69));t=e();break}case"www.fushuwang.org":{const{Fushuwang:e}=await Promise.resolve().then(n.bind(n,70));t=e;break}case"www.soxscc.net":case"www.soxscc.org":case"www.soxs.cc":case"www.soshuw.com":case"www.soshuwu.org":case"www.soxscc.cc":case"www.soshuwu.com":case"www.kubiji.net":{const{Soxscc:e}=await Promise.resolve().then(n.bind(n,71));t=e;break}case"www.xyqxs.cc":{const{xyqxs:e}=await Promise.resolve().then(n.bind(n,43));t=e();break}case"www.630shu.net":{const{c630shu:e}=await Promise.resolve().then(n.bind(n,72));t=e;break}case"www.qingoo.cn":{const{Qingoo:e}=await Promise.resolve().then(n.bind(n,73));t=e;break}case"www.trxs.cc":case"www.trxs123.com":case"www.jpxs123.com":case"trxs.cc":case"trxs123.com":case"jpxs123.com":{const{trxs:e}=await Promise.resolve().then(n.bind(n,74));t=e();break}case"www.tongrenquan.org":case"www.tongrenquan.me":case"tongrenquan.me":case"tongrenquan.org":{const{tongrenquan:e}=await Promise.resolve().then(n.bind(n,74));t=e();break}case"www.imiaobige.com":{const{imiaobige:e}=await Promise.resolve().then(n.bind(n,75));t=e();break}case"www.256wxc.com":case"www.256wenku.com":{const{c256wxc:e}=await Promise.resolve().then(n.bind(n,76));t=e;break}case function(t){if(/lofter\.com$/.test(e))return e}():{const{Lofter:e}=await Promise.resolve().then(n.bind(n,77));t=e;break}case"www.lwxs9.org":{const{lwxs9:e}=await Promise.resolve().then(n.bind(n,40));t=e();break}case"www.shubl.com":{const{Shubl:e}=await Promise.resolve().then(n.bind(n,78));t=e;break}case"www.ujxs.net":{const{ujxs:e}=await Promise.resolve().then(n.bind(n,79));t=e();break}case"m.haitangtxt.net":{const{haitangtxt:e}=await Promise.resolve().then(n.bind(n,80));t=e();break}case"m.yuzhaige.cc":case"m.yushuge123.com":{const{yuzhaige:e}=await Promise.resolve().then(n.bind(n,80));t=e();break}case"ebook.longmabook.com":case"www.longmabookcn.com":case"ebook.lmbooks.com":case"www.lmebooks.com":case"www.haitbook.com":case"www.htwhbook.com":case"www.myhtebook.com":case"www.lovehtbooks.com":case"www.myhtebooks.com":case"www.myhtlmebook.com":case"jp.myhtebook.com":case"jp.myhtlmebook.com":case"ebook.urhtbooks.com":case"www.urhtbooks.com":case"www.newhtbook.com":case"www.lvhtebook.com":case"jp.lvhtebook.com":case"www.htlvbooks.com":{const{Longmabook:e}=await Promise.resolve().then(n.bind(n,81));t=e;break}case"dijiubook.net":{const{dijiubook:e}=await Promise.resolve().then(n.bind(n,40));t=e();break}case"www.biquwx.la":{const{biquwx:e}=await Promise.resolve().then(n.bind(n,40));t=e();break}case"www.25zw.com":{const{c25zw:e}=await Promise.resolve().then(n.bind(n,40));t=e();break}case"www.tycqxs.com":{const{tycqxs:e}=await Promise.resolve().then(n.bind(n,40));t=e();break}case"www.kanunu8.com":{const{Kanunu8:e}=await Promise.resolve().then(n.bind(n,82));t=e;break}case"www.ciyuanji.com":{const{Ciyuanji:e}=await Promise.resolve().then(n.bind(n,87));t=e;break}case"www.wanben.org":{const{wanben:e}=await Promise.resolve().then(n.bind(n,88));t=e();break}case"m.wanben.org":{const{wanben:e}=await Promise.resolve().then(n.bind(n,89));t=e();break}case"www.ranwen.la":{const{ranwen:e}=await Promise.resolve().then(n.bind(n,40));t=e();break}case"www.washuge.com":{const{washuge:e}=await Promise.resolve().then(n.bind(n,90));t=e();break}case"m.baihexs.com":{const{baihexs:e}=await Promise.resolve().then(n.bind(n,91));t=e();break}case"www.quanshuzhai.com":{const{quanshuzhai:e}=await Promise.resolve().then(n.bind(n,92));t=e();break}case"masiro.me":{const{masiro:e}=await Promise.resolve().then(n.bind(n,93));t=e();break}case"www.pixiv.net":{const{Pixiv:e}=await Promise.resolve().then(n.bind(n,94));t=e;break}case"kakuyomu.jp":{const{kakuyomu:e}=await Promise.resolve().then(n.bind(n,95));t=e();break}case"ncode.syosetu.com":case"novel18.syosetu.com":{const{syosetu:e}=await Promise.resolve().then(n.bind(n,96));t=e();break}case"syosetu.org":{const{syosetuOrg:e}=await Promise.resolve().then(n.bind(n,96));t=e();break}case"zhaoze.art":case"houhuayuan.xyz":{const{houhuayuan:e}=await Promise.resolve().then(n.bind(n,97));t=e();break}case"www.myrics.com":{const{Myrics:e}=await Promise.resolve().then(n.bind(n,98));t=e;break}case"www.lstxt.cc":{const{lusetxt:e}=await Promise.resolve().then(n.bind(n,43));t=e();break}case"www.a7xs.com":{const{a7xs:e}=await Promise.resolve().then(n.bind(n,99));t=e();break}case"www.shencou.com":{const{shencou:e}=await Promise.resolve().then(n.bind(n,100));t=e();break}case"www.tianyabooks.com":{const{tianyabooks:e}=await Promise.resolve().then(n.bind(n,101));t=e();break}case"jingcaiyuedu6.com":{const{jingcaiyuedu6:e}=await Promise.resolve().then(n.bind(n,102));t=e();break}case"www.hanwujinian.com":{const{Hanwujinian:e}=await Promise.resolve().then(n.bind(n,103));t=e;break}case"www.biqu55.com":{const{biqu55:e}=await Promise.resolve().then(n.bind(n,44));t=e();break}case"manga.bilibili.com":{const{MangaBilibili:e}=await Promise.resolve().then(n.bind(n,104));t=e;break}case"www.aixdzs.com":{const{aixdzs:e}=await Promise.resolve().then(n.bind(n,105));t=e();break}case"www.liuxs.la":{const{liuxs:e}=await Promise.resolve().then(n.bind(n,106));t=e();break}case"www.cool18.com":{const{Cool18:e}=await Promise.resolve().then(n.bind(n,107));t=e;break}case"www.b5200.net":{const{b5200:e}=await Promise.resolve().then(n.bind(n,40));t=e();break}case"www.yqxs.cc":{const{yqxs:e}=await Promise.resolve().then(n.bind(n,43));t=e();break}case"www.dushu369.com":{const{dushu369:e}=await Promise.resolve().then(n.bind(n,108));t=e();break}case"www.18kanshu.com":{const{c18kanshu:e}=await Promise.resolve().then(n.bind(n,109));t=e();break}case"www.bxwx333.org":{const{bxwx333:e}=await Promise.resolve().then(n.bind(n,40));t=e();break}case"www.xiaoshuowu.com":{const{xiaoshuowu:e}=await Promise.resolve().then(n.bind(n,110));t=e();break}case"www.xrzww.com":{const{Xrzww:e}=await Promise.resolve().then(n.bind(n,111));t=e;break}default:throw new Error("Not Found Rule!")}return new t}const d={type:"download"},u={type:"error"};var h=n(16),m=n(7),p=n(15),g=n(2),f=n(11),b=n(10);const w=(0,c.wj)(b.Z),y=(0,i.defineComponent)({name:"ChapterList",setup(){const e=(0,i.reactive)([]),t=(0,i.ref)(!0),n=(0,i.ref)(!1);(0,i.onMounted)((async()=>{if(0===e.length)try{const n=await async function(){if(window._sections&&window._url===document.location.href)return window._sections;{const e=await l(),t=await e.bookParse();return window._book=t,window._url=document.location.href,unsafeWindow.saveOptions?.chapterSort?window._sections=(0,f.f)(t.chapters,unsafeWindow.saveOptions?.chapterSort):window._sections=(0,f.f)(t.chapters),window._sections}}();Object.assign(e,n),t.value=!1}catch(e){a().error(e),n.value=!0}}));const o=(0,i.inject)("filterSetting"),r=e=>{if(e.status===g.qb.aborted)return!1;if(o.value){const t=T(o.value.arg,o.value.functionBody);if("function"==typeof t)return t(e)}return!0},c=e=>!o.value.hiddenBad||!1!==r(e);return{sectionsObj:e,loading:t,failed:n,filter:r,warningFilter:e=>!0===e.isVIP&&!0!==e.isPaid,isChapterDisabled:e=>!e?.chapterUrl,isChapterSeen:c,isSectionSeen:e=>e.chpaters.some((e=>!0===c(e)))}},template:'<div> <div v-if="loading"> <div class="chapter-list-loading"> <h2 v-if="failed">加载章节失败！</h2> <h2 v-else>正在载入章节列表中，请耐心等待……</h2> </div> </div> <div class="chapter-list" v-else> <div v-for="sectionObj in sectionsObj" v-show="isSectionSeen(sectionObj)" v-bind:key="sectionObj.sectionNumber" class="section"> <h3 class="section-label" v-if="sectionObj.sectionName"> {{ sectionObj.sectionName }} </h3> <div v-for="chapter in sectionObj.chpaters" v-show="isChapterSeen(chapter)" v-bind:key="chapter.chapterNumber" class="chapter" v-bind:class="{\n              good: this.filter(chapter),\n              bad: !this.filter(chapter),\n              warning: this.warningFilter(chapter)\n            }" v-bind:title="chapter.chapterNumber"> <a v-bind:href="chapter.chapterUrl" v-bind:class="{\n                disabled: this.isChapterDisabled(chapter),\n              }" target="_blank" rel="noopener noreferrer">{{ chapter.chapterName }}</a> </div> </div> </div> </div> '});var v=n(13);const x={null:{raw:()=>()=>!0,description:"<p>不应用任何过滤器（默认）</p>",abbreviation:"无"},number:{raw:e=>{if(/^[\s\d\-,，]+$/.test(e))return t=>{const n=t.chapterNumber;return e.split(/,|，/).map((e=>e.replace(/\s/g,"").trim())).map((e=>function(e,t){switch(!0){case/^\d+$/.test(e):{const n=e.match(/^(\d+)$/);return 2===n?.length&&parseInt(n[1])===t}case/^\d+-\d+$/.test(e):{const n=e.match(/^(\d+)-(\d+)$/);if(3===n?.length){const e=n.map((e=>Number(e)));if(t>=e[1]&&t<=e[2])return!0}return!1}case/^\d+-$/.test(e):{const n=e.match(/^(\d+)-$/);return 2===n?.length&&t>=parseInt(n[1])}case/^-\d+$/.test(e):{const n=e.match(/^-(\d+)$/);return 2===n?.length&&t<=parseInt(n[1])}default:return!1}}(e,n))).some((e=>!0===e))}},description:"<p>基于章节序号过滤，章节序号可通过章节标题悬停查看。</p><p>支持以下格式：13, 1-5, 2-, -89。可通过分号（,）使用多个表达式。</p>",abbreviation:"章节序号"},baseOnString:{raw:e=>t=>t&&t.chapterName?.includes(e)||!1,description:"<p>过滤出所有包含过滤条件字符的章节</p>",abbreviation:"章节标题"}};function T(e,t){const n=new Function("arg",t)(e);return"function"==typeof n?n:void 0}const S=(0,i.defineComponent)({components:{"chapter-list":y},emits:["filterupdate"],setup(e,{emit:t}){const n=(0,i.ref)(""),o=(0,i.ref)(!0),r=(0,i.ref)("null"),a=Object.entries(x),c=(0,i.computed)((()=>`return (${x[r.value].raw.toString()})(arg)`)),s=(0,i.computed)((()=>x[r.value].description)),l=(0,i.computed)((()=>({arg:n.value,hiddenBad:o.value,filterType:r.value,functionBody:c.value})));(0,i.provide)("filterSetting",l),(0,i.watch)(l,(()=>{t("filterupdate",l.value)}),{deep:!0});const d=(0,i.inject)("getFilterSetting");return(0,i.onMounted)((()=>{const e=d();e&&(n.value=e.arg,o.value=e.hiddenBad,r.value=e.filterType)})),{arg:n,hiddenBad:o,filterType:r,filterOptionList:a,filterDescription:s}},template:'<div> <div class="filter-setting"> <div v-if="filterType !== \'null\'" class="filter-input"> <p>请输入过滤的条件：<input type="text" v-model="arg"/></p> </div> <div class="filter-setter"> <div> <span>当前过滤方法：</span> <select v-model="filterType"> <option v-for="filterOption in filterOptionList" v-bind:value="filterOption[0]"> {{ filterOption[1]["abbreviation"] }} </option> </select> </div> <input type="checkbox" id="hiddenBad" v-model="hiddenBad"/> <label for="hiddenBad">只显示符合条件章节</label> <div class="filter-description" v-html="filterDescription"></div> <div v-if="false"> <span class="good"></span> <span class="warning"></span> <span class="bad"></span> </div> </div> </div> <chapter-list/> </div> '}),A=(0,c.wj)(v.Z);var k=n(14);const N=(0,i.defineComponent)({name:"LogUI",setup(e,t){const n=(0,i.ref)("");let o;return(0,i.onMounted)((()=>{n.value=(0,k.mZ)(),o=globalThis.requestAnimationFrame((function e(){n.value=(0,k.mZ)(),o=globalThis.requestAnimationFrame(e)}))})),(0,i.onUnmounted)((()=>{o&&globalThis.cancelAnimationFrame(o)})),{logText:n}},template:'<div class="log"><pre v-html="logText" id="novel-downloader-log"></per></div>'});var M=n(17),C=n(19),E=n(18);const P=(0,i.defineComponent)({name:"TestUI",setup(){const e=(0,i.reactive)({}),t=(0,i.reactive)({}),n=(0,i.reactive)({}),r=(0,i.ref)(-99);function a(e){const t=(0,C.gc)(e);if(t?.imageBlob){const e=t.imageBlob;return URL.createObjectURL(e)}return""}return(0,i.watch)(r,((t,o)=>{"string"==typeof t&&(t=parseInt(t,10)),"string"==typeof o&&(o=parseInt(o,10)),o!==t&&-99!==t&&async function(t){const o=e.chapters.filter((e=>e.chapterNumber===t))[0];o&&(o.status===g.qb.pending?(await o.init(),Object.assign(n,o)):Object.assign(n,o))}(t)})),(0,i.onMounted)((async()=>{const n=await async function(){for(;;)if(await(0,o._v)(500),window._book)return window._book}();Object.assign(e,n);const i=n?.additionalMetadate?.cover?.url??"",c={封面:[i?a(i):"",i],题名:n?.bookname??"None",作者:n?.author??"None",网址:n?.bookUrl,简介:n?.introductionHTML??""};Object.assign(t,c);const s=function(){if(e){const t=e.chapters.filter((e=>e.status!==g.qb.aborted)).map((e=>e.chapterNumber));return t.sort(),t.slice(-3)[0]}}();s&&(r.value=s)})),{metaData:t,getData:function(e,t){return"封面"===e?`<img src="${t[0]}" alt="${t[1]}">`:"简介"===e&&t instanceof HTMLElement?t.outerHTML:"网址"===e&&"string"==typeof t?`<a href="${t}">${t}</a>`:t},chapter:n,isSeenChapter:function(e){return e.status===g.qb.finished},isChapterFailed:function(e){return e.status===g.qb.failed||e.status===g.qb.aborted},getChapterHtml:function(e){const t=e.contentHTML?.querySelectorAll("img");return t&&Array.from(t).forEach((e=>{const t=e.alt;e.src=a(t)})),e.contentHTML?.outerHTML},chapterNumber:r}},template:'<div> <div id="test-page-div"> <h2>元数据</h2> <table> <tbody> <tr v-for="(value, key) in metaData"> <td>{{ key }}</td> <td v-html="getData(key, value)"></td> </tr> </tbody> </table> <hr class="hr-edge-weak"/> <h2>章节测试</h2> <div class="preview-chapter-setting"> <label for="chapterNumber">预览章节序号：</label> <input type="text" id="chapterNumber" v-model="chapterNumber"/> </div> <div v-if="this.isSeenChapter(chapter)"> <h4> <a v-bind:href="chapter.chapterUrl" target="_blank" rel="noopener noreferrer">{{ chapter.chapterName }}</a> </h4> <div class="chapter" v-html="getChapterHtml(chapter)"></div> </div> <div v-else> <p v-if="this.isChapterFailed(chapter)">章节加载失败！</p> <p v-else>正在加载章节中……</p> </div> </div> </div> '}),q=(0,c.wj)(E.Z),L=(0,c.wj)(M.Z),_=(0,c.ut)('<div id="setting"></div>'),U=(0,i.createApp)({name:"nd-setting",components:{"filter-tab":S,"log-ui":N,"test-ui":P},setup(){const e=(0,i.reactive)({});let t={};const r=[{key:"null",value:"不使用自定义保存参数",options:{}},{key:"chapter_name",value:"将章节名称格式修改为 第xx章 xxxx",options:{getchapterName:e=>e.chapterName?`第${e.chapterNumber.toString()}章 ${e.chapterName}`:`第${e.chapterNumber.toString()}章`}},{key:"txt_space",value:"txt文档每个自然段前加两个空格",options:{genChapterText:(e,t)=>`## ${e}\n\n${t=t.split("\n").map((e=>""===e.trim()?e:e.replace(/^/,"    "))).join("\n")}\n\n`}},{key:"reverse_chapters",value:"保存章节时倒序排列",options:{chapterSort:(e,t)=>e.chapterNumber>t.chapterNumber?-1:e.chapterNumber===t.chapterNumber?0:e.chapterNumber<t.chapterNumber?1:0}}];e.enableDebug=h.Cy.value,e.chooseSaveOption="null",e.enableTestPage=!1,e.currentTab="tab-1",(0,i.provide)("getFilterSetting",(()=>e.filterSetting?e.filterSetting:void 0));const c=(0,i.ref)("false"),s=n=>{!0===n?t=(0,o.X8)(e):Object.assign(e,t),c.value="false"};return{openStatus:c,openSetting:()=>{t=(0,o.X8)(e),c.value="true"},closeSetting:s,closeAndSaveSetting:async()=>{var t;s(!0),await(0,o._v)(30),"boolean"==typeof(t=(0,o.X8)(e)).enableDebug&&(t.enableDebug?a().setLevel("trace"):a().setLevel("info"),h.Cy.value=t.enableDebug,t.enableDebug&&async function(){const e=await l();let t;t=void 0!==window._book?window._book:await e.bookParse(),unsafeWindow.rule=e,unsafeWindow.book=t,window._book=t,unsafeWindow.saveAs=p.saveAs;const{parse:o,fetchAndParse:r,gfetchAndParse:a}=await Promise.resolve().then(n.bind(n,83)),i={parse:o,fetchAndParse:r,gfetchAndParse:a};unsafeWindow.readability=i,unsafeWindow.stopController=window.stopController}(),a().info(`[Init]enableDebug: ${h.Cy.value}`)),unsafeWindow.saveOptions=(()=>{const t=r.find((t=>t.key===e.chooseSaveOption));return t?t.options:r[0].options})(),function(){if(t.filterSetting)if("null"===t.filterSetting.filterType)unsafeWindow.chapterFilter=void 0;else{const e=T(t.filterSetting.arg,t.filterSetting.functionBody);if(e){const t=t=>t.status!==g.qb.aborted&&e(t);unsafeWindow.chapterFilter=t}}}(),a().info("[Init]自定义设置："+JSON.stringify(e))},saveFilter:t=>{e.filterSetting=(0,o.X8)(t)},setting:e,saveOptions:r}},template:'<div> <dialog-ui dialog-title="设置" v-bind:status="openStatus" v-on:dialogclose="closeSetting" v-if="openStatus === \'true\'"> <div class="nd-setting"> <div class="nd-setting-tab"> <button v-bind:class="[\'tab-button\', { active: setting.currentTab === \'tab-1\'}]" v-on:click="setting.currentTab = \'tab-1\'"> 基本设置 </button> <button v-bind:class="[\'tab-button\', { active: setting.currentTab === \'tab-2\'}]" v-on:click="setting.currentTab = \'tab-2\'"> 自定义筛选条件 </button> <button v-if="setting.enableTestPage" v-bind:class="[\'tab-button\', { active: setting.currentTab === \'tab-3\'}]" v-on:click="setting.currentTab = \'tab-3\'"> 抓取测试 </button> <button v-if="setting.enableTestPage" v-bind:class="[\'tab-button\', { active: setting.currentTab === \'tab-4\'}]" v-on:click="setting.currentTab = \'tab-4\'"> 日志 </button> </div> <div class="nd-setting-body"> <div id="nd-setting-tab-1" class="tab-page" v-show="setting.currentTab === \'tab-1\'"> <div> <input type="checkbox" id="debug" v-model="setting.enableDebug"/> <label for="debug">启用调式模式。（输出更详细日志）</label> <input type="checkbox" id="test-page" v-model="setting.enableTestPage"/> <label for="test-page">启用测试视图</label> </div> <hr class="hr-twill-colorful"/> <div> <h3>自定义保存参数</h3> <ul> <li v-for="item of saveOptions"> <input type="radio" v-bind:id="item.key" v-bind:value="item.key" v-model="setting.chooseSaveOption"/> <label v-bind:for="item.key">{{ item.value }}</label> </li> </ul> </div> </div> <div id="nd-setting-tab-2" class="tab-page" v-show="setting.currentTab === \'tab-2\'"> <filter-tab v-on:filterupdate="saveFilter"/> </div> <div v-if="setting.enableTestPage" id="nd-setting-tab-3" class="tab-page" v-show="setting.currentTab === \'tab-3\'"> <test-ui></test-ui> </div> <div v-if="setting.enableTestPage" id="nd-setting-tab-4" class="tab-page" v-show="setting.currentTab === \'tab-4\'"> <log-ui></log-ui> </div> </div> <div class="nd-setting-footer"> <button v-on:click="closeAndSaveSetting">Save</button> <button v-on:click="closeSetting">Cancel</button> </div> </div> </dialog-ui> </div> '}).mount(_),I=(0,c.wj)(m.Z,"button-div-style"),V=(0,c.ut)('<div id="nd-button"></div>'),R=(0,i.createApp)({data:()=>({imgStart:h.cl,imgSetting:h.d7,isSettingSeen:"Greasemonkey"!==s._p.scriptHandler,imgJump:h.y6,uiObj:{}}),methods:{startButtonClick(){if(window.downloading)return void alert("正在下载中，请耐心等待……");const e=this;e.imgStart=h.wE,async function(){const e=await l();await e.run()}().then((()=>{e.imgStart=h.cl})).catch((e=>a().error(e)))},settingButtonClick(){U.openSetting()},jumpButtonClick(){this.uiObj.jumpFunction()}},mounted(){Object.assign(this.uiObj,function(){switch(document.location.host){case"wap.shuquge.com":return()=>{const e=/(\d+)\.html$/.exec(document.location.pathname)?.[1];return e?{type:"jump",jumpFunction(){document.location.href=`https://www.shuquge.com/txt/${e}/index.html`}}:u};case"m.xinwanben.com":return()=>({type:"jump",jumpFunction(){document.location.host="www.xinwanben.com"}});case"www.tadu.com":return()=>/^\/book\/\d+\/?$/.test(document.location.pathname)?d:u;case"www.kanunu8.com":return()=>document.body.innerHTML.includes("作者：")||document.body.innerHTML.includes("作者:")||document.body.innerHTML.includes("内容简介")?d:u;case"www.ciyuanji.com":return()=>"/bookDetails/info"===document.location.pathname?{type:"jump",jumpFunction:()=>document.location.pathname="/bookDetails/catalog"}:d;case"ebook.longmabook.com":case"www.longmabookcn.com":case"ebook.lmbooks.com":case"www.lmebooks.com":case"www.haitbook.com":case"www.htwhbook.com":case"www.myhtebook.com":case"www.lovehtbooks.com":case"www.myhtebooks.com":case"www.myhtlmebook.com":case"jp.myhtebook.com":case"jp.myhtlmebook.com":case"ebook.urhtbooks.com":case"www.urhtbooks.com":case"www.newhtbook.com":case"www.lvhtebook.com":case"jp.lvhtebook.com":case"www.htlvbooks.com":return()=>{const e=new URLSearchParams(document.location.search);return"showinfo"===e.get("act")&&e.has("bookwritercode")&&e.has("bookid")?d:u};case"m.sfacg.com":return()=>{const e=/(\d+)\/?$/.exec(document.location.pathname)?.[1];return e?{type:"jump",jumpFunction:()=>document.location.href=`https://book.sfacg.com/Novel/${e}/MainIndex/`}:u};case"book.sfacg.com":return()=>{if(/^\/Novel\/\d+\/?$/.test(document.location.pathname)){const e=/(\d+)\/?$/.exec(document.location.pathname)?.[1];return e?{type:"jump",jumpFunction:()=>document.location.href=`https://book.sfacg.com/Novel/${e}/MainIndex/`}:u}return d};case"www.ciweimao.com":return()=>{if(/^\/book\/\d+\/?$/.test(document.location.pathname)){const e=/(\d+)\/?$/.exec(document.location.pathname)?.[1];return e?{type:"jump",jumpFunction:()=>document.location.href=`https://www.ciweimao.com/chapter-list/${e}/book_detail`}:u}return d};case"m.lusetxt.com":return()=>({type:"jump",jumpFunction:()=>document.location.host="www.lusetxt.com"});case"ncode.syosetu.com":case"novel18.syosetu.com":return()=>1===document.location.pathname.split("/").filter((e=>""!==e.trim())).length?d:u;case"manhua.dmzj.com":case"www.dmzj.com":return()=>(window.addEventListener("load",(async()=>{await(0,o._v)(300),document.querySelectorAll('*[style*="2147483647;"]').forEach((e=>e.remove()))})),d);case"www.cool18.com":return()=>{const e=new URL(document.location.href);return"threadview"===e.searchParams.get("act")&&e.searchParams.has("tid")?d:u};default:return()=>d}}()())},template:'<div class="button-div" id="button-div"> <div v-if="uiObj.type !== \'error\'"> <div class="jump" v-if="uiObj.type === \'jump\'"> <button class="jump"> <img class="jump" v-bind:src="imgJump" v-on:click="jumpButtonClick"/> </button> </div> <div class="download" v-if="uiObj.type === \'download\'"> <button class="start"> <img class="start" v-bind:src="imgStart" v-on:click="startButtonClick"/> </button> <button class="setting" v-if="isSettingSeen"> <img class="setting" v-bind:src="imgSetting" v-on:click="settingButtonClick"/> </button> </div> </div> </div> '});var H=n(24);const D=(0,i.defineCustomElement)({name:"Dialog",props:{dialogTitle:String,status:String},emits:["dialogclose"],data(){return{myPrivateStatus:"true"===this.status}},methods:{dialogClose(){this.myPrivateStatus=!1,this.$emit("dialogclose")}},mounted(){this.myPrivateStatus="true"===this.status},watch:{status(){this.myPrivateStatus="true"===this.status}},template:'<div class="overlay" v-bind:class="{ open: myPrivateStatus }" v-if="myPrivateStatus"></div> <div class="out" v-if="myPrivateStatus"> <div id="dialog" class="dialog" v-bind:class="{ open: myPrivateStatus }"> <div class="titlebar"> <h1 class="dialog-title">{{ dialogTitle }}</h1> <button class="dialog-close" v-on:click="dialogClose">❌</button> </div> <div class="body"> <slot></slot> </div> </div> </div> ',styles:[H.Z]});var O=n(25);async function B(){!function(){window.workerId=(0,o.HP)(),window.downloading=!1,window.localStorageExpired=new t.Z;const e=new AbortController,n=e.signal;window.stopController=e,window.stopFlag=n}(),await async function(){a().info("[Init]开始载入小说下载器……"),Object.entries(await(0,e.Ty)()).forEach((e=>a().info("[Init]"+e.join("："))))}(),customElements.define("dialog-ui",D),R.mount(V),document.body.appendChild(V),document.body.appendChild(O.el),document.body.appendChild(_),document.head.appendChild(I),document.head.appendChild(O.o),document.head.appendChild(L),document.head.appendChild(A),document.head.appendChild(w),document.head.appendChild(q)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(e=>{B()})):B()})()})();